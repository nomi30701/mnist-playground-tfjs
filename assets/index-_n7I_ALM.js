var B_e=Object.defineProperty;var U_e=(e,t,n)=>t in e?B_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var W_e=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ot=(e,t,n)=>(U_e(e,typeof t!="symbol"?t+"":t,n),n);var WYt=W_e((eZt,YG)=>{function V_e(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Em(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var Tie={exports:{}},hN={},Aie={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E2=Symbol.for("react.element"),j_e=Symbol.for("react.portal"),H_e=Symbol.for("react.fragment"),G_e=Symbol.for("react.strict_mode"),q_e=Symbol.for("react.profiler"),X_e=Symbol.for("react.provider"),K_e=Symbol.for("react.context"),Y_e=Symbol.for("react.forward_ref"),Z_e=Symbol.for("react.suspense"),Q_e=Symbol.for("react.memo"),J_e=Symbol.for("react.lazy"),nX=Symbol.iterator;function eEe(e){return e===null||typeof e!="object"?null:(e=nX&&e[nX]||e["@@iterator"],typeof e=="function"?e:null)}var Nie={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Iie=Object.assign,Die={};function F1(e,t,n){this.props=e,this.context=t,this.refs=Die,this.updater=n||Nie}F1.prototype.isReactComponent={};F1.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};F1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Oie(){}Oie.prototype=F1.prototype;function nz(e,t,n){this.props=e,this.context=t,this.refs=Die,this.updater=n||Nie}var rz=nz.prototype=new Oie;rz.constructor=nz;Iie(rz,F1.prototype);rz.isPureReactComponent=!0;var rX=Array.isArray,Fie=Object.prototype.hasOwnProperty,iz={current:null},Rie={key:!0,ref:!0,__self:!0,__source:!0};function Mie(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Fie.call(t,r)&&!Rie.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var u=Array(a),l=0;l<a;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:E2,type:e,key:s,ref:o,props:i,_owner:iz.current}}function tEe(e,t){return{$$typeof:E2,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function sz(e){return typeof e=="object"&&e!==null&&e.$$typeof===E2}function nEe(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var iX=/\/+/g;function zF(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nEe(""+e.key):t.toString(36)}function C_(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case E2:case j_e:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+zF(o,0):r,rX(i)?(n="",e!=null&&(n=e.replace(iX,"$&/")+"/"),C_(i,t,n,"",function(l){return l})):i!=null&&(sz(i)&&(i=tEe(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(iX,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",rX(e))for(var a=0;a<e.length;a++){s=e[a];var u=r+zF(s,a);o+=C_(s,t,n,u,i)}else if(u=eEe(e),typeof u=="function")for(e=u.call(e),a=0;!(s=e.next()).done;)s=s.value,u=r+zF(s,a++),o+=C_(s,t,n,u,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Mk(e,t,n){if(e==null)return e;var r=[],i=0;return C_(e,r,"","",function(s){return t.call(n,s,i++)}),r}function rEe(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $s={current:null},k_={transition:null},iEe={ReactCurrentDispatcher:$s,ReactCurrentBatchConfig:k_,ReactCurrentOwner:iz};function Pie(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:Mk,forEach:function(e,t,n){Mk(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Mk(e,function(){t++}),t},toArray:function(e){return Mk(e,function(t){return t})||[]},only:function(e){if(!sz(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};It.Component=F1;It.Fragment=H_e;It.Profiler=q_e;It.PureComponent=nz;It.StrictMode=G_e;It.Suspense=Z_e;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iEe;It.act=Pie;It.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Iie({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=iz.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)Fie.call(t,u)&&!Rie.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var l=0;l<u;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:E2,type:e.type,key:i,ref:s,props:r,_owner:o}};It.createContext=function(e){return e={$$typeof:K_e,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:X_e,_context:e},e.Consumer=e};It.createElement=Mie;It.createFactory=function(e){var t=Mie.bind(null,e);return t.type=e,t};It.createRef=function(){return{current:null}};It.forwardRef=function(e){return{$$typeof:Y_e,render:e}};It.isValidElement=sz;It.lazy=function(e){return{$$typeof:J_e,_payload:{_status:-1,_result:e},_init:rEe}};It.memo=function(e,t){return{$$typeof:Q_e,type:e,compare:t===void 0?null:t}};It.startTransition=function(e){var t=k_.transition;k_.transition={};try{e()}finally{k_.transition=t}};It.unstable_act=Pie;It.useCallback=function(e,t){return $s.current.useCallback(e,t)};It.useContext=function(e){return $s.current.useContext(e)};It.useDebugValue=function(){};It.useDeferredValue=function(e){return $s.current.useDeferredValue(e)};It.useEffect=function(e,t){return $s.current.useEffect(e,t)};It.useId=function(){return $s.current.useId()};It.useImperativeHandle=function(e,t,n){return $s.current.useImperativeHandle(e,t,n)};It.useInsertionEffect=function(e,t){return $s.current.useInsertionEffect(e,t)};It.useLayoutEffect=function(e,t){return $s.current.useLayoutEffect(e,t)};It.useMemo=function(e,t){return $s.current.useMemo(e,t)};It.useReducer=function(e,t,n){return $s.current.useReducer(e,t,n)};It.useRef=function(e){return $s.current.useRef(e)};It.useState=function(e){return $s.current.useState(e)};It.useSyncExternalStore=function(e,t,n){return $s.current.useSyncExternalStore(e,t,n)};It.useTransition=function(){return $s.current.useTransition()};It.version="18.3.1";Aie.exports=It;var Ic=Aie.exports;const sEe=O1(Ic);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oEe=Ic,aEe=Symbol.for("react.element"),uEe=Symbol.for("react.fragment"),lEe=Object.prototype.hasOwnProperty,cEe=oEe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fEe={key:!0,ref:!0,__self:!0,__source:!0};function Lie(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)lEe.call(t,r)&&!fEe.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:aEe,type:e,key:s,ref:o,props:i,_owner:cEe.current}}hN.Fragment=uEe;hN.jsx=Lie;hN.jsxs=Lie;Tie.exports=hN;var tt=Tie.exports,g4={},zie={exports:{}},Ho={},Bie={exports:{}},Uie={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,B){var q=F.length;F.push(B);e:for(;0<q;){var J=q-1>>>1,ne=F[J];if(0<i(ne,B))F[J]=B,F[q]=ne,q=J;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var B=F[0],q=F.pop();if(q!==B){F[0]=q;e:for(var J=0,ne=F.length,re=ne>>>1;J<re;){var ae=2*(J+1)-1,le=F[ae],me=ae+1,Oe=F[me];if(0>i(le,q))me<ne&&0>i(Oe,le)?(F[J]=Oe,F[me]=q,J=me):(F[J]=le,F[ae]=q,J=ae);else if(me<ne&&0>i(Oe,q))F[J]=Oe,F[me]=q,J=me;else break e}}return B}function i(F,B){var q=F.sortIndex-B.sortIndex;return q!==0?q:F.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var u=[],l=[],c=1,f=null,d=3,h=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(F){for(var B=n(l);B!==null;){if(B.callback===null)r(l);else if(B.startTime<=F)r(l),B.sortIndex=B.expirationTime,t(u,B);else break;B=n(l)}}function x(F){if(m=!1,v(F),!p)if(n(u)!==null)p=!0,P(w);else{var B=n(l);B!==null&&V(x,B.startTime-F)}}function w(F,B){p=!1,m&&(m=!1,y(k),k=-1),h=!0;var q=d;try{for(v(B),f=n(u);f!==null&&(!(f.expirationTime>B)||F&&!T());){var J=f.callback;if(typeof J=="function"){f.callback=null,d=f.priorityLevel;var ne=J(f.expirationTime<=B);B=e.unstable_now(),typeof ne=="function"?f.callback=ne:f===n(u)&&r(u),v(B)}else r(u);f=n(u)}if(f!==null)var re=!0;else{var ae=n(l);ae!==null&&V(x,ae.startTime-B),re=!1}return re}finally{f=null,d=q,h=!1}}var S=!1,C=null,k=-1,E=5,_=-1;function T(){return!(e.unstable_now()-_<E)}function D(){if(C!==null){var F=e.unstable_now();_=F;var B=!0;try{B=C(!0,F)}finally{B?O():(S=!1,C=null)}}else S=!1}var O;if(typeof b=="function")O=function(){b(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,I=M.port2;M.port1.onmessage=D,O=function(){I.postMessage(null)}}else O=function(){g(D,0)};function P(F){C=F,S||(S=!0,O())}function V(F,B){k=g(function(){F(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,P(w))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(F){switch(d){case 1:case 2:case 3:var B=3;break;default:B=d}var q=d;d=B;try{return F()}finally{d=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,B){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var q=d;d=F;try{return B()}finally{d=q}},e.unstable_scheduleCallback=function(F,B,q){var J=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?J+q:J):q=J,F){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=q+ne,F={id:c++,callback:B,priorityLevel:F,startTime:q,expirationTime:ne,sortIndex:-1},q>J?(F.sortIndex=q,t(l,F),n(u)===null&&F===n(l)&&(m?(y(k),k=-1):m=!0,V(x,q-J))):(F.sortIndex=ne,t(u,F),p||h||(p=!0,P(w))),F},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(F){var B=d;return function(){var q=d;d=B;try{return F.apply(this,arguments)}finally{d=q}}}})(Uie);Bie.exports=Uie;var dEe=Bie.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hEe=Ic,Bo=dEe;function ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wie=new Set,nw={};function Tm(e,t){I0(e,t),I0(e+"Capture",t)}function I0(e,t){for(nw[e]=t,e=0;e<t.length;e++)Wie.add(t[e])}var zc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),y4=Object.prototype.hasOwnProperty,pEe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sX={},oX={};function mEe(e){return y4.call(oX,e)?!0:y4.call(sX,e)?!1:pEe.test(e)?oX[e]=!0:(sX[e]=!0,!1)}function gEe(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function yEe(e,t,n,r){if(t===null||typeof t>"u"||gEe(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _s(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var vi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){vi[e]=new _s(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];vi[t]=new _s(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){vi[e]=new _s(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){vi[e]=new _s(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){vi[e]=new _s(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){vi[e]=new _s(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){vi[e]=new _s(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){vi[e]=new _s(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){vi[e]=new _s(e,5,!1,e.toLowerCase(),null,!1,!1)});var oz=/[\-:]([a-z])/g;function az(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(oz,az);vi[t]=new _s(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(oz,az);vi[t]=new _s(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(oz,az);vi[t]=new _s(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){vi[e]=new _s(e,1,!1,e.toLowerCase(),null,!1,!1)});vi.xlinkHref=new _s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){vi[e]=new _s(e,1,!1,e.toLowerCase(),null,!0,!0)});function uz(e,t,n,r){var i=vi.hasOwnProperty(t)?vi[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(yEe(t,n,i,r)&&(n=null),r||i===null?mEe(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var rf=hEe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pk=Symbol.for("react.element"),Wg=Symbol.for("react.portal"),Vg=Symbol.for("react.fragment"),lz=Symbol.for("react.strict_mode"),b4=Symbol.for("react.profiler"),Vie=Symbol.for("react.provider"),jie=Symbol.for("react.context"),cz=Symbol.for("react.forward_ref"),v4=Symbol.for("react.suspense"),x4=Symbol.for("react.suspense_list"),fz=Symbol.for("react.memo"),Df=Symbol.for("react.lazy"),Hie=Symbol.for("react.offscreen"),aX=Symbol.iterator;function Bb(e){return e===null||typeof e!="object"?null:(e=aX&&e[aX]||e["@@iterator"],typeof e=="function"?e:null)}var Kn=Object.assign,BF;function Dv(e){if(BF===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);BF=t&&t[1]||""}return`
`+BF+e}var UF=!1;function WF(e,t){if(!e||UF)return"";UF=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var u=`
`+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=a);break}}}finally{UF=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Dv(e):""}function bEe(e){switch(e.tag){case 5:return Dv(e.type);case 16:return Dv("Lazy");case 13:return Dv("Suspense");case 19:return Dv("SuspenseList");case 0:case 2:case 15:return e=WF(e.type,!1),e;case 11:return e=WF(e.type.render,!1),e;case 1:return e=WF(e.type,!0),e;default:return""}}function w4(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vg:return"Fragment";case Wg:return"Portal";case b4:return"Profiler";case lz:return"StrictMode";case v4:return"Suspense";case x4:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case jie:return(e.displayName||"Context")+".Consumer";case Vie:return(e._context.displayName||"Context")+".Provider";case cz:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case fz:return t=e.displayName||null,t!==null?t:w4(e.type)||"Memo";case Df:t=e._payload,e=e._init;try{return w4(e(t))}catch{}}return null}function vEe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return w4(t);case 8:return t===lz?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xd(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Gie(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xEe(e){var t=Gie(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lk(e){e._valueTracker||(e._valueTracker=xEe(e))}function qie(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Gie(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function pE(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function S4(e,t){var n=t.checked;return Kn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function uX(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=xd(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Xie(e,t){t=t.checked,t!=null&&uz(e,"checked",t,!1)}function C4(e,t){Xie(e,t);var n=xd(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?k4(e,t.type,n):t.hasOwnProperty("defaultValue")&&k4(e,t.type,xd(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function lX(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function k4(e,t,n){(t!=="number"||pE(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ov=Array.isArray;function u0(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+xd(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function $4(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ge(91));return Kn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cX(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ge(92));if(Ov(n)){if(1<n.length)throw Error(ge(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:xd(n)}}function Kie(e,t){var n=xd(t.value),r=xd(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function fX(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Yie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _4(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Yie(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var zk,Zie=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(zk=zk||document.createElement("div"),zk.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=zk.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function rw(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var vx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wEe=["Webkit","ms","Moz","O"];Object.keys(vx).forEach(function(e){wEe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vx[t]=vx[e]})});function Qie(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||vx.hasOwnProperty(e)&&vx[e]?(""+t).trim():t+"px"}function Jie(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Qie(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var SEe=Kn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function E4(e,t){if(t){if(SEe[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ge(62))}}function T4(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var A4=null;function dz(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var N4=null,l0=null,c0=null;function dX(e){if(e=N2(e)){if(typeof N4!="function")throw Error(ge(280));var t=e.stateNode;t&&(t=bN(t),N4(e.stateNode,e.type,t))}}function ese(e){l0?c0?c0.push(e):c0=[e]:l0=e}function tse(){if(l0){var e=l0,t=c0;if(c0=l0=null,dX(e),t)for(e=0;e<t.length;e++)dX(t[e])}}function nse(e,t){return e(t)}function rse(){}var VF=!1;function ise(e,t,n){if(VF)return e(t,n);VF=!0;try{return nse(e,t,n)}finally{VF=!1,(l0!==null||c0!==null)&&(rse(),tse())}}function iw(e,t){var n=e.stateNode;if(n===null)return null;var r=bN(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ge(231,t,typeof n));return n}var I4=!1;if(zc)try{var Ub={};Object.defineProperty(Ub,"passive",{get:function(){I4=!0}}),window.addEventListener("test",Ub,Ub),window.removeEventListener("test",Ub,Ub)}catch{I4=!1}function CEe(e,t,n,r,i,s,o,a,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var xx=!1,mE=null,gE=!1,D4=null,kEe={onError:function(e){xx=!0,mE=e}};function $Ee(e,t,n,r,i,s,o,a,u){xx=!1,mE=null,CEe.apply(kEe,arguments)}function _Ee(e,t,n,r,i,s,o,a,u){if($Ee.apply(this,arguments),xx){if(xx){var l=mE;xx=!1,mE=null}else throw Error(ge(198));gE||(gE=!0,D4=l)}}function Am(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function sse(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hX(e){if(Am(e)!==e)throw Error(ge(188))}function EEe(e){var t=e.alternate;if(!t){if(t=Am(e),t===null)throw Error(ge(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return hX(i),e;if(s===r)return hX(i),t;s=s.sibling}throw Error(ge(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ge(189))}}if(n.alternate!==r)throw Error(ge(190))}if(n.tag!==3)throw Error(ge(188));return n.stateNode.current===n?e:t}function ose(e){return e=EEe(e),e!==null?ase(e):null}function ase(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ase(e);if(t!==null)return t;e=e.sibling}return null}var use=Bo.unstable_scheduleCallback,pX=Bo.unstable_cancelCallback,TEe=Bo.unstable_shouldYield,AEe=Bo.unstable_requestPaint,ur=Bo.unstable_now,NEe=Bo.unstable_getCurrentPriorityLevel,hz=Bo.unstable_ImmediatePriority,lse=Bo.unstable_UserBlockingPriority,yE=Bo.unstable_NormalPriority,IEe=Bo.unstable_LowPriority,cse=Bo.unstable_IdlePriority,pN=null,hl=null;function DEe(e){if(hl&&typeof hl.onCommitFiberRoot=="function")try{hl.onCommitFiberRoot(pN,e,void 0,(e.current.flags&128)===128)}catch{}}var du=Math.clz32?Math.clz32:REe,OEe=Math.log,FEe=Math.LN2;function REe(e){return e>>>=0,e===0?32:31-(OEe(e)/FEe|0)|0}var Bk=64,Uk=4194304;function Fv(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function bE(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Fv(a):(s&=o,s!==0&&(r=Fv(s)))}else o=n&~i,o!==0?r=Fv(o):s!==0&&(r=Fv(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-du(t),i=1<<n,r|=e[n],t&=~i;return r}function MEe(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PEe(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-du(s),a=1<<o,u=i[o];u===-1?(!(a&n)||a&r)&&(i[o]=MEe(a,t)):u<=t&&(e.expiredLanes|=a),s&=~a}}function O4(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fse(){var e=Bk;return Bk<<=1,!(Bk&4194240)&&(Bk=64),e}function jF(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function T2(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-du(t),e[t]=n}function LEe(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-du(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function pz(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-du(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var sn=0;function dse(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hse,mz,pse,mse,gse,F4=!1,Wk=[],rd=null,id=null,sd=null,sw=new Map,ow=new Map,zf=[],zEe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mX(e,t){switch(e){case"focusin":case"focusout":rd=null;break;case"dragenter":case"dragleave":id=null;break;case"mouseover":case"mouseout":sd=null;break;case"pointerover":case"pointerout":sw.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ow.delete(t.pointerId)}}function Wb(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=N2(t),t!==null&&mz(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function BEe(e,t,n,r,i){switch(t){case"focusin":return rd=Wb(rd,e,t,n,r,i),!0;case"dragenter":return id=Wb(id,e,t,n,r,i),!0;case"mouseover":return sd=Wb(sd,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return sw.set(s,Wb(sw.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ow.set(s,Wb(ow.get(s)||null,e,t,n,r,i)),!0}return!1}function yse(e){var t=up(e.target);if(t!==null){var n=Am(t);if(n!==null){if(t=n.tag,t===13){if(t=sse(n),t!==null){e.blockedOn=t,gse(e.priority,function(){pse(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $_(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=R4(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);A4=r,n.target.dispatchEvent(r),A4=null}else return t=N2(n),t!==null&&mz(t),e.blockedOn=n,!1;t.shift()}return!0}function gX(e,t,n){$_(e)&&n.delete(t)}function UEe(){F4=!1,rd!==null&&$_(rd)&&(rd=null),id!==null&&$_(id)&&(id=null),sd!==null&&$_(sd)&&(sd=null),sw.forEach(gX),ow.forEach(gX)}function Vb(e,t){e.blockedOn===t&&(e.blockedOn=null,F4||(F4=!0,Bo.unstable_scheduleCallback(Bo.unstable_NormalPriority,UEe)))}function aw(e){function t(i){return Vb(i,e)}if(0<Wk.length){Vb(Wk[0],e);for(var n=1;n<Wk.length;n++){var r=Wk[n];r.blockedOn===e&&(r.blockedOn=null)}}for(rd!==null&&Vb(rd,e),id!==null&&Vb(id,e),sd!==null&&Vb(sd,e),sw.forEach(t),ow.forEach(t),n=0;n<zf.length;n++)r=zf[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<zf.length&&(n=zf[0],n.blockedOn===null);)yse(n),n.blockedOn===null&&zf.shift()}var f0=rf.ReactCurrentBatchConfig,vE=!0;function WEe(e,t,n,r){var i=sn,s=f0.transition;f0.transition=null;try{sn=1,gz(e,t,n,r)}finally{sn=i,f0.transition=s}}function VEe(e,t,n,r){var i=sn,s=f0.transition;f0.transition=null;try{sn=4,gz(e,t,n,r)}finally{sn=i,f0.transition=s}}function gz(e,t,n,r){if(vE){var i=R4(e,t,n,r);if(i===null)eR(e,t,r,xE,n),mX(e,r);else if(BEe(i,e,t,n,r))r.stopPropagation();else if(mX(e,r),t&4&&-1<zEe.indexOf(e)){for(;i!==null;){var s=N2(i);if(s!==null&&hse(s),s=R4(e,t,n,r),s===null&&eR(e,t,r,xE,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else eR(e,t,r,null,n)}}var xE=null;function R4(e,t,n,r){if(xE=null,e=dz(r),e=up(e),e!==null)if(t=Am(e),t===null)e=null;else if(n=t.tag,n===13){if(e=sse(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xE=e,null}function bse(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NEe()){case hz:return 1;case lse:return 4;case yE:case IEe:return 16;case cse:return 536870912;default:return 16}default:return 16}}var Wf=null,yz=null,__=null;function vse(){if(__)return __;var e,t=yz,n=t.length,r,i="value"in Wf?Wf.value:Wf.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return __=i.slice(e,1<r?1-r:void 0)}function E_(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Vk(){return!0}function yX(){return!1}function Go(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Vk:yX,this.isPropagationStopped=yX,this}return Kn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vk)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vk)},persist:function(){},isPersistent:Vk}),t}var R1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bz=Go(R1),A2=Kn({},R1,{view:0,detail:0}),jEe=Go(A2),HF,GF,jb,mN=Kn({},A2,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vz,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jb&&(jb&&e.type==="mousemove"?(HF=e.screenX-jb.screenX,GF=e.screenY-jb.screenY):GF=HF=0,jb=e),HF)},movementY:function(e){return"movementY"in e?e.movementY:GF}}),bX=Go(mN),HEe=Kn({},mN,{dataTransfer:0}),GEe=Go(HEe),qEe=Kn({},A2,{relatedTarget:0}),qF=Go(qEe),XEe=Kn({},R1,{animationName:0,elapsedTime:0,pseudoElement:0}),KEe=Go(XEe),YEe=Kn({},R1,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ZEe=Go(YEe),QEe=Kn({},R1,{data:0}),vX=Go(QEe),JEe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eTe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tTe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nTe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=tTe[e])?!!t[e]:!1}function vz(){return nTe}var rTe=Kn({},A2,{key:function(e){if(e.key){var t=JEe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=E_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?eTe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vz,charCode:function(e){return e.type==="keypress"?E_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?E_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iTe=Go(rTe),sTe=Kn({},mN,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xX=Go(sTe),oTe=Kn({},A2,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vz}),aTe=Go(oTe),uTe=Kn({},R1,{propertyName:0,elapsedTime:0,pseudoElement:0}),lTe=Go(uTe),cTe=Kn({},mN,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fTe=Go(cTe),dTe=[9,13,27,32],xz=zc&&"CompositionEvent"in window,wx=null;zc&&"documentMode"in document&&(wx=document.documentMode);var hTe=zc&&"TextEvent"in window&&!wx,xse=zc&&(!xz||wx&&8<wx&&11>=wx),wX=" ",SX=!1;function wse(e,t){switch(e){case"keyup":return dTe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sse(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var jg=!1;function pTe(e,t){switch(e){case"compositionend":return Sse(t);case"keypress":return t.which!==32?null:(SX=!0,wX);case"textInput":return e=t.data,e===wX&&SX?null:e;default:return null}}function mTe(e,t){if(jg)return e==="compositionend"||!xz&&wse(e,t)?(e=vse(),__=yz=Wf=null,jg=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xse&&t.locale!=="ko"?null:t.data;default:return null}}var gTe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function CX(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gTe[e.type]:t==="textarea"}function Cse(e,t,n,r){ese(r),t=wE(t,"onChange"),0<t.length&&(n=new bz("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Sx=null,uw=null;function yTe(e){Fse(e,0)}function gN(e){var t=qg(e);if(qie(t))return e}function bTe(e,t){if(e==="change")return t}var kse=!1;if(zc){var XF;if(zc){var KF="oninput"in document;if(!KF){var kX=document.createElement("div");kX.setAttribute("oninput","return;"),KF=typeof kX.oninput=="function"}XF=KF}else XF=!1;kse=XF&&(!document.documentMode||9<document.documentMode)}function $X(){Sx&&(Sx.detachEvent("onpropertychange",$se),uw=Sx=null)}function $se(e){if(e.propertyName==="value"&&gN(uw)){var t=[];Cse(t,uw,e,dz(e)),ise(yTe,t)}}function vTe(e,t,n){e==="focusin"?($X(),Sx=t,uw=n,Sx.attachEvent("onpropertychange",$se)):e==="focusout"&&$X()}function xTe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return gN(uw)}function wTe(e,t){if(e==="click")return gN(t)}function STe(e,t){if(e==="input"||e==="change")return gN(t)}function CTe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ku=typeof Object.is=="function"?Object.is:CTe;function lw(e,t){if(ku(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!y4.call(t,i)||!ku(e[i],t[i]))return!1}return!0}function _X(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function EX(e,t){var n=_X(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_X(n)}}function _se(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?_se(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ese(){for(var e=window,t=pE();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=pE(e.document)}return t}function wz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function kTe(e){var t=Ese(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&_se(n.ownerDocument.documentElement,n)){if(r!==null&&wz(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=EX(n,s);var o=EX(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var $Te=zc&&"documentMode"in document&&11>=document.documentMode,Hg=null,M4=null,Cx=null,P4=!1;function TX(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;P4||Hg==null||Hg!==pE(r)||(r=Hg,"selectionStart"in r&&wz(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Cx&&lw(Cx,r)||(Cx=r,r=wE(M4,"onSelect"),0<r.length&&(t=new bz("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Hg)))}function jk(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Gg={animationend:jk("Animation","AnimationEnd"),animationiteration:jk("Animation","AnimationIteration"),animationstart:jk("Animation","AnimationStart"),transitionend:jk("Transition","TransitionEnd")},YF={},Tse={};zc&&(Tse=document.createElement("div").style,"AnimationEvent"in window||(delete Gg.animationend.animation,delete Gg.animationiteration.animation,delete Gg.animationstart.animation),"TransitionEvent"in window||delete Gg.transitionend.transition);function yN(e){if(YF[e])return YF[e];if(!Gg[e])return e;var t=Gg[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Tse)return YF[e]=t[n];return e}var Ase=yN("animationend"),Nse=yN("animationiteration"),Ise=yN("animationstart"),Dse=yN("transitionend"),Ose=new Map,AX="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hd(e,t){Ose.set(e,t),Tm(t,[e])}for(var ZF=0;ZF<AX.length;ZF++){var QF=AX[ZF],_Te=QF.toLowerCase(),ETe=QF[0].toUpperCase()+QF.slice(1);Hd(_Te,"on"+ETe)}Hd(Ase,"onAnimationEnd");Hd(Nse,"onAnimationIteration");Hd(Ise,"onAnimationStart");Hd("dblclick","onDoubleClick");Hd("focusin","onFocus");Hd("focusout","onBlur");Hd(Dse,"onTransitionEnd");I0("onMouseEnter",["mouseout","mouseover"]);I0("onMouseLeave",["mouseout","mouseover"]);I0("onPointerEnter",["pointerout","pointerover"]);I0("onPointerLeave",["pointerout","pointerover"]);Tm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tm("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TTe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rv));function NX(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,_Ee(r,t,void 0,e),e.currentTarget=null}function Fse(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,l=a.currentTarget;if(a=a.listener,u!==s&&i.isPropagationStopped())break e;NX(i,a,l),s=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,l=a.currentTarget,a=a.listener,u!==s&&i.isPropagationStopped())break e;NX(i,a,l),s=u}}}if(gE)throw e=D4,gE=!1,D4=null,e}function $n(e,t){var n=t[W4];n===void 0&&(n=t[W4]=new Set);var r=e+"__bubble";n.has(r)||(Rse(t,e,2,!1),n.add(r))}function JF(e,t,n){var r=0;t&&(r|=4),Rse(n,e,r,t)}var Hk="_reactListening"+Math.random().toString(36).slice(2);function cw(e){if(!e[Hk]){e[Hk]=!0,Wie.forEach(function(n){n!=="selectionchange"&&(TTe.has(n)||JF(n,!1,e),JF(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Hk]||(t[Hk]=!0,JF("selectionchange",!1,t))}}function Rse(e,t,n,r){switch(bse(t)){case 1:var i=WEe;break;case 4:i=VEe;break;default:i=gz}n=i.bind(null,t,n,e),i=void 0,!I4||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function eR(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;a!==null;){if(o=up(a),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}a=a.parentNode}}r=r.return}ise(function(){var l=s,c=dz(n),f=[];e:{var d=Ose.get(e);if(d!==void 0){var h=bz,p=e;switch(e){case"keypress":if(E_(n)===0)break e;case"keydown":case"keyup":h=iTe;break;case"focusin":p="focus",h=qF;break;case"focusout":p="blur",h=qF;break;case"beforeblur":case"afterblur":h=qF;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=bX;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=GEe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=aTe;break;case Ase:case Nse:case Ise:h=KEe;break;case Dse:h=lTe;break;case"scroll":h=jEe;break;case"wheel":h=fTe;break;case"copy":case"cut":case"paste":h=ZEe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=xX}var m=(t&4)!==0,g=!m&&e==="scroll",y=m?d!==null?d+"Capture":null:d;m=[];for(var b=l,v;b!==null;){v=b;var x=v.stateNode;if(v.tag===5&&x!==null&&(v=x,y!==null&&(x=iw(b,y),x!=null&&m.push(fw(b,x,v)))),g)break;b=b.return}0<m.length&&(d=new h(d,p,null,n,c),f.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&n!==A4&&(p=n.relatedTarget||n.fromElement)&&(up(p)||p[Bc]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?up(p):null,p!==null&&(g=Am(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(m=bX,x="onMouseLeave",y="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=xX,x="onPointerLeave",y="onPointerEnter",b="pointer"),g=h==null?d:qg(h),v=p==null?d:qg(p),d=new m(x,b+"leave",h,n,c),d.target=g,d.relatedTarget=v,x=null,up(c)===l&&(m=new m(y,b+"enter",p,n,c),m.target=v,m.relatedTarget=g,x=m),g=x,h&&p)t:{for(m=h,y=p,b=0,v=m;v;v=kg(v))b++;for(v=0,x=y;x;x=kg(x))v++;for(;0<b-v;)m=kg(m),b--;for(;0<v-b;)y=kg(y),v--;for(;b--;){if(m===y||y!==null&&m===y.alternate)break t;m=kg(m),y=kg(y)}m=null}else m=null;h!==null&&IX(f,d,h,m,!1),p!==null&&g!==null&&IX(f,g,p,m,!0)}}e:{if(d=l?qg(l):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var w=bTe;else if(CX(d))if(kse)w=STe;else{w=xTe;var S=vTe}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=wTe);if(w&&(w=w(e,l))){Cse(f,w,n,c);break e}S&&S(e,d,l),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&k4(d,"number",d.value)}switch(S=l?qg(l):window,e){case"focusin":(CX(S)||S.contentEditable==="true")&&(Hg=S,M4=l,Cx=null);break;case"focusout":Cx=M4=Hg=null;break;case"mousedown":P4=!0;break;case"contextmenu":case"mouseup":case"dragend":P4=!1,TX(f,n,c);break;case"selectionchange":if($Te)break;case"keydown":case"keyup":TX(f,n,c)}var C;if(xz)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else jg?wse(e,n)&&(k="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(xse&&n.locale!=="ko"&&(jg||k!=="onCompositionStart"?k==="onCompositionEnd"&&jg&&(C=vse()):(Wf=c,yz="value"in Wf?Wf.value:Wf.textContent,jg=!0)),S=wE(l,k),0<S.length&&(k=new vX(k,e,null,n,c),f.push({event:k,listeners:S}),C?k.data=C:(C=Sse(n),C!==null&&(k.data=C)))),(C=hTe?pTe(e,n):mTe(e,n))&&(l=wE(l,"onBeforeInput"),0<l.length&&(c=new vX("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:l}),c.data=C))}Fse(f,t)})}function fw(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wE(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=iw(e,n),s!=null&&r.unshift(fw(e,s,i)),s=iw(e,t),s!=null&&r.push(fw(e,s,i))),e=e.return}return r}function kg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function IX(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var a=n,u=a.alternate,l=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&l!==null&&(a=l,i?(u=iw(n,s),u!=null&&o.unshift(fw(n,u,a))):i||(u=iw(n,s),u!=null&&o.push(fw(n,u,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var ATe=/\r\n?/g,NTe=/\u0000|\uFFFD/g;function DX(e){return(typeof e=="string"?e:""+e).replace(ATe,`
`).replace(NTe,"")}function Gk(e,t,n){if(t=DX(t),DX(e)!==t&&n)throw Error(ge(425))}function SE(){}var L4=null,z4=null;function B4(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var U4=typeof setTimeout=="function"?setTimeout:void 0,ITe=typeof clearTimeout=="function"?clearTimeout:void 0,OX=typeof Promise=="function"?Promise:void 0,DTe=typeof queueMicrotask=="function"?queueMicrotask:typeof OX<"u"?function(e){return OX.resolve(null).then(e).catch(OTe)}:U4;function OTe(e){setTimeout(function(){throw e})}function tR(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),aw(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);aw(t)}function od(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function FX(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var M1=Math.random().toString(36).slice(2),ol="__reactFiber$"+M1,dw="__reactProps$"+M1,Bc="__reactContainer$"+M1,W4="__reactEvents$"+M1,FTe="__reactListeners$"+M1,RTe="__reactHandles$"+M1;function up(e){var t=e[ol];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Bc]||n[ol]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=FX(e);e!==null;){if(n=e[ol])return n;e=FX(e)}return t}e=n,n=e.parentNode}return null}function N2(e){return e=e[ol]||e[Bc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qg(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ge(33))}function bN(e){return e[dw]||null}var V4=[],Xg=-1;function Gd(e){return{current:e}}function In(e){0>Xg||(e.current=V4[Xg],V4[Xg]=null,Xg--)}function wn(e,t){Xg++,V4[Xg]=e.current,e.current=t}var wd={},ji=Gd(wd),Xs=Gd(!1),Op=wd;function D0(e,t){var n=e.type.contextTypes;if(!n)return wd;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ks(e){return e=e.childContextTypes,e!=null}function CE(){In(Xs),In(ji)}function RX(e,t,n){if(ji.current!==wd)throw Error(ge(168));wn(ji,t),wn(Xs,n)}function Mse(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ge(108,vEe(e)||"Unknown",i));return Kn({},n,r)}function kE(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wd,Op=ji.current,wn(ji,e),wn(Xs,Xs.current),!0}function MX(e,t,n){var r=e.stateNode;if(!r)throw Error(ge(169));n?(e=Mse(e,t,Op),r.__reactInternalMemoizedMergedChildContext=e,In(Xs),In(ji),wn(ji,e)):In(Xs),wn(Xs,n)}var cc=null,vN=!1,nR=!1;function Pse(e){cc===null?cc=[e]:cc.push(e)}function MTe(e){vN=!0,Pse(e)}function qd(){if(!nR&&cc!==null){nR=!0;var e=0,t=sn;try{var n=cc;for(sn=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}cc=null,vN=!1}catch(i){throw cc!==null&&(cc=cc.slice(e+1)),use(hz,qd),i}finally{sn=t,nR=!1}}return null}var Kg=[],Yg=0,$E=null,_E=0,sa=[],oa=0,Fp=null,wc=1,Sc="";function Hh(e,t){Kg[Yg++]=_E,Kg[Yg++]=$E,$E=e,_E=t}function Lse(e,t,n){sa[oa++]=wc,sa[oa++]=Sc,sa[oa++]=Fp,Fp=e;var r=wc;e=Sc;var i=32-du(r)-1;r&=~(1<<i),n+=1;var s=32-du(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,wc=1<<32-du(t)+i|n<<i|r,Sc=s+e}else wc=1<<s|n<<i|r,Sc=e}function Sz(e){e.return!==null&&(Hh(e,1),Lse(e,1,0))}function Cz(e){for(;e===$E;)$E=Kg[--Yg],Kg[Yg]=null,_E=Kg[--Yg],Kg[Yg]=null;for(;e===Fp;)Fp=sa[--oa],sa[oa]=null,Sc=sa[--oa],sa[oa]=null,wc=sa[--oa],sa[oa]=null}var Mo=null,$o=null,Mn=!1,ru=null;function zse(e,t){var n=da(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function PX(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Mo=e,$o=od(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Mo=e,$o=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Fp!==null?{id:wc,overflow:Sc}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=da(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Mo=e,$o=null,!0):!1;default:return!1}}function j4(e){return(e.mode&1)!==0&&(e.flags&128)===0}function H4(e){if(Mn){var t=$o;if(t){var n=t;if(!PX(e,t)){if(j4(e))throw Error(ge(418));t=od(n.nextSibling);var r=Mo;t&&PX(e,t)?zse(r,n):(e.flags=e.flags&-4097|2,Mn=!1,Mo=e)}}else{if(j4(e))throw Error(ge(418));e.flags=e.flags&-4097|2,Mn=!1,Mo=e}}}function LX(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Mo=e}function qk(e){if(e!==Mo)return!1;if(!Mn)return LX(e),Mn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!B4(e.type,e.memoizedProps)),t&&(t=$o)){if(j4(e))throw Bse(),Error(ge(418));for(;t;)zse(e,t),t=od(t.nextSibling)}if(LX(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){$o=od(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}$o=null}}else $o=Mo?od(e.stateNode.nextSibling):null;return!0}function Bse(){for(var e=$o;e;)e=od(e.nextSibling)}function O0(){$o=Mo=null,Mn=!1}function kz(e){ru===null?ru=[e]:ru.push(e)}var PTe=rf.ReactCurrentBatchConfig;function Hb(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ge(309));var r=n.stateNode}if(!r)throw Error(ge(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(ge(284));if(!n._owner)throw Error(ge(290,e))}return e}function Xk(e,t){throw e=Object.prototype.toString.call(t),Error(ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zX(e){var t=e._init;return t(e._payload)}function Use(e){function t(y,b){if(e){var v=y.deletions;v===null?(y.deletions=[b],y.flags|=16):v.push(b)}}function n(y,b){if(!e)return null;for(;b!==null;)t(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function i(y,b){return y=cd(y,b),y.index=0,y.sibling=null,y}function s(y,b,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<b?(y.flags|=2,b):v):(y.flags|=2,b)):(y.flags|=1048576,b)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function a(y,b,v,x){return b===null||b.tag!==6?(b=lR(v,y.mode,x),b.return=y,b):(b=i(b,v),b.return=y,b)}function u(y,b,v,x){var w=v.type;return w===Vg?c(y,b,v.props.children,x,v.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Df&&zX(w)===b.type)?(x=i(b,v.props),x.ref=Hb(y,b,v),x.return=y,x):(x=F_(v.type,v.key,v.props,null,y.mode,x),x.ref=Hb(y,b,v),x.return=y,x)}function l(y,b,v,x){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=cR(v,y.mode,x),b.return=y,b):(b=i(b,v.children||[]),b.return=y,b)}function c(y,b,v,x,w){return b===null||b.tag!==7?(b=vp(v,y.mode,x,w),b.return=y,b):(b=i(b,v),b.return=y,b)}function f(y,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=lR(""+b,y.mode,v),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Pk:return v=F_(b.type,b.key,b.props,null,y.mode,v),v.ref=Hb(y,null,b),v.return=y,v;case Wg:return b=cR(b,y.mode,v),b.return=y,b;case Df:var x=b._init;return f(y,x(b._payload),v)}if(Ov(b)||Bb(b))return b=vp(b,y.mode,v,null),b.return=y,b;Xk(y,b)}return null}function d(y,b,v,x){var w=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return w!==null?null:a(y,b,""+v,x);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Pk:return v.key===w?u(y,b,v,x):null;case Wg:return v.key===w?l(y,b,v,x):null;case Df:return w=v._init,d(y,b,w(v._payload),x)}if(Ov(v)||Bb(v))return w!==null?null:c(y,b,v,x,null);Xk(y,v)}return null}function h(y,b,v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return y=y.get(v)||null,a(b,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Pk:return y=y.get(x.key===null?v:x.key)||null,u(b,y,x,w);case Wg:return y=y.get(x.key===null?v:x.key)||null,l(b,y,x,w);case Df:var S=x._init;return h(y,b,v,S(x._payload),w)}if(Ov(x)||Bb(x))return y=y.get(v)||null,c(b,y,x,w,null);Xk(b,x)}return null}function p(y,b,v,x){for(var w=null,S=null,C=b,k=b=0,E=null;C!==null&&k<v.length;k++){C.index>k?(E=C,C=null):E=C.sibling;var _=d(y,C,v[k],x);if(_===null){C===null&&(C=E);break}e&&C&&_.alternate===null&&t(y,C),b=s(_,b,k),S===null?w=_:S.sibling=_,S=_,C=E}if(k===v.length)return n(y,C),Mn&&Hh(y,k),w;if(C===null){for(;k<v.length;k++)C=f(y,v[k],x),C!==null&&(b=s(C,b,k),S===null?w=C:S.sibling=C,S=C);return Mn&&Hh(y,k),w}for(C=r(y,C);k<v.length;k++)E=h(C,y,k,v[k],x),E!==null&&(e&&E.alternate!==null&&C.delete(E.key===null?k:E.key),b=s(E,b,k),S===null?w=E:S.sibling=E,S=E);return e&&C.forEach(function(T){return t(y,T)}),Mn&&Hh(y,k),w}function m(y,b,v,x){var w=Bb(v);if(typeof w!="function")throw Error(ge(150));if(v=w.call(v),v==null)throw Error(ge(151));for(var S=w=null,C=b,k=b=0,E=null,_=v.next();C!==null&&!_.done;k++,_=v.next()){C.index>k?(E=C,C=null):E=C.sibling;var T=d(y,C,_.value,x);if(T===null){C===null&&(C=E);break}e&&C&&T.alternate===null&&t(y,C),b=s(T,b,k),S===null?w=T:S.sibling=T,S=T,C=E}if(_.done)return n(y,C),Mn&&Hh(y,k),w;if(C===null){for(;!_.done;k++,_=v.next())_=f(y,_.value,x),_!==null&&(b=s(_,b,k),S===null?w=_:S.sibling=_,S=_);return Mn&&Hh(y,k),w}for(C=r(y,C);!_.done;k++,_=v.next())_=h(C,y,k,_.value,x),_!==null&&(e&&_.alternate!==null&&C.delete(_.key===null?k:_.key),b=s(_,b,k),S===null?w=_:S.sibling=_,S=_);return e&&C.forEach(function(D){return t(y,D)}),Mn&&Hh(y,k),w}function g(y,b,v,x){if(typeof v=="object"&&v!==null&&v.type===Vg&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Pk:e:{for(var w=v.key,S=b;S!==null;){if(S.key===w){if(w=v.type,w===Vg){if(S.tag===7){n(y,S.sibling),b=i(S,v.props.children),b.return=y,y=b;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Df&&zX(w)===S.type){n(y,S.sibling),b=i(S,v.props),b.ref=Hb(y,S,v),b.return=y,y=b;break e}n(y,S);break}else t(y,S);S=S.sibling}v.type===Vg?(b=vp(v.props.children,y.mode,x,v.key),b.return=y,y=b):(x=F_(v.type,v.key,v.props,null,y.mode,x),x.ref=Hb(y,b,v),x.return=y,y=x)}return o(y);case Wg:e:{for(S=v.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){n(y,b.sibling),b=i(b,v.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else t(y,b);b=b.sibling}b=cR(v,y.mode,x),b.return=y,y=b}return o(y);case Df:return S=v._init,g(y,b,S(v._payload),x)}if(Ov(v))return p(y,b,v,x);if(Bb(v))return m(y,b,v,x);Xk(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(n(y,b.sibling),b=i(b,v),b.return=y,y=b):(n(y,b),b=lR(v,y.mode,x),b.return=y,y=b),o(y)):n(y,b)}return g}var F0=Use(!0),Wse=Use(!1),EE=Gd(null),TE=null,Zg=null,$z=null;function _z(){$z=Zg=TE=null}function Ez(e){var t=EE.current;In(EE),e._currentValue=t}function G4(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function d0(e,t){TE=e,$z=Zg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(js=!0),e.firstContext=null)}function Ia(e){var t=e._currentValue;if($z!==e)if(e={context:e,memoizedValue:t,next:null},Zg===null){if(TE===null)throw Error(ge(308));Zg=e,TE.dependencies={lanes:0,firstContext:e}}else Zg=Zg.next=e;return t}var lp=null;function Tz(e){lp===null?lp=[e]:lp.push(e)}function Vse(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Tz(t)):(n.next=i.next,i.next=n),t.interleaved=n,Uc(e,r)}function Uc(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Of=!1;function Az(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jse(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Dc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ad(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Wt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Uc(e,n)}return i=r.interleaved,i===null?(t.next=t,Tz(r)):(t.next=i.next,i.next=t),r.interleaved=t,Uc(e,n)}function T_(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,pz(e,n)}}function BX(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function AE(e,t,n,r){var i=e.updateQueue;Of=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var u=a,l=u.next;u.next=null,o===null?s=l:o.next=l,o=u;var c=e.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=l:a.next=l,c.lastBaseUpdate=u))}if(s!==null){var f=i.baseState;o=0,c=l=u=null,a=s;do{var d=a.lane,h=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(h,f,d):p,d==null)break e;f=Kn({},f,d);break e;case 2:Of=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else h={eventTime:h,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(l=c=h,u=f):c=c.next=h,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(u=f),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Mp|=o,e.lanes=o,e.memoizedState=f}}function UX(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ge(191,i));i.call(r)}}}var I2={},pl=Gd(I2),hw=Gd(I2),pw=Gd(I2);function cp(e){if(e===I2)throw Error(ge(174));return e}function Nz(e,t){switch(wn(pw,t),wn(hw,e),wn(pl,I2),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_4(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_4(t,e)}In(pl),wn(pl,t)}function R0(){In(pl),In(hw),In(pw)}function Hse(e){cp(pw.current);var t=cp(pl.current),n=_4(t,e.type);t!==n&&(wn(hw,e),wn(pl,n))}function Iz(e){hw.current===e&&(In(pl),In(hw))}var Gn=Gd(0);function NE(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rR=[];function Dz(){for(var e=0;e<rR.length;e++)rR[e]._workInProgressVersionPrimary=null;rR.length=0}var A_=rf.ReactCurrentDispatcher,iR=rf.ReactCurrentBatchConfig,Rp=0,Xn=null,Er=null,Wr=null,IE=!1,kx=!1,mw=0,LTe=0;function $i(){throw Error(ge(321))}function Oz(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ku(e[n],t[n]))return!1;return!0}function Fz(e,t,n,r,i,s){if(Rp=s,Xn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,A_.current=e===null||e.memoizedState===null?WTe:VTe,e=n(r,i),kx){s=0;do{if(kx=!1,mw=0,25<=s)throw Error(ge(301));s+=1,Wr=Er=null,t.updateQueue=null,A_.current=jTe,e=n(r,i)}while(kx)}if(A_.current=DE,t=Er!==null&&Er.next!==null,Rp=0,Wr=Er=Xn=null,IE=!1,t)throw Error(ge(300));return e}function Rz(){var e=mw!==0;return mw=0,e}function tl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?Xn.memoizedState=Wr=e:Wr=Wr.next=e,Wr}function Da(){if(Er===null){var e=Xn.alternate;e=e!==null?e.memoizedState:null}else e=Er.next;var t=Wr===null?Xn.memoizedState:Wr.next;if(t!==null)Wr=t,Er=e;else{if(e===null)throw Error(ge(310));Er=e,e={memoizedState:Er.memoizedState,baseState:Er.baseState,baseQueue:Er.baseQueue,queue:Er.queue,next:null},Wr===null?Xn.memoizedState=Wr=e:Wr=Wr.next=e}return Wr}function gw(e,t){return typeof t=="function"?t(e):t}function sR(e){var t=Da(),n=t.queue;if(n===null)throw Error(ge(311));n.lastRenderedReducer=e;var r=Er,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,u=null,l=s;do{var c=l.lane;if((Rp&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(a=u=f,o=r):u=u.next=f,Xn.lanes|=c,Mp|=c}l=l.next}while(l!==null&&l!==s);u===null?o=r:u.next=a,ku(r,t.memoizedState)||(js=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,Xn.lanes|=s,Mp|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function oR(e){var t=Da(),n=t.queue;if(n===null)throw Error(ge(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);ku(s,t.memoizedState)||(js=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Gse(){}function qse(e,t){var n=Xn,r=Da(),i=t(),s=!ku(r.memoizedState,i);if(s&&(r.memoizedState=i,js=!0),r=r.queue,Mz(Yse.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Wr!==null&&Wr.memoizedState.tag&1){if(n.flags|=2048,yw(9,Kse.bind(null,n,r,i,t),void 0,null),Qr===null)throw Error(ge(349));Rp&30||Xse(n,t,i)}return i}function Xse(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Kse(e,t,n,r){t.value=n,t.getSnapshot=r,Zse(t)&&Qse(e)}function Yse(e,t,n){return n(function(){Zse(t)&&Qse(e)})}function Zse(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ku(e,n)}catch{return!0}}function Qse(e){var t=Uc(e,1);t!==null&&hu(t,e,1,-1)}function WX(e){var t=tl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gw,lastRenderedState:e},t.queue=e,e=e.dispatch=UTe.bind(null,Xn,e),[t.memoizedState,e]}function yw(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Jse(){return Da().memoizedState}function N_(e,t,n,r){var i=tl();Xn.flags|=e,i.memoizedState=yw(1|t,n,void 0,r===void 0?null:r)}function xN(e,t,n,r){var i=Da();r=r===void 0?null:r;var s=void 0;if(Er!==null){var o=Er.memoizedState;if(s=o.destroy,r!==null&&Oz(r,o.deps)){i.memoizedState=yw(t,n,s,r);return}}Xn.flags|=e,i.memoizedState=yw(1|t,n,s,r)}function VX(e,t){return N_(8390656,8,e,t)}function Mz(e,t){return xN(2048,8,e,t)}function eoe(e,t){return xN(4,2,e,t)}function toe(e,t){return xN(4,4,e,t)}function noe(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function roe(e,t,n){return n=n!=null?n.concat([e]):null,xN(4,4,noe.bind(null,t,e),n)}function Pz(){}function ioe(e,t){var n=Da();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Oz(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function soe(e,t){var n=Da();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Oz(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ooe(e,t,n){return Rp&21?(ku(n,t)||(n=fse(),Xn.lanes|=n,Mp|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,js=!0),e.memoizedState=n)}function zTe(e,t){var n=sn;sn=n!==0&&4>n?n:4,e(!0);var r=iR.transition;iR.transition={};try{e(!1),t()}finally{sn=n,iR.transition=r}}function aoe(){return Da().memoizedState}function BTe(e,t,n){var r=ld(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},uoe(e))loe(t,n);else if(n=Vse(e,t,n,r),n!==null){var i=ds();hu(n,e,r,i),coe(n,t,r)}}function UTe(e,t,n){var r=ld(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(uoe(e))loe(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ku(a,o)){var u=t.interleaved;u===null?(i.next=i,Tz(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}n=Vse(e,t,i,r),n!==null&&(i=ds(),hu(n,e,r,i),coe(n,t,r))}}function uoe(e){var t=e.alternate;return e===Xn||t!==null&&t===Xn}function loe(e,t){kx=IE=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function coe(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,pz(e,n)}}var DE={readContext:Ia,useCallback:$i,useContext:$i,useEffect:$i,useImperativeHandle:$i,useInsertionEffect:$i,useLayoutEffect:$i,useMemo:$i,useReducer:$i,useRef:$i,useState:$i,useDebugValue:$i,useDeferredValue:$i,useTransition:$i,useMutableSource:$i,useSyncExternalStore:$i,useId:$i,unstable_isNewReconciler:!1},WTe={readContext:Ia,useCallback:function(e,t){return tl().memoizedState=[e,t===void 0?null:t],e},useContext:Ia,useEffect:VX,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,N_(4194308,4,noe.bind(null,t,e),n)},useLayoutEffect:function(e,t){return N_(4194308,4,e,t)},useInsertionEffect:function(e,t){return N_(4,2,e,t)},useMemo:function(e,t){var n=tl();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=tl();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=BTe.bind(null,Xn,e),[r.memoizedState,e]},useRef:function(e){var t=tl();return e={current:e},t.memoizedState=e},useState:WX,useDebugValue:Pz,useDeferredValue:function(e){return tl().memoizedState=e},useTransition:function(){var e=WX(!1),t=e[0];return e=zTe.bind(null,e[1]),tl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Xn,i=tl();if(Mn){if(n===void 0)throw Error(ge(407));n=n()}else{if(n=t(),Qr===null)throw Error(ge(349));Rp&30||Xse(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,VX(Yse.bind(null,r,s,e),[e]),r.flags|=2048,yw(9,Kse.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=tl(),t=Qr.identifierPrefix;if(Mn){var n=Sc,r=wc;n=(r&~(1<<32-du(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=mw++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=LTe++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},VTe={readContext:Ia,useCallback:ioe,useContext:Ia,useEffect:Mz,useImperativeHandle:roe,useInsertionEffect:eoe,useLayoutEffect:toe,useMemo:soe,useReducer:sR,useRef:Jse,useState:function(){return sR(gw)},useDebugValue:Pz,useDeferredValue:function(e){var t=Da();return ooe(t,Er.memoizedState,e)},useTransition:function(){var e=sR(gw)[0],t=Da().memoizedState;return[e,t]},useMutableSource:Gse,useSyncExternalStore:qse,useId:aoe,unstable_isNewReconciler:!1},jTe={readContext:Ia,useCallback:ioe,useContext:Ia,useEffect:Mz,useImperativeHandle:roe,useInsertionEffect:eoe,useLayoutEffect:toe,useMemo:soe,useReducer:oR,useRef:Jse,useState:function(){return oR(gw)},useDebugValue:Pz,useDeferredValue:function(e){var t=Da();return Er===null?t.memoizedState=e:ooe(t,Er.memoizedState,e)},useTransition:function(){var e=oR(gw)[0],t=Da().memoizedState;return[e,t]},useMutableSource:Gse,useSyncExternalStore:qse,useId:aoe,unstable_isNewReconciler:!1};function Qa(e,t){if(e&&e.defaultProps){t=Kn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function q4(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Kn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var wN={isMounted:function(e){return(e=e._reactInternals)?Am(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ds(),i=ld(e),s=Dc(r,i);s.payload=t,n!=null&&(s.callback=n),t=ad(e,s,i),t!==null&&(hu(t,e,i,r),T_(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ds(),i=ld(e),s=Dc(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=ad(e,s,i),t!==null&&(hu(t,e,i,r),T_(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ds(),r=ld(e),i=Dc(n,r);i.tag=2,t!=null&&(i.callback=t),t=ad(e,i,r),t!==null&&(hu(t,e,r,n),T_(t,e,r))}};function jX(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!lw(n,r)||!lw(i,s):!0}function foe(e,t,n){var r=!1,i=wd,s=t.contextType;return typeof s=="object"&&s!==null?s=Ia(s):(i=Ks(t)?Op:ji.current,r=t.contextTypes,s=(r=r!=null)?D0(e,i):wd),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=wN,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function HX(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&wN.enqueueReplaceState(t,t.state,null)}function X4(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Az(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Ia(s):(s=Ks(t)?Op:ji.current,i.context=D0(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(q4(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&wN.enqueueReplaceState(i,i.state,null),AE(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function M0(e,t){try{var n="",r=t;do n+=bEe(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function aR(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function K4(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var HTe=typeof WeakMap=="function"?WeakMap:Map;function doe(e,t,n){n=Dc(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){FE||(FE=!0,s5=r),K4(e,t)},n}function hoe(e,t,n){n=Dc(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){K4(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){K4(e,t),typeof r!="function"&&(ud===null?ud=new Set([this]):ud.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function GX(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new HTe;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=sAe.bind(null,e,t,n),t.then(e,e))}function qX(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function XX(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Dc(-1,1),t.tag=2,ad(n,t,1))),n.lanes|=1),e)}var GTe=rf.ReactCurrentOwner,js=!1;function es(e,t,n,r){t.child=e===null?Wse(t,null,n,r):F0(t,e.child,n,r)}function KX(e,t,n,r,i){n=n.render;var s=t.ref;return d0(t,i),r=Fz(e,t,n,r,s,i),n=Rz(),e!==null&&!js?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wc(e,t,i)):(Mn&&n&&Sz(t),t.flags|=1,es(e,t,r,i),t.child)}function YX(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!Hz(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,poe(e,t,s,r,i)):(e=F_(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:lw,n(o,r)&&e.ref===t.ref)return Wc(e,t,i)}return t.flags|=1,e=cd(s,r),e.ref=t.ref,e.return=t,t.child=e}function poe(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(lw(s,r)&&e.ref===t.ref)if(js=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(js=!0);else return t.lanes=e.lanes,Wc(e,t,i)}return Y4(e,t,n,r,i)}function moe(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wn(Jg,bo),bo|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wn(Jg,bo),bo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,wn(Jg,bo),bo|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,wn(Jg,bo),bo|=r;return es(e,t,i,n),t.child}function goe(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Y4(e,t,n,r,i){var s=Ks(n)?Op:ji.current;return s=D0(t,s),d0(t,i),n=Fz(e,t,n,r,s,i),r=Rz(),e!==null&&!js?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wc(e,t,i)):(Mn&&r&&Sz(t),t.flags|=1,es(e,t,n,i),t.child)}function ZX(e,t,n,r,i){if(Ks(n)){var s=!0;kE(t)}else s=!1;if(d0(t,i),t.stateNode===null)I_(e,t),foe(t,n,r),X4(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var u=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Ia(l):(l=Ks(n)?Op:ji.current,l=D0(t,l));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==l)&&HX(t,o,r,l),Of=!1;var d=t.memoizedState;o.state=d,AE(t,r,o,i),u=t.memoizedState,a!==r||d!==u||Xs.current||Of?(typeof c=="function"&&(q4(t,n,c,r),u=t.memoizedState),(a=Of||jX(t,n,a,r,d,u,l))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,jse(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:Qa(t.type,a),o.props=l,f=t.pendingProps,d=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Ia(u):(u=Ks(n)?Op:ji.current,u=D0(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||d!==u)&&HX(t,o,r,u),Of=!1,d=t.memoizedState,o.state=d,AE(t,r,o,i);var p=t.memoizedState;a!==f||d!==p||Xs.current||Of?(typeof h=="function"&&(q4(t,n,h,r),p=t.memoizedState),(l=Of||jX(t,n,l,r,d,p,u)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=l):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Z4(e,t,n,r,s,i)}function Z4(e,t,n,r,i,s){goe(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&MX(t,n,!1),Wc(e,t,s);r=t.stateNode,GTe.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=F0(t,e.child,null,s),t.child=F0(t,null,a,s)):es(e,t,a,s),t.memoizedState=r.state,i&&MX(t,n,!0),t.child}function yoe(e){var t=e.stateNode;t.pendingContext?RX(e,t.pendingContext,t.pendingContext!==t.context):t.context&&RX(e,t.context,!1),Nz(e,t.containerInfo)}function QX(e,t,n,r,i){return O0(),kz(i),t.flags|=256,es(e,t,n,r),t.child}var Q4={dehydrated:null,treeContext:null,retryLane:0};function J4(e){return{baseLanes:e,cachePool:null,transitions:null}}function boe(e,t,n){var r=t.pendingProps,i=Gn.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),wn(Gn,i&1),e===null)return H4(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=kN(o,r,0,null),e=vp(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=J4(n),t.memoizedState=Q4,e):Lz(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return qTe(e,t,o,r,a,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,a=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=cd(i,u),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=cd(a,s):(s=vp(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?J4(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=Q4,r}return s=e.child,e=s.sibling,r=cd(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Lz(e,t){return t=kN({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Kk(e,t,n,r){return r!==null&&kz(r),F0(t,e.child,null,n),e=Lz(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function qTe(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=aR(Error(ge(422))),Kk(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=kN({mode:"visible",children:r.children},i,0,null),s=vp(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&F0(t,e.child,null,o),t.child.memoizedState=J4(o),t.memoizedState=Q4,s);if(!(t.mode&1))return Kk(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ge(419)),r=aR(s,r,void 0),Kk(e,t,o,r)}if(a=(o&e.childLanes)!==0,js||a){if(r=Qr,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Uc(e,i),hu(r,e,i,-1))}return jz(),r=aR(Error(ge(421))),Kk(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=oAe.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,$o=od(i.nextSibling),Mo=t,Mn=!0,ru=null,e!==null&&(sa[oa++]=wc,sa[oa++]=Sc,sa[oa++]=Fp,wc=e.id,Sc=e.overflow,Fp=t),t=Lz(t,r.children),t.flags|=4096,t)}function JX(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),G4(e.return,t,n)}function uR(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function voe(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(es(e,t,r.children,n),r=Gn.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&JX(e,n,t);else if(e.tag===19)JX(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(wn(Gn,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&NE(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),uR(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&NE(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}uR(t,!0,n,null,s);break;case"together":uR(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function I_(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wc(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Mp|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ge(153));if(t.child!==null){for(e=t.child,n=cd(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=cd(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function XTe(e,t,n){switch(t.tag){case 3:yoe(t),O0();break;case 5:Hse(t);break;case 1:Ks(t.type)&&kE(t);break;case 4:Nz(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;wn(EE,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(wn(Gn,Gn.current&1),t.flags|=128,null):n&t.child.childLanes?boe(e,t,n):(wn(Gn,Gn.current&1),e=Wc(e,t,n),e!==null?e.sibling:null);wn(Gn,Gn.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return voe(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),wn(Gn,Gn.current),r)break;return null;case 22:case 23:return t.lanes=0,moe(e,t,n)}return Wc(e,t,n)}var xoe,e5,woe,Soe;xoe=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};e5=function(){};woe=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,cp(pl.current);var s=null;switch(n){case"input":i=S4(e,i),r=S4(e,r),s=[];break;case"select":i=Kn({},i,{value:void 0}),r=Kn({},r,{value:void 0}),s=[];break;case"textarea":i=$4(e,i),r=$4(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=SE)}E4(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(nw.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in r){var u=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&u!==a&&(u!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(s=s||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(nw.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&$n("scroll",e),s||a===u||(s=[])):(s=s||[]).push(l,u))}n&&(s=s||[]).push("style",n);var l=s;(t.updateQueue=l)&&(t.flags|=4)}};Soe=function(e,t,n,r){n!==r&&(t.flags|=4)};function Gb(e,t){if(!Mn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function _i(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function KTe(e,t,n){var r=t.pendingProps;switch(Cz(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _i(t),null;case 1:return Ks(t.type)&&CE(),_i(t),null;case 3:return r=t.stateNode,R0(),In(Xs),In(ji),Dz(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(qk(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ru!==null&&(u5(ru),ru=null))),e5(e,t),_i(t),null;case 5:Iz(t);var i=cp(pw.current);if(n=t.type,e!==null&&t.stateNode!=null)woe(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ge(166));return _i(t),null}if(e=cp(pl.current),qk(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ol]=t,r[dw]=s,e=(t.mode&1)!==0,n){case"dialog":$n("cancel",r),$n("close",r);break;case"iframe":case"object":case"embed":$n("load",r);break;case"video":case"audio":for(i=0;i<Rv.length;i++)$n(Rv[i],r);break;case"source":$n("error",r);break;case"img":case"image":case"link":$n("error",r),$n("load",r);break;case"details":$n("toggle",r);break;case"input":uX(r,s),$n("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},$n("invalid",r);break;case"textarea":cX(r,s),$n("invalid",r)}E4(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Gk(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Gk(r.textContent,a,e),i=["children",""+a]):nw.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&$n("scroll",r)}switch(n){case"input":Lk(r),lX(r,s,!0);break;case"textarea":Lk(r),fX(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=SE)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Yie(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[ol]=t,e[dw]=r,xoe(e,t,!1,!1),t.stateNode=e;e:{switch(o=T4(n,r),n){case"dialog":$n("cancel",e),$n("close",e),i=r;break;case"iframe":case"object":case"embed":$n("load",e),i=r;break;case"video":case"audio":for(i=0;i<Rv.length;i++)$n(Rv[i],e);i=r;break;case"source":$n("error",e),i=r;break;case"img":case"image":case"link":$n("error",e),$n("load",e),i=r;break;case"details":$n("toggle",e),i=r;break;case"input":uX(e,r),i=S4(e,r),$n("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Kn({},r,{value:void 0}),$n("invalid",e);break;case"textarea":cX(e,r),i=$4(e,r),$n("invalid",e);break;default:i=r}E4(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var u=a[s];s==="style"?Jie(e,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Zie(e,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&rw(e,u):typeof u=="number"&&rw(e,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(nw.hasOwnProperty(s)?u!=null&&s==="onScroll"&&$n("scroll",e):u!=null&&uz(e,s,u,o))}switch(n){case"input":Lk(e),lX(e,r,!1);break;case"textarea":Lk(e),fX(e);break;case"option":r.value!=null&&e.setAttribute("value",""+xd(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?u0(e,!!r.multiple,s,!1):r.defaultValue!=null&&u0(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=SE)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _i(t),null;case 6:if(e&&t.stateNode!=null)Soe(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ge(166));if(n=cp(pw.current),cp(pl.current),qk(t)){if(r=t.stateNode,n=t.memoizedProps,r[ol]=t,(s=r.nodeValue!==n)&&(e=Mo,e!==null))switch(e.tag){case 3:Gk(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Gk(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ol]=t,t.stateNode=r}return _i(t),null;case 13:if(In(Gn),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Mn&&$o!==null&&t.mode&1&&!(t.flags&128))Bse(),O0(),t.flags|=98560,s=!1;else if(s=qk(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(ge(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ge(317));s[ol]=t}else O0(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_i(t),s=!1}else ru!==null&&(u5(ru),ru=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Gn.current&1?Ar===0&&(Ar=3):jz())),t.updateQueue!==null&&(t.flags|=4),_i(t),null);case 4:return R0(),e5(e,t),e===null&&cw(t.stateNode.containerInfo),_i(t),null;case 10:return Ez(t.type._context),_i(t),null;case 17:return Ks(t.type)&&CE(),_i(t),null;case 19:if(In(Gn),s=t.memoizedState,s===null)return _i(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)Gb(s,!1);else{if(Ar!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=NE(e),o!==null){for(t.flags|=128,Gb(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return wn(Gn,Gn.current&1|2),t.child}e=e.sibling}s.tail!==null&&ur()>P0&&(t.flags|=128,r=!0,Gb(s,!1),t.lanes=4194304)}else{if(!r)if(e=NE(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Gb(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Mn)return _i(t),null}else 2*ur()-s.renderingStartTime>P0&&n!==1073741824&&(t.flags|=128,r=!0,Gb(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ur(),t.sibling=null,n=Gn.current,wn(Gn,r?n&1|2:n&1),t):(_i(t),null);case 22:case 23:return Vz(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?bo&1073741824&&(_i(t),t.subtreeFlags&6&&(t.flags|=8192)):_i(t),null;case 24:return null;case 25:return null}throw Error(ge(156,t.tag))}function YTe(e,t){switch(Cz(t),t.tag){case 1:return Ks(t.type)&&CE(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return R0(),In(Xs),In(ji),Dz(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Iz(t),null;case 13:if(In(Gn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ge(340));O0()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return In(Gn),null;case 4:return R0(),null;case 10:return Ez(t.type._context),null;case 22:case 23:return Vz(),null;case 24:return null;default:return null}}var Yk=!1,Oi=!1,ZTe=typeof WeakSet=="function"?WeakSet:Set,ze=null;function Qg(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Jn(e,t,r)}else n.current=null}function t5(e,t,n){try{n()}catch(r){Jn(e,t,r)}}var eK=!1;function QTe(e,t){if(L4=vE,e=Ese(),wz(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,u=-1,l=0,c=0,f=e,d=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===n&&++l===i&&(a=o),d===s&&++c===r&&(u=o),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(z4={focusedElem:e,selectionRange:n},vE=!1,ze=t;ze!==null;)if(t=ze,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ze=e;else for(;ze!==null;){t=ze;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Qa(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(x){Jn(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,ze=e;break}ze=t.return}return p=eK,eK=!1,p}function $x(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&t5(t,n,s)}i=i.next}while(i!==r)}}function SN(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function n5(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Coe(e){var t=e.alternate;t!==null&&(e.alternate=null,Coe(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ol],delete t[dw],delete t[W4],delete t[FTe],delete t[RTe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function koe(e){return e.tag===5||e.tag===3||e.tag===4}function tK(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||koe(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function r5(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=SE));else if(r!==4&&(e=e.child,e!==null))for(r5(e,t,n),e=e.sibling;e!==null;)r5(e,t,n),e=e.sibling}function i5(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(i5(e,t,n),e=e.sibling;e!==null;)i5(e,t,n),e=e.sibling}var fi=null,tu=!1;function Tf(e,t,n){for(n=n.child;n!==null;)$oe(e,t,n),n=n.sibling}function $oe(e,t,n){if(hl&&typeof hl.onCommitFiberUnmount=="function")try{hl.onCommitFiberUnmount(pN,n)}catch{}switch(n.tag){case 5:Oi||Qg(n,t);case 6:var r=fi,i=tu;fi=null,Tf(e,t,n),fi=r,tu=i,fi!==null&&(tu?(e=fi,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):fi.removeChild(n.stateNode));break;case 18:fi!==null&&(tu?(e=fi,n=n.stateNode,e.nodeType===8?tR(e.parentNode,n):e.nodeType===1&&tR(e,n),aw(e)):tR(fi,n.stateNode));break;case 4:r=fi,i=tu,fi=n.stateNode.containerInfo,tu=!0,Tf(e,t,n),fi=r,tu=i;break;case 0:case 11:case 14:case 15:if(!Oi&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&t5(n,t,o),i=i.next}while(i!==r)}Tf(e,t,n);break;case 1:if(!Oi&&(Qg(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Jn(n,t,a)}Tf(e,t,n);break;case 21:Tf(e,t,n);break;case 22:n.mode&1?(Oi=(r=Oi)||n.memoizedState!==null,Tf(e,t,n),Oi=r):Tf(e,t,n);break;default:Tf(e,t,n)}}function nK(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new ZTe),t.forEach(function(r){var i=aAe.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function qa(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:fi=a.stateNode,tu=!1;break e;case 3:fi=a.stateNode.containerInfo,tu=!0;break e;case 4:fi=a.stateNode.containerInfo,tu=!0;break e}a=a.return}if(fi===null)throw Error(ge(160));$oe(s,o,i),fi=null,tu=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){Jn(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)_oe(t,e),t=t.sibling}function _oe(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(qa(t,e),Yu(e),r&4){try{$x(3,e,e.return),SN(3,e)}catch(m){Jn(e,e.return,m)}try{$x(5,e,e.return)}catch(m){Jn(e,e.return,m)}}break;case 1:qa(t,e),Yu(e),r&512&&n!==null&&Qg(n,n.return);break;case 5:if(qa(t,e),Yu(e),r&512&&n!==null&&Qg(n,n.return),e.flags&32){var i=e.stateNode;try{rw(i,"")}catch(m){Jn(e,e.return,m)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Xie(i,s),T4(a,o);var l=T4(a,s);for(o=0;o<u.length;o+=2){var c=u[o],f=u[o+1];c==="style"?Jie(i,f):c==="dangerouslySetInnerHTML"?Zie(i,f):c==="children"?rw(i,f):uz(i,c,f,l)}switch(a){case"input":C4(i,s);break;case"textarea":Kie(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?u0(i,!!s.multiple,h,!1):d!==!!s.multiple&&(s.defaultValue!=null?u0(i,!!s.multiple,s.defaultValue,!0):u0(i,!!s.multiple,s.multiple?[]:"",!1))}i[dw]=s}catch(m){Jn(e,e.return,m)}}break;case 6:if(qa(t,e),Yu(e),r&4){if(e.stateNode===null)throw Error(ge(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Jn(e,e.return,m)}}break;case 3:if(qa(t,e),Yu(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{aw(t.containerInfo)}catch(m){Jn(e,e.return,m)}break;case 4:qa(t,e),Yu(e);break;case 13:qa(t,e),Yu(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Uz=ur())),r&4&&nK(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(Oi=(l=Oi)||c,qa(t,e),Oi=l):qa(t,e),Yu(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ze=e,c=e.child;c!==null;){for(f=ze=c;ze!==null;){switch(d=ze,h=d.child,d.tag){case 0:case 11:case 14:case 15:$x(4,d,d.return);break;case 1:Qg(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Jn(r,n,m)}}break;case 5:Qg(d,d.return);break;case 22:if(d.memoizedState!==null){iK(f);continue}}h!==null?(h.return=d,ze=h):iK(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=Qie("display",o))}catch(m){Jn(e,e.return,m)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(m){Jn(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:qa(t,e),Yu(e),r&4&&nK(e);break;case 21:break;default:qa(t,e),Yu(e)}}function Yu(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(koe(n)){var r=n;break e}n=n.return}throw Error(ge(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(rw(i,""),r.flags&=-33);var s=tK(e);i5(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=tK(e);r5(e,a,o);break;default:throw Error(ge(161))}}catch(u){Jn(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function JTe(e,t,n){ze=e,Eoe(e)}function Eoe(e,t,n){for(var r=(e.mode&1)!==0;ze!==null;){var i=ze,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Yk;if(!o){var a=i.alternate,u=a!==null&&a.memoizedState!==null||Oi;a=Yk;var l=Oi;if(Yk=o,(Oi=u)&&!l)for(ze=i;ze!==null;)o=ze,u=o.child,o.tag===22&&o.memoizedState!==null?sK(i):u!==null?(u.return=o,ze=u):sK(i);for(;s!==null;)ze=s,Eoe(s),s=s.sibling;ze=i,Yk=a,Oi=l}rK(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ze=s):rK(e)}}function rK(e){for(;ze!==null;){var t=ze;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Oi||SN(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Oi)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Qa(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&UX(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}UX(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&aw(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}Oi||t.flags&512&&n5(t)}catch(d){Jn(t,t.return,d)}}if(t===e){ze=null;break}if(n=t.sibling,n!==null){n.return=t.return,ze=n;break}ze=t.return}}function iK(e){for(;ze!==null;){var t=ze;if(t===e){ze=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ze=n;break}ze=t.return}}function sK(e){for(;ze!==null;){var t=ze;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{SN(4,t)}catch(u){Jn(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(u){Jn(t,i,u)}}var s=t.return;try{n5(t)}catch(u){Jn(t,s,u)}break;case 5:var o=t.return;try{n5(t)}catch(u){Jn(t,o,u)}}}catch(u){Jn(t,t.return,u)}if(t===e){ze=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ze=a;break}ze=t.return}}var eAe=Math.ceil,OE=rf.ReactCurrentDispatcher,zz=rf.ReactCurrentOwner,Ca=rf.ReactCurrentBatchConfig,Wt=0,Qr=null,br=null,bi=0,bo=0,Jg=Gd(0),Ar=0,bw=null,Mp=0,CN=0,Bz=0,_x=null,Ls=null,Uz=0,P0=1/0,uc=null,FE=!1,s5=null,ud=null,Zk=!1,Vf=null,RE=0,Ex=0,o5=null,D_=-1,O_=0;function ds(){return Wt&6?ur():D_!==-1?D_:D_=ur()}function ld(e){return e.mode&1?Wt&2&&bi!==0?bi&-bi:PTe.transition!==null?(O_===0&&(O_=fse()),O_):(e=sn,e!==0||(e=window.event,e=e===void 0?16:bse(e.type)),e):1}function hu(e,t,n,r){if(50<Ex)throw Ex=0,o5=null,Error(ge(185));T2(e,n,r),(!(Wt&2)||e!==Qr)&&(e===Qr&&(!(Wt&2)&&(CN|=n),Ar===4&&Bf(e,bi)),Ys(e,r),n===1&&Wt===0&&!(t.mode&1)&&(P0=ur()+500,vN&&qd()))}function Ys(e,t){var n=e.callbackNode;PEe(e,t);var r=bE(e,e===Qr?bi:0);if(r===0)n!==null&&pX(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&pX(n),t===1)e.tag===0?MTe(oK.bind(null,e)):Pse(oK.bind(null,e)),DTe(function(){!(Wt&6)&&qd()}),n=null;else{switch(dse(r)){case 1:n=hz;break;case 4:n=lse;break;case 16:n=yE;break;case 536870912:n=cse;break;default:n=yE}n=Roe(n,Toe.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Toe(e,t){if(D_=-1,O_=0,Wt&6)throw Error(ge(327));var n=e.callbackNode;if(h0()&&e.callbackNode!==n)return null;var r=bE(e,e===Qr?bi:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ME(e,r);else{t=r;var i=Wt;Wt|=2;var s=Noe();(Qr!==e||bi!==t)&&(uc=null,P0=ur()+500,bp(e,t));do try{rAe();break}catch(a){Aoe(e,a)}while(!0);_z(),OE.current=s,Wt=i,br!==null?t=0:(Qr=null,bi=0,t=Ar)}if(t!==0){if(t===2&&(i=O4(e),i!==0&&(r=i,t=a5(e,i))),t===1)throw n=bw,bp(e,0),Bf(e,r),Ys(e,ur()),n;if(t===6)Bf(e,r);else{if(i=e.current.alternate,!(r&30)&&!tAe(i)&&(t=ME(e,r),t===2&&(s=O4(e),s!==0&&(r=s,t=a5(e,s))),t===1))throw n=bw,bp(e,0),Bf(e,r),Ys(e,ur()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ge(345));case 2:Gh(e,Ls,uc);break;case 3:if(Bf(e,r),(r&130023424)===r&&(t=Uz+500-ur(),10<t)){if(bE(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){ds(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=U4(Gh.bind(null,e,Ls,uc),t);break}Gh(e,Ls,uc);break;case 4:if(Bf(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-du(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=ur()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*eAe(r/1960))-r,10<r){e.timeoutHandle=U4(Gh.bind(null,e,Ls,uc),r);break}Gh(e,Ls,uc);break;case 5:Gh(e,Ls,uc);break;default:throw Error(ge(329))}}}return Ys(e,ur()),e.callbackNode===n?Toe.bind(null,e):null}function a5(e,t){var n=_x;return e.current.memoizedState.isDehydrated&&(bp(e,t).flags|=256),e=ME(e,t),e!==2&&(t=Ls,Ls=n,t!==null&&u5(t)),e}function u5(e){Ls===null?Ls=e:Ls.push.apply(Ls,e)}function tAe(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ku(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bf(e,t){for(t&=~Bz,t&=~CN,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-du(t),r=1<<n;e[n]=-1,t&=~r}}function oK(e){if(Wt&6)throw Error(ge(327));h0();var t=bE(e,0);if(!(t&1))return Ys(e,ur()),null;var n=ME(e,t);if(e.tag!==0&&n===2){var r=O4(e);r!==0&&(t=r,n=a5(e,r))}if(n===1)throw n=bw,bp(e,0),Bf(e,t),Ys(e,ur()),n;if(n===6)throw Error(ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gh(e,Ls,uc),Ys(e,ur()),null}function Wz(e,t){var n=Wt;Wt|=1;try{return e(t)}finally{Wt=n,Wt===0&&(P0=ur()+500,vN&&qd())}}function Pp(e){Vf!==null&&Vf.tag===0&&!(Wt&6)&&h0();var t=Wt;Wt|=1;var n=Ca.transition,r=sn;try{if(Ca.transition=null,sn=1,e)return e()}finally{sn=r,Ca.transition=n,Wt=t,!(Wt&6)&&qd()}}function Vz(){bo=Jg.current,In(Jg)}function bp(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ITe(n)),br!==null)for(n=br.return;n!==null;){var r=n;switch(Cz(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&CE();break;case 3:R0(),In(Xs),In(ji),Dz();break;case 5:Iz(r);break;case 4:R0();break;case 13:In(Gn);break;case 19:In(Gn);break;case 10:Ez(r.type._context);break;case 22:case 23:Vz()}n=n.return}if(Qr=e,br=e=cd(e.current,null),bi=bo=t,Ar=0,bw=null,Bz=CN=Mp=0,Ls=_x=null,lp!==null){for(t=0;t<lp.length;t++)if(n=lp[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}lp=null}return e}function Aoe(e,t){do{var n=br;try{if(_z(),A_.current=DE,IE){for(var r=Xn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}IE=!1}if(Rp=0,Wr=Er=Xn=null,kx=!1,mw=0,zz.current=null,n===null||n.return===null){Ar=1,bw=t,br=null;break}e:{var s=e,o=n.return,a=n,u=t;if(t=bi,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=qX(o);if(h!==null){h.flags&=-257,XX(h,o,a,s,t),h.mode&1&&GX(s,l,t),t=h,u=l;var p=t.updateQueue;if(p===null){var m=new Set;m.add(u),t.updateQueue=m}else p.add(u);break e}else{if(!(t&1)){GX(s,l,t),jz();break e}u=Error(ge(426))}}else if(Mn&&a.mode&1){var g=qX(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),XX(g,o,a,s,t),kz(M0(u,a));break e}}s=u=M0(u,a),Ar!==4&&(Ar=2),_x===null?_x=[s]:_x.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=doe(s,u,t);BX(s,y);break e;case 1:a=u;var b=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ud===null||!ud.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t;var x=hoe(s,a,t);BX(s,x);break e}}s=s.return}while(s!==null)}Doe(n)}catch(w){t=w,br===n&&n!==null&&(br=n=n.return);continue}break}while(!0)}function Noe(){var e=OE.current;return OE.current=DE,e===null?DE:e}function jz(){(Ar===0||Ar===3||Ar===2)&&(Ar=4),Qr===null||!(Mp&268435455)&&!(CN&268435455)||Bf(Qr,bi)}function ME(e,t){var n=Wt;Wt|=2;var r=Noe();(Qr!==e||bi!==t)&&(uc=null,bp(e,t));do try{nAe();break}catch(i){Aoe(e,i)}while(!0);if(_z(),Wt=n,OE.current=r,br!==null)throw Error(ge(261));return Qr=null,bi=0,Ar}function nAe(){for(;br!==null;)Ioe(br)}function rAe(){for(;br!==null&&!TEe();)Ioe(br)}function Ioe(e){var t=Foe(e.alternate,e,bo);e.memoizedProps=e.pendingProps,t===null?Doe(e):br=t,zz.current=null}function Doe(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=YTe(n,t),n!==null){n.flags&=32767,br=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ar=6,br=null;return}}else if(n=KTe(n,t,bo),n!==null){br=n;return}if(t=t.sibling,t!==null){br=t;return}br=t=e}while(t!==null);Ar===0&&(Ar=5)}function Gh(e,t,n){var r=sn,i=Ca.transition;try{Ca.transition=null,sn=1,iAe(e,t,n,r)}finally{Ca.transition=i,sn=r}return null}function iAe(e,t,n,r){do h0();while(Vf!==null);if(Wt&6)throw Error(ge(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ge(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(LEe(e,s),e===Qr&&(br=Qr=null,bi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zk||(Zk=!0,Roe(yE,function(){return h0(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ca.transition,Ca.transition=null;var o=sn;sn=1;var a=Wt;Wt|=4,zz.current=null,QTe(e,n),_oe(n,e),kTe(z4),vE=!!L4,z4=L4=null,e.current=n,JTe(n),AEe(),Wt=a,sn=o,Ca.transition=s}else e.current=n;if(Zk&&(Zk=!1,Vf=e,RE=i),s=e.pendingLanes,s===0&&(ud=null),DEe(n.stateNode),Ys(e,ur()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(FE)throw FE=!1,e=s5,s5=null,e;return RE&1&&e.tag!==0&&h0(),s=e.pendingLanes,s&1?e===o5?Ex++:(Ex=0,o5=e):Ex=0,qd(),null}function h0(){if(Vf!==null){var e=dse(RE),t=Ca.transition,n=sn;try{if(Ca.transition=null,sn=16>e?16:e,Vf===null)var r=!1;else{if(e=Vf,Vf=null,RE=0,Wt&6)throw Error(ge(331));var i=Wt;for(Wt|=4,ze=e.current;ze!==null;){var s=ze,o=s.child;if(ze.flags&16){var a=s.deletions;if(a!==null){for(var u=0;u<a.length;u++){var l=a[u];for(ze=l;ze!==null;){var c=ze;switch(c.tag){case 0:case 11:case 15:$x(8,c,s)}var f=c.child;if(f!==null)f.return=c,ze=f;else for(;ze!==null;){c=ze;var d=c.sibling,h=c.return;if(Coe(c),c===l){ze=null;break}if(d!==null){d.return=h,ze=d;break}ze=h}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}ze=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ze=o;else e:for(;ze!==null;){if(s=ze,s.flags&2048)switch(s.tag){case 0:case 11:case 15:$x(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,ze=y;break e}ze=s.return}}var b=e.current;for(ze=b;ze!==null;){o=ze;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,ze=v;else e:for(o=b;ze!==null;){if(a=ze,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:SN(9,a)}}catch(w){Jn(a,a.return,w)}if(a===o){ze=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,ze=x;break e}ze=a.return}}if(Wt=i,qd(),hl&&typeof hl.onPostCommitFiberRoot=="function")try{hl.onPostCommitFiberRoot(pN,e)}catch{}r=!0}return r}finally{sn=n,Ca.transition=t}}return!1}function aK(e,t,n){t=M0(n,t),t=doe(e,t,1),e=ad(e,t,1),t=ds(),e!==null&&(T2(e,1,t),Ys(e,t))}function Jn(e,t,n){if(e.tag===3)aK(e,e,n);else for(;t!==null;){if(t.tag===3){aK(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ud===null||!ud.has(r))){e=M0(n,e),e=hoe(t,e,1),t=ad(t,e,1),e=ds(),t!==null&&(T2(t,1,e),Ys(t,e));break}}t=t.return}}function sAe(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ds(),e.pingedLanes|=e.suspendedLanes&n,Qr===e&&(bi&n)===n&&(Ar===4||Ar===3&&(bi&130023424)===bi&&500>ur()-Uz?bp(e,0):Bz|=n),Ys(e,t)}function Ooe(e,t){t===0&&(e.mode&1?(t=Uk,Uk<<=1,!(Uk&130023424)&&(Uk=4194304)):t=1);var n=ds();e=Uc(e,t),e!==null&&(T2(e,t,n),Ys(e,n))}function oAe(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ooe(e,n)}function aAe(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ge(314))}r!==null&&r.delete(t),Ooe(e,n)}var Foe;Foe=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xs.current)js=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return js=!1,XTe(e,t,n);js=!!(e.flags&131072)}else js=!1,Mn&&t.flags&1048576&&Lse(t,_E,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;I_(e,t),e=t.pendingProps;var i=D0(t,ji.current);d0(t,n),i=Fz(null,t,r,e,i,n);var s=Rz();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ks(r)?(s=!0,kE(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Az(t),i.updater=wN,t.stateNode=i,i._reactInternals=t,X4(t,r,e,n),t=Z4(null,t,r,!0,s,n)):(t.tag=0,Mn&&s&&Sz(t),es(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(I_(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=lAe(r),e=Qa(r,e),i){case 0:t=Y4(null,t,r,e,n);break e;case 1:t=ZX(null,t,r,e,n);break e;case 11:t=KX(null,t,r,e,n);break e;case 14:t=YX(null,t,r,Qa(r.type,e),n);break e}throw Error(ge(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Qa(r,i),Y4(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Qa(r,i),ZX(e,t,r,i,n);case 3:e:{if(yoe(t),e===null)throw Error(ge(387));r=t.pendingProps,s=t.memoizedState,i=s.element,jse(e,t),AE(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=M0(Error(ge(423)),t),t=QX(e,t,r,n,i);break e}else if(r!==i){i=M0(Error(ge(424)),t),t=QX(e,t,r,n,i);break e}else for($o=od(t.stateNode.containerInfo.firstChild),Mo=t,Mn=!0,ru=null,n=Wse(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(O0(),r===i){t=Wc(e,t,n);break e}es(e,t,r,n)}t=t.child}return t;case 5:return Hse(t),e===null&&H4(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,B4(r,i)?o=null:s!==null&&B4(r,s)&&(t.flags|=32),goe(e,t),es(e,t,o,n),t.child;case 6:return e===null&&H4(t),null;case 13:return boe(e,t,n);case 4:return Nz(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=F0(t,null,r,n):es(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Qa(r,i),KX(e,t,r,i,n);case 7:return es(e,t,t.pendingProps,n),t.child;case 8:return es(e,t,t.pendingProps.children,n),t.child;case 12:return es(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,wn(EE,r._currentValue),r._currentValue=o,s!==null)if(ku(s.value,o)){if(s.children===i.children&&!Xs.current){t=Wc(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Dc(-1,n&-n),u.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),G4(s.return,n,t),a.lanes|=n;break}u=u.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ge(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),G4(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}es(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,d0(t,n),i=Ia(i),r=r(i),t.flags|=1,es(e,t,r,n),t.child;case 14:return r=t.type,i=Qa(r,t.pendingProps),i=Qa(r.type,i),YX(e,t,r,i,n);case 15:return poe(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Qa(r,i),I_(e,t),t.tag=1,Ks(r)?(e=!0,kE(t)):e=!1,d0(t,n),foe(t,r,i),X4(t,r,i,n),Z4(null,t,r,!0,e,n);case 19:return voe(e,t,n);case 22:return moe(e,t,n)}throw Error(ge(156,t.tag))};function Roe(e,t){return use(e,t)}function uAe(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function da(e,t,n,r){return new uAe(e,t,n,r)}function Hz(e){return e=e.prototype,!(!e||!e.isReactComponent)}function lAe(e){if(typeof e=="function")return Hz(e)?1:0;if(e!=null){if(e=e.$$typeof,e===cz)return 11;if(e===fz)return 14}return 2}function cd(e,t){var n=e.alternate;return n===null?(n=da(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function F_(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")Hz(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Vg:return vp(n.children,i,s,t);case lz:o=8,i|=8;break;case b4:return e=da(12,n,t,i|2),e.elementType=b4,e.lanes=s,e;case v4:return e=da(13,n,t,i),e.elementType=v4,e.lanes=s,e;case x4:return e=da(19,n,t,i),e.elementType=x4,e.lanes=s,e;case Hie:return kN(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Vie:o=10;break e;case jie:o=9;break e;case cz:o=11;break e;case fz:o=14;break e;case Df:o=16,r=null;break e}throw Error(ge(130,e==null?e:typeof e,""))}return t=da(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function vp(e,t,n,r){return e=da(7,e,r,t),e.lanes=n,e}function kN(e,t,n,r){return e=da(22,e,r,t),e.elementType=Hie,e.lanes=n,e.stateNode={isHidden:!1},e}function lR(e,t,n){return e=da(6,e,null,t),e.lanes=n,e}function cR(e,t,n){return t=da(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function cAe(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jF(0),this.expirationTimes=jF(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jF(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gz(e,t,n,r,i,s,o,a,u){return e=new cAe(e,t,n,a,u),t===1?(t=1,s===!0&&(t|=8)):t=0,s=da(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Az(s),e}function fAe(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wg,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Moe(e){if(!e)return wd;e=e._reactInternals;e:{if(Am(e)!==e||e.tag!==1)throw Error(ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ks(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ge(171))}if(e.tag===1){var n=e.type;if(Ks(n))return Mse(e,n,t)}return t}function Poe(e,t,n,r,i,s,o,a,u){return e=Gz(n,r,!0,e,i,s,o,a,u),e.context=Moe(null),n=e.current,r=ds(),i=ld(n),s=Dc(r,i),s.callback=t??null,ad(n,s,i),e.current.lanes=i,T2(e,i,r),Ys(e,r),e}function $N(e,t,n,r){var i=t.current,s=ds(),o=ld(i);return n=Moe(n),t.context===null?t.context=n:t.pendingContext=n,t=Dc(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ad(i,t,o),e!==null&&(hu(e,i,o,s),T_(e,i,o)),o}function PE(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function uK(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function qz(e,t){uK(e,t),(e=e.alternate)&&uK(e,t)}function dAe(){return null}var Loe=typeof reportError=="function"?reportError:function(e){console.error(e)};function Xz(e){this._internalRoot=e}_N.prototype.render=Xz.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ge(409));$N(e,t,null,null)};_N.prototype.unmount=Xz.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Pp(function(){$N(null,e,null,null)}),t[Bc]=null}};function _N(e){this._internalRoot=e}_N.prototype.unstable_scheduleHydration=function(e){if(e){var t=mse();e={blockedOn:null,target:e,priority:t};for(var n=0;n<zf.length&&t!==0&&t<zf[n].priority;n++);zf.splice(n,0,e),n===0&&yse(e)}};function Kz(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function EN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function lK(){}function hAe(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var l=PE(o);s.call(l)}}var o=Poe(t,r,e,0,null,!1,!1,"",lK);return e._reactRootContainer=o,e[Bc]=o.current,cw(e.nodeType===8?e.parentNode:e),Pp(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=PE(u);a.call(l)}}var u=Gz(e,0,!1,null,null,!1,!1,"",lK);return e._reactRootContainer=u,e[Bc]=u.current,cw(e.nodeType===8?e.parentNode:e),Pp(function(){$N(t,u,n,r)}),u}function TN(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var u=PE(o);a.call(u)}}$N(t,o,e,i)}else o=hAe(n,t,e,i,r);return PE(o)}hse=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fv(t.pendingLanes);n!==0&&(pz(t,n|1),Ys(t,ur()),!(Wt&6)&&(P0=ur()+500,qd()))}break;case 13:Pp(function(){var r=Uc(e,1);if(r!==null){var i=ds();hu(r,e,1,i)}}),qz(e,1)}};mz=function(e){if(e.tag===13){var t=Uc(e,134217728);if(t!==null){var n=ds();hu(t,e,134217728,n)}qz(e,134217728)}};pse=function(e){if(e.tag===13){var t=ld(e),n=Uc(e,t);if(n!==null){var r=ds();hu(n,e,t,r)}qz(e,t)}};mse=function(){return sn};gse=function(e,t){var n=sn;try{return sn=e,t()}finally{sn=n}};N4=function(e,t,n){switch(t){case"input":if(C4(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bN(r);if(!i)throw Error(ge(90));qie(r),C4(r,i)}}}break;case"textarea":Kie(e,n);break;case"select":t=n.value,t!=null&&u0(e,!!n.multiple,t,!1)}};nse=Wz;rse=Pp;var pAe={usingClientEntryPoint:!1,Events:[N2,qg,bN,ese,tse,Wz]},qb={findFiberByHostInstance:up,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mAe={bundleType:qb.bundleType,version:qb.version,rendererPackageName:qb.rendererPackageName,rendererConfig:qb.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ose(e),e===null?null:e.stateNode},findFiberByHostInstance:qb.findFiberByHostInstance||dAe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qk=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qk.isDisabled&&Qk.supportsFiber)try{pN=Qk.inject(mAe),hl=Qk}catch{}}Ho.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pAe;Ho.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kz(t))throw Error(ge(200));return fAe(e,t,null,n)};Ho.createRoot=function(e,t){if(!Kz(e))throw Error(ge(299));var n=!1,r="",i=Loe;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Gz(e,1,!1,null,null,n,!1,r,i),e[Bc]=t.current,cw(e.nodeType===8?e.parentNode:e),new Xz(t)};Ho.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ge(188)):(e=Object.keys(e).join(","),Error(ge(268,e)));return e=ose(t),e=e===null?null:e.stateNode,e};Ho.flushSync=function(e){return Pp(e)};Ho.hydrate=function(e,t,n){if(!EN(t))throw Error(ge(200));return TN(null,e,t,!0,n)};Ho.hydrateRoot=function(e,t,n){if(!Kz(e))throw Error(ge(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Loe;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Poe(t,null,e,1,n??null,i,!1,s,o),e[Bc]=t.current,cw(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new _N(t)};Ho.render=function(e,t,n){if(!EN(t))throw Error(ge(200));return TN(null,e,t,!1,n)};Ho.unmountComponentAtNode=function(e){if(!EN(e))throw Error(ge(40));return e._reactRootContainer?(Pp(function(){TN(null,null,e,!1,function(){e._reactRootContainer=null,e[Bc]=null})}),!0):!1};Ho.unstable_batchedUpdates=Wz;Ho.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!EN(n))throw Error(ge(200));if(e==null||e._reactInternals===void 0)throw Error(ge(38));return TN(e,t,n,!1,r)};Ho.version="18.3.1-next-f1338f8080-20240426";function zoe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zoe)}catch(e){console.error(e)}}zoe(),zie.exports=Ho;var gAe=zie.exports,cK=gAe;g4.createRoot=cK.createRoot,g4.hydrateRoot=cK.hydrateRoot;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yAe=1e-7,bAe=1e-4;class Yz{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class AN{refCount(t){return Ns("refCount")}incRef(t){return Ns("incRef")}timerAvailable(){return!0}time(t){return Ns("time")}read(t){return Ns("read")}readSync(t){return Ns("readSync")}readToGPU(t,n){return Ns("readToGPU")}numDataIds(){return Ns("numDataIds")}disposeData(t,n){return Ns("disposeData")}write(t,n,r){return Ns("write")}move(t,n,r,i,s){return Ns("move")}createTensorFromGPUData(t,n,r){return Ns("createTensorFromGPUData")}memory(){return Ns("memory")}floatPrecision(){return Ns("floatPrecision")}epsilon(){return this.floatPrecision()===32?yAe:bAe}dispose(){return Ns("dispose")}}function Ns(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,bc(e,t,n)}function vAe(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,bc(e,n,r),bc(t,n,r)}function Sd(e,t,n){return Math.max(e,Math.min(t,n))}function NN(e){return e%2===0?e:e+1}function bc(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Boe(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function xAe(e,t){const n=Math.random();return t*n+(1-n)*e}function wAe(e,t){let n=0;for(let r=0;r<e.length;r++){const i=Number(e[r])-Number(t[r]);n+=i*i}return n}function A(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function ni(e,t,n=""){A($t(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function Nm(e){A(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ee(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function SAe(e){return e.length===0}function Uoe(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function $t(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Lp(e){return e%1===0}function CAe(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{const t=Math.exp(2*e);return(t-1)/(t+1)}}function LE(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function l5(e){const t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return Zz(t),t}function xp(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function c5(e,t=i=>0,n,r){return new Promise((i,s)=>{let o=0;const a=()=>{if(e()){i();return}o++;const u=t(o);if(n!=null&&o>=n){s();return}r!=null?r(a,u):setTimeout(a,u)};a()})}function Qz(e,t){let n=1,r=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(e[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(e[s]<0)throw Error(`Shapes can not be < 0. Found ${e[s]} at dim ${s}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function wt(e,t){const n=t.length;return e=e==null?t.map((r,i)=>i):[].concat(e),A(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),A(e.every(r=>Lp(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function sf(e,t){const n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,s=t==null||i?null:wt(t,e).sort();let o=0;for(let a=0;a<e.length;++a){if(s!=null){if(s[o]===a&&e[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${e[a]}' is not 1`);(s[o]==null||s[o]>a)&&e[a]===1&&(n.push(e[a]),r.push(a)),s[o]<=a&&o++}e[a]!==1&&(n.push(e[a]),r.push(a))}return{newShape:n,keptDims:r}}function Dr(e,t){return qn(e,t)}function qn(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function Woe(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function Voe(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function Jz(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function vw(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function joe(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function cl(e){return typeof e=="string"||e instanceof String}function Hoe(e){return typeof e=="boolean"}function zE(e){return typeof e=="number"}function Im(e){return Array.isArray(e)?Im(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":zE(e)?"float32":cl(e)?"string":Hoe(e)?"bool":"float32"}function Cd(e){return!!(e&&e.constructor&&e.call&&e.apply)}function BE(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Ye(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Goe(e,t,n,r=!1){const i=new Array;if(t.length===1){const s=t[0]*(r?2:1);for(let o=0;o<s;o++)i[o]=n[e+o]}else{const s=t[0],o=t.slice(1),a=o.reduce((u,l)=>u*l)*(r?2:1);for(let u=0;u<s;u++)i[u]=Goe(e+u*a,o,n,r)}return i}function Po(e,t,n=!1){if(e.length===0)return t[0];const r=e.reduce((i,s)=>i*s)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return Goe(0,e,t,n)}function qoe(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function IN(e,t){const n=ei(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function ei(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function eB(e,t){const n=e.reduce((r,i)=>r*i,1);if(t==null||t==="float32")return Po(e,new Float32Array(n));if(t==="int32")return Po(e,new Int32Array(n));if(t==="bool")return Po(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function uo(e){e.forEach(t=>{A(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function pu(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function Dm(e,t,n){if(t===0)return[];if(t===1)return[e];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function Vc(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fK="tfjsflags";class Xoe{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=kAe,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){const i=this.urlFlags[t];Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(Vc(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);fK in t&&t[fK].split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=_Ae(i,s)})}}function kAe(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>($Ae(t,r[0],r[1]),r.join("="))),t}function $Ae(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function _Ae(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function Y(){return tB}let tB=null;function EAe(e){tB=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fR;function Koe(){if(fR==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");fR=e}return fR}function TAe(){const e=Koe();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function nB(e,t){const n=TAe();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const D2="Abs",P1="Acos",L1="Acosh",Om="Add",O2="AddN",DN="All",ON="Any",F2="ArgMax",R2="ArgMin",z1="Asin",B1="Asinh",U1="Atan",W1="Atanh",V1="Atan2",M2="AvgPool",FN="AvgPoolGrad",P2="AvgPool3D",RN="AvgPool3DGrad",L2="BatchMatMul",z2="BatchToSpaceND",MN="Bincount",B2="BitwiseAnd",Yoe="BroadcastTo",PN="BroadcastArgs",j1="Cast",H1="Ceil",G1="ClipByValue",LN="Complex",U2="ComplexAbs",W2="Concat",V2="Conv2D",zN="Conv2DBackpropFilter",j2="Conv2DBackpropInput",H2="Conv3D",BN="Conv3DBackpropFilterV2",UN="Conv3DBackpropInputV2",q1="Cos",X1="Cosh",WN="Cumprod",G2="Cumsum",VN="CropAndResize",jN="DenseBincount",HN="DepthToSpace",q2="DepthwiseConv2dNative",GN="DepthwiseConv2dNativeBackpropFilter",qN="DepthwiseConv2dNativeBackpropInput",XN="Diag",X2="Dilation2D",UE="Dilation2DBackpropInput",WE="Dilation2DBackpropFilter",KN="Draw",K1="RealDiv",YN="Einsum",Y1="Elu",ZN="EluGrad",Z1="Erf",K2="Equal",Q1="Exp",Y2="ExpandDims",J1="Expm1",QN="FFT",JN="Fill",eI="FlipLeftRight",ey="Floor",ty="FloorDiv",Z2="FusedBatchNorm",Q2="GatherV2",tI="GatherNd",J2="Greater",ny="GreaterEqual",ry="Identity",nI="IFFT",rI="Imag",iy="IsFinite",sy="IsInf",oy="IsNan",eS="LeakyRelu",tS="Less",nS="LessEqual",iI="LinSpace",ay="Log",uy="Log1p",rS="LogicalAnd",iS="LogicalNot",sS="LogicalOr",AAe="LogicalXor",Zoe="LogSoftmax",NAe="LowerBound",oS="LRN",sI="LRNGrad",IAe="MatrixBandPart",aS="Max",ly="Maximum",uS="MaxPool",oI="MaxPoolGrad",lS="MaxPool3D",aI="MaxPool3DGrad",uI="MaxPoolWithArgmax",cS="Mean",fS="Min",cy="Minimum",dS="MirrorPad",fy="Mod",lI="Multinomial",dy="Multiply",hS="Neg",pS="NotEqual",cI="NonMaxSuppressionV3",fI="NonMaxSuppressionV4",dI="NonMaxSuppressionV5",mS="OnesLike",gS="OneHot",yS="Pack",bS="PadV2",DAe="Pool",hy="Pow",vS="Prelu",xS="Prod",hI="RaggedGather",pI="RaggedRange",mI="RaggedTensorToTensor",gI="Range",yI="Real",py="Reciprocal",my="Relu",wS="Reshape",SS="ResizeNearestNeighbor",bI="ResizeNearestNeighborGrad",CS="ResizeBilinear",vI="ResizeBilinearGrad",gy="Relu6",kS="Reverse",yy="Round",by="Rsqrt",xI="ScatterNd",wI="TensorScatterUpdate",SI="SearchSorted",$S="Select",vy="Selu",_S="Slice",xy="Sin",wy="Sinh",Sy="Sign",Cy="Sigmoid",ky="Softplus",$y="Sqrt",ES="Sum",TS="SpaceToBatchND",AS="SplitV",NS="Softmax",CI="SparseFillEmptyRows",kI="SparseReshape",$I="SparseSegmentMean",_I="SparseSegmentSum",EI="SparseToDense",_y="SquaredDifference",TI="Square",IS="StaticRegexReplace",AI="StridedSlice",NI="StringNGrams",II="StringSplit",DI="StringToHashBucketFast",Ey="Sub",Ty="Tan",Ay="Tanh",Ny="Tile",OI="TopK",FI="Transform",wp="Transpose",RI="Unique",DS="Unpack",OS="UnsortedSegmentSum",OAe="UpperBound",FS="ZerosLike",Iy="Step",VE="FromPixels",MI="RotateWithOffset",xw="_FusedMatMul",ww="FusedConv2D",Sw="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function So(...e){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(...e)}function FAe(...e){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.log(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L0=nB("kernelRegistry",()=>new Map),Cw=nB("gradRegistry",()=>new Map);function kw(e,t){const n=rB(e,t);return L0.get(n)}function f5(e){return Cw.get(e)}function jE(e){const t=L0.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[s,o]=i,[a]=s.split("_");a===e&&n.push(o)}return n}function PI(e){const{kernelName:t,backendName:n}=e,r=rB(t,n);L0.has(r)&&So(`The kernel '${t}' for backend '${n}' is already registered`),L0.set(r,e)}function Qoe(e){const{kernelName:t}=e;Cw.has(t)&&Y().getBool("DEBUG")&&So(`Overriding the gradient for '${t}'`),Cw.set(t,e)}function RAe(e,t){const n=rB(e,t);if(!L0.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);L0.delete(n)}function MAe(e){if(!Cw.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);Cw.delete(e)}function PAe(e,t){jE(e).forEach(r=>{const i=Object.assign({},r,{backendName:t});PI(i)})}function rB(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Joe(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var eae=Sn,ha=null;try{ha=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Sn(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}Sn.prototype.__isLong__;Object.defineProperty(Sn.prototype,"__isLong__",{value:!0});function lo(e){return(e&&e.__isLong__)===!0}Sn.isLong=lo;var dK={},hK={};function Fm(e,t){var n,r,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(r=hK[e],r)?r:(n=Cn(e,(e|0)<0?-1:0,!0),i&&(hK[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(r=dK[e],r)?r:(n=Cn(e,e<0?-1:0,!1),i&&(dK[e]=n),n))}Sn.fromInt=Fm;function pa(e,t){if(isNaN(e))return t?fp:ma;if(t){if(e<0)return fp;if(e>=tae)return iae}else{if(e<=-mK)return Hs;if(e+1>=mK)return rae}return e<0?pa(-e,t).neg():Cn(e%z0|0,e/z0|0,t)}Sn.fromNumber=pa;function Cn(e,t,n){return new Sn(e,t,n)}Sn.fromBits=Cn;var HE=Math.pow;function iB(e,t,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return ma;if(typeof t=="number"?(n=t,t=!1):t=!!t,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return iB(e.substring(1),t,n).neg();for(var i=pa(HE(n,8)),s=ma,o=0;o<e.length;o+=8){var a=Math.min(8,e.length-o),u=parseInt(e.substring(o,o+a),n);if(a<8){var l=pa(HE(n,a));s=s.mul(l).add(pa(u))}else s=s.mul(i),s=s.add(pa(u))}return s.unsigned=t,s}Sn.fromString=iB;function Du(e,t){return typeof e=="number"?pa(e,t):typeof e=="string"?iB(e,t):Cn(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}Sn.fromValue=Du;var pK=65536,LAe=1<<24,z0=pK*pK,tae=z0*z0,mK=tae/2,gK=Fm(LAe),ma=Fm(0);Sn.ZERO=ma;var fp=Fm(0,!0);Sn.UZERO=fp;var e0=Fm(1);Sn.ONE=e0;var nae=Fm(1,!0);Sn.UONE=nae;var d5=Fm(-1);Sn.NEG_ONE=d5;var rae=Cn(-1,2147483647,!1);Sn.MAX_VALUE=rae;var iae=Cn(-1,-1,!0);Sn.MAX_UNSIGNED_VALUE=iae;var Hs=Cn(0,-2147483648,!1);Sn.MIN_VALUE=Hs;var De=Sn.prototype;De.toInt=function(){return this.unsigned?this.low>>>0:this.low};De.toNumber=function(){return this.unsigned?(this.high>>>0)*z0+(this.low>>>0):this.high*z0+(this.low>>>0)};De.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Hs)){var n=pa(t),r=this.div(n),i=r.mul(n).sub(this);return r.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var s=pa(HE(t,6),this.unsigned),o=this,a="";;){var u=o.div(s),l=o.sub(u.mul(s)).toInt()>>>0,c=l.toString(t);if(o=u,o.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};De.getHighBits=function(){return this.high};De.getHighBitsUnsigned=function(){return this.high>>>0};De.getLowBits=function(){return this.low};De.getLowBitsUnsigned=function(){return this.low>>>0};De.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Hs)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,n=31;n>0&&!(t&1<<n);n--);return this.high!=0?n+33:n+1};De.isZero=function(){return this.high===0&&this.low===0};De.eqz=De.isZero;De.isNegative=function(){return!this.unsigned&&this.high<0};De.isPositive=function(){return this.unsigned||this.high>=0};De.isOdd=function(){return(this.low&1)===1};De.isEven=function(){return(this.low&1)===0};De.equals=function(t){return lo(t)||(t=Du(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};De.eq=De.equals;De.notEquals=function(t){return!this.eq(t)};De.neq=De.notEquals;De.ne=De.notEquals;De.lessThan=function(t){return this.comp(t)<0};De.lt=De.lessThan;De.lessThanOrEqual=function(t){return this.comp(t)<=0};De.lte=De.lessThanOrEqual;De.le=De.lessThanOrEqual;De.greaterThan=function(t){return this.comp(t)>0};De.gt=De.greaterThan;De.greaterThanOrEqual=function(t){return this.comp(t)>=0};De.gte=De.greaterThanOrEqual;De.ge=De.greaterThanOrEqual;De.compare=function(t){if(lo(t)||(t=Du(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};De.comp=De.compare;De.negate=function(){return!this.unsigned&&this.eq(Hs)?Hs:this.not().add(e0)};De.neg=De.negate;De.add=function(t){lo(t)||(t=Du(t));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,s=this.low&65535,o=t.high>>>16,a=t.high&65535,u=t.low>>>16,l=t.low&65535,c=0,f=0,d=0,h=0;return h+=s+l,d+=h>>>16,h&=65535,d+=i+u,f+=d>>>16,d&=65535,f+=r+a,c+=f>>>16,f&=65535,c+=n+o,c&=65535,Cn(d<<16|h,c<<16|f,this.unsigned)};De.subtract=function(t){return lo(t)||(t=Du(t)),this.add(t.neg())};De.sub=De.subtract;De.multiply=function(t){if(this.isZero())return ma;if(lo(t)||(t=Du(t)),ha){var n=ha.mul(this.low,this.high,t.low,t.high);return Cn(n,ha.get_high(),this.unsigned)}if(t.isZero())return ma;if(this.eq(Hs))return t.isOdd()?Hs:ma;if(t.eq(Hs))return this.isOdd()?Hs:ma;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(gK)&&t.lt(gK))return pa(this.toNumber()*t.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,s=this.low>>>16,o=this.low&65535,a=t.high>>>16,u=t.high&65535,l=t.low>>>16,c=t.low&65535,f=0,d=0,h=0,p=0;return p+=o*c,h+=p>>>16,p&=65535,h+=s*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=i*c,f+=d>>>16,d&=65535,d+=s*l,f+=d>>>16,d&=65535,d+=o*u,f+=d>>>16,d&=65535,f+=r*c+i*l+s*u+o*a,f&=65535,Cn(h<<16|p,f<<16|d,this.unsigned)};De.mul=De.multiply;De.divide=function(t){if(lo(t)||(t=Du(t)),t.isZero())throw Error("division by zero");if(ha){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var n=(this.unsigned?ha.div_u:ha.div_s)(this.low,this.high,t.low,t.high);return Cn(n,ha.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?fp:ma;var r,i,s;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return fp;if(t.gt(this.shru(1)))return nae;s=fp}else{if(this.eq(Hs)){if(t.eq(e0)||t.eq(d5))return Hs;if(t.eq(Hs))return e0;var o=this.shr(1);return r=o.div(t).shl(1),r.eq(ma)?t.isNegative()?e0:d5:(i=this.sub(t.mul(r)),s=r.add(i.div(t)),s)}else if(t.eq(Hs))return this.unsigned?fp:ma;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=ma}for(i=this;i.gte(t);){r=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),u=a<=48?1:HE(2,a-48),l=pa(r),c=l.mul(t);c.isNegative()||c.gt(i);)r-=u,l=pa(r,this.unsigned),c=l.mul(t);l.isZero()&&(l=e0),s=s.add(l),i=i.sub(c)}return s};De.div=De.divide;De.modulo=function(t){if(lo(t)||(t=Du(t)),ha){var n=(this.unsigned?ha.rem_u:ha.rem_s)(this.low,this.high,t.low,t.high);return Cn(n,ha.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};De.mod=De.modulo;De.rem=De.modulo;De.not=function(){return Cn(~this.low,~this.high,this.unsigned)};De.and=function(t){return lo(t)||(t=Du(t)),Cn(this.low&t.low,this.high&t.high,this.unsigned)};De.or=function(t){return lo(t)||(t=Du(t)),Cn(this.low|t.low,this.high|t.high,this.unsigned)};De.xor=function(t){return lo(t)||(t=Du(t)),Cn(this.low^t.low,this.high^t.high,this.unsigned)};De.shiftLeft=function(t){return lo(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Cn(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Cn(0,this.low<<t-32,this.unsigned)};De.shl=De.shiftLeft;De.shiftRight=function(t){return lo(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Cn(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Cn(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};De.shr=De.shiftRight;De.shiftRightUnsigned=function(t){if(lo(t)&&(t=t.toInt()),t&=63,t===0)return this;var n=this.high;if(t<32){var r=this.low;return Cn(r>>>t|n<<32-t,n>>>t,this.unsigned)}else return t===32?Cn(n,0,this.unsigned):Cn(n>>>t-32,0,this.unsigned)};De.shru=De.shiftRightUnsigned;De.shr_u=De.shiftRightUnsigned;De.toSigned=function(){return this.unsigned?Cn(this.low,this.high,!1):this};De.toUnsigned=function(){return this.unsigned?this:Cn(this.low,this.high,!0)};De.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};De.toBytesLE=function(){var t=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};De.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Sn.fromBytes=function(t,n,r){return r?Sn.fromBytesLE(t,n):Sn.fromBytesBE(t,n)};Sn.fromBytesLE=function(t,n){return new Sn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)};Sn.fromBytesBE=function(t,n){return new Sn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)};const sae=O1(eae),zAe=V_e({__proto__:null,default:sae},[eae]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jh=sae||zAe;function RS(e){return Jh.fromString(e,!0,16)}const oae=RS("c3a5c85c97cb3127"),qh=RS("b492b66fbe98f273"),Fi=RS("9ae16a3b2f90404f");function h5(e){return e.xor(e.shru(47))}function aae(e,t,n){const r=e.slice(t,t+n);return Jh.fromBytes(Array.from(r),!0,!0)}function mn(e,t){return aae(e,t,8)}function yK(e,t){return aae(e,t,4)}function Tr(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function fd(e,t,n=RS("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function BAe(e,t,n,r,i,s){i=i.add(e),s=Tr(s.add(i).add(r),21);const o=i;return i=i.add(t),i=i.add(n),s=s.add(Tr(i,44)),[i.add(r),s.add(o)]}function Jk(e,t,n,r){return BAe(mn(e,t),mn(e,t+8),mn(e,t+16),mn(e,t+24),n,r)}function UAe(e,t=e.length){if(t>=8){const n=Fi.add(t*2),r=mn(e,0).add(Fi),i=mn(e,t-8),s=Tr(i,37).mul(n).add(r),o=Tr(r,25).add(i).mul(n);return fd(s,o,n)}if(t>=4){const n=Fi.add(t*2),r=yK(e,0);return fd(r.shl(3).add(t),yK(e,t-4),n)}if(t>0){const n=e[0],r=e[t>>1],i=e[t-1],s=n+(r<<8),o=t+(i<<2);return h5(Fi.mul(s).xor(oae.mul(o))).mul(Fi)}return Fi}function WAe(e,t=e.length){const n=Fi.add(t*2),r=mn(e,0).mul(qh),i=mn(e,8),s=mn(e,t-8).mul(n),o=mn(e,t-16).mul(Fi);return fd(Tr(r.add(i),43).add(Tr(s,30)).add(o),r.add(Tr(i.add(Fi),18)).add(s),n)}function VAe(e,t=e.length){const n=Fi.add(t*2),r=mn(e,0).mul(Fi),i=mn(e,8),s=mn(e,t-8).mul(n),o=mn(e,t-16).mul(Fi),a=Tr(r.add(i),43).add(Tr(s,30)).add(o),u=fd(a,r.add(Tr(i.add(Fi),18)).add(s),n),l=mn(e,16).mul(n),c=mn(e,24),f=a.add(mn(e,t-32)).mul(n),d=u.add(mn(e,t-24)).mul(n);return fd(Tr(l.add(c),43).add(Tr(f,30)).add(d),l.add(Tr(c.add(r),18)).add(f),n)}function uae(e,t=e.length){const n=Jh.fromNumber(81,!0);if(t<=32)return t<=16?UAe(e,t):WAe(e,t);if(t<=64)return VAe(e,t);let r=n,i=n.mul(qh).add(113),s=h5(i.mul(Fi).add(113)).mul(Fi),o=[Jh.UZERO,Jh.UZERO],a=[Jh.UZERO,Jh.UZERO];r=r.mul(Fi).add(mn(e,0));let u=0;const l=(t-1>>6)*64,c=l+(t-1&63)-63;do r=Tr(r.add(i).add(o[0]).add(mn(e,u+8)),37).mul(qh),i=Tr(i.add(o[1]).add(mn(e,u+48)),42).mul(qh),r=r.xor(a[1]),i=i.add(o[0]).add(mn(e,u+40)),s=Tr(s.add(a[0]),33).mul(qh),o=Jk(e,u,o[1].mul(qh),r.add(a[0])),a=Jk(e,u+32,s.add(a[1]),i.add(mn(e,u+16))),[s,r]=[r,s],u+=64;while(u!==l);const f=qh.add(s.and(255).shl(1));return u=c,a[0]=a[0].add(t-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=Tr(r.add(i).add(o[0]).add(mn(e,u+8)),37).mul(f),i=Tr(i.add(o[1]).add(mn(e,u+48)),42).mul(f),r=r.xor(a[1].mul(9)),i=i.add(o[0].mul(9).add(mn(e,u+40))),s=Tr(s.add(a[0]),33).mul(f),o=Jk(e,u,o[1].mul(f),r.add(a[0])),a=Jk(e,u+32,s.add(a[1]),i.add(mn(e,u+16))),[s,r]=[r,s],fd(fd(o[0],a[0],f).add(h5(i).mul(oae)).add(s),fd(o[1],a[1],f).add(r),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of(e,t){return t==="string"?ml(e):Xd([e],t)}function jAe(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Xd(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Al(e)),Y().getBool("DEBUG")&&Woe(e,t),jAe(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function Vr(){return Y().platform.now()}function lae(e,t){return Y().platform.fetch(e,t)}function ml(e,t="utf-8"){return t=t||"utf-8",Y().platform.encode(e,t)}function jc(e,t="utf-8"){return t=t||"utf-8",Y().platform.decode(e,t)}function yr(e){return Y().platform.isTypedArray!=null?Y().platform.isTypedArray(e):Joe(e)}function Al(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||Vc(e)||e==null||yr(e)&&n)t.push(e);else if(Array.isArray(e)||yr(e))for(let r=0;r<e.length;++r)Al(e[r],t,n);else{let r=-1;for(const i of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)Al(e[i],t,n)}return t}const HAe=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:$t,arraysEqualWithNull:Uoe,assert:A,assertNonNegativeIntegerDimensions:uo,assertNonNull:Nm,assertShapesMatch:ni,bytesFromStringArray:joe,bytesPerElement:vw,checkConversionForErrors:Woe,clamp:Sd,computeStrides:Ye,convertBackendValuesAndArrayBuffer:qoe,createScalarValue:of,createShuffledIndices:l5,decodeString:jc,distSquared:wAe,encodeString:ml,fetch:lae,fingerPrint64:uae,flatten:Al,getArrayFromDType:qn,getTypedArrayFromDType:Dr,hasEncodingLoss:Jz,hexToLong:RS,indexToLoc:Dm,inferDtype:Im,inferFromImplicitShape:Qz,isBoolean:Hoe,isFunction:Cd,isInt:Lp,isNumber:zE,isPromise:Vc,isScalarShape:SAe,isString:cl,isTypedArray:yr,isValidDtype:Voe,locToIndex:pu,makeOnesTypedArray:IN,makeZerosNestedTypedArray:eB,makeZerosTypedArray:ei,nearestDivisor:BE,nearestLargerEven:NN,now:Vr,parseAxisParam:wt,randUniform:xAe,repeatedTry:c5,rightPad:xp,shuffle:Zz,shuffleCombo:vAe,sizeFromShape:ee,sizeToSquarishShape:LE,squeezeShape:sf,sum:Boe,swap:bc,tanh:CAe,toNestedArray:Po,toTypedArray:Xd},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GAe{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new XAe)}profileKernel(t,n,r){let i;const s=()=>{i=r()};let o;const a=Vr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();for(const l of i)l.dataSync();o=Promise.resolve({kernelMs:Vr()-a})}if(Y().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<i.length;l++){const c=i[l];c.data().then(f=>{qAe(f,c.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:o.then(l=>l.kernelMs),extraInfo:o.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:r,timeMs:i,inputs:s,extraInfo:o}=t;r.forEach(a=>{Promise.all([a.data(),i,o]).then(u=>{this.logger.logKernelProfile(n,a,u[0],u[1],s,u[2])})})}}function qAe(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){const i=e[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}class XAe{logKernelProfile(t,n,r,i,s,o){const a=typeof i=="number"?xp(`${i}ms`,9):i.error,u=xp(t,25),l=n.rank,c=n.size,f=xp(n.shape.toString(),14);let d="";for(const h in s){const p=s[h];if(p!=null){const m=p.shape||n.shape,g=m.length;d+=`${h}: ${g}D ${g>0?m:""} `}}console.log(`%c${u}	%c${a}	%c${l}D ${f}	%c${c}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KAe(e,t,n){const r={},i={};for(let u=0;u<t.length;u++)r[t[u].id]=!0;for(let u=0;u<e.length;u++){const l=e[u],c=l.inputs;for(const f in c){const d=c[f];let h=!1;for(let p=0;p<t.length;p++)if(r[d.id]){l.outputs.forEach(m=>r[m.id]=!0),h=!0,i[l.id]=!0;break}if(h)break}}const s={};s[n.id]=!0;const o={};for(let u=e.length-1;u>=0;u--){const l=e[u],c=l.inputs;for(let f=0;f<l.outputs.length;f++)if(s[l.outputs[f].id]){for(const d in c)s[c[d].id]=!0,o[l.id]=!0;break}}const a=[];for(let u=0;u<e.length;u++){const l=e[u];if(i[l.id]&&o[l.id]){const c={};for(const d in l.inputs){const h=l.inputs[d];r[h.id]&&(c[d]=h)}const f=Object.assign({},l);f.inputs=c,f.outputs=l.outputs,a.push(f)}}return a}function YAe(e,t,n,r){for(let i=t.length-1;i>=0;i--){const s=t[i],o=[];if(s.outputs.forEach(u=>{const l=e[u.id];l!=null?o.push(l):o.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const a=s.gradient(o);for(const u in s.inputs){if(!(u in a))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(a)}.`);const l=n(()=>a[u]());if(l.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${l.dtype}'`);const c=s.inputs[u];if(!$t(l.shape,c.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${u}' has shape '${l.shape}', which does not match the shape of the input '${c.shape}'`);if(e[c.id]==null)e[c.id]=l;else{const f=e[c.id];e[c.id]=r(f,l),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bK=20,Xb=3,dR=7;function ZAe(e,t,n,r){const i=Ye(t),s=QAe(e,t,n,i),o=t.length,a=R_(e,t,n,i,s),u=["Tensor"];return r&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${o}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(a.map(l=>"    "+l).join(`
`)),u.join(`
`)}function QAe(e,t,n,r){const i=ee(t),s=r[r.length-1],o=new Array(s).fill(0),a=t.length,u=n==="complex64"?Pv(e):e;if(a>1)for(let l=0;l<i/s;l++){const c=l*s;for(let f=0;f<s;f++)o[f]=Math.max(o[f],Mv(u[c+f],0,n).length)}return o}function Mv(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(dR))} + ${parseFloat(e[1].toFixed(dR))}j`:cl(e)?r=`'${e}'`:n==="bool"?r=cae(e):r=parseFloat(e.toFixed(dR)).toString(),xp(r,t)}function cae(e){return e===0?"false":"true"}function R_(e,t,n,r,i,s=!0){const o=n==="complex64"?2:1,a=t[0],u=t.length;if(u===0){if(n==="complex64"){const m=Pv(e);return[Mv(m[0],0,n)]}return n==="bool"?[cae(e[0])]:[e[0].toString()]}if(u===1){if(a>bK){const g=Xb*o;let y=Array.from(e.slice(0,g)),b=Array.from(e.slice((a-Xb)*o,a*o));return n==="complex64"&&(y=Pv(y),b=Pv(b)),["["+y.map((v,x)=>Mv(v,i[x],n)).join(", ")+", ..., "+b.map((v,x)=>Mv(v,i[a-Xb+x],n)).join(", ")+"]"]}return["["+(n==="complex64"?Pv(e):Array.from(e)).map((g,y)=>Mv(g,i[y],n)).join(", ")+"]"]}const l=t.slice(1),c=r.slice(1),f=r[0]*o,d=[];if(a>bK){for(let m=0;m<Xb;m++){const g=m*f,y=g+f;d.push(...R_(e.slice(g,y),l,n,c,i,!1))}d.push("...");for(let m=a-Xb;m<a;m++){const g=m*f,y=g+f;d.push(...R_(e.slice(g,y),l,n,c,i,m===a-1))}}else for(let m=0;m<a;m++){const g=m*f,y=g+f;d.push(...R_(e.slice(g,y),l,n,c,i,m===a-1))}const h=u===2?",":"";d[0]="["+(a>0?d[0]+h:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+h;let p=`,
`;for(let m=2;m<u;m++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(s?"":p),d}function Pv(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hr{constructor(t,n,r){if(this.dtype=n,this.shape=t.slice(),this.size=ee(t),r!=null){const i=r.length;A(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||qn(n,this.size),this.strides=Ye(t)}set(t,...n){n.length===0&&(n=[0]),A(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const i of t){if(i<0||i>=this.shape[n]){const s=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(s)}n++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return iu().makeTensor(this.values,this.shape,this.dtype)}}let iu=null,Mg=null;function JAe(e){iu=e}function eNe(e){Mg=e}class Rt{constructor(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=ee(t),this.strides=Ye(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Mg.buffer(this.shape,this.dtype,t)}bufferSync(){return Mg.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Po(this.shape,t,this.dtype==="complex64")}arraySync(){return Po(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=iu().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(r=>jc(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),iu().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=iu().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>jc(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await iu().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),iu().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Mg.print(this,t)}clone(){return this.throwIfDisposed(),Mg.clone(this)}toString(t=!1){const n=this.dataSync();return ZAe(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Mg.cast(this,t)}variable(t=!0,n,r){return this.throwIfDisposed(),iu().makeVariable(this,t,n,r)}}Object.defineProperty(Rt,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function te(){return nB("Tensor",()=>Rt)}te();class $w extends Rt{constructor(t,n,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!$t(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);iu().disposeTensor(this),this.dataId=t.dataId,iu().incRef(this,null)}dispose(){iu().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty($w,Symbol.hasInstance,{value:e=>e instanceof Rt&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var p5;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(p5||(p5={}));var m5;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(m5||(m5={}));var g5;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(g5||(g5={}));var y5;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(y5||(y5={}));var b5;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(b5||(b5={}));const tNe={float32:y5,int32:m5,bool:g5,complex64:b5};function ms(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return tNe[e][t]}function LI(e){return ms(e,"int32")}function fae(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function dae(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zn(e,t){if(e.dtype===t.dtype)return[e,t];const n=ms(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function hae(e,t){A(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function zI(e,t){return t.some(n=>n.id===e.id)}function Hc(e){const t=[];return pae(e,t,new Set),t}function pae(e,t,n){if(e==null)return;if(e instanceof Rt){t.push(e);return}if(!nNe(e))return;const r=e;for(const i in r){const s=r[i];n.has(s)||(n.add(s),pae(s,t,n))}}function nNe(e){return Array.isArray(e)||typeof e=="object"}const rNe=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:hae,getTensorsInContainer:Hc,isTensorInList:zI,makeTypesMatch:zn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hR(e){return e.kernelName!=null}class vK{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class B0{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new vK}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,r=1){return t in this.registryFactory?(So(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:r},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(t);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new GAe(this.backendInstance),!0}setupRegisteredKernels(){jE(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){jE(t).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof AN)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,s=r.then(o=>i<this.pendingBackendInitId?!1:(this.registry[t]=o,this.pendingBackendInit=null,!0)).catch(o=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,So(`Initialization of backend ${t} failed`),So(o.stack||o.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(r){return So(`Initialization of backend ${t} failed`),So(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n],{success:i,asyncInit:s}=this.initializeBackend(r);if(s||i)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const r=this.state.tensorInfo.get(n),i=r.backend,s=this.readSync(n),o=i.refCount(n);i.disposeData(n,!0),r.backend=t,t.move(n,s,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let r=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,r){t();try{const i=r();return n(),i}catch(i){throw n(),i}}nextTensorId(){return B0.nextTensorId++}nextVariableId(){return B0.nextVariableId++}clone(t){const n=L.runKernel(ry,{x:t}),r={x:t},i=o=>({x:()=>{const a="float32",u={x:o},l={dtype:a};return L.runKernel(j1,u,l)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],i,s,{}),n}runKernel(t,n,r){if(this.backendName==null&&this.backend,!(kw(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,r){const i=this.backend.numDataIds();let s=0;r.forEach(u=>{s+=u.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-n-s-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${t}'`)}runKernelFunc(t){let n,r=[];const i=this.isTapeOn(),s=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let u;const l=hR(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(hR(t)){const{kernelName:p,inputs:m,attrs:g}=t;this.backendName==null&&this.backend;const y=kw(p,this.backendName);A(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();u=y.kernelFunc({inputs:m,attrs:g,backend:this.backend});const v=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,b,v);const x=v.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(i){const w=this.getTensorsForGradient(p,m,x);r=this.saveTensorsForBackwardMode(w)}return x}}else{const{forwardFunc:p}=t,m=g=>{i&&(r=g.map(y=>this.keep(this.clone(y))))};a=()=>{const g=this.backend.numDataIds();u=this.tidy(()=>p(this.backend,m));const y=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,g,y),y}}const{inputs:c,attrs:f}=t,d=hR(t)?null:t.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(h=this.profiler.profileKernel(l,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),i&&this.addTapeNode(l,c,n,d,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(u)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(t,n,r){const i=f5(t);if(i!=null){const s=i.inputsToSave||[],o=i.outputsToSave||[];let a;i.saveAllInputs?(A(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(l=>n[l])):a=s.map(l=>n[l]);const u=r.filter((l,c)=>o[c]);return a.concat(u)}return[]}makeTensor(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let s=t;r==="string"&&cl(t[0])&&(s=t.map(u=>ml(u)));const o=i.write(s,n,r),a=new Rt(n,r,o,this.nextTensorId());if(this.trackTensor(a,i),r==="string"){const u=this.state.tensorInfo.get(o),l=joe(s);this.state.numBytes+=l-u.bytes,u.bytes=l}return a}makeTensorFromDataId(t,n,r,i){r=r||"float32";const s={dataId:t,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,i)}makeTensorFromTensorInfo(t,n){const{dataId:r,shape:i,dtype:s}=t,o=new Rt(i,s,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(t,n=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const s=new $w(t,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*vw(t.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r})),t instanceof $w||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const r=t.size*vw(t.dtype);this.state.numBytes-=r}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,r,i,s,o){const a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:s},u=f5(t);u!=null&&(i=u.gradFunc),i!=null&&(a.gradient=l=>(l=l.map((c,f)=>{if(c==null){const d=r[f],h=ei(d.size,d.dtype);return this.makeTensor(h,d.shape,d.dtype)}return c}),i(l.length>1?l:l[0],s,o))),this.state.activeTape.push(a)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=Hc(t),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const o=this.state.activeScope.track[s];!o.kept&&!r.has(o.id)&&o.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===i.id&&this.track(s)})}gradients(t,n,r,i=!1){if(A(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));A(s instanceof Rt,()=>"The result y returned by f() must be a tensor.");const o=KAe(this.state.activeTape,n,s);if(!i&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[s.id]=r??iNe(s.shape),YAe(a,o,l=>this.tidy(l),sNe);const u=n.map(l=>a[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(const c of l.saved)c.dispose()}),this.state.activeTape=null),{value:s,grads:u}})}customGrad(t){return A(Cd(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{A(n.every(a=>a instanceof Rt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};n.forEach((a,u)=>{i[u]=a});const s=(a,u)=>(r=t(...n,u),A(r.value instanceof Rt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),A(Cd(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,u)=>{const l=r.gradFunc(a,u),c=Array.isArray(l)?l:[l];A(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),A(c.every(d=>d instanceof Rt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return c.forEach((d,h)=>{f[h]=()=>d}),f};return this.runKernelFunc({forwardFunc:s,backwardsFunc:o,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=Vr(),r=await this.backend.time(t);return r.wallMs=Vr()-n,r}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new vK;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}B0.nextTensorId=0;B0.nextVariableId=0;function iNe(e){const t=IN(ee(e),"float32");return L.makeTensor(t,e,"float32")}function mae(){const e=Koe();if(e._tfengine==null){const t=new Xoe(e);e._tfengine=new B0(t)}return EAe(e._tfengine.ENV),JAe(()=>e._tfengine),e._tfengine}const L=mae();function sNe(e,t){const n={a:e,b:t};return L.runKernel(Om,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNe(){return typeof navigator<"u"&&navigator!=null}let v5;function aNe(e){v5=e}function sB(e){if(v5!==void 0)return v5;if(e||oNe()){if(e||(e=navigator),e.product==="ReactNative")return!0;const t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function oB(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const uNe=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:oB,isMobile:sB,mockIsMobile:aNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gs=Y();gs.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});gs.registerFlag("IS_BROWSER",()=>oB());gs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");gs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));gs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));gs.registerFlag("PROD",()=>!1);gs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>gs.getBool("DEBUG"));gs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);gs.registerFlag("IS_TEST",()=>!1);gs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>gs.getBool("DEBUG"));gs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);gs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);gs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nl(e,t){let n=e;if(yr(e))return t==="string"?[]:[e.length];if(fae(e)){const i=e.channels||"RGBA";return[e.height,e.width*i.length]}else if(dae(e))return[e.buffer.size/(t==null?4:vw(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||yr(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Y().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&gae(e,r,[]),r}function gae(e,t,n){if(n=n||[],!Array.isArray(e)&&!yr(e)){A(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}A(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),A(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const r=t.slice(1);for(let i=0;i<e.length;++i)gae(e[i],r,n.concat(i))}function xK(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function N(e,t,n,r="numeric"){if(e instanceof te())return xK(r,e.dtype,t,n),e;let i=Im(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),xK(r,i,t,n),e==null||!yr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const u=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${u}'`)}const s=Nl(e,i);!yr(e)&&!Array.isArray(e)&&(e=[e]);const a=i!=="string"?Xd(e,i):Al(e,[],!0);return L.makeTensor(a,s,i)}function _w(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((s,o)=>N(s,`${t}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aB="__op";function z(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+aB;const i=(...s)=>{L.startScope(n);try{const o=r(...s);return Vc(o)&&console.error("Cannot return a Promise inside of tidy."),L.endScope(o),o}catch(o){throw L.endScope(null),o}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lNe(e,t){const n=N(e,"real","complex"),r=N(t,"imag","complex");ni(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return L.runKernel(LN,i)}const Gc=z({complex_:lNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kd(e,t,n,r){if(r==null)r=Im(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(dae(e)||fae(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return L.backend.createTensorFromGPUData(e,t||n,r)}if(!yr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){uo(t);const i=ee(t),s=ee(n);A(i===s,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${s}`);for(let o=0;o<n.length;++o){const a=n[o],u=o===n.length-1?a!==ee(t.slice(o)):!0;A(n[o]===t[o]||!u,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!yr(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?Xd(e,r):Al(e,[],!0),L.makeTensor(e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(e,t,n){const r=Nl(e,n);return Kd(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zp={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Ou{static join(t){return new Ou(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>yr(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){const i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=n+i.byteLength;this.shards.push({buffer:i,start:n,end:s}),n=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);const i=n-t,s=new ArrayBuffer(i),o=new Uint8Array(s);let a=0;for(let u=r;u<this.shards.length;u++){const l=this.shards[u],f=t+a-l.start,d=a,p=Math.min(n,l.end)-l.start,m=new Uint8Array(l.buffer,f,p-f);if(o.set(m,d),a+=m.length,n<l.end)break}return s}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(i){return t<i.start?-1:t>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=cNe(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function cNe(e,t){let n=0,r=e.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,s=t(e[i]);if(s===0)return i;s<0?r=i:n=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fNe(){Y().set("PROD",!0)}function dNe(){Y().set("DEBUG",!0)}function hNe(){Y().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function pNe(e){Y().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function mNe(){L.disposeVariables()}function Ja(){return L}function x5(){return L.memory()}function gNe(e){return L.profile(e)}function K(e,t){return L.tidy(e,t)}function at(e){Hc(e).forEach(n=>n.dispose())}function xr(e){return L.keep(e)}function yNe(e){return L.time(e)}function bNe(e){return L.setBackend(e)}function vNe(){return L.ready()}function yae(){return L.backendName}function xNe(e){L.removeBackend(e)}function wNe(e){return L.findBackend(e)}function SNe(e){return L.findBackendFactory(e)}function uB(e,t,n=1){return L.registerBackend(e,t,n)}function lB(){return L.backend}function CNe(e,t){Y().setPlatform(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kd=4;async function w5(e,t){const n=[],r=[],i=Array.isArray(e)?e.map(o=>o.name):Object.keys(e);for(let o=0;o<i.length;++o){const a=i[o],u=Array.isArray(e)?e[o].tensor:e[a];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${u.dtype}`);const l={name:a,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const c=new Promise(async f=>{const d=await u.bytes(),h=d.reduce((g,y)=>g+y.length,0)+kd*d.length,p=new Uint8Array(h);let m=0;for(let g=0;g<d.length;g++){const y=d[g],b=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(b,m),m+=kd,p.set(y,m),m+=y.length}f(p)});r.push(c)}else r.push(u.data());t!=null&&(l.group=t),n.push(l)}const s=await Promise.all(r);return{data:_Ne(s),specs:n}}function cB(e,t){const n=new Ou(e),r={};let i=0;for(const s of t){const o=kNe(s,(a,u)=>n.slice(i+a,i+u));r[s.name]=bae(s,n.slice(i,i+o)),i+=o}return r}function kNe(e,t){const n=ee(e.shape);let r;if("quantization"in e){const i=e.quantization;r=zp[i.dtype]}else if(e.dtype==="string"){let i=0;for(let s=0;s<n;s++)i+=kd+new Uint32Array(t(i,i+kd))[0];return i}else r=zp[e.dtype];return n*r}async function $Ne(e,t){const n=ee(e.shape);let r;if("quantization"in e){const i=e.quantization;r=zp[i.dtype]}else if(e.dtype==="string"){let i=0;for(let s=0;s<n;s++)i+=kd+new Uint32Array(await t(i,i+kd))[0];return i}else r=zp[e.dtype];return n*r}function bae(e,t){const n=e.name,r=e.dtype,i=e.shape,s=ee(i);let o,a=0;if("quantization"in e){const u=e.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${e.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${e.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const l=zp[u.dtype],c=u.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(r==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){o=new Float32Array(c.length);for(let f=0;f<c.length;f++){const d=c[f];o[f]=d*u.scale+u.min}}else if(u.dtype==="float16")o=DNe()(c);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(r==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);o=new Int32Array(c.length);for(let f=0;f<c.length;f++){const d=c[f];o[f]=Math.round(d*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=s*l}else if(r==="string"){const u=ee(e.shape);o=[];for(let l=0;l<u;l++){const c=new Uint32Array(t.slice(a,a+kd))[0];a+=kd;const f=new Uint8Array(t.slice(a,a+c));o.push(f),a+=c}}else{const u=zp[r];if(r==="float32")o=new Float32Array(t);else if(r==="int32")o=new Int32Array(t);else if(r==="bool")o=new Uint8Array(t);else if(r==="complex64"){o=new Float32Array(t);const l=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let p=0;p<l.length;p++)l[p]=o[p*2],c[p]=o[p*2+1];const f=hs(l,i,"float32"),d=hs(c,i,"float32"),h=Gc(f,d);return f.dispose(),d.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=s*u}return hs(o,i,r)}async function wK(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){const{done:i,value:s}=await e.read();if(i&&s==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(r.length+s.byteLength);o.set(r,0),o.set(new Uint8Array(s),r.length),r=o}return r.buffer}async function vae(e,t){const n={},r=e.getReader();let i=new ArrayBuffer(0);for(const s of t){const o=await $Ne(s,async(l,c)=>(i=await wK(r,i,c),i.slice(l,c)));i=await wK(r,i,o);const a=i.slice(0,o);i=i.slice(o);const u=bae(s,a);if(n[s.name]=u,yae()==="webgpu"){const l=lB();"uploadToGPU"in l&&ee(u.shape)>=Y().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&l.uploadToGPU(u.dataId)}}return n}function _Ne(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(s=>{if(t+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(t);let i=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}const fB=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function SK(e){return fB?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function ENe(e){if(fB)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function TNe(e){if(fB){const r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function xae(e){return Ou.join(e)}function CK(e){const t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);const n=e.split(t);return n[n.length-1]}function wae(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function dB(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function hB(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),dB(e,n,r)}function MS(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:SK(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:SK(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new Ou(e.weightData).byteLength}}function GE(e){const t=[];for(const n of e)t.push(...n.weights);return t}function ANe(){const e=n=>{let r=n<<13,i=0;for(;!(r&8388608);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function NNe(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function INe(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function DNe(){const e=ANe(),t=NNe(),n=INe();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let o=0;o<r.length;o++){const a=r[o],u=e[n[a>>10]+(a&1023)]+t[a>>10];s[o]=u}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Rn.instance==null&&(Rn.instance=new Rn),Rn.instance}static registerSaveRouter(t){Rn.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Rn.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Rn.getHandlers(t,"save")}static getLoadHandlers(t,n){return Rn.getHandlers(t,"load",n)}static getHandlers(t,n,r){const i=[];return(n==="load"?Rn.getInstance().loadRouters:Rn.getInstance().saveRouters).forEach(o=>{const a=o(t,r);a!==null&&i.push(a)}),i}}const ONe=e=>Rn.registerSaveRouter(e),FNe=e=>Rn.registerLoadRouter(e),Sae=e=>Rn.getSaveHandlers(e),Cae=(e,t)=>Rn.getLoadHandlers(e,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5="tensorflowjs",C5=1,dp="models_store",jf="model_info_store";function kae(){if(!Y().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function k5(e){const t=e.result;t.createObjectStore(dp,{keyPath:"modelPath"}),t.createObjectStore(jf,{keyPath:"modelPath"})}class Bp{constructor(t){if(this.indexedDB=kae(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((r,i)=>{const s=this.indexedDB.open(S5,C5);s.onupgradeneeded=()=>k5(s),s.onsuccess=()=>{const o=s.result;if(n==null){const a=o.transaction(dp,"readonly"),l=a.objectStore(dp).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return o.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(l.result.modelArtifacts)},l.onerror=c=>(o.close(),i(l.error)),a.oncomplete=()=>o.close()}else{n.weightData=Ou.join(n.weightData);const a=MS(n),u=o.transaction(jf,"readwrite");let l=u.objectStore(jf),c;try{c=l.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return i(d)}let f;c.onsuccess=()=>{f=o.transaction(dp,"readwrite");const d=f.objectStore(dp);let h;try{h=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return i(p)}h.onsuccess=()=>r({modelArtifactsInfo:a}),h.onerror=p=>{l=u.objectStore(jf);const m=l.delete(this.modelPath);m.onsuccess=()=>(o.close(),i(h.error)),m.onerror=g=>(o.close(),i(h.error))}},c.onerror=d=>(o.close(),i(c.error)),u.oncomplete=()=>{f==null?o.close():f.oncomplete=()=>o.close()}}},s.onerror=o=>i(s.error)})}}Bp.URL_SCHEME="indexeddb://";const $ae=e=>Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Bp.URL_SCHEME)?RNe(e.slice(Bp.URL_SCHEME.length)):null;Rn.registerSaveRouter($ae);Rn.registerLoadRouter($ae);function RNe(e){return new Bp(e)}function MNe(e){return e.startsWith(Bp.URL_SCHEME)?e.slice(Bp.URL_SCHEME.length):e}class PNe{constructor(){this.indexedDB=kae()}async listModels(){return new Promise((t,n)=>{const r=this.indexedDB.open(S5,C5);r.onupgradeneeded=()=>k5(r),r.onsuccess=()=>{const i=r.result,s=i.transaction(jf,"readonly"),a=s.objectStore(jf).getAll();a.onsuccess=()=>{const u={};for(const l of a.result)u[l.modelPath]=l.modelArtifactsInfo;t(u)},a.onerror=u=>(i.close(),n(a.error)),s.oncomplete=()=>i.close()},r.onerror=i=>n(r.error)})}async removeModel(t){return t=MNe(t),new Promise((n,r)=>{const i=this.indexedDB.open(S5,C5);i.onupgradeneeded=()=>k5(i),i.onsuccess=()=>{const s=i.result,o=s.transaction(jf,"readwrite"),a=o.objectStore(jf),u=a.get(t);let l;u.onsuccess=()=>{if(u.result==null)return s.close(),r(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const c=a.delete(t),f=()=>{l=s.transaction(dp,"readwrite");const h=l.objectStore(dp).delete(t);h.onsuccess=()=>n(u.result.modelArtifactsInfo),h.onerror=p=>r(u.error)};c.onsuccess=f,c.onerror=d=>(f(),s.close(),r(u.error))}},u.onerror=c=>(s.close(),r(u.error)),o.oncomplete=()=>{l==null?s.close():l.oncomplete=()=>s.close()}},i.onerror=s=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vc="/",Pg="tensorflowjs_models",_ae="info",LNe="model_topology",zNe="weight_specs",BNe="weight_data",UNe="model_metadata";function Eae(e){return{info:[Pg,e,_ae].join(vc),topology:[Pg,e,LNe].join(vc),weightSpecs:[Pg,e,zNe].join(vc),weightData:[Pg,e,BNe].join(vc),modelMetadata:[Pg,e,UNe].join(vc)}}function Tae(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function WNe(e){const t=e.split(vc);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(vc)}function VNe(e){return e.startsWith(Up.URL_SCHEME)?e.slice(Up.URL_SCHEME.length):e}class Up{constructor(t){if(!Y().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Eae(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=MS(t),s=Ou.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,ENe(s));const o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:i}}catch{throw Tae(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const a=JSON.parse(s);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=TNe(o),n}}Up.URL_SCHEME="localstorage://";const Aae=e=>Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Up.URL_SCHEME)?jNe(e.slice(Up.URL_SCHEME.length)):null;Rn.registerSaveRouter(Aae);Rn.registerLoadRouter(Aae);function jNe(e){return new Up(e)}class HNe{constructor(){A(Y().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),A(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=Pg+vc,r=vc+_ae;for(let i=0;i<this.LS.length;++i){const s=this.LS.key(i);if(s.startsWith(n)&&s.endsWith(r)){const o=WNe(s);t[o]=JSON.parse(this.LS.getItem(s))}}return t}async removeModel(t){t=VNe(t);const n=Eae(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return Tae(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p0="://";class Di{constructor(){this.managers={}}static getInstance(){return Di.instance==null&&(Di.instance=new Di),Di.instance}static registerManager(t,n){A(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(p0)&&(t=t.slice(0,t.indexOf(p0))),A(t.length>0,()=>"scheme must not be an empty string.");const r=Di.getInstance();A(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){const n=Di.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(Di.getInstance().managers)}}function M_(e){if(e.indexOf(p0)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Di.getSchemes().join(",")}`);return{scheme:e.split(p0)[0],path:e.split(p0)[1]}}async function Nae(e,t,n=!1){A(e!==t,()=>`Old path and new path are the same: '${e}'`);const r=Rn.getLoadHandlers(e);A(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),A(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);const i=r[0],s=Rn.getSaveHandlers(t);A(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),A(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);const o=s[0],a=M_(e).scheme,u=M_(e).path,l=a===M_(e).scheme,c=await i.load();n&&l&&await Di.getManager(a).removeModel(u);const f=await o.save(c);return n&&!l&&await Di.getManager(a).removeModel(u),f.modelArtifactsInfo}async function GNe(){const e=Di.getSchemes(),t={};for(const n of e){const r=await Di.getManager(n).listModels();for(const i in r){const s=n+p0+i;t[s]=r[i]}}return t}async function qNe(e){const t=M_(e);return Di.getManager(t.scheme).removeModel(t.path)}async function XNe(e,t){return Nae(e,t,!1)}async function KNe(e,t){return Nae(e,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YNe{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!Y().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return Joe(t)}}if(Y().get("IS_BROWSER")){Y().setPlatform("browser",new YNe);try{Di.registerManager(Up.URL_SCHEME,new HNe)}catch{}try{Di.registerManager(Bp.URL_SCHEME,new PNe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZNe={importFetch:()=>require("node-fetch")};let pR;class QNe{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return Y().global.fetch!=null?Y().global.fetch(t,n):(pR==null&&(pR=ZNe.importFetch()),pR(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}Y().get("IS_NODE")&&!Y().get("IS_BROWSER")&&Y().setPlatform("node",new QNe);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mt(e,t="float32",n){return t=t||"float32",uo(e),new hr(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(e,t){const n=N(e,"x","cast");if(!Voe(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:t};return L.runKernel(j1,r,i)}const Ce=z({cast_:JNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eIe(e){const n={x:N(e,"x","clone","string_or_numeric")};return L.runKernel(ry,n)}const gl=z({clone_:eIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */mae();const tIe={buffer:mt,cast:Ce,clone:gl,print:pB};eNe(tIe);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIe(e,t){let n=N(e,"a","add"),r=N(t,"b","add");[n,r]=zn(n,r);const i={a:n,b:r};return L.runKernel(Om,i)}const de=z({add_:nIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rIe(e,t){let n=N(e,"a","floorDiv"),r=N(t,"b","floorDiv");[n,r]=zn(n,r);const i={a:n,b:r};return L.runKernel(ty,i)}const BI=z({floorDiv_:rIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(e,t){let n=N(e,"a","div"),r=N(t,"b","div");if([n,r]=zn(n,r),n.dtype==="int32"&&r.dtype==="int32")return BI(n,r);const i={a:n,b:r},s={};return L.runKernel(K1,i,s)}const Ue=z({div_:iIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sIe(e,t){let n=N(e,"a","mul"),r=N(t,"b","mul");[n,r]=zn(n,r);const i={a:n,b:r};return L.runKernel(dy,i)}const U=z({mul_:sIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(e){const t=N(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return L.runKernel(U2,n)}else{const n={x:t};return L.runKernel(D2,n)}}const ar=z({abs_:oIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aIe(e){const n={x:N(e,"x","acos")};return L.runKernel(P1,n)}const mB=z({acos_:aIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uIe(e){const n={x:N(e,"x","acosh")};return L.runKernel(L1,n)}const gB=z({acosh_:uIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(e){A(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),A(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((i,s)=>N(i,`tensors${s}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!$t(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=t;return L.runKernel(O2,r)}const Iae=z({addN_:lIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIe(e,t=null,n=!1){const i={x:N(e,"x","all","bool")},s={axis:t,keepDims:n};return L.runKernel(DN,i,s)}const UI=z({all_:cIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fIe(e,t=null,n=!1){const i={x:N(e,"x","any","bool")},s={axis:t,keepDims:n};return L.runKernel(ON,i,s)}const Ew=z({any_:fIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dIe(e,t=0){const r={x:N(e,"x","argMax")},i={axis:t};return L.runKernel(F2,r,i)}const Wp=z({argMax_:dIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hIe(e,t=0){const r={x:N(e,"x","argMin")},i={axis:t};return L.runKernel(R2,r,i)}const yB=z({argMin_:hIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pIe(e){const n={x:N(e,"x","asin")};return L.runKernel(z1,n)}const bB=z({asin_:pIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mIe(e){const n={x:N(e,"x","asinh")};return L.runKernel(B1,n)}const vB=z({asinh_:mIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gIe(e){const n={x:N(e,"x","atan")};return L.runKernel(U1,n)}const xB=z({atan_:gIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yIe(e,t){let n=N(e,"a","atan2"),r=N(t,"b","atan2");[n,r]=zn(n,r);const i={a:n,b:r};return L.runKernel(V1,i)}const wB=z({atan2_:yIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bIe(e){const n={x:N(e,"x","atanh")};return L.runKernel(W1,n)}const SB=z({atanh_:bIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PS(e,t,n,r,i="NHWC",s){const o=e[3],a=[...t,o],u=uf(i);return Pr(e,a,n,s,r,null,null,u)}function za(e,t,n,r,i,s,o="channelsLast"){const[a,u]=Tw(t);let l;if(o==="channelsLast")l=[a,u,e[3],e[3]];else if(o==="channelsFirst")l=[a,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return Pr(e,l,n,r,i,s,!1,o)}function af(e,t,n,r,i,s,o="NDHWC"){const[a,u,l]=$5(t);let c,f;if(o==="NDHWC")f="channelsLast",c=[a,u,l,e[4],e[4]];else if(o==="NCDHW")f="channelsFirst",c=[a,u,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return Yd(e,c,n,r,i,!1,f,s)}function Pr(e,t,n,r,i,s,o=!1,a="channelsLast"){let[u,l,c,f]=[-1,-1,-1,-1];if(a==="channelsLast")[u,l,c,f]=e;else if(a==="channelsFirst")[u,f,l,c]=e;else throw new Error(`Unknown dataFormat ${a}`);const[d,h,,p]=t,[m,g]=Tw(n),[y,b]=Tw(r),v=m0(d,y),x=m0(h,b),{padInfo:w,outHeight:S,outWidth:C}=wIe(i,l,c,m,g,v,x,s,a),k=o?p*f:p;let E;return a==="channelsFirst"?E=[u,k,S,C]:a==="channelsLast"&&(E=[u,S,C,k]),{batchSize:u,dataFormat:a,inHeight:l,inWidth:c,inChannels:f,outHeight:S,outWidth:C,outChannels:k,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:h,effectiveFilterHeight:v,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:b,inShape:e,outShape:E,filterShape:t}}function Yd(e,t,n,r,i,s=!1,o="channelsLast",a){let[u,l,c,f,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[u,l,c,f,d]=e;else if(o==="channelsFirst")[u,d,l,c,f]=e;else throw new Error(`Unknown dataFormat ${o}`);const[h,p,m,,g]=t,[y,b,v]=$5(n),[x,w,S]=$5(r),C=m0(h,x),k=m0(p,w),E=m0(m,S),{padInfo:_,outDepth:T,outHeight:D,outWidth:O}=SIe(i,l,c,f,y,b,v,C,k,E,a),M=s?g*d:g;let I;return o==="channelsFirst"?I=[u,M,T,D,O]:o==="channelsLast"&&(I=[u,T,D,O,M]),{batchSize:u,dataFormat:o,inDepth:l,inHeight:c,inWidth:f,inChannels:d,outDepth:T,outHeight:D,outWidth:O,outChannels:M,padInfo:_,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:h,filterHeight:p,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:k,effectiveFilterWidth:E,dilationDepth:x,dilationHeight:w,dilationWidth:S,inShape:e,outShape:I,filterShape:t}}function vIe(e,t,n,r,i){r==null&&(r=CB(e,t,n));const s=e[0],o=e[1],a=Aw((s-t+2*r)/n+1,i),u=Aw((o-t+2*r)/n+1,i);return[a,u]}function xIe(e,t,n,r,i,s){i==null&&(i=CB(e,t[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)e[a]+2*i>=t[a]&&(o[a]=Aw((e[a]-t[a]+2*i)/r[a]+1,s));return o}function CB(e,t,n,r=1){const i=m0(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function Tw(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function $5(e){return typeof e=="number"?[e,e,e]:e}function m0(e,t){return t<=1?e:e+(e-1)*(t-1)}function wIe(e,t,n,r,i,s,o,a,u){let l,c,f;if(typeof e=="number"){l={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const h=vIe([t,n],s,r,e,a);c=h[0],f=h[1]}else if(e==="same"){c=Math.ceil(t/r),f=Math.ceil(n/i);const d=Math.max(0,(c-1)*r+s-t),h=Math.max(0,(f-1)*i+o-n),p=Math.floor(d/2),m=d-p,g=Math.floor(h/2),y=h-g;l={top:p,bottom:m,left:g,right:y,type:"SAME"}}else if(e==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-s+1)/r),f=Math.ceil((n-o+1)/i);else if(typeof e=="object"){const d=u==="channelsLast"?e[1][0]:e[2][0],h=u==="channelsLast"?e[1][1]:e[2][1],p=u==="channelsLast"?e[2][0]:e[3][0],m=u==="channelsLast"?e[2][1]:e[3][1];l={top:d,bottom:h,left:p,right:m,type:d===0&&h===0&&p===0&&m===0?"VALID":"EXPLICIT"},c=Aw((t-s+d+h)/r+1,a),f=Aw((n-o+p+m)/i+1,a)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:l,outHeight:c,outWidth:f}}function SIe(e,t,n,r,i,s,o,a,u,l,c){let f,d,h,p;if(e==="valid"&&(e=0),typeof e=="number"){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const g=xIe([t,n,r,1],[a,u,l],1,[i,s,o],e,c);d=g[0],h=g[1],p=g[2]}else if(e==="same"){d=Math.ceil(t/i),h=Math.ceil(n/s),p=Math.ceil(r/o);const m=(d-1)*i+a-t,g=(h-1)*s+u-n,y=(p-1)*o+l-r,b=Math.floor(m/2),v=m-b,x=Math.floor(g/2),w=g-x,S=Math.floor(y/2),C=y-S;f={top:x,bottom:w,left:S,right:C,front:b,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:f,outDepth:d,outHeight:h,outWidth:p}}function Aw(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function $d(e){const[t,n,r]=Tw(e);return t===1&&n===1&&r===1}function ri(e,t){return $d(e)||$d(t)}function Vp(e){return Tw(e).every(t=>t>0)}function uf(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Xi(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")A(Lp(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(i=>{A(Lp(i),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CIe(e,t){const r={x:N(e,"x","reshape","string_or_numeric")},i={shape:t};return L.runKernel(wS,r,i)}const j=z({reshape_:CIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kIe(e,t,n,r,i){const s=N(e,"x","avgPool","float32"),o=1;A(ri(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=s,u=!1;s.rank===3&&(u=!0,a=j(s,[1,s.shape[0],s.shape[1],s.shape[2]])),A(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Xi("avgPool",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i};let f=L.runKernel(M2,l,c);return f=Ce(f,s.dtype),u?j(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const LS=z({avgPool_:kIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ie(e,t,n,r,i,s="NDHWC"){const o=N(e,"x","avgPool3d","float32");let a=o,u=!1;o.rank===4&&(u=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),A(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),A(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),A(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Xi("avgPool3d",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s};let f=L.runKernel(P2,l,c);return f=Ce(f,a.dtype),u?j(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const kB=z({avgPool3d_:$Ie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ie(e,t=0){A(e.length>=1,()=>"Pass at least one tensor to concat");const n=_w(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return gl(n[0]);const r=n,i={axis:t};return L.runKernel(W2,r,i)}const tr=z({concat_:_Ie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIe(e,t,n=!1,r=!1){let i=N(e,"a","matMul"),s=N(t,"b","matMul");[i,s]=zn(i,s);const o={a:i,b:s},a={transposeA:n,transposeB:r};return L.runKernel(L2,o,a)}const vt=z({matMul_:EIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIe(e){const n={x:N(e,"x","sigmoid","float32")};return L.runKernel(Cy,n)}const mu=z({sigmoid_:TIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AIe(e,t,n){const r=N(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},s={begin:t,size:n};return L.runKernel(_S,i,s)}const At=z({slice_:AIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NIe(e){const n={x:N(e,"x","tanh","float32")};return L.runKernel(Ay,n)}const _d=z({tanh_:NIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IIe(e,t,n,r,i,s){const o=N(e,"forgetBias","basicLSTMCell"),a=N(t,"lstmKernel","basicLSTMCell"),u=N(n,"lstmBias","basicLSTMCell"),l=N(r,"data","basicLSTMCell"),c=N(i,"c","basicLSTMCell"),f=N(s,"h","basicLSTMCell"),d=tr([l,f],1),h=vt(d,a),p=de(h,u),m=p.shape[0],g=p.shape[1]/4,y=[m,g],b=At(p,[0,0],y),v=At(p,[0,g],y),x=At(p,[0,g*2],y),w=At(p,[0,g*3],y),S=de(U(mu(b),_d(v)),U(c,mu(de(o,x)))),C=U(_d(S),mu(w));return[S,C]}const Dae=z({basicLSTMCell_:IIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(e,t,n){const r=N(e,"x","batchToSpaceND"),i=t.reduce((a,u)=>a*u);A(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),A(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),A(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);const s={x:r},o={blockShape:t,crops:n};return L.runKernel(z2,s,o)}const zS=z({batchToSpaceND_:DIe});function OIe(e){let t;return e.rank===0||e.rank===1?t=j(e,[1,1,1,e.size]):e.rank===2?t=j(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(e,t,n,r,i,s){s==null&&(s=.001);const o=N(e,"x","batchNorm"),a=N(t,"mean","batchNorm"),u=N(n,"variance","batchNorm");let l;i!=null&&(l=N(i,"scale","batchNorm"));let c;r!=null&&(c=N(r,"offset","batchNorm")),A(a.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(l==null||a.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:OIe(o),scale:l,offset:c,mean:a,variance:u},h={varianceEpsilon:s},p=L.runKernel(Z2,d,h);return j(p,o.shape)}const Dy=z({batchNorm_:FIe});function RIe(e,t,n,r,i,s){const o=N(e,"x","batchNorm"),a=N(t,"mean","batchNorm"),u=N(n,"variance","batchNorm");let l;i!=null&&(l=N(i,"scale","batchNorm"));let c;return r!=null&&(c=N(r,"offset","batchNorm")),A(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),A(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),A(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),l!=null&&A(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&A(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Dy(o,a,u,c,l,s)}const $B=z({batchNorm2d_:RIe});function MIe(e,t,n,r,i,s){const o=N(e,"x","batchNorm"),a=N(t,"mean","batchNorm"),u=N(n,"variance","batchNorm");let l;i!=null&&(l=N(i,"scale","batchNorm"));let c;return r!=null&&(c=N(r,"offset","batchNorm")),A(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),A(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),A(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),l!=null&&A(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&A(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Dy(o,a,u,c,l,s)}const _B=z({batchNorm3d_:MIe});function PIe(e,t,n,r,i,s){const o=N(e,"x","batchNorm"),a=N(t,"mean","batchNorm"),u=N(n,"variance","batchNorm");let l;i!=null&&(l=N(i,"scale","batchNorm"));let c;return r!=null&&(c=N(r,"offset","batchNorm")),A(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),A(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),A(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),l!=null&&A(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&A(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Dy(o,a,u,c,l,s)}const EB=z({batchNorm4d_:PIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LIe(e,t,n){const r=N(e,"x","bincount"),i=N(t,"weights","bincount");A(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const s={x:r,weights:i},o={size:n};return L.runKernel(MN,s,o)}const TB=z({bincount_:LIe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zIe(e,t){const n=N(e,"x","bitwiseAnd"),r=N(t,"y","bitwiseAnd");if(!$t(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const i={a:n,b:r};return L.runKernel(B2,i)}const Oae=z({bitwiseAnd_:zIe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BIe(e,t){const n=N(e,"s0","broadcastArgs","int32"),r=N(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return L.runKernel(PN,i)}const Fae=z({broadcastArgs_:BIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UIe(e,t){let n=N(e,"broadcastTo","x");const r=n.shape;if(uo(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const l=n.shape.slice();for(;l.length<t.length;)l.unshift(1);n=j(n,l)}const i=n.shape,s=Array.from(t);for(let l=t.length-1;l>=0;l--)if(i[l]===t[l])s[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(s.map((l,c)=>l>1?c:-1).filter(l=>l>=0).length===0)return gl(n);const a={x:n},u={reps:s};return L.runKernel(Ny,a,u)}const Sp=z({broadcastTo_:UIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WIe(e){const n={x:N(e,"x","ceil","float32")};return L.runKernel(H1,n)}const AB=z({ceil_:WIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rm(e,t,n){uo(e),n=n||Im(t);const r={shape:e,value:t,dtype:n};return L.runKernel(JN,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIe(e,t,n){const r=N(e,"x","clipByValue");if(A(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return Rm(r.shape,t,r.dtype);const i={x:r},s={clipValueMin:t,clipValueMax:n};return L.runKernel(G1,i,s)}const ys=z({clipByValue_:VIe});function jIe(e){return tr(e,0)}const NB=z({concat1d_:jIe});function HIe(e,t){return tr(e,t)}const IB=z({concat2d_:HIe});function GIe(e,t){return tr(e,t)}const DB=z({concat3d_:GIe});function qIe(e,t){return tr(e,t)}const OB=z({concat4d_:qIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XIe(e,t,n,r,i="NHWC",s=[1,1],o){const a=N(e,"x","conv2d","float32"),u=N(t,"filter","conv2d","float32");let l=a,c=!1;a.rank===3&&(c=!0,l=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(l.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),A(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),Xi("conv2d",r,o);const f=i==="NHWC"?l.shape[3]:l.shape[1];A(f===u.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${u.shape[2]}.`),A(ri(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),A(Vp(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),A(Vp(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:l,filter:u},h={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},p=L.runKernel(V2,d,h);return c?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const qc=z({conv2d_:XIe});function KIe(e,t,n,r,i="NWC",s=1,o){const a=N(e,"x","conv1d"),u=N(t,"filter","conv1d");let l=a,c=!1;a.rank===2&&(c=!0,l=j(a,[1,a.shape[0],a.shape[1]])),A(l.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),A(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),Xi("conv1d",r,o),A(l.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${u.shape[1]}.`),A(ri(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),A(Vp(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),A(Vp(n),()=>"Error in conv1D: Stride should be larger than 0."),A(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=j(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=j(l,[l.shape[0],1,l.shape[1],l.shape[2]]),g=qc(d,f,[1,n],r,"NHWC",[1,s],o);return c?j(g,[g.shape[2],g.shape[3]]):j(g,[g.shape[0],g.shape[2],g.shape[3]])}const WI=z({conv1d_:KIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YIe(e,t,n,r,i,s="NHWC",o){A(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,u=t,l=!1;t.rank===3&&(l=!0,u=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,e[0],e[1],e[2]]),A(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),A(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),A(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=s==="NHWC"?a[3]:a[1],f=s==="NHWC"?u.shape[3]:u.shape[1];A(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),A(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),Xi("conv2dDerInput",i,o);const d={dy:u,filter:n},h={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,inputShape:a},p=L.runKernel(j2,d,h);return l?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const FB=z({conv2DBackpropInput_:YIe});function ZIe(e,t,n,r,i,s){const o=N(e,"x","conv2dTranspose"),a=N(t,"filter","conv2dTranspose");return FB(n,o,a,r,i,"NHWC",s)}const VI=z({conv2dTranspose_:ZIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(e,t,n,r,i="NDHWC",s=[1,1,1]){const o=N(e,"x","conv3d"),a=N(t,"filter","conv3d");let u=o,l=!1;o.rank===4&&(l=!0,u=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),A(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),A(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),A(u.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${a.shape[3]}.`),A(ri(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),A(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),A(Vp(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),A(Vp(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:u,filter:a},f={strides:n,pad:r,dataFormat:i,dilations:s},d=L.runKernel(H2,c,f);return l?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const RB=z({conv3d_:QIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JIe(e,t,n,r,i){A(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let s=e,o=t,a=!1;t.rank===4&&(a=!0,o=j(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);const u=s[4],l=o.shape[4];A(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),A(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),A(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),A(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),A(l===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},f={pad:i,strides:r,inputShape:s},d=L.runKernel(UN,c,f);return a?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Rae=z({conv3DBackpropInput_:JIe});function e3e(e,t,n,r,i){const s=N(e,"x","conv3dTranspose"),o=N(t,"filter","conv3dTranspose");return Rae(n,s,o,r,i)}const MB=z({conv3dTranspose_:e3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3e(e){const n={x:N(e,"x","cos","float32")};return L.runKernel(q1,n)}const BS=z({cos_:t3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n3e(e){const n={x:N(e,"x","cosh","float32")};return L.runKernel(X1,n)}const jI=z({cosh_:n3e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3e(e,t=0,n=!1,r=!1){const s={x:N(e,"x","cumprod")},o={axis:t,exclusive:n,reverse:r};return L.runKernel(WN,s,o)}const Nw=z({cumprod_:r3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3e(e,t=0,n=!1,r=!1){const s={x:N(e,"x","cumsum")},o={axis:t,exclusive:n,reverse:r};return L.runKernel(G2,s,o)}const HI=z({cumsum_:i3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3e(e,t,n,r=!1){const i=N(e,"x","denseBincount"),s=N(t,"weights","denseBincount");A(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),A(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(s.size===i.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`);const o={x:i,weights:s},a={size:n,binaryOutput:r};return L.runKernel(jN,o,a)}const qE=z({denseBincount_:s3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o3e(e,t,n="NHWC"){const r=N(e,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];A(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),A(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),A(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${t} for depthToSpace with input shape
        ${r.shape}`),A(o%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},u={blockSize:t,dataFormat:n};return L.runKernel(HN,a,u)}const PB=z({depthToSpace_:o3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3e(e,t,n,r,i="NHWC",s=[1,1],o){const a=N(e,"x","depthwiseConv2d","float32"),u=N(t,"filter","depthwiseConv2d","float32");let l=a,c=!1;a.rank===3&&(c=!0,l=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(l.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),A(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const f=i==="NHWC"?l.shape[3]:l.shape[1];A(f===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${u.shape[2]}.`),Xi("depthwiseConv2d",r,o);const d={x:l,filter:u},h={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},p=L.runKernel(q2,d,h);return c?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Oy=z({depthwiseConv2d_:a3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3e(e){const n={x:N(e,"x","diag")};return L.runKernel(XN,n)}const Mae=z({diag_:u3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3e(e,t,n,r,i=[1,1],s="NHWC"){const o=N(e,"x","dilation2d"),a=N(t,"filter","dilation2d");A(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),A(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),A(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let u=o,l=!1;o.rank===3&&(u=j(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0),A(u.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${a.shape[2]}`);const c={x:u,filter:a},f={strides:n,pad:r,dilations:i},d=L.runKernel(X2,c,f);return l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const LB=z({dilation2d_:l3e});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jp(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const s=n-1-i,o=e[s]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(s)}return r}function gr(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],s=t.length-r-1,o=t[s];(i==null||i===1&&o>1)&&n.unshift(s)}return n}function ut(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let s=e[e.length-i-1];s==null&&(s=1);let o=t[t.length-i-1];if(o==null&&(o=1),s===1)r[n-i-1]=o;else if(o===1)r[n-i-1]=s;else if(s!==o){const a=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(a)}else r[n-i-1]=s}return r}const c3e=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:ut,getBroadcastDims:jp,getReductionAxes:gr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3e(e,t){let n=N(e,"a","equal","string_or_numeric"),r=N(t,"b","equal","string_or_numeric");[n,r]=zn(n,r),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(K2,i)}const eo=z({equal_:f3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3e(e,t,n){const r=N(t,"a","where"),i=N(n,"b","where"),s=N(e,"condition","where","bool"),o=ut(ut(s.shape,r.shape),i.shape),a=Sp(s,o),u=Sp(r,o),l=Sp(i,o),c={condition:a,t:u,e:l};return L.runKernel($S,c)}const Ir=z({where_:d3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3e(e){const n={x:N(e,"x","zerosLike")};return L.runKernel(FS,n)}const Nt=z({zerosLike_:h3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3e(e,t){let n=N(e,"a","div"),r=N(t,"b","div");[n,r]=zn(n,r);const i=Ue(n,r),s=Nt(i),o=eo(r,s);return Ir(o,s,i)}const zB=z({divNoNan_:p3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m3e(e,t){const n=N(e,"t1","dot"),r=N(t,"t2","dot");A((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const i=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(A(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),n.rank===1&&r.rank===1){const o=j(n,[1,-1]),a=j(r,[-1,1]),u=vt(o,a);return j(u,[])}else if(n.rank===1&&r.rank===2){const o=j(n,[1,-1]),a=j(r,[r.shape[0],r.shape[1]]),u=vt(o,a);return j(u,[u.size])}else if(n.rank===2&&r.rank===1){const o=j(r,[-1,1]),a=vt(n,o);return j(a,[a.size])}else{const o=j(r,[r.shape[0],r.shape[1]]);return vt(n,o)}}const BB=z({dot_:m3e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3e(e,...t){const n=t.map((i,s)=>N(i,`tensors${s}`,"einsum")),r={equation:e};return L.runKernel(YN,n,r)}const ep=z({einsum_:g3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3e(e){const n={x:N(e,"x","elu","float32")};return L.runKernel(Y1,n)}const Fy=z({elu_:y3e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3e(e,t){const n=N(e,"x","ensureShape","string_or_numeric");if(!Uoe(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}const Pae=z({ensureShape_:b3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3e(e){let t=N(e,"x","erf");A(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Ce(t,"float32"));const n={x:t};return L.runKernel(Z1,n)}const GI=z({erf_:v3e});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Lae(e,t,n){const r=e.length+t.length,i=[];let s=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?i.push(e[s++]):i.push(t[o++]);return i}function Lr(e,t){const n=[],r=e.length;for(let s=0;s<r;s++)t.indexOf(s)===-1&&n.push(e[s]);const i=t.map(s=>e[s]);return[n,i]}function rr(e,t){const n=t.map(r=>1);return Lae(e,n,t)}function ii(e,t,n){A(UB(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function Bn(e,t){if(UB(e,t))return null;const n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function Zd(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function ir(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x3e(e,t=null,n=!1){const i={x:N(e,"x","max")},s={reductionIndices:t,keepDims:n};return L.runKernel(aS,i,s)}const Lo=z({max_:x3e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w3e(e,t=null,n=!1){const i={x:N(e,"x","min")},s={axis:t,keepDims:n};return L.runKernel(fS,i,s)}const U0=z({min_:w3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3e(e,t){let n=N(e,"base","pow"),r=N(t,"exp","pow");[n,r]=zn(n,r);const i={a:n,b:r};return L.runKernel(hy,i)}const Il=z({pow_:S3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(e,t){if((yr(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&yr(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Kd(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3e(e){const n={x:N(e,"x","sqrt","float32")};return L.runKernel($y,n)}const Or=z({sqrt_:C3e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3e(e){const t=N(e,"x","square"),n={};return L.runKernel("Square",{x:t},n)}const rn=z({square_:k3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3e(e,t=null,n=!1){let r=N(e,"x","sum");r.dtype==="bool"&&(r=Ce(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return L.runKernel(ES,i,s)}const Le=z({sum_:$3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3e(e,t="euclidean",n=null,r=!1){e=N(e,"x","norm");const i=zae(e,t,n);let s=i.shape;if(r){const o=wt(n,e.shape);s=rr(i.shape,o)}return j(i,s)}function zae(e,t,n=null){if(e.rank===0)return ar(e);if(e.rank!==1&&n===null)return zae(j(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Le(ar(e),n);if(t===1/0)return Lo(ar(e),n);if(t===-1/0)return U0(ar(e),n);if(t==="euclidean"||t===2)return Or(Le(Il(ar(e),Ze(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Lo(Le(ar(e),n[0]),n[1]-1);if(t===1/0)return Lo(Le(ar(e),n[1]),n[0]);if(t===-1/0)return U0(Le(ar(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Or(Le(rn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Ry=z({norm_:_3e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E3e(e,t=null,n=!1){return Ry(e,"euclidean",t,n)}const WB=z({euclideanNorm_:E3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3e(e){const n={x:N(e,"x","exp")};return L.runKernel(Q1,n)}const bs=z({exp_:T3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3e(e,t=0){const n=N(e,"x","expandDims","string_or_numeric");A(t<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},i={dim:t};return L.runKernel(Y2,r,i)}const jr=z({expandDims_:A3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3e(e){const n={x:N(e,"x","expm1")};return L.runKernel(J1,n)}const VB=z({expm1_:N3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I3e(e,t){const n=N(e,"x","tile","string_or_numeric");A(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const r={x:n},i={reps:t};return L.runKernel(Ny,r,i)}const _o=z({tile_:I3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3e(e,t,n,r="float32"){t==null&&(t=e);const i=mt([e,t],r),s=e<=t?e:t;for(let a=0;a<s;++a)i.set(1,a,a);const o=j(i.toTensor(),[e,t]);if(n==null)return o;if(n.length===1)return _o(jr(o,0),[n[0],1,1]);if(n.length===2)return _o(jr(jr(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return _o(jr(jr(jr(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const qI=z({eye_:D3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3e(e){const n={x:N(e,"x","floor","float32")};return L.runKernel(ey,n)}const My=z({floor_:O3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3e(e,t,n=0,r=0){const i=N(e,"x","gather"),s=N(t,"indices","gather","int32"),o={x:i,indices:s},a={axis:n,batchDims:r};return L.runKernel(Q2,o,a)}const Py=z({gather_:F3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3e(e,t){let n=N(e,"a","greater","string_or_numeric"),r=N(t,"b","greater","string_or_numeric");[n,r]=zn(n,r),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(J2,i)}const Ki=z({greater_:R3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3e(e,t){let n=N(e,"a","greaterEqual","string_or_numeric"),r=N(t,"b","greaterEqual","string_or_numeric");[n,r]=zn(n,r),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(ny,i)}const lf=z({greaterEqual_:M3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3e(e){const n={input:N(e,"input","imag")};return L.runKernel(rI,n)}const US=z({imag_:P3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L3e(e){const n={x:N(e,"x","isFinite")};return L.runKernel(iy,n)}const jB=z({isFinite_:L3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3e(e){const n={x:N(e,"x","isInf")};return L.runKernel(sy,n)}const HB=z({isInf_:z3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3e(e){const n={x:N(e,"x","isNaN")};return L.runKernel(oy,n)}const GB=z({isNaN_:B3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3e(e,t=.2){const r={x:N(e,"x","leakyRelu")},i={alpha:t};return L.runKernel(eS,r,i)}const WS=z({leakyRelu_:U3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W3e(e,t){let n=N(e,"a","less","string_or_numeric"),r=N(t,"b","less","string_or_numeric");[n,r]=zn(n,r),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(tS,i)}const W0=z({less_:W3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V3e(e,t){let n=N(e,"a","lessEqual","string_or_numeric"),r=N(t,"b","lessEqual","string_or_numeric");[n,r]=zn(n,r),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(nS,i)}const Qd=z({lessEqual_:V3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bae(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return L.runKernel(iI,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3e(e,t=5,n=1,r=1,i=.5){const s=N(e,"x","localResponseNormalization");A(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),A(Lp(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=s,a=!1;s.rank===3&&(a=!0,o=j(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const u={x:o},l={depthRadius:t,bias:n,alpha:r,beta:i},c=L.runKernel(oS,u,l);return a?j(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const qB=z({localResponseNormalization_:j3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H3e(e){const n={x:N(e,"x","log","float32")};return L.runKernel(ay,n)}const to=z({log_:H3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3e(e){const n={x:N(e,"x","log1p")};return L.runKernel(uy,n)}const VS=z({log1p_:G3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3e(e){return A(Cd(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const r=N(t,"x","tf.grad","string_or_numeric"),i=n!=null?N(n,"dy","tf.grad"):null;return L.tidy(()=>{const{value:s,grads:o}=L.gradients(()=>e(r),[r],i);return i!=null&&ni(s.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),XI(o),o[0]})}}function X3e(e){return A(Cd(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{A(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=_w(t,"args","tf.grads","string_or_numeric"),i=n!=null?N(n,"dy","tf.grads"):null;return L.tidy(()=>{const{value:s,grads:o}=L.gradients(()=>e(...r),r,i);return i!=null&&ni(s.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),XI(o),o})}}function K3e(e){return A(Cd(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{A(t instanceof Rt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),A(n==null||n instanceof Rt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:i}=L.gradients(()=>e(t),[t],n);return XI(r),{grad:r[0],value:i}}}function Y3e(e){return A(Cd(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{A(Array.isArray(t)&&t.every(i=>i instanceof Rt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),A(n==null||n instanceof Rt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=L.gradients(()=>e(...t),t,n);return n!=null&&ni(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),XI(r.grads),r}}function Uae(e,t){A(Cd(e),()=>"The f passed in variableGrads(f) must be a function"),A(t==null||Array.isArray(t)&&t.every(l=>l instanceof $w),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const l in L.registeredVariables)t.push(L.registeredVariables[l])}const r=n?t.filter(l=>!l.trainable):null,i=t.length;t=t.filter(l=>l.trainable),A(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const s=!0,{value:o,grads:a}=L.gradients(e,t,null,s);A(a.some(l=>l!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),A(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const u={};return t.forEach((l,c)=>{a[c]!=null&&(u[l.name]=a[c])}),r!=null&&r.forEach(l=>u[l.name]=null),{value:o,grads:u}}function Dl(e){return L.customGrad(e)}function XI(e){if(e.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3e(e){const n={x:N(e,"x","neg")};return L.runKernel(hS,n)}const yn=z({neg_:Z3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q3e(e){const n={x:N(e,"x","softplus")};return L.runKernel(ky,n)}const Mm=z({softplus_:Q3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J3e(e){const t=N(e,"x","logSigmoid");return Dl(r=>({value:yn(Mm(yn(r))),gradFunc:o=>U(o,mu(yn(r)))}))(t)}const XB=z({logSigmoid_:J3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eDe(e,t){let n=N(e,"a","sub"),r=N(t,"b","sub");[n,r]=zn(n,r);const i={a:n,b:r};return L.runKernel(Ey,i)}const Re=z({sub_:eDe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDe(e,t=-1){const n=N(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Dl((i,s)=>{const a=Lo(i,t,!0),u=Re(i,a),l=Re(Ce(u,"float32"),to(Le(bs(u),t,!0)));return s([l]),{value:l,gradFunc:(f,d)=>{const[h]=d,p=!0,m=bs(h);return Re(f,U(Le(f,t,p),m))}}})(n)}const KI=z({logSoftmax_:tDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nDe(e,t=null,n=!1){const r=N(e,"x","logSumExp"),i=wt(t,r.shape),s=Lo(r,i,!0),o=Re(r,s),a=bs(o),u=Le(a,i),l=to(u),c=de(j(s,l.shape),l);if(n){const f=rr(c.shape,i);return j(c,f)}return c}const jS=z({logSumExp_:nDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(e,t){const n=N(e,"a","logicalAnd","bool"),r=N(t,"b","logicalAnd","bool");ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(rS,i)}const Oa=z({logicalAnd_:rDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iDe(e){const n={x:N(e,"x","logicalNot","bool")};return L.runKernel(iS,n)}const HS=z({logicalNot_:iDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sDe(e,t){const n=N(e,"a","logicalOr","bool"),r=N(t,"b","logicalOr","bool");ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(sS,i)}const YI=z({logicalOr_:sDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oDe(e,t){const n=N(e,"a","logicalXor","bool"),r=N(t,"b","logicalXor","bool");return ut(n.shape,r.shape),Oa(YI(e,t),HS(Oa(e,t)))}const KB=z({logicalXor_:oDe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e$=2147483648;function aDe(e,t,n="left"){const r=N(e,"sortedSequence","searchSorted"),i=N(t,"values","searchSorted"),s=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],a=j(r,[-1,s]),u=j(i,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(ee(u.shape)>=e$)throw new Error(`values tensor size must less than ${e$}`);if(a.shape[1]>=e$)throw new Error(`trailing dim_size must less than ${e$} for int32 output type, was ${a.shape[1]}`);const l={sortedSequence:a,values:u},c={side:n};return L.runKernel(SI,l,c)}const ZI=z({searchSorted_:aDe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wae(e,t){return ZI(e,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uDe(e,t,n,r,i){const s=N(e,"x","maxPool"),o=1;let a=s,u=!1;s.rank===3&&(u=!0,a=j(s,[1,s.shape[0],s.shape[1],s.shape[2]])),A(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),A(ri(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Xi("maxPool",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},f=L.runKernel(uS,l,c);return u?j(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const GS=z({maxPool_:uDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lDe(e,t=[1,1,1],n,r,i,s="NDHWC"){const o=N(e,"x","maxPool3d");let a=o,u=!1;o.rank===4&&(u=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),A(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),A(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Xi("maxPool3d",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s},f=L.runKernel(lS,l,c);return u?j(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const YB=z({maxPool3d_:lDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cDe(e,t,n,r,i=!1){const o={x:N(e,"x","maxPoolWithArgmax")},a={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},u=L.runKernel(uI,o,a);return{result:u[0],indexes:u[1]}}const Vae=z({maxPoolWithArgmax_:cDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fDe(e,t){let n=N(e,"a","maximum"),r=N(t,"b","maximum");[n,r]=zn(n,r),n.dtype==="bool"&&(n=Ce(n,"int32"),r=Ce(r,"int32")),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(ly,i)}const Vl=z({maximum_:fDe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dDe(e,t=null,n=!1){const i={x:N(e,"x","mean")},s={axis:t,keepDims:n};return L.runKernel(cS,i,s)}const Pn=z({mean_:dDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(e,t="float32"){if(uo(e),t==="complex64"){const r=lr(e,"float32"),i=lr(e,"float32");return Gc(r,i)}const n=ei(ee(e),t);return L.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ls(e,t="float32"){if(uo(e),t==="complex64"){const r=ls(e,"float32"),i=lr(e,"float32");return Gc(r,i)}const n=IN(ee(e),t);return L.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=N(e,"x","meshgrid",e instanceof Rt?e.dtype:"float32");if(t===void 0)return[r];let i=N(t,"y","meshgrid",t instanceof Rt?t.dtype:"float32");const s=ee(r.shape),o=ee(i.shape);return n==="xy"?(r=j(r,[1,-1]),i=j(i,[-1,1]),[vt(ls([o,1],r.dtype),r),vt(i,ls([1,s],i.dtype))]):(r=j(r,[-1,1]),i=j(i,[1,-1]),[vt(r,ls([1,o],r.dtype)),vt(ls([s,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hDe(e,t){let n=N(e,"a","minimum"),r=N(t,"b","minimum");[n,r]=zn(n,r),n.dtype==="bool"&&(n=Ce(n,"int32"),r=Ce(r,"int32")),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(cy,i)}const Ed=z({minimum_:hDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pDe(e,t,n){A(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=N(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");A(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);const i=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)A(t[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),A(t[a][0]>=0&&t[a][0]<=r.shape[a]-i&&t[a][1]>=0&&t[a][1]<=r.shape[a]-i,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-i} or less than 0 for input of shape ${r.shape}`);const s={paddings:t,mode:n},o={x:r};return L.runKernel(dS,o,s)}const ZB=z({mirrorPad_:pDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mDe(e,t){let n=N(e,"a","mod"),r=N(t,"b","mod");[n,r]=zn(n,r);const i={a:n,b:r};return L.runKernel(fy,i)}const QB=z({mod_:mDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gDe(e,t=null,n=!1){e=N(e,"x","moments");const r=wt(t,e.shape),i=Pn(e,r,n);let s=i.shape;n||(s=rr(i.shape,r));const o=rn(Re(Ce(e,"float32"),j(i,s))),a=Pn(o,r,n);return{mean:i,variance:a}}const qS=z({moments_:gDe});function yDe(e,t,n,r){const i=N(t,"data","multiRNNCell"),s=_w(n,"c","multiRNNCell"),o=_w(r,"h","multiRNNCell");let a=i;const u=[];for(let f=0;f<e.length;f++){const d=e[f](a,s[f],o[f]);u.push(d[0]),u.push(d[1]),a=d[1]}const l=[],c=[];for(let f=0;f<u.length;f+=2)l.push(u[f]),c.push(u[f+1]);return[l,c]}const Hae=z({multiRNNCell_:yDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bDe(e,t,n,r=!1){const i=N(e,"logits","multinomial"),s=i.size,o=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const u={logits:o===1?j(i,[1,-1]):i},l={numSamples:t,seed:n,normalized:r},c=L.runKernel(lI,u,l);return o===1?j(c,[c.size]):c}const Gae=z({multinomial_:bDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vDe(e,t){let n=N(e,"a","notEqual","string_or_numeric"),r=N(t,"b","notEqual","string_or_numeric");[n,r]=zn(n,r),ut(n.shape,r.shape);const i={a:n,b:r};return L.runKernel(pS,i)}const Hp=z({notEqual_:vDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xDe(e,t,n=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:N(e,"indices","oneHot","int32")},a={dtype:i,depth:t,onValue:n,offValue:r};return L.runKernel(gS,o,a)}const V0=z({oneHot_:xDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(e){const n={x:N(e,"x","onesLike")};return L.runKernel(mS,n)}const no=z({onesLike_:wDe});function SDe(e,t){const n=N(e,"v1","outerProduct"),r=N(t,"v2","outerProduct");A(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const i=j(n,[-1,1]),s=j(r,[1,-1]);return vt(i,s)}const qae=z({outerProduct_:SDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDe(e,t,n=0){const r=N(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},s={x:r};return L.runKernel(bS,s,i)}const cf=z({pad_:CDe});function kDe(e,t,n=0){return A(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),cf(e,[t],n)}const Xae=z({pad1d_:kDe});function $De(e,t,n=0){return A(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),cf(e,t,n)}const Kae=z({pad2d_:$De});function _De(e,t,n=0){return A(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),cf(e,t,n)}const Yae=z({pad3d_:_De});function EDe(e,t,n=0){return A(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),cf(e,t,n)}const Zae=z({pad4d_:EDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TDe(e,t,n){const r=N(e,"x","spaceToBatchND");A(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),A(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),A(r.shape.reduce((o,a,u)=>u>0&&u<=t.length?o&&(a+n[u-1][0]+n[u-1][1])%t[u-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const i={x:r},s={blockShape:t,paddings:n};return L.runKernel(TS,i,s)}const XS=z({spaceToBatchND_:TDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ADe(e,t,n,r,i,s,o){i==null&&(i=[1,1]),s==null&&(s=1),r===0&&(r="valid");const a=N(e,"x","maxPool");let u=a,l=!1;a.rank===3&&(l=!0,u=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(ri(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const c=za(u.shape,t,s,i,r),f=[c.dilationHeight,c.dilationWidth];let d;r==="same"?d=IDe([c.filterHeight,c.filterWidth],f):d=[[0,0],[0,0]];const h=f[0]===1&&f[1]===1,[p,m]=NDe([c.inHeight,c.inWidth],f,d),g=h?r:"valid",y=h?u:XS(u,f,p),v=(n==="avg"?()=>LS(y,t,s,g,o):()=>GS(y,t,s,g,o))(),x=h?v:zS(v,f,m);return l?j(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function NDe(e,t,n){const r=n.map(c=>c[0]),i=n.map(c=>c[1]),s=e.concat(r,i),o=t.map((c,f)=>(c-s[f]%c)%c),a=i.map((c,f)=>c+o[f]),u=t.map((c,f)=>[r[f],a[f]]),l=t.map((c,f)=>[0,o[f]]);return[u,l]}function IDe(e,t){const r=e.map((o,a)=>o+(o-1)*(t[a]-1)).map(o=>o-1),i=r.map(o=>Math.floor(o/2)),s=r.map((o,a)=>o-i[a]);return r.map((o,a)=>[i[a],s[a]])}const JB=z({pool_:ADe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDe(e,t){const n=N(e,"x","prelu"),r=N(t,"alpha","prelu"),i={x:n,alpha:r};return L.runKernel(vS,i)}const KS=z({prelu_:DDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ODe(e,t=null,n=!1){let r=N(e,"x","prod");r.dtype==="bool"&&(r=Ce(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return L.runKernel(xS,i,s)}const e8=z({prod_:ODe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FDe(e,t,n,r){const i=e.map((c,f)=>N(c,`tensors${f}`,"raggedGather","int32")),s=N(t,"paramsDenseValues","raggedGather"),o=N(n,"indices","raggedGather","int32"),a={paramsNestedSplits:i,paramsDenseValues:s,indices:o},u={outputRaggedRank:r},l=L.runKernel(hI,a,u);return{outputNestedSplits:l.slice(0,l.length-1),outputDenseValues:l[l.length-1]}}const Qae=z({raggedGather_:FDe});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RDe(e,t,n){const r=N(e,"starts","raggedRange"),i=N(t,"limits","raggedRange",r.dtype),s=N(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:i,deltas:s},a=L.runKernel(pI,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const Jae=z({raggedRange_:RDe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MDe(e,t,n,r,i){const s=N(e,"shape","raggedTensorToTensor","int32"),o=N(t,"values","raggedTensorToTensor"),a=N(n,"defaultValue","raggedTensorToTensor",o.dtype),u=r.map((f,d)=>N(f,`tensors${d}`,"raggedTensorToTensor","int32")),l={shape:s,values:o,defaultValue:a,rowPartitionTensors:u},c={rowPartitionTypes:i};return L.runKernel(mI,l,c)}const eue=z({raggedTensorToTensor_:MDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PDe(e,t,n){uo(e);const r=ee(e);let i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else if(n==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let s=0;s<r;s++)i[s]=t();return L.makeTensor(i,e,n)}const tue=z({rand_:PDe});var t8={exports:{}};t8.exports;(function(e){(function(t,n,r){function i(u){var l=this,c=a();l.next=function(){var f=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=f|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(u),l.s0<0&&(l.s0+=1),l.s1-=c(u),l.s1<0&&(l.s1+=1),l.s2-=c(u),l.s2<0&&(l.s2+=1),c=null}function s(u,l){return l.c=u.c,l.s0=u.s0,l.s1=u.s1,l.s2=u.s2,l}function o(u,l){var c=new i(u),f=l&&l.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,f&&(typeof f=="object"&&s(f,c),d.state=function(){return s(c,{})}),d}function a(){var u=4022871197,l=function(c){c=String(c);for(var f=0;f<c.length;f++){u+=c.charCodeAt(f);var d=.02519603282416938*u;u=d>>>0,d-=u,d*=u,u=d>>>0,d-=u,u+=d*4294967296}return(u>>>0)*23283064365386963e-26};return l}n&&n.exports?n.exports=o:this.alea=o})(rt,e)})(t8);var LDe=t8.exports,n8={exports:{}};n8.exports;(function(e){(function(t,n,r){function i(a){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},a===(a|0)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,u.next()}function s(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function o(a,u){var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&s(c,l),f.state=function(){return s(l,{})}),f}n&&n.exports?n.exports=o:this.xor128=o})(rt,e)})(n8);var zDe=n8.exports,r8={exports:{}};r8.exports;(function(e){(function(t,n,r){function i(a){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(f^f<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(a|0)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function s(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function o(a,u){var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&s(c,l),f.state=function(){return s(l,{})}),f}n&&n.exports?n.exports=o:this.xorwow=o})(rt,e)})(r8);var BDe=r8.exports,i8={exports:{}};i8.exports;(function(e){(function(t,n,r){function i(a){var u=this;u.next=function(){var c=u.x,f=u.i,d,h;return d=c[f],d^=d>>>7,h=d^d<<24,d=c[f+1&7],h^=d^d>>>10,d=c[f+3&7],h^=d^d>>>3,d=c[f+4&7],h^=d^d<<7,d=c[f+7&7],d=d^d<<13,h^=d^d<<9,c[f]=h,u.i=f+1&7,h};function l(c,f){var d,h=[];if(f===(f|0))h[0]=f;else for(f=""+f,d=0;d<f.length;++d)h[d&7]=h[d&7]<<15^f.charCodeAt(d)+h[d+1&7]<<13;for(;h.length<8;)h.push(0);for(d=0;d<8&&h[d]===0;++d);for(d==8?h[7]=-1:h[d],c.x=h,c.i=0,d=256;d>0;--d)c.next()}l(u,a)}function s(a,u){return u.x=a.x.slice(),u.i=a.i,u}function o(a,u){a==null&&(a=+new Date);var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(c.x&&s(c,l),f.state=function(){return s(l,{})}),f}n&&n.exports?n.exports=o:this.xorshift7=o})(rt,e)})(i8);var UDe=i8.exports,s8={exports:{}};s8.exports;(function(e){(function(t,n,r){function i(a){var u=this;u.next=function(){var c=u.w,f=u.X,d=u.i,h,p;return u.w=c=c+1640531527|0,p=f[d+34&127],h=f[d=d+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=f[d]=p^h,u.i=d,p+(c^c>>>16)|0};function l(c,f){var d,h,p,m,g,y=[],b=128;for(f===(f|0)?(h=f,f=null):(f=f+"\0",h=0,b=Math.max(b,f.length)),p=0,m=-32;m<b;++m)f&&(h^=f.charCodeAt((m+32)%f.length)),m===0&&(g=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,m>=0&&(g=g+1640531527|0,d=y[m&127]^=h+g,p=d==0?p+1:0);for(p>=128&&(y[(f&&f.length||0)&127]=-1),p=127,m=4*128;m>0;--m)h=y[p+34&127],d=y[p=p+1&127],h^=h<<13,d^=d<<17,h^=h>>>15,d^=d>>>12,y[p]=h^d;c.w=g,c.X=y,c.i=p}l(u,a)}function s(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function o(a,u){a==null&&(a=+new Date);var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(c.X&&s(c,l),f.state=function(){return s(l,{})}),f}n&&n.exports?n.exports=o:this.xor4096=o})(rt,e)})(s8);var WDe=s8.exports,o8={exports:{}};o8.exports;(function(e){(function(t,n,r){function i(a){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=a|0):l+=a;for(var c=0;c<l.length+20;c++)u.b^=l.charCodeAt(c)|0,u.next()}function s(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function o(a,u){var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&s(c,l),f.state=function(){return s(l,{})}),f}n&&n.exports?n.exports=o:this.tychei=o})(rt,e)})(o8);var VDe=o8.exports,nue={exports:{}};const jDe={},HDe=Object.freeze(Object.defineProperty({__proto__:null,default:jDe},Symbol.toStringTag,{value:"Module"})),GDe=Em(HDe);(function(e){(function(t,n,r){var i=256,s=6,o=52,a="random",u=r.pow(i,s),l=r.pow(2,o),c=l*2,f=i-1,d;function h(x,w,S){var C=[];w=w==!0?{entropy:!0}:w||{};var k=y(g(w.entropy?[x,v(n)]:x??b(),3),C),E=new p(C),_=function(){for(var T=E.g(s),D=u,O=0;T<l;)T=(T+O)*i,D*=i,O=E.g(1);for(;T>=c;)T/=2,D/=2,O>>>=1;return(T+O)/D};return _.int32=function(){return E.g(4)|0},_.quick=function(){return E.g(4)/4294967296},_.double=_,y(v(E.S),n),(w.pass||S||function(T,D,O,M){return M&&(M.S&&m(M,E),T.state=function(){return m(E,{})}),O?(r[a]=T,D):T})(_,k,"global"in w?w.global:this==r,w.state)}function p(x){var w,S=x.length,C=this,k=0,E=C.i=C.j=0,_=C.S=[];for(S||(x=[S++]);k<i;)_[k]=k++;for(k=0;k<i;k++)_[k]=_[E=f&E+x[k%S]+(w=_[k])],_[E]=w;(C.g=function(T){for(var D,O=0,M=C.i,I=C.j,P=C.S;T--;)D=P[M=f&M+1],O=O*i+P[f&(P[M]=P[I=f&I+D])+(P[I]=D)];return C.i=M,C.j=I,O})(i)}function m(x,w){return w.i=x.i,w.j=x.j,w.S=x.S.slice(),w}function g(x,w){var S=[],C=typeof x,k;if(w&&C=="object")for(k in x)try{S.push(g(x[k],w-1))}catch{}return S.length?S:C=="string"?x:x+"\0"}function y(x,w){for(var S=x+"",C,k=0;k<S.length;)w[f&k]=f&(C^=w[f&k]*19)+S.charCodeAt(k++);return v(w)}function b(){try{var x;return d&&(x=d.randomBytes)?x=x(i):(x=new Uint8Array(i),(t.crypto||t.msCrypto).getRandomValues(x)),v(x)}catch{var w=t.navigator,S=w&&w.plugins;return[+new Date,t,S,t.screen,v(n)]}}function v(x){return String.fromCharCode.apply(0,x)}if(y(r.random(),n),e.exports){e.exports=h;try{d=GDe}catch{}}else r["seed"+a]=h})(typeof self<"u"?self:rt,[],Math)})(nue);var qDe=nue.exports,XDe=LDe,KDe=zDe,YDe=BDe,ZDe=UDe,QDe=WDe,JDe=VDe,Pm=qDe;Pm.alea=XDe;Pm.xor128=KDe;Pm.xorwow=YDe;Pm.xorshift7=ZDe;Pm.xor4096=QDe;Pm.tychei=JDe;var Ly=Pm;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eOe=.001,rue=.1;function tOe(e,t,n){return n==null&&(n=a8()),_5(e,t,(r,i)=>u8(r,i,n))}function a8(){return L.backend.floatPrecision()===32?eOe:rue}function _5(e,t,n){let r=!0;if((yr(e)||yr(t))&&(r=!1),yr(e)&&yr(t)&&(r=!0),r){const o=e.constructor.name,a=t.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(e)&&Array.isArray(t)){const o=Nl(e),a=Nl(t);if(!$t(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const i=yr(e)?e:Al(e),s=yr(t)?t:Al(t);if(i.length!==s.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${s.length}.
Actual:   ${i}.
Expected: ${s}.`);for(let o=0;o<s.length;++o){const a=i[o],u=s[o];if(!n(a,u))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${u}.
Actual:   ${i}.
Expected: ${s}.`)}typeof expect<"u"&&expect().nothing()}function nOe(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function rOe(e,t){const n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return cl(e)||cl(e[0])||cl(t)||cl(t[0])?_5(e,n,(r,i)=>r==i):_5(e,t,(r,i)=>u8(r,i,0))}function iOe(e,t,n){if(n==null&&(n=a8()),!u8(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function u8(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function sOe(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function oOe(e,t){const n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${n[i]} instead`)}function iue(e){for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(n)?iue(n):e[t]=ml(n)}return e}function aOe(e){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function uOe(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}const lOe=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:rue,createVideoElement:aOe,encodeStrings:iue,expectArrayBuffersEqual:oOe,expectArraysClose:tOe,expectArraysEqual:rOe,expectNumbersClose:iOe,expectPromiseToFail:nOe,expectValuesInRange:sOe,play:uOe,testEpsilon:a8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l8{constructor(t,n,r,i,s){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=s||Math.random();this.random=Ly.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,n,r=!1;for(;!r;){let i,s,o;do i=2*this.random()-1,s=2*this.random()-1,o=i*i+s*s;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*i*a,n=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class cOe{constructor(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;const s=i||Math.random();this.randu=Ly.alea(s.toString()),this.randn=new l8(0,1,r,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,r,i,s,o;for(;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,t=i*i,n=1-.331*t*t,r=.5*t+this.d*(1-o+Math.log(o)),s=this.randu(),s<n||Math.log(s)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class fOe{constructor(t=0,n=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=Ly.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dOe(e,t,n=1,r="float32",i){if(uo(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const s=new cOe(t,n,r,i),o=mt(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const sue=z({randomGamma_:dOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hOe(e,t=0,n=1,r,i){if(uo(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new l8(t,n,r,!1,i),o=mt(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const QI=z({randomNormal_:hOe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pOe(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return QI(e,0,1,t,n)}const oue=z({randomStandardNormal_:pOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mOe(e,t=0,n=1,r="float32",i){uo(e);const s=mt(e,r),o=new fOe(t,n,null,i);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}const Jd=z({randomUniform_:mOe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gOe(e,t,n,r){return Jd(e,t,n,"int32",r)}const aue=z({randomUniformInt_:gOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gp(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return L.runKernel(gI,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yOe(e){const n={input:N(e,"input","real")};return L.runKernel(yI,n)}const j0=z({real_:yOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bOe(e){const n={x:N(e,"x","reciprocal")};return L.runKernel(py,n)}const c8=z({reciprocal_:bOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vOe(e){const n={x:N(e,"x","relu")};return L.runKernel(my,n)}const Fu=z({relu_:vOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xOe(e){const n={x:N(e,"x","relu6")};return L.runKernel(gy,n)}const JI=z({relu6_:xOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wOe(e,t){const r={x:N(e,"x","reverse")},i={dims:t};return L.runKernel(kS,r,i)}const Uo=z({reverse_:wOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SOe(e){const t=N(e,"x","reverse");return A(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Uo(t,0)}const uue=z({reverse1d_:SOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function COe(e,t){const n=N(e,"x","reverse");return A(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Uo(n,t)}const lue=z({reverse2d_:COe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kOe(e,t){const n=N(e,"x","reverse");return A(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Uo(n,t)}const cue=z({reverse3d_:kOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Oe(e,t){const n=N(e,"x","reverse");return A(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Uo(n,t)}const fue=z({reverse4d_:$Oe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Oe(e){const n={x:N(e,"x","round")};return L.runKernel(yy,n)}const e3=z({round_:_Oe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EOe(e){const n={x:N(e,"x","rsqrt","float32")};return L.runKernel(by,n)}const t3=z({rsqrt_:EOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TOe(e){const n={x:N(e,"x","selu")};return L.runKernel(vy,n)}const n3=z({selu_:TOe});function AOe(e,t,n,r,i,s=[1,1],o="NHWC"){const a=N(e,"x","separableConv2d"),u=N(t,"depthwiseFilter","separableConv2d"),l=N(n,"pointwiseFilter","separableConv2d");let c=a,f=!1;if(a.rank===3&&(f=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),A(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),A(l.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),A(l.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),A(l.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);const d=u.shape[2],h=u.shape[3];A(l.shape[2]===d*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*h}, but got ${l.shape[2]}.`);const p=Oy(c,u,r,i,o,s),g=qc(p,l,1,"valid",o);return f?j(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const r3=z({separableConv2d_:AOe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function NOe(e,t){const n=N(e,"x","setdiff1d"),r=N(t,"y","setdiff1d");A(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),A(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),A(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await n.data(),s=await r.data(),o=new Set(s);let a=0;for(let c=0;c<i.length;c++)o.has(i[c])||a++;const u=new hr([a],n.dtype),l=new hr([a],"int32");for(let c=0,f=0;c<i.length;c++)o.has(i[c])||(u.values[f]=i[c],l.values[f]=c,f++);return[u.toTensor(),l.toTensor()]}const due=NOe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IOe(e){const n={x:N(e,"x","sign")};return L.runKernel(Sy,n)}const f8=z({sign_:IOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DOe(e){const n={x:N(e,"x","sin","float32")};return L.runKernel(xy,n)}const i3=z({sin_:DOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OOe(e){const n={x:N(e,"x","sinh")};return L.runKernel(wy,n)}const s3=z({sinh_:OOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FOe(e,t,n){const r=N(e,"x","slice1d");return A(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),At(r,[t],[n])}const YS=z({slice1d_:FOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ROe(e,t,n){const r=N(e,"x","slice2d");return A(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),At(r,t,n)}const o3=z({slice2d_:ROe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MOe(e,t,n){const r=N(e,"x","slice3d");return A(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),At(r,t,n)}const ZS=z({slice3d_:MOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POe(e,t,n){const r=N(e,"x","slice4d");return A(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),At(r,t,n)}const H0=z({slice4d_:POe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LOe(e,t=-1){const n=N(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},i={dim:t};return L.runKernel(NS,r,i)}const QS=z({softmax_:LOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zOe(e){A(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return L.runKernel(QN,t)}const JS=z({fft_:zOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BOe(e){A(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return L.runKernel(nI,t)}const G0=z({ifft_:BOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UOe(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const i=j(e,[n,t]);r=G0(i)}else{const i=[n,2*(t-1)],s=j(j0(e),[n,t]),o=j(US(e),[n,t]),a=Uo(At(s,[0,1],[n,t-2]),1),u=U(Uo(At(o,[0,1],[n,t-2]),1),Ze(-1)),l=tr([s,a],1),c=tr([o,u],1),f=j(Gc(l,c),[i[0],i[1]]);r=G0(f)}if(r=j0(r),e.rank===3&&e.shape[0]!==0){const i=r,s=e.shape[0];r=j(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}const a3=z({irfft_:UOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WOe(e,t,n=0){const i={x:N(e,"x","split")},s={numOrSizeSplits:t,axis:n};return L.runKernel(AS,i,s)}const ps=z({split_:WOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VOe(e,t){A(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const r=e.size/n;let i;if(t!=null&&t<n){const p=e.shape.map(g=>0),m=e.shape.map(g=>g);m[e.shape.length-1]=t,i=At(e,p,m),n=t}else if(t!=null&&t>n){const p=e.shape.map(m=>m);p[e.shape.length-1]=t-n,i=tr([e,lr(p)],e.shape.length-1),n=t}else i=e;const s=Nt(i),o=j(Gc(i,s),[r,n]),a=JS(o),u=Math.floor(n/2)+1,l=j0(a),c=US(a),f=ps(l,[u,n-u],l.shape.length-1),d=ps(c,[u,n-u],c.shape.length-1),h=i.shape.slice();return h[i.shape.length-1]=u,j(Gc(f[0],d[0]),h)}const eC=z({rfft_:VOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jOe(e,t){let n=N(e,"a","squaredDifference"),r=N(t,"b","squaredDifference");[n,r]=zn(n,r),ut(n.shape,r.shape);const i={a:n,b:r},s={};return L.runKernel(_y,i,s)}const u3=z({squaredDifference_:jOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HOe(e,t){const n=N(e,"x","squeeze","string_or_numeric");return j(n,sf(n.shape,t).newShape)}const eh=z({squeeze_:HOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GOe(e,t=0){const n=_w(e,"tensors","stack","string_or_numeric");A(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&A(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,i={axis:t};return L.runKernel(yS,r,i)}const Hi=z({stack_:GOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qOe(e,t=0){const r={x:N(e,"x","step")},i={alpha:t};return L.runKernel(Iy,r,i)}const Lm=z({step_:qOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOe(e,t,n,r,i=0,s=0,o=0,a=0,u=0){const c={x:N(e,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:r,beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u};return L.runKernel(AI,c,f)}const d8=z({stridedSlice_:XOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KOe(e){const n={x:N(e,"x","tan","float32")};return L.runKernel(Ty,n)}const h8=z({tan_:KOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qr(e,t){Nm(e);const n=Nl(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Kd(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yl(e,t,n){if(Nm(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Nl(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Kd(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(e,t,n){if(Nm(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Nl(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Kd(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(e,t,n){if(Nm(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Nl(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Kd(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(e,t,n){if(Nm(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Nl(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Kd(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mue(e,t,n){if(Nm(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Nl(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Kd(e,t,r,n)}function m8(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(s+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(s+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(s+` update.rank != ${i+e.length-r}`);for(let o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(s+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(s+` updates.shape[${o+i}] (${n.shape[o+i]}) != shape[${o+i}] (${e[o+i]})`)}function l3(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}m8(n,t,e)}function th(e,t,n){const r=t.shape.length,i=r>1?t.shape[r-1]:1,s=n.length;let o=1;for(let f=i;f<s;++f)o*=n[f];const a=i<1?1:i,u=ee(t.shape)/a,l=[...Ye(n.slice(0,i)),1],c=ee(n);return{sliceRank:i,numUpdates:u,sliceSize:o,strides:l,outputSize:c}}const YOe=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:th,validateInput:l3,validateUpdateShape:m8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZOe(e,t,n){const r=N(e,"tensor","tensorScatterupdate"),i=N(t,"indices","tensorScatterupdate","int32"),s=N(n,"updates","tensorScatterupdate");if(l3(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);const o={tensor:r,indices:i,updates:s},a={};return L.runKernel(wI,o,a)}const gue=z({tensorScatterUpdate_:ZOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QOe(e,t=1,n=!0){const r=N(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const s={x:r},o={k:t,sorted:n},[a,u]=L.runKernel(OI,s,o);return{values:a,indices:u}}const g8=z({topk_:QOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JOe(e,t=0,n=1,r,i){if(uo(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new l8(t,n,r,!0,i),o=mt(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const c3=z({truncatedNormal_:JOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eFe(e,t=0){const n=N(e,"x","unique","string_or_numeric");A(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},i={axis:t},[s,o]=L.runKernel(RI,r,i);return{values:s,indices:o}}const y8=z({unique_:eFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tFe(e,t,n){const r=N(e,"x","unsortedSegmentSum"),i=N(t,"segmentIds","unsortedSegmentSum","int32");A(Lp(n),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:i},o={numSegments:n};return L.runKernel(OS,s,o)}const f3=z({unsortedSegmentSum_:tFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nFe(e,t=0){const n=N(e,"x","unstack","string_or_numeric");A(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},i={axis:t};return L.runKernel(DS,r,i)}const Wo=z({unstack_:nFe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(e,t){return ZI(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(e,t=!0,n,r){return L.makeVariable(e,t,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3(e,t){const n=[];for(let s=0;s<t.length;s++)t[s]&&n.push(s);const r=mt(e,"int32"),i=mt([n.length,e.length],"int32");for(let s=0;s<n.length;s++){const o=r.indexToLoc(n[s]),a=s*e.length;i.values.set(o,a)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function rFe(e){const t=N(e,"condition","whereAsync","bool"),n=await t.data(),r=d3(t.shape,n);return e!==t&&t.dispose(),r}const v8=rFe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function iFe(e,t,n){const r=N(e,"tensor","boolMask"),i=N(t,"mask","boolMask","bool"),s=n??0,o=i.rank,a=r.shape;A(o>0,()=>"mask cannot be scalar"),ni(a.slice(s,s+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let m=s;m<s+o;m++)u*=a[m];const l=a.slice(0,s).concat([u],a.slice(s+o)),c=j(r,l),f=j(i,[-1]),d=await v8(f),h=eh(d,[1]),p=Py(c,h,s);return e!==r&&r.dispose(),t!==i&&i.dispose(),h.dispose(),c.dispose(),f.dispose(),d.dispose(),p}const bue=iFe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFe(e,t,n){const r=N(e,"x","transpose");if(t==null&&(t=r.shape.map((o,a)=>a).reverse()),A(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(o=>{A(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:t};return r.dtype==="complex64"?K(()=>{let o=j0(r),a=US(r);return o=L.runKernel(wp,{x:o},s),a=L.runKernel(wp,{x:a},s),n&&(a=yn(a)),Gc(o,a)}):L.runKernel(wp,i,s)}const Tt=z({transpose_:sFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oFe(e,t,n,r,i=!0){const s=N(e,"v","movingAverage"),o=N(t,"x","movingAverage"),a=N(n,"decay","movingAverage");hae(s,o),A($t(s.shape,o.shape),()=>"Shape mismatch in v and x");const u=Ze(1),l=Re(u,a);let c=U(Re(o,s),l);if(i){A(r!=null,()=>"When using zeroDebias: true, step is required.");const f=N(r,"step","movingAverage");c=Ue(c,Re(u,Il(a,f)))}return de(s,c)}const vue=z({movingAverage_:oFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aFe(e,t,n){uo(n);const r=N(e,"indices","scatterND","int32"),i=N(t,"updates","scatterND");l3(i,r,n);const s={indices:r,updates:i},o={shape:n};return L.runKernel(xI,s,o)}const xue=z({scatterND_:aFe});function uFe(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const i=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);const o=t.size;if(!(t.rank===0||t.rank===1&&o===i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lFe(e,t,n,r=0){uo(n);const i=N(e,"sparseIndices","sparseToDense","int32"),s=N(t,"sparseValues","sparseToDense","string_or_numeric"),o=N(r,"defaultValue","sparseToDense",s.dtype);uFe(i,s,n,o);const a={sparseIndices:i,sparseValues:s,defaultValue:o},u={outputShape:n};return L.runKernel(EI,a,u)}const wue=z({sparseToDense_:lFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cFe(e,t){const n=N(t,"indices","gatherND","int32"),i={params:N(e,"x","gatherND","string_or_numeric"),indices:n};return L.runKernel(tI,i)}const Sue=z({gatherND_:cFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fFe(e,t){if(t==null)return e.shape.slice();if($t(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dFe(e,t,n,r){const i=N(e,"x","dropout");if(A(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),A(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Rt?i.clone():i;const s=fFe(i,n),o=1-t,a=Ue(My(de(Jd(s,0,1,"float32",r),o)),o);return U(i,a)}const x8=z({dropout_:dFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function h3(e,t,n){const r=1-e%2,i=new Float32Array(e);for(let s=0;s<e;++s){const o=2*Math.PI*s/(e+r-1);i[s]=t-n*Math.cos(o)}return qr(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hFe(e,t,n=1){const r=N(e,"predictions","inTopK"),i=N(t,"targets","inTopK");A(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),A(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),ni(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];A(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);const o=await r.data(),a=await i.data(),[u,l]=[o.length/s,s],c=Dr("bool",u);for(let f=0;f<u;f++){const d=f*l,h=o.subarray(d,d+l),p=[];for(let m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort((m,g)=>g.value-m.value),c[f]=0;for(let m=0;m<n;m++)if(p[m].index===a[f]){c[f]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),hs(c,i.shape,"bool")}const Cue=hFe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pFe(e,t,n,r,i,s="NHWC",o){let a=e;e.rank===3&&(a=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=j(t,[1,t.shape[0],t.shape[1],t.shape[2]])),A(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),A(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),A(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const l=s==="NHWC"?a.shape[3]:a.shape[1],c=s==="NHWC"?u.shape[3]:u.shape[1];A(l===n[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${n[2]}.`),A(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Xi("conv2dDerFilter",i,o);const f={x:a,dy:u},d={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,filterShape:n};return L.runKernel(zN,f,d)}const S8=z({conv2DBackpropFilter_:pFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return U(e,Lm(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function m3(e,t){let n=t;const r=gr(e.shape,t.shape);return r.length>0&&(n=Le(n,r)),j(n,e.shape)}function g3(e,t,n,r){if(t==="linear")return e;if(t==="relu")return Fu(e);if(t==="elu")return Fy(e);if(t==="relu6")return JI(e);if(t==="prelu")return KS(e,n);if(t==="leakyrelu")return WS(e,r);if(t==="sigmoid")return mu(e);throw new Error(`Unknown fused activation ${t}.`)}const y3=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mFe({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:c}){if(u=u||"linear",y3(L.state.gradientDepth,u)===!1){A(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=qc(e,t,n,r,i,s,o);return a!=null&&(S=de(S,a)),g3(S,u,l,c)}const f=N(e,"x","conv2d","float32"),d=N(t,"filter","conv2d","float32");let h=f,p=!1;f.rank===3&&(p=!0,h=j(f,[1,f.shape[0],f.shape[1],f.shape[2]])),A(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),A(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),Xi("fused conv2d",r,o);const m=i==="NHWC"?h.shape[3]:h.shape[1];A(d.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${d.shape[2]}.`),A(ri(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const g=Pr(h.shape,d.shape,n,s,r,o);let y;a!=null&&(y=N(a,"bias","fused conv2d"),[y]=zn(y,f),i==="NHWC"?ut(g.outShape,y.shape):(A(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),A(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let b;if(l!=null){const S=l.shape;if(A(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)A(S[0]===1||S[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${g.outChannels}).`);else if(S.length===3)try{ut(S,g.outShape)}catch{const k=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(k)}b=N(l,"prelu weights","fused conv2d")}const v=(S,C)=>{A(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[k,E,_,T]=C,D=p3(S,_,u);A($d(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const O=FB(E.shape,D,k,n,r),M=S8(E,D,k.shape,n,r),I=[O,M];if(T!=null){const P=m3(T,D);I.push(P)}return I},x={x:h,filter:d,bias:y,preluActivationWeights:b},w={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:c};return a==null?Dl((C,k,E)=>{let _=L.runKernel(ww,x,w);return E([k,C,_]),p&&(_=j(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:v}})(h,d):Dl((C,k,E,_)=>{let T=L.runKernel(ww,x,w);return _([k,C,T,E]),p&&(T=j(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:v}})(h,d,y)}const kue=z({fusedConv2d_:mFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gFe(e,t,n,r,i,s=[1,1],o){let a=e;e.rank===3&&(a=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={x:a,dy:u},c={strides:r,pad:i,dimRoundingMode:o,dilations:s,filterShape:n};return L.runKernel(GN,l,c)}const $ue=z({depthwiseConv2dNativeBackpropFilter_:gFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yFe(e,t,n,r,i,s=[1,1],o){let a=t,u=!1;t.rank===3&&(u=!0,a=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={dy:a,filter:n},c={strides:r,pad:i,dimRoundingMode:o,dilations:s,inputShape:e},f=L.runKernel(qN,l,c);return u?j(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const _ue=z({depthwiseConv2dNativeBackpropInput_:yFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bFe({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:c}){if(y3(L.state.gradientDepth,u)===!1){let w=Oy(e,t,n,r,i,s,o);return a!=null&&(w=de(w,a)),g3(w,u,l,c)}const f=N(e,"x","depthwiseConv2d","float32"),d=N(t,"filter","depthwiseConv2d","float32");let h=f,p=!1;f.rank===3&&(p=!0,h=j(f,[1,f.shape[0],f.shape[1],f.shape[2]])),A(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),A(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),A(h.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),s==null&&(s=[1,1]),A(ri(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),Xi("fused depthwiseConv2d",r,o);const m=Pr(h.shape,d.shape,n,s,r,o,!0);let g;a!=null&&(g=N(a,"bias","fused conv2d"),[g]=zn(g,f),ut(m.outShape,g.shape));let y;l!=null&&(y=N(l,"prelu weights","fused depthwiseConv2d"));const b=(w,S)=>{A($d(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[C,k,E,_]=S,T=p3(w,E,u),D=_ue(k.shape,T,C,n,r,s,o),O=$ue(k,T,C.shape,n,r,s,o);if(_!=null){const M=m3(g,T);return[D,O,M]}return[D,O]},v={x:h,filter:d,bias:g,preluActivationWeights:y},x={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:c};return a==null?Dl((S,C,k)=>{let E=L.runKernel(Sw,v,x);return k([C,S,E]),p&&(E=j(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(h,d):Dl((S,C,k,E)=>{let _=L.runKernel(Sw,v,x);return E([C,S,_,k]),p&&(_=j(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:b}})(h,d,g)}const vFe=z({fusedDepthwiseConv2d_:bFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xFe({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(y3(L.state.gradientDepth,s)===!1){let T=vt(e,t,n,r);return i!=null&&(T=de(T,i)),g3(T,s,o,a)}let u=N(e,"a","fused matMul"),l=N(t,"b","fused matMul");[u,l]=zn(u,l);const c=n?u.shape[u.rank-2]:u.shape[u.rank-1],f=r?l.shape[l.rank-1]:l.shape[l.rank-2],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],h=r?l.shape[l.rank-2]:l.shape[l.rank-1],p=u.shape.slice(0,-2),m=l.shape.slice(0,-2),g=ee(p),y=ee(m);A(c===f,()=>`Error in fused matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${u.shape} and ${l.shape} and transposeA=${n} and transposeB=${r} must match.`);const v=ut(u.shape.slice(0,-2),l.shape.slice(0,-2)).concat([d,h]),x=n?j(u,[g,c,d]):j(u,[g,d,c]),w=r?j(l,[y,h,f]):j(l,[y,f,h]);let S;i!=null&&(S=N(i,"bias","fused matMul"),[S]=zn(S,u),ut(v,S.shape));let C;o!=null&&(C=N(o,"prelu weights","fused matMul"));const k=(T,D)=>{const[O,M,I,P]=D,V=p3(j(T,I.shape),I,s);let F,B;if(!n&&!r?(F=vt(V,M,!1,!0),B=vt(O,V,!0,!1)):!n&&r?(F=vt(V,M,!1,!1),B=vt(V,O,!0,!1)):n&&!r?(F=vt(M,V,!1,!0),B=vt(O,V,!1,!1)):(F=vt(M,V,!0,!0),B=vt(V,O,!0,!0)),i!=null){const q=m3(P,V);return[F,B,q]}else return[F,B]},E={a:x,b:w,bias:S,preluActivationWeights:C},_={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:a};return i==null?Dl((D,O,M)=>{const I=L.runKernel(xw,E,_);return M([D,O,I]),{value:j(I,v),gradFunc:k}})(x,w):Dl((D,O,M,I)=>{const P=L.runKernel(xw,E,_);return I([D,O,P,M]),{value:j(P,v),gradFunc:k}})(x,w,S)}const E5=z({fusedMatMul_:xFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eue=Object.freeze(Object.defineProperty({__proto__:null,conv2d:kue,depthwiseConv2d:vFe,matMul:E5},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wFe(e){return h3(e,.54,.46)}const SFe=z({hammingWindow_:wFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CFe(e){return h3(e,.5,.5)}const Tue=z({hannWindow_:CFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kFe(e,t,n,r=!1,i=0){let s=0;const o=[];for(;s+t<=e.size;)o.push(At(e,s,t)),s+=n;if(r)for(;s<e.size;){const a=s+t-e.size,u=tr([At(e,s,t-a),Rm([a],i)]);o.push(u),s+=n}return o.length===0?yl([],[0,t]):j(tr(o),[o.length,t])}const Aue=z({frame_:kFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Fe(e,t,n,r,i=Tue){r==null&&(r=w8(t));const s=Aue(e,t,n),o=U(s,i(t));return eC(o,r)}const _Fe=z({stft_:$Fe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EFe(e,t,n,r,i="bilinear",s=0){const o=N(e,"image","cropAndResize"),a=N(t,"boxes","cropAndResize","float32"),u=N(n,"boxInd","cropAndResize","int32"),l=a.shape[0];A(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),A(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${a.shape}.`),A(u.rank===1&&u.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${a.shape}.`),A(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),A(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),A(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const c={image:o,boxes:a,boxInd:u},f={method:i,extrapolationValue:s,cropSize:r};return L.runKernel(VN,c,f)}const TFe=z({cropAndResize_:EFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AFe(e){const t=N(e,"image","flipLeftRight","float32");A(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return L.runKernel(eI,n,{})}const NFe=z({flipLeftRight_:AFe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IFe(e){const t=N(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];A(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),A(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,_o(t,i)}const DFe=z({grayscaleToRGB_:IFe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OFe(e){const t=N(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];A(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),A(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const i=t.dtype,s=Ce(t,"float32"),o=qr([.2989,.587,.114]);let a;switch(t.rank){case 2:a=ep("ij,j->i",s,o);break;case 3:a=ep("ijk,k->ij",s,o);break;case 4:a=ep("ijkl,l->ijk",s,o);break;case 5:a=ep("ijklm,m->ijkl",s,o);break;case 6:a=ep("ijklmn,n->ijklm",s,o);break;default:throw new Error("Not a valid tensor rank.")}return a=jr(a,-1),Ce(a,i)}const FFe=z({rgbToGrayscale_:OFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RFe(e,t,n=0,r=.5){const i=N(e,"image","rotateWithOffset","float32");A(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const s={image:i},o={radians:t,fillValue:n,center:r};return L.runKernel(MI,s,o)}const MFe=z({rotateWithOffset_:RFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zy(e,t,n,r,i,s){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),s==null&&(s=0);const o=e.shape[0];return n=Math.min(n,o),A(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),A(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),A(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),A(t.rank===1,()=>"scores must be a 1D tensor"),A(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),A(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PFe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=N(e,"boxes","nonMaxSuppression","float32"),o=N(t,"scores","nonMaxSuppression","float32"),a=zy(s,o,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return L.runKernel(cI,{boxes:s,scores:o},u)}const LFe=z({nonMaxSuppression_:PFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zFe(e,t,n){const r=BFe(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function BFe(e,t,n){return WFe(e,t,n||UFe)}function UFe(e,t){return e>t?1:e<t?-1:0}function WFe(e,t,n){let r=0,i=e.length,s=0,o=!1;for(;r<i;){s=r+(i-r>>>1);const a=n(t,e[s]);a>0?r=s+1:(i=s,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3(e,t,n,r,i){return C8(e,t,n,r,i,0)}function v3(e,t,n,r,i,s){return C8(e,t,n,r,i,0,!1,s,!0)}function x3(e,t,n,r,i,s){return C8(e,t,n,r,i,s,!0)}function C8(e,t,n,r,i,s,o=!1,a=!1,u=!1){const l=[];for(let g=0;g<t.length;g++)t[g]>i&&l.push({score:t[g],boxIndex:g,suppressBeginIndex:0});l.sort(kK);const c=s>0?-.5/s:0,f=[],d=[];for(;f.length<n&&l.length>0;){const g=l.pop(),{score:y,boxIndex:b,suppressBeginIndex:v}=g;if(y<i)break;let x=!1;for(let w=f.length-1;w>=v;--w){const S=VFe(e,b,f[w]);if(S>=r){x=!0;break}if(g.score=g.score*jFe(r,c,S),g.score<=i)break}g.suppressBeginIndex=f.length,x||(g.score===y?(f.push(b),d.push(g.score)):g.score>i&&zFe(l,g,kK))}const h=f.length,p=n-h;a&&p>0&&(f.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const m={selectedIndices:f};return o&&(m.selectedScores=d),u&&(m.validOutputs=h),m}function VFe(e,t,n){const r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(a-s)*(u-o),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;const m=Math.max(s,l),g=Math.max(o,c),y=Math.min(a,f),b=Math.min(u,d),v=Math.max(y-m,0)*Math.max(b-g,0);return v/(h+p-v)}function jFe(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function kK(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function HFe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=N(e,"boxes","nonMaxSuppressionAsync"),o=N(t,"scores","nonMaxSuppressionAsync"),a=zy(s,o,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const u=await Promise.all([s.data(),o.data()]),l=u[0],c=u[1],{selectedIndices:f}=b3(l,c,n,r,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),qr(f,"int32")}const GFe=HFe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qFe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=N(e,"boxes","nonMaxSuppression"),a=N(t,"scores","nonMaxSuppression"),u=zy(o,a,n,r,i,s);n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,s=u.softNmsSigma;const l={boxes:o,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s},f=L.runKernel(dI,l,c);return{selectedIndices:f[0],selectedScores:f[1]}}const XFe=z({nonMaxSuppressionWithScore_:qFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function KFe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=N(e,"boxes","nonMaxSuppressionAsync"),a=N(t,"scores","nonMaxSuppressionAsync"),u=zy(o,a,n,r,i,s);n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,s=u.softNmsSigma;const l=await Promise.all([o.data(),a.data()]),c=l[0],f=l[1],{selectedIndices:d,selectedScores:h}=x3(c,f,n,r,i,s);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:qr(d,"int32"),selectedScores:qr(h)}}const YFe=KFe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZFe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=N(e,"boxes","nonMaxSuppression"),a=N(t,"scores","nonMaxSuppression"),u=zy(o,a,n,r,i,null),l=u.maxOutputSize,c=u.iouThreshold,f=u.scoreThreshold,d={boxes:o,scores:a},h={maxOutputSize:l,iouThreshold:c,scoreThreshold:f,padToMaxOutputSize:s},p=L.runKernel(fI,d,h);return{selectedIndices:p[0],validOutputs:p[1]}}const QFe=z({nonMaxSuppressionPadded_:ZFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function JFe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=N(e,"boxes","nonMaxSuppressionAsync"),a=N(t,"scores","nonMaxSuppressionAsync"),u=zy(o,a,n,r,i,null),l=u.maxOutputSize,c=u.iouThreshold,f=u.scoreThreshold,[d,h]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=v3(d,h,l,c,f,s);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:qr(p,"int32"),validOutputs:Ze(m,"int32")}}const eRe=JFe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tRe(e,t,n=!1,r=!1){const i=N(e,"images","resizeBilinear");A(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),A(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),A(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;i.rank===3&&(o=!0,s=j(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:s},u={alignCorners:n,halfPixelCenters:r,size:t},l=L.runKernel(CS,a,u);return o?j(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const Nue=z({resizeBilinear_:tRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nRe(e,t,n=!1,r=!1){const i=N(e,"images","resizeNearestNeighbor");A(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),A(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),A(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),A(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;i.rank===3&&(o=!0,s=j(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:s},u={alignCorners:n,halfPixelCenters:r,size:t},l=L.runKernel(SS,a,u);return o?j(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const Iue=z({resizeNearestNeighbor_:nRe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rRe(e,t="binary",n=!1,r=.5){const i=N(e,"image","threshold"),s=.2989,o=.587,a=.114,u=i.shape[0]*i.shape[1];let l=U(qr([r]),255),c,f,d,h;if(A(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),A(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),A(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),A(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[c,f,d]=ps(i,[1,1,1],-1);const g=U(c,s),y=U(f,o),b=U(d,a);h=de(de(g,y),b)}else h=e;if(t==="otsu"){const g=TB(Ce(e3(h),"int32"),hs([]),256);l=iRe(g,u)}const p=n?Qd(h,l):Ki(h,l);return Ce(U(p,255),"int32")}function iRe(e,t){let n=qr([-1]),r=qr([0]),i=qr([0]),s,o,a,u,l,c;for(let f=0;f<e.size-1;f++){s=At(e,0,f+1),o=At(e,f+1),l=Ue(Le(s),t),c=Ue(Le(o),t);const d=Le(U(s,Gp(0,s.size)));a=Ue(d,Le(s));const h=Rm(o.shape,s.size),p=de(Gp(0,o.size),h),m=U(o,p);u=Ue(Le(m),Le(o));const g=Re(a,u),y=Re(a,u),b=U(l,c);i=U(U(b,g),y);const v=Ki(i,r);r=Ir(v,i,r),n=Ir(v,qr([f]),n)}return n}const sRe=z({threshold_:rRe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRe(e,t,n="nearest",r="constant",i=0,s){const o=N(e,"image","transform","float32"),a=N(t,"transforms","transform","float32");A(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),A(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),A(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const u={image:o,transforms:a},l={interpolation:n,fillMode:r,fillValue:i,outputShape:s};return L.runKernel(FI,u,l)}const aRe=z({transform_:oRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uRe(e,t,n){const r=N(e,"a","bandPart");A(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,o]=r.shape.slice(-2);let a,u;typeof t=="number"?(A(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),A(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),a=N(t<0?s:t,"numLower","bandPart")):(A(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Ir(W0(t,0),s,Ed(t,s))),typeof n=="number"?(A(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),A(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),u=N(n<0?o:n,"numUpper","bandPart")):(A(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=Ir(W0(n,0),o,Ed(n,o)));const l=j(Gp(0,s,1,"int32"),[-1,1]),c=Gp(0,o,1,"int32"),f=Re(l,c),d=Oa(Qd(f,a),lf(f,yn(u))),h=lr([s,o],r.dtype);return j(Hi(Wo(j(r,[-1,s,o])).map(p=>Ir(d,p,h))),i)}const lRe=z({bandPart_:uRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cRe(e){let t;if(Array.isArray(e)){t=!1,A(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=e[0].shape[0];for(let s=1;s<e.length;++s)A(e[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[s].shape[0]} vs. ${i})`)}else t=!0,e=ps(e,e.shape[0],0).map(i=>eh(i,[0]));A(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],r=e;for(let i=0;i<e.length;++i)n.push(L.tidy(()=>{let s=r[i];if(i>0)for(let o=0;o<i;++o){const a=U(Le(U(n[o],s)),n[o]);s=Re(s,a)}return Ue(s,Ry(s,"euclidean"))}));return t?Hi(n,0):n}const fRe=z({gramSchmidt_:cRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dRe(e,t=!1){if(A(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return $K(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((u,l)=>u*l),r=Wo(j(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],s=[];r.forEach(u=>{const[l,c]=$K(u,t);i.push(l),s.push(c)});const o=j(Hi(i,0),e.shape),a=j(Hi(s,0),e.shape);return[o,a]}}function $K(e,t=!1){return L.tidy(()=>{A(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],r=e.shape[1];let i=qI(n),s=gl(e);const o=yl([[1]],[1,1]);let a=gl(o);const u=n>=r?r:n;for(let l=0;l<u;++l){const c=s,f=a,d=i;[a,s,i]=L.tidy(()=>{const h=At(s,[l,l],[n-l,1]),p=Ry(h),m=At(s,[l,l],[1,1]),g=Ir(Ki(m,0),yl([[-1]]),yl([[1]])),y=Re(m,U(g,p)),b=Ue(h,y);b.shape[0]===1?a=gl(o):a=tr([o,At(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const v=yn(Ue(vt(g,y),p)),x=At(s,[l,0],[n-l,r]),w=U(v,a),S=Tt(a);if(l===0)s=Re(x,vt(w,vt(S,x)));else{const E=Re(x,vt(w,vt(S,x)));s=tr([At(s,[0,0],[l,r]),E],0)}const C=Tt(w),k=At(i,[0,l],[n,i.shape[1]-l]);if(l===0)i=Re(k,vt(vt(k,a),C));else{const E=Re(k,vt(vt(k,a),C));i=tr([At(i,[0,0],[n,l]),E],1)}return[a,s,i]}),at([c,f,d])}return!t&&n>r&&(i=At(i,[0,0],[n,r]),s=At(s,[0,0],[r,r])),[i,s]})}const hRe=z({qr_:dRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ri;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ri||(Ri={}));function pRe(e,t,n=Ri.SUM_BY_NONZERO_WEIGHTS){const r=N(e,"losses","computeWeightedLoss");let i=null;t!=null&&(i=N(t,"weights","computeWeightedLoss"));const s=i==null?r:U(r,i);if(n===Ri.NONE)return s;if(n===Ri.SUM)return Le(s);if(n===Ri.MEAN){if(i==null)return Pn(s);{const o=r.size/i.size,a=Ue(Le(s),Le(i));return o>1?Ue(a,Ze(o)):a}}if(n===Ri.SUM_BY_NONZERO_WEIGHTS){if(i==null)return Ue(Le(s),Ze(r.size));{const o=U(i,ls(r.shape)),a=Ce(Le(Hp(o,Ze(0))),"float32");return Ue(Le(s),a)}}throw Error(`Unknown reduction: ${n}`)}const ff=z({computeWeightedLoss_:pRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mRe(e,t,n,r=Ri.SUM_BY_NONZERO_WEIGHTS){const i=N(e,"labels","absoluteDifference"),s=N(t,"predictions","absoluteDifference");let o=null;n!=null&&(o=N(n,"weights","absoluteDifference")),ni(i.shape,s.shape,"Error in absoluteDifference: ");const a=ar(Re(i,s));return ff(a,o,r)}const gRe=z({absoluteDifference_:mRe});function yRe(e,t,n,r,i=Ri.SUM_BY_NONZERO_WEIGHTS){const s=N(e,"labels","cosineDistance"),o=N(t,"predictions","cosineDistance");let a=null;r!=null&&(a=N(r,"weights","cosineDistance")),ni(s.shape,o.shape,"Error in cosineDistance: ");const u=Ze(1),l=Re(u,Le(U(s,o),n,!0));return ff(l,a,i)}const bRe=z({cosineDistance_:yRe});function vRe(e,t,n,r=Ri.SUM_BY_NONZERO_WEIGHTS){let i=N(e,"labels","hingeLoss");const s=N(t,"predictions","hingeLoss");let o=null;n!=null&&(o=N(n,"weights","hingeLoss")),ni(i.shape,s.shape,"Error in hingeLoss: ");const a=Ze(1);i=Re(U(Ze(2),i),a);const u=Fu(Re(a,U(i,s)));return ff(u,o,r)}const xRe=z({hingeLoss_:vRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wRe(e,t,n,r=1,i=Ri.SUM_BY_NONZERO_WEIGHTS){const s=N(e,"labels","huberLoss"),o=N(t,"predictions","huberLoss");let a=null;n!=null&&(a=N(n,"weights","huberLoss")),ni(s.shape,o.shape,"Error in huberLoss: ");const u=Ze(r),l=ar(Re(o,s)),c=Ed(l,u),f=Re(l,c),d=de(U(Ze(.5),rn(c)),U(u,f));return ff(d,a,i)}const SRe=z({huberLoss_:wRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CRe(e,t,n,r=1e-7,i=Ri.SUM_BY_NONZERO_WEIGHTS){const s=N(e,"labels","logLoss"),o=N(t,"predictions","logLoss");let a=null;n!=null&&(a=N(n,"weights","logLoss")),ni(s.shape,o.shape,"Error in logLoss: ");const u=Ze(1),l=Ze(r),c=yn(U(s,to(de(o,l)))),f=U(Re(u,s),to(de(Re(u,o),l))),d=Re(c,f);return ff(d,a,i)}const kRe=z({logLoss_:CRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Re(e,t,n,r=Ri.SUM_BY_NONZERO_WEIGHTS){const i=N(e,"labels","meanSquaredError"),s=N(t,"predictions","meanSquaredError");let o=null;n!=null&&(o=N(n,"weights","meanSquaredError")),ni(i.shape,s.shape,"Error in meanSquaredError: ");const a=u3(i,s);return ff(a,o,r)}const _Re=z({meanSquaredError_:$Re});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERe(e,t){const n=N(e,"labels","sigmoidCrossEntropyWithLogits"),r=N(t,"logits","sigmoidCrossEntropyWithLogits");ni(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=Fu(r),s=U(r,n),o=VS(bs(yn(ar(r))));return de(Re(i,s),o)}function TRe(e,t,n,r=0,i=Ri.SUM_BY_NONZERO_WEIGHTS){let s=N(e,"multiClassLabels","sigmoidCrossEntropy");const o=N(t,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=N(n,"weights","sigmoidCrossEntropy")),ni(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const l=Ze(r),c=Ze(1),f=Ze(.5);s=de(U(s,Re(c,l)),U(f,l))}const u=ERe(s,o);return ff(u,a,i)}const ARe=z({sigmoidCrossEntropy_:TRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NRe(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Dl((i,s,o)=>{const u=jS(s,[n],!0),l=Re(Ce(s,"float32"),u);o([i,l]);const c=yn(U(l,i));return{value:Le(c,[n]),gradFunc:(h,p)=>{const[m,g]=p,y=rr(h.shape,[n]);return[U(j(h,y),Re(Ce(m,"float32"),bs(g))),U(j(h,y),Re(bs(g),Ce(m,"float32")))]}}})(e,t)}function IRe(e,t,n,r=0,i=Ri.SUM_BY_NONZERO_WEIGHTS){let s=N(e,"onehotLabels","softmaxCrossEntropy");const o=N(t,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=N(n,"weights","softmaxCrossEntropy")),ni(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const l=Ze(r),c=Ze(1),f=Ze(s.shape[1]);s=de(U(s,Re(c,l)),Ue(l,f))}const u=NRe(s,o);return ff(u,a,i)}const DRe=z({softmaxCrossEntropy_:IRe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ORe(e,t,n,r){const i=N(e,"indices","sparseFillEmptyRows","int32"),s=N(t,"values","sparseFillEmptyRows"),o=N(n,"denseShape","sparseFillEmptyRows","int32"),a=N(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const u={indices:i,values:s,denseShape:o,defaultValue:a},l=L.runKernel(CI,u);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}const FRe=z({sparseFillEmptyRows_:ORe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RRe(e,t,n){const r=N(e,"inputIndices","sparseReshape","int32"),i=N(t,"inputShape","sparseReshape","int32"),s=N(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const o={inputIndices:r,inputShape:i,newShape:s},a=L.runKernel(kI,o);return{outputIndices:a[0],outputShape:a[1]}}const MRe=z({sparseReshape_:RRe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PRe(e,t,n){const r=N(e,"data","sparseSegmentMean"),i=N(t,"indices","sparseSegmentMean","int32"),s=N(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const o={data:r,indices:i,segmentIds:s};return L.runKernel($I,o)}const LRe=z({sparseSegmentMean_:PRe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zRe(e,t,n){const r=N(e,"data","sparseSegmentSum"),i=N(t,"indices","sparseSegmentSum","int32"),s=N(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const o={data:r,indices:i,segmentIds:s};return L.runKernel(_I,o)}const BRe=z({sparseSegmentSum_:zRe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function URe(e,t,n,r,i,s,o,a){const u=N(e,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const l=N(t,"dataSplits","stringNGrams");if(l.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:i,rightPad:s,padWidth:o,preserveShortSequences:a},f={data:u,dataSplits:l},d=L.runKernel(NI,f,c);return{nGrams:d[0],nGramsSplits:d[1]}}const WRe=z({stringNGrams_:URe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VRe(e,t,n=!0){const r=N(e,"input","stringSplit","string"),i=N(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const s={skipEmpty:n},o={input:r,delimiter:i},a=L.runKernel(II,o,s);return{indices:a[0],values:a[1],shape:a[2]}}const jRe=z({stringSplit_:VRe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HRe(e,t){const n=N(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return L.runKernel(DI,i,r)}const GRe=z({stringToHashBucketFast_:HRe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qRe(e,t,n,r=!0){const i=N(e,"input","staticRegexReplace","string"),s={pattern:t,rewrite:n,replaceGlobal:r};return L.runKernel(IS,{x:i},s)}const XRe=z({staticRegexReplace_:qRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Due={fft:JS,ifft:G0,rfft:eC,irfft:a3},Oue={hammingWindow:SFe,hannWindow:Tue,frame:Aue,stft:_Fe},Eo={flipLeftRight:NFe,grayscaleToRGB:DFe,resizeNearestNeighbor:Iue,resizeBilinear:Nue,rgbToGrayscale:FFe,rotateWithOffset:MFe,cropAndResize:TFe,nonMaxSuppression:LFe,nonMaxSuppressionAsync:GFe,nonMaxSuppressionWithScore:XFe,nonMaxSuppressionWithScoreAsync:YFe,nonMaxSuppressionPadded:QFe,nonMaxSuppressionPaddedAsync:eRe,threshold:sRe,transform:aRe},k8={bandPart:lRe,gramSchmidt:fRe,qr:hRe},Fue={absoluteDifference:gRe,computeWeightedLoss:ff,cosineDistance:bRe,hingeLoss:xRe,huberLoss:SRe,logLoss:kRe,meanSquaredError:_Re,sigmoidCrossEntropy:ARe,softmaxCrossEntropy:DRe},Rue={sparseFillEmptyRows:FRe,sparseReshape:MRe,sparseSegmentMean:LRe,sparseSegmentSum:BRe},Mue={stringNGrams:WRe,stringSplit:jRe,stringToHashBucketFast:GRe,staticRegexReplace:XRe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KRe=new Map,T5=new Map;class zm{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Co{constructor(){this.classNameMap={}}static getMap(){return Co.instance==null&&(Co.instance=new Co),Co.instance}static register(t){Co.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function pe(e,t,n){A(e.className!=null,()=>"Class being registered does not have the static className property defined."),A(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),A(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const r=n,i=t+">"+r;return Co.register(e),KRe.set(i,e),T5.set(e,i),e}function YRe(e){return T5.has(e)?T5.get(e):e.className}const ZRe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:zm,SerializationMap:Co,getRegisteredName:YRe,registerClass:pe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class df extends zm{minimize(t,n=!1,r){const{value:i,grads:s}=this.computeGradients(t,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(o)}else this.applyGradients(s);return at(s),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return Uae(t,n)}dispose(){this.iterations_!=null&&at(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ze(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(df,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $8 extends df{static get className(){return"Adadelta"}constructor(t,n,r=null){super(),this.learningRate=t,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=L.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=L.registeredVariables[r],o=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:K(()=>Nt(s).variable(o))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:K(()=>Nt(s).variable(o))});const a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;const u=this.accumulatedGrads[i].variable,l=this.accumulatedUpdates[i].variable;K(()=>{const c=de(U(u,this.rho),U(rn(a),1-this.rho)),f=U(Ue(Or(de(l,this.epsilon)),Or(de(u,this.epsilon))),a),d=de(U(l,this.rho),U(rn(f),1-this.rho));u.assign(c),l.assign(d);const h=de(U(f,-this.learningRate),s);s.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(at(this.accumulatedGrads.map(t=>t.variable)),at(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,r=!1;this.accumulatedGrads=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _8 extends df{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=L.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:K(()=>Rm(s.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const a=this.accumulatedGrads[i].variable;K(()=>{const u=de(a,rn(o));a.assign(u);const l=de(U(Ue(o,Or(de(u,L.backend.epsilon()))),-this.learningRate),s);s.assign(l)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&at(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E8 extends df{static get className(){return"Adam"}constructor(t,n,r,i=null){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],K(()=>{this.accBeta1=Ze(n).variable(),this.accBeta2=Ze(r).variable()}),i==null&&(this.epsilon=L.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);K(()=>{const r=Re(1,this.accBeta1),i=Re(1,this.accBeta2);n.forEach((s,o)=>{const a=L.registeredVariables[s],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:K(()=>Nt(a).variable(u))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${s}/v`,variable:K(()=>Nt(a).variable(u))});const l=Array.isArray(t)?t[o].tensor:t[s];if(l==null)return;const c=this.accumulatedFirstMoment[o].variable,f=this.accumulatedSecondMoment[o].variable,d=de(U(c,this.beta1),U(l,1-this.beta1)),h=de(U(f,this.beta2),U(rn(l),1-this.beta2)),p=Ue(d,r),m=Ue(h,i);c.assign(d),f.assign(h);const g=de(U(Ue(p,de(Or(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(U(this.accBeta1,this.beta1)),this.accBeta2.assign(U(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&at(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&at(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),K(()=>{this.accBeta1.assign(Il(this.beta1,this.iterations_+1)),this.accBeta2.assign(Il(this.beta2,this.iterations_+1))});const n=t.length/2,r=!1;this.accumulatedFirstMoment=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T8 extends df{static get className(){return"Adamax"}constructor(t,n,r,i=null,s=0){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],K(()=>{this.iteration=Ze(0).variable(),this.accBeta1=Ze(n).variable()}),i==null&&(this.epsilon=L.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);K(()=>{const r=Re(1,this.accBeta1),i=Ue(-this.learningRate,de(U(this.iteration,this.decay),1));n.forEach((s,o)=>{const a=L.registeredVariables[s],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:Nt(a).variable(u)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${s}/v`,variable:Nt(a).variable(u)});const l=Array.isArray(t)?t[o].tensor:t[s];if(l==null)return;const c=this.accumulatedFirstMoment[o].variable,f=this.accumulatedWeightedInfNorm[o].variable,d=de(U(c,this.beta1),U(l,1-this.beta1)),h=U(f,this.beta2),p=ar(l),m=Vl(h,p);c.assign(d),f.assign(m);const g=de(U(Ue(i,r),Ue(d,de(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(de(this.iteration,1)),this.accBeta1.assign(U(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&at(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&at(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w3 extends df{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Array.isArray(t)?t[i].tensor:t[r];if(s==null)return;const o=L.registeredVariables[r];K(()=>{const a=de(U(this.c,s),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=xr(Ze(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A8 extends w3{static get className(){return"Momentum"}constructor(t,n,r=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Ze(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=L.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:K(()=>Nt(s).variable(!1))});const o=this.accumulations[i].variable,a=Array.isArray(t)?t[i].tensor:t[r];a!=null&&K(()=>{let u;const l=de(U(this.m,o),a);this.useNesterov?u=de(U(this.c,de(a,U(l,this.m))),s):u=de(U(this.c,l),s),o.assign(l),s.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&at(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N8 extends df{static get className(){return"RMSProp"}constructor(t,n=.9,r=0,i=null,s=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,i==null&&(this.epsilon=L.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=L.registeredVariables[r],o=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:K(()=>Nt(s).variable(o))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:K(()=>Nt(s).variable(o))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:K(()=>Nt(s).variable(o))});const a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;const u=this.accumulatedMeanSquares[i].variable,l=this.accumulatedMoments[i].variable;K(()=>{const c=de(U(u,this.decay),U(rn(a),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[i].variable,d=de(U(f,this.decay),U(a,1-this.decay)),h=Ue(U(a,this.learningRate),Or(Re(c,de(rn(d),this.epsilon)))),p=de(U(l,this.momentum),h);u.assign(c),f.assign(d),l.assign(p);const m=Re(s,p);s.assign(m)}else{const f=de(U(u,this.decay),U(rn(a),1-this.decay)),d=de(U(l,this.momentum),Ue(U(a,this.learningRate),Or(de(f,this.epsilon))));u.assign(f),l.assign(d);const h=Re(s,d);s.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&at(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&at(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&at(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,r=!1;this.accumulatedMeanSquares=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QRe=[$8,_8,E8,T8,A8,N8,w3];function JRe(){for(const e of QRe)pe(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eMe="model",tMe=".json",nMe=".weights.bin";function _K(e){return new Promise(t=>setTimeout(t)).then(e)}class qp{constructor(t){if(!Y().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(qp.URL_SCHEME)&&(t=t.slice(qp.URL_SCHEME.length)),(t==null||t.length===0)&&(t=eMe),this.modelJsonFileName=t+tMe,this.weightDataFileName=t+nMe}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Ou.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const i=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],s=wae(t,i),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await _K(()=>a.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=r,await _K(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:MS(t)}}}}qp.URL_SCHEME="downloads://";class rMe{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,n)=>{const r=new FileReader;r.onload=i=>{const s=JSON.parse(i.target.result),o=s.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:o});return}const u=hB(s,l=>this.loadWeights(l));t(u)},r.onerror=i=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(t){const n=[],r=[];for(const o of t)n.push(...o.weights),r.push(...o.paths);const i=this.checkManifestAndWeightFiles(t),s=r.map(o=>this.loadWeightsFile(o,i[o]));return Promise.all(s).then(o=>[n,o])}loadWeightsFile(t,n){return new Promise((r,i)=>{const s=new FileReader;s.onload=o=>{const a=o.target.result;r(a)},s.onerror=o=>i(`Failed to weights data from file of path '${t}'.`),s.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){const n=[],r=this.weightsFiles.map(s=>CK(s.name)),i={};for(const s of t)s.paths.forEach(o=>{const a=CK(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);i[o]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const iMe=e=>Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(qp.URL_SCHEME)?sMe(e.slice(qp.URL_SCHEME.length)):null;Rn.registerSaveRouter(iMe);function sMe(e="model"){return new qp(e)}function oMe(e){return new rMe(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EK(e,t,n,r){o(e),n=n??0,r=r??1,a(n,r);let i=0;const s=u=>(u.then(l=>{const c=n+ ++i/e.length*(r-n);return t(c),l}),u);function o(u){A(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function a(u,l){A(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),A(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${l}`),A(l>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${l}`)}return Promise.all(e.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Pue(e,t){t==null&&(t={});const n=t.fetchFunc==null?Y().platform.fetch:t.fetchFunc,r=e.map(f=>n(f,t.requestInit,{isBinary:!0})),a=(t.onProgress==null?await Promise.all(r):await EK(r,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?await Promise.all(a):await EK(a,t.onProgress,.5,1)}function aMe(e,t){var n;const r=t.fetchFunc==null?Y().platform.fetch:t.fetchFunc;let i=0,s;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:async o=>{for(var a;i<e.length;){s||(s=(await r(e[i],t.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:l}=await s.read();if(u){i++,s=void 0,(a=t.onProgress)===null||a===void 0||a.call(t,i/e.length);continue}o.enqueue(l);return}o.close()}})}async function Lue(e,t="",n,r){return zue(o=>Pue(o,{requestInit:r}))(e,t,n)}function zue(e){return async(t,n="",r)=>{const i=t.map(()=>!1),s={},o=r!=null?r.map(()=>!1):[],a=[];if(t.forEach((h,p)=>{let m=0;h.weights.forEach(g=>{const y="quantization"in g?g.quantization.dtype:g.dtype,b=zp[y]*ee(g.shape),v=()=>{i[p]=!0,s[p]==null&&(s[p]=[]),s[p].push({manifestEntry:g,groupOffset:m,sizeBytes:b})};r!=null?r.forEach((x,w)=>{x===g.name&&(v(),o[w]=!0)}):v(),a.push(g.name),m+=b})}),!o.every(h=>h)){const h=r.filter((p,m)=>!o[m]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const u=i.reduce((h,p,m)=>(p&&h.push(m),h),[]),l=[];u.forEach(h=>{t[h].paths.forEach(p=>{const m=n+(n.endsWith("/")?"":"/")+p;l.push(m)})});const c=await e(l),f={};let d=0;return u.forEach(h=>{const p=t[h].paths.length,m=new Ou(c.slice(d,d+p));s[h].forEach(y=>{const b=m.slice(y.groupOffset,y.groupOffset+y.sizeBytes),v=cB(b,[y.manifestEntry]);for(const x in v)f[x]=v[x]}),d+=p}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uMe="application/octet-stream",lMe="application/json";class I8{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(A(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=Y().platform.fetch,A(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&A(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i=wae(t,r);if(n.body.append("model.json",new Blob([JSON.stringify(i)],{type:lMe}),"model.json"),t.weightData!=null){const o=Ou.join(t.weightData);n.body.append("model.weights.bin",new Blob([o],{type:uMe}),"model.weights.bin")}const s=await this.fetch(this.path,n);if(s.ok)return{modelArtifactsInfo:MS(t),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,i=n.weightsManifest;if(r==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return hB(t,n=>this.loadWeights(n))}async loadStream(){const t=await this.loadModelJSON(),n=await this.getWeightUrls(t.weightsManifest),r=GE(t.weightsManifest),i=()=>aMe(n,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:r,getWeightStream:i})}async getWeightUrls(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=cMe(n),s=this.weightPathPrefix||r,o=[],a=[];for(const u of t)for(const l of u.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(l)):o.push(s+l+i);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(t){const n=await this.getWeightUrls(t),r=GE(t),i=await Pue(n,this.loadOptions);return[r,i]}}I8.URL_SCHEME_REGEX=/^https?:\/\//;function cMe(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}function A5(e){return e.match(I8.URL_SCHEME_REGEX)!=null}const Bue=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>A5(r)):n=A5(e),n)return D8(e,t)}return null};Rn.registerSaveRouter(Bue);Rn.registerLoadRouter(Bue);function D8(e,t){return new I8(e,t)}function Uue(e,t){return D8(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mR{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class Wue{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class fMe{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}function dMe(e,t,n,r){const i=arguments;return new fMe(XE(...i))}function XE(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new mR(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new mR({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new mR({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function hMe(e){return new Wue(e)}function pMe(e){return new Wue(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Ou,browserFiles:oMe,browserHTTPRequest:Uue,concatenateArrayBuffers:xae,copyModel:XNe,decodeWeights:cB,decodeWeightsStream:vae,encodeWeights:w5,fromMemory:dMe,fromMemorySync:XE,getLoadHandlers:Cae,getModelArtifactsForJSON:hB,getModelArtifactsForJSONSync:dB,getModelArtifactsInfoForJSON:MS,getSaveHandlers:Sae,getWeightSpecs:GE,http:D8,isHTTPScheme:A5,listModels:GNe,loadWeights:Lue,moveModel:KNe,registerLoadRouter:FNe,registerSaveRouter:ONe,removeModel:qNe,weightsLoaderFactory:zue,withSaveHandler:hMe,withSaveHandlerSync:pMe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMe(e,t,n){const r=N(e,"labels","confusionMatrix"),i=N(t,"predictions","confusionMatrix");A(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),A(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),A(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),A(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),A(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const s=V0(Ce(r,"int32"),n),o=V0(Ce(i,"int32"),n),a=Tt(s),u=vt(a,o);return Ce(u,"int32")}const gMe=z({confusionMatrix_:mMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yMe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:gMe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let kh,TK=!1;function Vue(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,s=!1,o=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)s=!0;else if(e.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(kw(VE,L.backendName)!=null){const p={pixels:e},m={numChannels:t};return L.runKernel(VE,p,m)}const[l,c]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height];let f;if(o)f=e.getContext("2d").getImageData(0,0,l,c).data;else if(r||n)f=e.data;else if(s||i||a){if(kh==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")kh=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else kh=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});kh.canvas.width=l,kh.canvas.height=c,kh.drawImage(e,0,0,l,c),f=kh.getImageData(0,0,l,c).data}let d;if(t===4)d=new Int32Array(f);else{const p=l*c;d=new Int32Array(p*t);for(let m=0;m<p;m++)for(let g=0;g<t;++g)d[m*t+g]=f[m*4+g]}return p8(d,[c,l,t],"int32")}function bMe(e){return e!=null&&e.data instanceof Uint8Array}function vMe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function xMe(e){return e!=null&&e.width!==0&&e.height!==0}function wMe(e){return vMe()&&!(e instanceof ImageBitmap)&&xMe(e)&&!bMe(e)}async function SMe(e,t=3){let n=null;if(Y().getBool("WRAP_TO_IMAGEBITMAP")&&wMe(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return Vue(n,t)}function jue(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function CMe(e){const t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function Hue(e,t){let n=N(e,"img","toPixels");if(!(e instanceof Rt)){const l=n;n=Ce(l,"int32"),l.dispose()}jue(n);const[r,i]=n.shape.slice(0,2),s=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,u=new Uint8ClampedArray(i*r*4);for(let l=0;l<r*i;++l){const c=[0,0,0,255];for(let d=0;d<s;d++){const h=o[l*s+d];if(n.dtype==="float32"){if(h<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${h}.`)}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${h}.`);s===1?(c[0]=h*a,c[1]=h*a,c[2]=h*a):c[d]=h*a}const f=l*4;u[f+0]=Math.round(c[0]),u[f+1]=Math.round(c[1]),u[f+2]=Math.round(c[2]),u[f+3]=Math.round(c[3])}if(t!=null){TK||kw(KN,L.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),TK=!0),t.width=i,t.height=r;const l=t.getContext("2d"),c=new ImageData(u,i,r);l.putImageData(c,0,0)}return n!==e&&n.dispose(),u}function kMe(e,t,n){let r=N(e,"img","draw");if(!(e instanceof Rt)){const o=r;r=Ce(o,"int32"),o.dispose()}jue(r),CMe(n==null?void 0:n.imageOptions);const i={image:r},s={canvas:t,options:n};L.runKernel(KN,i,s)}const Gue=z({fromPixels_:Vue}),$Me=Object.freeze(Object.defineProperty({__proto__:null,draw:kMe,fromPixels:Gue,fromPixelsAsync:SMe,toPixels:Hue},Symbol.toStringTag,{value:"Module"}));function S3(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(ee(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,s=i[i.length-1];let o=1;for(let f=0;f<i.length-1;++f)o*=i[f];const a=e.shape,u=i.slice();u.pop();let l=1;for(let f=s;f<n;++f)l*=a[f],u.push(a[f]);const c=[...Ye(e.shape).map(f=>f/l),1].slice(0,s);return[u,o,l,c]}const _Me=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:S3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N5=-2,EMe=-1;function F8(e,t,n){const r=e.shape.length;A(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),A(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)A(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function TMe(e){const t=[];let n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function R8(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function que(e,t,n,r){const i=[...e];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<n;s++)s===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function Xue(e,t,n){return n<=e?n:n-(t-1)}function Kue(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function AMe(e,t,n,r,i,s,o,a,u){const l=e.length;let c=new Array(l),f=new Array(l),d=new Array(l);if(t.length&&n>0){const h=t[0],p=n+1;c=Yue(o,h,p,r,e),f=Zue(a,h,p,i,e),d=que(s,h,p,e)}else for(let h=0;h<l;h++)c[h]=Jue(o,r,s,e,h,u),f[h]=ele(a,i,s,e,h,u),d[h]=Que(s,h,u);return{begin:c,end:f,strides:d}}function Yue(e,t,n,r,i){const s=[...i],o=Kue(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=0;else{const u=Xue(t,n,a);let l=r[u];e&1<<u&&(l=0),s[a]=l}return s}function Zue(e,t,n,r,i){const s=[...i],o=Kue(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const u=Xue(t,n,a);let l=r[u];e&1<<u&&(l=Number.MAX_SAFE_INTEGER),s[a]=l}for(let a=0;a<s.length;a++){const u=i[a];s[a]<0&&(s[a]+=u),s[a]=Sd(0,s[a],i[a])}return s}function Que(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function Jue(e,t,n,r,i,s){let o=t[i];const a=n[i]||1;(e&1<<i||s&1<<i||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),o=Sd(0,o,u-1),o}function ele(e,t,n,r,i,s){let o=t[i];const a=n[i]||1;(e&1<<i||s&1<<i||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),a>0?o=Sd(0,o,u):o=Sd(-1,o,u-1),o}function M8(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function P8(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function C3(e,t,n){let r;const i=e.shape.length;typeof t=="number"?r=[t,...new Array(i-1).fill(0)]:t.length<i?r=t.concat(new Array(i-t.length).fill(0)):r=t.slice(),r.forEach(o=>{A(o!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(i).fill(-1):typeof n=="number"?s=[n,...new Array(i-1).fill(-1)]:n.length<i?s=n.concat(new Array(i-n.length).fill(-1)):s=n,s=s.map((o,a)=>o>=0?o:(A(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),e.shape[a]-r[a])),[r,s]}function L8(e,t,n,r,i,s,o,a,u){let l;if(r==null?(l=new Array(t.length),l.fill(1)):l=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const f={dims:l.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:l.slice(),beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u};for(let v=0;v<f.dims;v++)c&&1<<v&a&&f.numAddAxisAfterEllipsis++,1<<v&o&&(c=!0);c||(f.ellipsisMask|=1<<f.dims,f.dims++);const d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};NMe(f,d);let h=!0,p=!0,m=!0;const g=[],y=[];for(let v=0;v<e.length;++v){if(d.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const x=!!(d.shrinkAxisMask&1<<v),w=e[v];if(w===-1){g.push(x?1:-1);continue}const S=[d.beginMask&1<<v,d.endMask&1<<v],C=[d.strides[v]>0?0:-1,d.strides[v]>0?w:w-1];if(x&&d.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&d.strides[v]===1;const k=!!(d.beginMask&1<<v&&d.endMask&1<<v);if(d.beginValid&&d.endValid){if(x){const D=d.begin[v]<0?w+d.begin[v]:d.begin[v];if(d.begin[v]=D,d.end[v]=d.begin[v]+1,D<0||D>=w)throw Error(`slice index ${d.begin[v]} of dimension ${v} out of bounds.`)}else d.begin[v]=AK(d.begin[v],0,d.strides[v],w,S,C),d.end[v]=AK(d.end[v],1,d.strides[v],w,S,C);const T=d.strides[v]===1&&d.begin[v]===0&&d.end[v]===w;h=h&&T,p=p&&(v===0&&d.strides[v]===1||T)}else h=h&&d.strides[v]===1&&k,p=p&&(v===0&&d.strides[v]===1||k);let E,_=!1;if(d.beginValid&&d.endValid?(E=d.end[v]-d.begin[v],_=!0):x?(E=1,_=!0):k&&w>=0&&(d.strides[v]<0?E=-w:E=w,_=!0),_){let T;E===0||E<0!=d.strides[v]<0?T=0:T=Math.trunc(E/d.strides[v])+(E%d.strides[v]!==0?1:0),g.push(T)}else g.push(-1)}for(let v=0;v<d.finalShapeGatherIndices.length;++v){const x=d.finalShapeGatherIndices[v];x>=0?y.push(g[x]):x===N5&&y.push(1)}return{finalShapeSparse:y.filter((v,x)=>d.finalShapeGatherIndices[x]!==N5),finalShape:y,isIdentity:h,sliceDim0:p,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function NMe(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(N5),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(EMe),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function AK(e,t,n,r,i,s){if(i[t])return n>0?s[t]:s[t+1&1];{const o=e<0?r+e:e;return o<s[0]?s[0]:o>s[1]?s[1]:o}}const tle=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:F8,computeFlatOffset:P8,computeOutShape:R8,getNormalizedAxes:AMe,isSliceContinous:M8,maskToAxes:TMe,parseSliceParams:C3,sliceInfo:L8,startForAxis:Jue,startIndicesWithElidedDims:Yue,stopForAxis:ele,stopIndicesWithElidedDims:Zue,stridesForAxis:Que,stridesWithElidedDims:que},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const nle="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rle{static sgd(t){return new w3(t)}static momentum(t,n,r=!1){return new A8(t,n,r)}static rmsprop(t,n=.9,r=0,i=null,s=!1){return new N8(t,n,r,i,s)}static adam(t=.001,n=.9,r=.999,i=null){return new E8(t,n,r,i)}static adadelta(t=.001,n=.95,r=null){return new $8(t,n,r)}static adamax(t=.002,n=.9,r=.999,i=null,s=0){return new T8(t,n,r,i,s)}static adagrad(t,n=.1){return new _8(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ff=rle;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IMe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function z8(){return new Promise(e=>IMe(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(e,t){const n=e[0].length;e.forEach((i,s)=>{A(i.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),A(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=e[0];e.forEach((i,s)=>{for(let o=0;o<n;o++)A(o===t||i[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function bl(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var su;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(su||(su={}));function ile(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const s=n[i],o=r[r.length-n.length+i],a=r[o];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${s} but shape[${i+e}] = ${a}`)}else r[o]=s}return r}function sle(e){const t={FIRST_DIM_SIZE:su.FIRST_DIM_SIZE,VALUE_ROWIDS:su.VALUE_ROWIDS,ROW_LENGTHS:su.ROW_LENGTHS,ROW_SPLITS:su.ROW_SPLITS,ROW_LIMITS:su.ROW_LIMITS,ROW_STARTS:su.ROW_STARTS},n=[];for(const r of e)if(r in t)n.push(t[r]);else break;return n}function ole(e){return e.length===0?0:e[0]===su.FIRST_DIM_SIZE?e.length-1:e.length}function ale(e,t){if(e==null||t==null)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const s=e[i],o=t[i+1];if(s>=0&&o>=0&&s!==1&&s!==o)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${s} but ragged tensor input.flatValues.shape[${i-e.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U8=30;function k3(e){return e<=U8?e:BE(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(e,t,n){const r=n*(typeof e=="number"?e:e[0]),i=t*(typeof e=="number"?e:e[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tC(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);const s=t.length;for(let o=0;o<s;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(s+1))}return i}function nC(e,t,n=!0){const r=[];if(n){r.push(t);for(let i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{const i=[],s=[];for(let o=1;o<e;++o)o>=t*2+1||o%2===1?s.push(o):i.push(o);r.push(...i),r.push(0),r.push(...s)}return r}function rC(e,t,n,r=!0){const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let s=1;s<e.length;++s)s<=t.length?r?i.push(t[s-1]*e[s]):i.push(e[s]/t[s-1]):i.push(e[s]);return i}function V8(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function j8(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $3=1.7580993408473768,_3=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H8=.3275911,G8=.254829592,q8=-.284496736,X8=1.421413741,K8=-1.453152027,Y8=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xc(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function ule(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function lle(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function cle(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function Z8(e,t){const n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function fle(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function dle(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const s=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:n,imag:r}}function hle(e,t,n){const r=(n?2:-2)*Math.PI*(e/t),i=Math.cos(r),s=Math.sin(r);return{real:i,imag:s}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gR="->",DMe=/->/g,NK=",",IK="...";function Q8(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(DMe,"").length)/gR.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${gR}").`);const[r,i]=e.split(gR);A(r.indexOf(IK)===-1,()=>`The ellipsis notation ("${IK}") is not supported yet.`);const s=r.split(NK),o=s.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<i.length;++d){const h=i[d];if(!s.some(p=>p.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);a.indexOf(h)===-1&&a.push(h)}for(let d=0;d<r.length;++d){const h=r[d];a.indexOf(h)===-1&&h!==NK&&a.push(h)}const u=new Array(s.length);for(let d=0;d<o;++d){if(new Set(s[d].split("")).size!==s[d].length)throw new Error(`Found duplicate axes in input component ${s[d]}. Support for duplicate axes in input is not implemented yet.`);u[d]=[];for(let h=0;h<s[d].length;++h)u[d].push(a.indexOf(s[d][h]))}const l=a.length,c=i.length,f=[];for(let d=c;d<l;++d)f.push(d);return{allDims:a,summedDims:f,idDims:u}}function J8(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;const r=[];for(let i=0;i<e;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function e7(e,t,n){const r=new Array(e);for(let i=0;i<n.length;++i){const s=n[i].shape;for(let o=0;o<t[i].length;++o)r[t[i][o]]===void 0?r[t[i][o]]=s[o]:A(r[t[i][o]]===s[o],()=>`Expected dimension ${r[t[i][o]]} at axis ${o} of input shaped ${JSON.stringify(s)}, but got dimension ${s[o]}`)}}function t7(e,t){const n=e,r=[];let i=0;e.length===0&&n.push(-1),i=e.length+1;for(let o=0;o<i;++o)r.push([]);const s=[];for(let o=0;o<n.length;++o){const a=n[o],u=OMe(t,a);for(const l of u)s.indexOf(l)===-1&&(r[o].push(l),s.push(l))}return{path:n,steps:r}}function n7(e){return e.every((t,n)=>t===n)}function OMe(e,t){const n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function r7(e,t,n=0){let r=[];if(typeof t=="number")A(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{const i=t.reduce((o,a)=>(a===-1&&(o+=1),o),0);A(i<=1,()=>"There should be only one negative value in split array.");const s=t.indexOf(-1);if(s!==-1){const o=t.reduce((a,u)=>u>0?a+u:a);t[s]=e.shape[n]-o}A(e.shape[n]===t.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function mle(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function gle(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function ble(e,t){return`size ${e} must be non-negative, not ${t}`}function vle(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function xle(e,t){const n=ee(e),r=ee(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function wle(e,t){const n=ee(e),r=ee(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(){return"segment ids must be >= 0"}function Sle(){return"segment ids are not increasing"}function Cle(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function kle(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $le(e,t){let n=!1,r;for(e<=U8?(r=e,n=!0):r=BE(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=BE(e,r+1);return r}function _le(e,t,n){const r=[],i=e.length;for(let s=0;s<i;s++)s!==t?r.push(e[s]):r.push(n);return r}function i7(e,t,n,r){const i=t.shape.length,s=e.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let f=0;f<r;++f)if(e.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${e.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const o=e.shape[n],a=[];let u=1,l=1,c=1;for(let f=0;f<r;++f)a.push(e.shape[f]),u*=e.shape[f];for(let f=r;f<n;f++)a.push(e.shape[f]),l*=e.shape[f];for(let f=r;f<i;f++)a.push(t.shape[f]);for(let f=n+1;f<s;f++)a.push(e.shape[f]),c*=e.shape[f];return{batchSize:u,sliceSize:c,outerSize:l,dimSize:o,outputShape:a}}const FMe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:i7,computeOutShape:_le,segOpComputeOptimalWindowSize:$le},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kc(e){try{return e.map(t=>jc(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function Ele(e){return e.map(t=>ml(t))}const Tle=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:G8,ERF_A2:q8,ERF_A3:X8,ERF_A4:K8,ERF_A5:Y8,ERF_P:H8,PARALLELIZE_THRESHOLD:U8,get RowPartitionType(){return su},SELU_SCALE:_3,SELU_SCALEALPHA:$3,applyActivation:g3,assertAndGetBroadcastShape:ut,assertAxesAreInnerMostDims:ii,assertParamsConsistent:B8,assignToTypedArray:fle,axesAreInnerMostDims:UB,calculateShapes:th,checkEinsumDimSizes:e7,checkPadOnDimRoundingMode:Xi,combineLocations:Lae,combineRaggedTensorToTensorShapes:ile,complexWithEvenIndex:lle,complexWithOddIndex:cle,computeConv2DInfo:Pr,computeConv3DInfo:Yd,computeDefaultPad:CB,computeDilation2DInfo:PS,computeOptimalWindowSize:k3,computeOutAndReduceShapes:Lr,computeOutShape:bl,computePool2DInfo:za,computePool3DInfo:af,convertConv2DDataFormat:uf,decodeEinsumEquation:Q8,eitherStridesOrDilationsAreOne:ri,expandShapeToKeepDim:rr,exponent:hle,exponents:dle,fromStringArrayToUint8:Ele,fromUint8ToStringArray:Kc,getAxesPermutation:Bn,getBroadcastDims:jp,getComplexWithIndex:Z8,getEinsumComputePath:t7,getEinsumPermutation:J8,getFusedBiasGradient:m3,getFusedDyActivation:p3,getImageCenter:W8,getInnerMostAxes:ir,getPermuted:nC,getRaggedRank:ole,getReductionAxes:gr,getReshaped:tC,getReshapedPermuted:rC,getRowPartitionTypesHelper:sle,getSliceBeginCoords:V8,getSliceSize:j8,getSparseFillEmptyRowsIndicesDenseShapeMismatch:ple,getSparseFillEmptyRowsNegativeIndexErrorMessage:mle,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:gle,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:vle,getSparseReshapeInputOutputMismatchErrorMessage:wle,getSparseReshapeInputOutputMultipleErrorMessage:xle,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:yle,getSparseReshapeNegativeOutputDimErrorMessage:ble,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:kle,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:I5,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Sle,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Cle,getUndoAxesPermutation:Zd,isIdentityPermutation:n7,log:FAe,mergeRealAndImagArrays:Xc,prepareAndValidate:S3,prepareSplitSize:r7,segment_util:FMe,shouldFuse:y3,slice_util:tle,splitRealAndImagArrays:ule,stridesOrDilationsArePositive:Vp,tupleValuesAreOne:$d,upcastType:ms,validateDefaultValueShape:ale,validateInput:l3,validateUpdateShape:m8,warn:So},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RMe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:b3,nonMaxSuppressionV4Impl:v3,nonMaxSuppressionV5Impl:x3,whereImpl:d3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */JRe();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale={kernelName:D2,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(e,Lm(Ce(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MMe={kernelName:P1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=rn(Ce(n,"float32")),i=Or(Re(Ze(1),r));return yn(Ue(e,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PMe={kernelName:L1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Or(Re(rn(Ce(n,"float32")),1));return Ue(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LMe={kernelName:Om,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=ut(n.shape,r.shape);return{a:()=>{let a=e;const u=gr(n.shape,i);return u.length>0&&(a=Le(a,u)),j(a,n.shape)},b:()=>{let a=e;const u=gr(r.shape,i);return u.length>0&&(a=Le(a,u)),j(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zMe={kernelName:O2,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((r,i)=>{n[i]=()=>e.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BMe={kernelName:F2,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UMe={kernelName:R2,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WMe={kernelName:z1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,Or(Re(Ze(1),rn(Ce(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VMe={kernelName:B1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Or(de(Ze(1),rn(Ce(n,"float32"))));return Ue(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jMe={kernelName:V1,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=ut(n.shape,r.shape);return{a:()=>{const a=de(rn(n),rn(r));let u=U(e,Ue(r,a));const l=gr(n.shape,i);return l.length>0&&(u=Le(u,l)),j(u,n.shape)},b:()=>{const a=de(rn(n),rn(r));let u=yn(U(e,Ue(n,a)));const l=gr(r.shape,i);return l.length>0&&(u=Le(u,l)),j(u,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HMe={kernelName:U1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,de(rn(Ce(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GMe={kernelName:W1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,Re(Ze(1),rn(Ce(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qMe(e,t,n,r,i,s){const o=N(e,"dy","avgPool3dGrad"),a=N(t,"input","avgPool3dGrad");let u=o,l=a,c=!1;a.rank===4&&(c=!0,u=j(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),A(u.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),A(l.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${l.rank}.`),Xi("avgPool3dGrad",i,s);const f={dy:u,input:l},d={filterSize:n,strides:r,pad:i,dimRoundingMode:s},h=L.runKernel(RN,f,d);return c?j(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const XMe=z({avgPool3dGrad_:qMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KMe={kernelName:P2,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:a}=n;return{x:()=>XMe(e,r,i,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YMe(e,t,n,r,i){const s=N(e,"dy","avgPoolGrad"),o=N(t,"input","avgPoolGrad");A(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`);let a=o,u=s,l=!1;o.rank===3&&(l=!0,a=j(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=j(s,[1,s.shape[0],s.shape[1],s.shape[2]])),A(u.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),A(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:u,input:a},f={filterSize:n,strides:r,pad:i},d=L.runKernel(FN,c,f);return l?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const ZMe=z({avgPoolGrad_:YMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QMe={kernelName:M2,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>ZMe(e,r,i,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JMe={kernelName:L2,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,i]=t,{transposeA:s,transposeB:o}=n;return!s&&!o?{a:()=>vt(e,i,!1,!0),b:()=>vt(r,e,!0,!1)}:!s&&o?{a:()=>vt(e,i,!1,!1),b:()=>vt(e,r,!0,!1)}:s&&!o?{a:()=>vt(i,e,!1,!0),b:()=>vt(r,e,!1,!1)}:{a:()=>vt(i,e,!0,!0),b:()=>vt(e,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e4e={kernelName:z2,gradFunc:(e,t,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>XS(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t4e={kernelName:Yoe,gradFunc:(e,t,n)=>{const r=n,i=r.inputShape,s=r.shape,o=Array.from(s);for(let u=i.length-1;u>=0;u--)if(i[u]===s[u])o[u]=1;else if(i[u]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const a=[];for(let u=0;u<o.length;u++)o[u]>1&&a.push(u);return{x:()=>Le(e,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n4e={kernelName:j1,gradFunc:e=>({x:()=>e.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r4e={kernelName:H1,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i4e={kernelName:G1,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:i,clipValueMax:s}=n;return{x:()=>Ir(Oa(lf(r,i),Qd(r,s)),e,Nt(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s4e={kernelName:U2,inputsToSave:["x"],gradFunc:Ale.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o4e={kernelName:W2,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map(u=>u.shape),{axis:i}=n,s=wt(i,t[0].shape)[0],o=r.map(u=>u[s]);return ps(e,o,s).map(u=>()=>u)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a4e={kernelName:V2,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{dilations:s,strides:o,pad:a,dataFormat:u}=n;return A($d(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>FB(r.shape,e,i,o,a,u),filter:()=>S8(r,e,i.shape,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u4e={kernelName:j2,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{strides:s,pad:o,dataFormat:a,dimRoundingMode:u}=n;return{dy:()=>qc(e,i,s,o,a,1,u),filter:()=>S8(e,r,i.shape,s,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4e(e,t,n,r,i){let s=e;e.rank===4&&(s=j(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;o.rank===4&&(o=j(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),A(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),A(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),A(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),A(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),A(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:s,dy:o},u={strides:r,pad:i,filterShape:n};return L.runKernel(BN,a,u)}const c4e=z({conv3DBackpropFilter_:l4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4e={kernelName:H2,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s}=n;A($d(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=t;return{x:()=>Rae(o.shape,e,a,i,s),filter:()=>c4e(o,e,a.shape,i,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d4e={kernelName:q1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(yn(i3(Ce(n,"float32"))),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h4e={kernelName:X1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(s3(Ce(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p4e={kernelName:G2,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i,exclusive:s,reverse:o}=n;return{x:()=>{const a=Bn([i],r.rank);let u=HI(e,i,s,!o);return a!=null&&(u=Tt(u,a)),u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m4e={kernelName:q2,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:o}=n,a=r??[1,1];A($d(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[u,l]=t;return A(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),A(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`),A(u.shape[3]===l.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),A(ri(i,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${a}'.`),Xi("depthwiseConv2d",s,o),{x:()=>_ue(u.shape,e,l,i,s,a,o),filter:()=>$ue(u,e,l.shape,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g4e={kernelName:X2,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,s={x:r,filter:i,dy:e},o={x:r,filter:i,dy:e};return{x:()=>L.runKernel(UE,s,n),filter:()=>L.runKernel(WE,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y4e={kernelName:Y1,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>L.runKernel(ZN,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b4e={kernelName:Z1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=U(bs(yn(rn(n))),2/Math.sqrt(Math.PI));return{x:()=>U(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v4e={kernelName:Q1,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(e,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x4e={kernelName:Y2,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>j(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w4e={kernelName:J1,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(e,bs(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S4e={kernelName:ey,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C4e={kernelName:ty,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=ut(n.shape,r.shape);return{a:()=>{const a=Ue(e,Ce(r,"float32")),u=gr(n.shape,i);return u.length>0?j(Le(a,u),n.shape):a},b:()=>{let a=U(e,Ce(n,"float32"));const u=gr(r.shape,i);u.length>0&&(a=j(Le(a,u),r.shape));const l=rn(r);return yn(Ue(a,Ce(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k4e={kernelName:Z2,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[i,s,o,a]=t,u=a??Ze(1),l=gr(s.shape,i.shape),c=[];if(s.rank===1){for(let x=0;x<i.shape.length-1;++x)c.push(i.shape[x]);c.push(1)}const f=Re(i,s),d=U(e,u),h=t3(de(o,Ze(r))),p=U(U(U(h,h),h),Ze(-.5));return{x:()=>s.rank===1?j(U(U(e,_o(j(h,[1,1,1,s.shape[0]]),c)),u),i.shape):j(U(U(e,h),u),i.shape),mean:()=>{let x=U(U(h,Ze(-1)),d);return s.rank===1&&(x=Le(x,l)),j(x,s.shape)},variance:()=>{let x=U(U(p,f),d);return s.rank===1&&(x=Le(x,l)),j(x,s.shape)},scale:()=>{const x=U(f,h);let w=U(e,x);return s.rank===1&&(w=Le(w,l)),j(w,s.shape)},offset:()=>{let x=e;return s.rank===1&&(x=Le(x,l)),j(x,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $4e={kernelName:Q2,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,i]=t,{axis:s,batchDims:o}=n,a=wt(s,r.shape)[0],u=(l,c,f)=>()=>{const d=l.shape,h=c.size,p=d.slice(0,a),m=p.length,g=d.slice(s,d.length).slice(1),y=g.length,b=DK(0,m),v=DK(m+1,m+1+y),x=OK([p,[h],g]),w=j(f,x),S=j(c,[h]),C=OK([[m],b,v]),k=Tt(w,C);let E=f3(k,S,l.shape[a]);const _=Zd(C);return E=Tt(E,_),E};if(o===1){const l=r.shape[0],c=r.split(l,0);return{x:()=>Hi(c.map((h,p)=>u(h,i.slice(p,1),e.slice(p,1))())).reshape(r.shape),indices:()=>i}}else return{x:u(r,i,e),indices:()=>i}}};function DK(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function OK(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _4e={kernelName:ny,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>Nt(n),b:()=>Nt(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E4e={kernelName:ry,gradFunc:e=>({x:()=>Ce(e,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T4e={kernelName:iy,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A4e={kernelName:sy,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N4e={kernelName:oy,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I4e={kernelName:eS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:i}=n,s=Ki(r,0);return{x:()=>Ir(s,e,U(e,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4e={kernelName:uy,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,de(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O4e={kernelName:ay,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,Ce(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F4e={kernelName:Zoe,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;return{logits:()=>{const o=bs(r);return Re(e,U(Le(e,i,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4e(e,t,n,r=5,i=1,s=1,o=.5){const a={x:e,y:t,dy:n},u={depthRadius:r,bias:i,alpha:s,beta:o};return L.runKernel(sI,a,u)}const M4e=z({localResponseNormalizationBackprop_:R4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P4e={kernelName:oS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{depthRadius:s,bias:o,alpha:a,beta:u}=n;return{x:()=>M4e(r,i,e,s,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(e,t,n,r){return t.rank<n.rank&&(t=j(t,rr(t.shape,r))),e.rank<n.rank&&(e=j(e,rr(e.shape,r))),{x:()=>U(e,Ce(eo(n,t),e.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK={kernelName:aS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:i}=r,s=t[0],o=t[1],a=wt(i,s.shape),u=Nle(e,o,s,a);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4e={kernelName:ly,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>U(e,Ce(lf(n,r),"float32")),b:()=>U(e,Ce(W0(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z4e(e,t,n,r,i,s,o){const a=N(e,"dy","maxPool3dGrad"),u=N(t,"input","maxPool3dGrad"),l=N(n,"output","maxPool3dGrad");let c=a,f=u,d=l,h=!1;u.rank===4&&(h=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),f=j(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),d=j(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),A(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),A(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),A(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),Xi("maxPool3dGrad",s,o);const p={dy:c,input:f,output:d},m={filterSize:r,strides:i,pad:s,dimRoundingMode:o},g=L.runKernel(aI,p,m);return h?j(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const B4e=z({maxPool3dGrad_:z4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U4e={kernelName:lS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=n;return{x:()=>B4e(e,r,i,s,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4e(e,t,n,r,i,s,o){const a=N(e,"dy","maxPoolGrad"),u=N(t,"input","maxPoolGrad"),l=N(n,"output","maxPoolGrad");A(u.rank===a.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${a.rank})`),A(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),A(u.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`),Xi("maxPoolGrad",s,o);const c={dy:a,input:u,output:l},f={filterSize:r,strides:i,pad:s,dimRoundingMode:o};return L.runKernel(oI,c,f)}const V4e=z({maxPoolGrad_:W4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j4e={kernelName:uS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a}=n;return{x:()=>V4e(e,r,i,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H4e={kernelName:cS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n,s=wt(i,r.shape),a=Lr(r.shape,s)[1],u=ee(a);return{x:()=>{const c=r.shape.slice();s.forEach(h=>{c[h]=1});const f=j(e,c);return Ue(U(f,ls(r.shape,"float32")),u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G4e={kernelName:fS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:i}=r,[s,o]=t,a=wt(i,s.shape),u=Nle(e,o,s,a);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q4e={kernelName:cy,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>U(e,Ce(Qd(n,r),"float32")),b:()=>U(e,Ce(Ki(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X4e={kernelName:dS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(o=>o[0]);return{x:()=>At(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K4e={kernelName:fy,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=ut(n.shape,r.shape);return{a:()=>{const a=gr(n.shape,i);return a.length>0?j(Le(e,a),n.shape):e},b:()=>{const a=U(e,yn(My(Ue(n,r)))),u=gr(r.shape,i);return u.length>0?j(Le(a,u),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y4e={kernelName:dy,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=ut(n.shape,r.shape);return{a:()=>{const a=U(e,Ce(r,"float32")),u=gr(n.shape,i);return u.length>0?j(Le(a,u),n.shape):a},b:()=>{const a=U(e,Ce(n,"float32")),u=gr(r.shape,i);return u.length>0?j(Le(a,u),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z4e={kernelName:hS,gradFunc:e=>({x:()=>yn(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4e={kernelName:gS,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>lr(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J4e={kernelName:mS,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e5e={kernelName:yS,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return Wo(e,r).map(s=>()=>s)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RK={kernelName:bS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(o=>o[0]);return{x:()=>At(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5e={kernelName:hy,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,i]=t,s=n,o=r,a=ut(s.shape,o.shape);return{a:()=>{const c=Ce(o,"float32");let f=U(e,U(c,Il(s,Re(c,Ze(1)))));const d=gr(s.shape,a);return d.length>0&&(f=Le(f,d)),j(f,s.shape)},b:()=>{const c=Ki(s,0),f=Ir(c,to(s),Nt(s));let d=U(e,U(i,f));const h=gr(o.shape,a);return h.length>0&&(d=Le(d,h)),j(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n5e={kernelName:vS,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,i=Ki(n,0);return{x:()=>Ir(i,e,U(e,r)),alpha:()=>{let s=Ir(i,Nt(e),U(e,n));const o=gr(r.shape,e.shape);return o.length>0&&(s=Le(s,o)),j(s,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5e(e,t,n){const r=e.shape.slice();r[n]=1;const i=j(t,r),s=Nw(e,n,!0,!1),o=Nw(e,n,!0,!0),a=U(s,o);return U(i,a)}function i5e(e,t,n){const r=e.shape.length,i=r-n.length,s=Bn(n,r);let o=e;s!=null&&(o=Tt(e,s));const a=o.shape.slice(),l=a.splice(r-n.length,n.length).reduce((d,h)=>d*h,1);a.push(l);const c=o.reshape(a);let f=r5e(c,t,i);if(f=f.reshape(o.shape),s!=null){const d=Zd(s);f=Tt(f,d)}return f}const s5e={kernelName:xS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;let s=[];return i==null?s=r.shape.map((o,a)=>a):typeof i=="number"?s=[i]:s=i,{x:()=>i5e(r,e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o5e={kernelName:K1,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=ut(n.shape,r.shape);return{a:()=>{const a=Ue(e,Ce(r,"float32")),u=gr(n.shape,i);return u.length>0?j(Le(a,u),n.shape):a},b:()=>{let a=U(e,Ce(n,"float32"));const u=gr(r.shape,i);u.length>0&&(a=j(Le(a,u),r.shape));const l=rn(r);return yn(Ue(a,Ce(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5e={kernelName:py,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,yn(rn(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u5e={kernelName:gy,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=U(Qd(n,6),Lm(n));return{x:()=>U(e,Ce(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l5e={kernelName:my,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(e,Ce(Lm(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c5e={kernelName:wS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>j(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f5e={kernelName:CS,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>L.runKernel(vI,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d5e={kernelName:SS,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>L.runKernel(bI,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h5e={kernelName:kS,gradFunc:(e,t,n)=>{const{dims:r}=n,i=wt(r,e.shape);return{x:()=>Uo(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p5e={kernelName:yy,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m5e={kernelName:by,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>yn(Ue(e,U(Il(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g5e={kernelName:$S,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>Ce(Nt(n),"float32"),t:()=>U(e,Ce(n,e.dtype)),e:()=>U(e,Ce(HS(n),e.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y5e={kernelName:vy,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Ki(n,Ze(0)),i=Ze($3),s=Ze(_3),o=U(e,s),a=U(U(e,i),bs(Ce(n,"float32")));return Ir(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b5e={kernelName:Cy,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(e,U(n,Re(Ze(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v5e={kernelName:Sy,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x5e={kernelName:xy,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(BS(Ce(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5e={kernelName:wy,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(jI(Ce(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5e={kernelName:_S,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:i,size:s}=n,o=r.shape,[a,u]=C3(r,i,s),l=[];for(let c=0;c<e.rank;c++)l.push([a[c],o[c]-a[c]-u[c]]);return{x:()=>cf(e,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C5e={kernelName:NS,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:i}=n,s=!0,o=U(e,r);return{logits:()=>Re(o,U(Le(o,[i],s),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k5e={kernelName:ky,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(e,mu(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MK={kernelName:TS,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>zS(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PK={kernelName:AS,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>tr(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $5e={kernelName:$y,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,U(Or(Ce(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _5e={kernelName:TI,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(e,U(Ce(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5e={kernelName:_y,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Ze(2);return{a:()=>U(e,U(i,Re(n,r))),b:()=>U(e,U(i,Re(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T5e={kernelName:Iy,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5e={kernelName:Ey,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=ut(n.shape,r.shape);return{a:()=>{let a=e;const u=gr(n.shape,i);return u.length>0&&(a=Le(a,u)),j(a,n.shape)},b:()=>{let a=e;const u=gr(r.shape,i);return u.length>0&&(a=Le(a,u)),j(yn(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N5e={kernelName:ES,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,i=r.shape.slice(),{axis:s}=n;wt(s,r.shape).forEach(l=>{i[l]=1});const a=j(e,i),u=U(a,ls(r.shape,"float32"));return{x:()=>u}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I5e={kernelName:Ty,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ue(e,rn(BS(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D5e={kernelName:Ay,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>U(Re(Ze(1),rn(n)),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O5e={kernelName:Ny,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:i}=n;return{x:()=>{let o=Nt(r);if(r.rank===1)for(let a=0;a<i[0];++a)o=de(o,At(e,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)o=de(o,At(e,[a*r.shape[0],u*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)for(let l=0;l<i[2];++l)o=de(o,At(e,[a*r.shape[0],u*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)for(let l=0;l<i[2];++l)for(let c=0;c<i[3];++c)o=de(o,At(e,[a*r.shape[0],u*r.shape[1],l*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5e={kernelName:wp,gradFunc:(e,t,n)=>{const r=n,{perm:i}=r,s=Zd(i);return{x:()=>Tt(e,s)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R5e={kernelName:DS,gradFunc:(e,t,n)=>{const r=n,{axis:i}=r;return{value:()=>Hi(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M5e={kernelName:OS,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>P5e(e,n)}}};function P5e(e,t){const n=Vl(t,Nt(t)),r=Py(e,n);let i=lf(t,Ze(0,"int32"));const s=r.rank-i.rank;for(let a=0;a<s;++a)i=jr(i,a+1);i=Oa(i,ls(r.shape,"bool"));const o=Nt(r);return Ir(i,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L5e={kernelName:FS,gradFunc:e=>({x:()=>Nt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z5e=[Ale,MMe,PMe,LMe,zMe,BMe,UMe,WMe,VMe,jMe,HMe,GMe,KMe,QMe,JMe,e4e,t4e,n4e,r4e,i4e,s4e,o4e,u4e,a4e,f4e,d4e,h4e,p4e,m4e,g4e,o5e,y4e,b4e,v4e,x4e,w4e,C4e,S4e,k4e,$4e,_4e,E4e,T4e,A4e,N4e,I4e,D4e,O4e,F4e,P4e,FK,FK,L4e,U4e,j4e,H4e,G4e,q4e,X4e,K4e,Y4e,Z4e,Q4e,J4e,e5e,RK,RK,t5e,n5e,s5e,a5e,u5e,l5e,c5e,f5e,d5e,h5e,p5e,m5e,g5e,y5e,b5e,v5e,x5e,w5e,S5e,C5e,k5e,MK,MK,PK,PK,$5e,E5e,_5e,T5e,A5e,N5e,I5e,D5e,O5e,F5e,R5e,M5e,L5e];for(const e of z5e)Qoe(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.abs=function(){return this.throwIfDisposed(),ar(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.acos=function(){return this.throwIfDisposed(),mB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.acosh=function(){return this.throwIfDisposed(),gB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.add=function(e){return this.throwIfDisposed(),de(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.all=function(e,t){return this.throwIfDisposed(),UI(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.any=function(e,t){return this.throwIfDisposed(),Ew(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.argMax=function(e){return this.throwIfDisposed(),Wp(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.argMin=function(e){return this.throwIfDisposed(),yB(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.asScalar=function(){return this.throwIfDisposed(),A(this.size===1,()=>"The array must have only 1 element."),j(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.asType=function(e){return this.throwIfDisposed(),Ce(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.as1D=function(){return this.throwIfDisposed(),j(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.as2D=function(e,t){return this.throwIfDisposed(),j(this,[e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),j(this,[e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),j(this,[e,t,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),j(this,[e,t,n,r,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.asin=function(){return this.throwIfDisposed(),bB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.asinh=function(){return this.throwIfDisposed(),vB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.atan=function(){return this.throwIfDisposed(),xB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.atan2=function(e){return this.throwIfDisposed(),wB(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.atanh=function(){return this.throwIfDisposed(),SB(this)};te().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),LS(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),zS(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),Dy(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Sp(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.cast=function(e){return this.throwIfDisposed(),Ce(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.ceil=function(){return this.throwIfDisposed(),AB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),ys(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Rt&&(e=[e]),tr([this,...e],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.conv1d=function(e,t,n,r,i,s){return this.throwIfDisposed(),WI(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),VI(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.conv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),qc(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.cos=function(){return this.throwIfDisposed(),BS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.cosh=function(){return this.throwIfDisposed(),jI(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),Nw(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),HI(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),PB(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.depthwiseConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),Oy(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),LB(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.divNoNan=function(e){return this.throwIfDisposed(),zB(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.div=function(e){return this.throwIfDisposed(),Ue(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.dot=function(e){return this.throwIfDisposed(),BB(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.elu=function(){return this.throwIfDisposed(),Fy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.equal=function(e){return this.throwIfDisposed(),eo(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.erf=function(){return this.throwIfDisposed(),GI(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),WB(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.exp=function(){return this.throwIfDisposed(),bs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.expandDims=function(e){return this.throwIfDisposed(),jr(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.expm1=function(){return this.throwIfDisposed(),VB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.fft=function(){return this.throwIfDisposed(),JS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.flatten=function(){return this.throwIfDisposed(),j(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.floor=function(){return this.throwIfDisposed(),My(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.floorDiv=function(e){return this.throwIfDisposed(),BI(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.gather=function(e,t,n){return this.throwIfDisposed(),Py(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.greaterEqual=function(e){return this.throwIfDisposed(),lf(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.greater=function(e){return this.throwIfDisposed(),Ki(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.ifft=function(){return this.throwIfDisposed(),G0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.irfft=function(){return this.throwIfDisposed(),a3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.isFinite=function(){return this.throwIfDisposed(),jB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.isInf=function(){return this.throwIfDisposed(),HB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.isNaN=function(){return this.throwIfDisposed(),GB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.leakyRelu=function(e){return this.throwIfDisposed(),WS(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.lessEqual=function(e){return this.throwIfDisposed(),Qd(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.less=function(e){return this.throwIfDisposed(),W0(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),qB(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.logSigmoid=function(){return this.throwIfDisposed(),XB(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.logSoftmax=function(e){return this.throwIfDisposed(),KI(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),jS(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.log=function(){return this.throwIfDisposed(),to(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.log1p=function(){return this.throwIfDisposed(),VS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Oa(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.logicalNot=function(){return this.throwIfDisposed(),HS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.logicalOr=function(e){return this.throwIfDisposed(),YI(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.logicalXor=function(e){return this.throwIfDisposed(),KB(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),vt(this,e,t,n)};te().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),GS(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.max=function(e,t){return this.throwIfDisposed(),Lo(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.maximum=function(e){return this.throwIfDisposed(),Vl(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.mean=function(e,t){return this.throwIfDisposed(),Pn(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.min=function(e,t){return this.throwIfDisposed(),U0(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.minimum=function(e){return this.throwIfDisposed(),Ed(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),ZB(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.mod=function(e){return this.throwIfDisposed(),QB(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.mul=function(e){return this.throwIfDisposed(),U(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.neg=function(){return this.throwIfDisposed(),yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Ry(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.notEqual=function(e){return this.throwIfDisposed(),Hp(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),V0(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.onesLike=function(){return this.throwIfDisposed(),no(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.pad=function(e,t){return this.throwIfDisposed(),cf(this,e,t)};te().prototype.pool=function(e,t,n,r,i,s){return this.throwIfDisposed(),JB(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.pow=function(e){return this.throwIfDisposed(),Il(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.prelu=function(e){return this.throwIfDisposed(),KS(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.prod=function(e,t){return this.throwIfDisposed(),e8(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.reciprocal=function(){return this.throwIfDisposed(),c8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.relu=function(){return this.throwIfDisposed(),Fu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.relu6=function(){return this.throwIfDisposed(),JI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.reshapeAs=function(e){return this.throwIfDisposed(),j(this,e.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.reshape=function(e){return this.throwIfDisposed(),j(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),Nue(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Iue(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.reverse=function(e){return this.throwIfDisposed(),Uo(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.rfft=function(){return this.throwIfDisposed(),eC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.round=function(){return this.throwIfDisposed(),e3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.rsqrt=function(){return this.throwIfDisposed(),t3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.selu=function(){return this.throwIfDisposed(),n3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.separableConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),r3(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.sigmoid=function(){return this.throwIfDisposed(),mu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.sign=function(){return this.throwIfDisposed(),f8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.sin=function(){return this.throwIfDisposed(),i3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.sinh=function(){return this.throwIfDisposed(),s3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.slice=function(e,t){return this.throwIfDisposed(),At(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.softmax=function(e){return this.throwIfDisposed(),QS(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.softplus=function(){return this.throwIfDisposed(),Mm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),XS(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.split=function(e,t){return this.throwIfDisposed(),ps(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.sqrt=function(){return this.throwIfDisposed(),Or(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.square=function(){return this.throwIfDisposed(),rn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.squaredDifference=function(e){return this.throwIfDisposed(),u3(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.squeeze=function(e){return this.throwIfDisposed(),eh(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof Rt?[this,e]:[this,...e];return Hi(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.step=function(e){return this.throwIfDisposed(),Lm(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.stridedSlice=function(e,t,n,r,i,s,o,a){return this.throwIfDisposed(),d8(this,e,t,n,r,i,s,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.sub=function(e){return this.throwIfDisposed(),Re(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.sum=function(e,t){return this.throwIfDisposed(),Le(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.tan=function(){return this.throwIfDisposed(),h8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.tanh=function(){return this.throwIfDisposed(),_d(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.tile=function(e){return this.throwIfDisposed(),_o(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.toBool=function(){return this.throwIfDisposed(),Ce(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.toFloat=function(){return this.throwIfDisposed(),Ce(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.toInt=function(){return this.throwIfDisposed(),Ce(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.topk=function(e,t){return this.throwIfDisposed(),g8(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.transpose=function(e){return this.throwIfDisposed(),Tt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.unique=function(e){return this.throwIfDisposed(),y8(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),f3(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.unstack=function(e){return this.throwIfDisposed(),Wo(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.where=function(e,t){return this.throwIfDisposed(),Ir(e,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */te().prototype.zerosLike=function(){return this.throwIfDisposed(),Nt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rl extends Error{constructor(t){super(t),Object.setPrototypeOf(this,rl.prototype)}}class ga extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ga.prototype)}}class H extends Error{constructor(t){super(t),Object.setPrototypeOf(this,H.prototype)}}class ht extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ht.prototype)}}class s7 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,s7.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ile{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xp(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{const n=new Array(t);return n.fill(e),n}}function il(e,t){if(!e)throw new s7(t)}function LK(e,t){let n=0;for(const r of e)r===t&&n++;return n}function ns(e){return e.length===1?e[0]:e}function Zt(e){return Array.isArray(e)?e:[e]}function fc(e){const n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function tp(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let Jo={};function o7(e){if(e==null)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function D5(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>D5(t));else{const t=Object.keys(e);for(const n of t){const r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:D5(r))}}}function iC(e,t={},n={},r="object",i=!1){if(typeof e=="string"){const s=e;let o;if(s in n)o=n[s];else if(s in Jo)o=Jo[s];else if(o=t[s],o==null)throw new H(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const s=e;if(s.className==null||s.config==null)throw new H(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);const o=s.className;let a,u;if(o in n?[a,u]=n[o]:o in Jo?[a,u]=Jo.className:o in t&&([a,u]=t[o]),a==null)throw new H(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(u!=null){const l={};for(const h of Object.keys(Jo))l[h]=Jo[h];for(const h of Object.keys(n))l[h]=n[h];const c=s.config;c.customObjects=l;const f=Object.assign({},Jo);for(const h of Object.keys(n))Jo[h]=n[h];D5(s.config);const d=u(a,s.config,n,i);return Jo=Object.assign({},f),d}else{const l=Object.assign({},Jo);for(const f of Object.keys(n))Jo[f]=n[f];const c=new a(s.config);return Jo=Object.assign({},l),c}}}function B5e(e,t){return e<t?-1:e>t?1:0}function t$(e,t){return-1*B5e(e,t)}function dd(e){if(e==null)return e;const t=[];for(const n of e)t.indexOf(n)===-1&&t.push(n);return t}function U5e(e){if(e==null)throw new H(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Bm(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new H(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function a7(e,t,n=0,r=1/0){return il(n>=0),il(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(i=>typeof i===t)}function Nr(e,t){Array.isArray(e)?(A(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>Nr(n,`element ${r+1} of ${t}`))):A(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${Dle(e)}.`)}function Dle(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>Dle(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function W5e(e,t,n){let r=n!=null?n():Vr(),i;return(...o)=>{const a=n!=null?n():Vr();return a-r<t||(r=a,i=e(...o)),i}}function Ole(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let V5e=0;function Fle(){return V5e++}const n$={};function E3(e=""){return e in n$||(n$[e]=0),n$[e]+=1,e+n$[e].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const j5e=["channelsFirst","channelsLast"],H5e=["nearest","bilinear"],G5e=["valid","same","causal"],q5e=["max","avg"],X5e=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const $g=new Map;function sr(e){Bm(j5e,"DataFormat",e)}function K5e(e){Bm(H5e,"InterpolationFormat",e)}function qo(e){Bm(G5e,"PaddingMode",e)}function Rle(e){Bm(q5e,"PoolMode",e)}const Tx=[],zK="/";function Cp(e,t){Tx.push(e);try{const n=t();return Tx.pop(),n}catch(n){throw Tx.pop(),n}}function Y5e(){return Tx.length===0?"":Tx.join(zK)+zK}function Mle(e){if(!Lle(e))throw new Error("Not a valid tensor name: '"+e+"'");return Y5e()+e}function Ple(e){if(!Lle(e))throw new Error("Not a valid tensor name: '"+e+"'");$g.has(e)||$g.set(e,0);const t=$g.get(e);if($g.set(e,$g.get(e)+1),t>0){const n=`${e}_${t}`;return $g.set(n,1),n}else return e}const Z5e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Lle(e){return!!e.match(Z5e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Q5e(e){return e===parseInt(e.toString(),10)}function hd(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function q0(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function Td(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function $u(e,t){if(t<e)throw new H(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let yR;function wr(){return yR==null&&(yR=lB().epsilon()),yR}function _u(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vl(e,t){return Ce(e,t)}function sC(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),j(e,n)}function J5e(e,t){return K(()=>{if(e.shape.length!==2)throw new H(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);const n=sC(e,1);return O5(n,[1,t,1])})}function ePe(e){const t=[hd(e.shape)];return j(e,t)}function tPe(e){if(e.rank<=1)throw new H(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],hd(e.shape,1)];return j(e,t)}function kp(e,t,n){return K(()=>{switch(e.rank){case 1:return YS(e,t,n);case 2:return o3(e,[t,0],[n,e.shape[1]]);case 3:return ZS(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return H0(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return At(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return At(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new H(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function bR(e,t,n){return K(()=>{switch(e.rank){case 1:return YS(e,t,n);case 2:return o3(e,[0,t],[e.shape[0],n]);case 3:return ZS(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return H0(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new H(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function r$(e,t,n,r){return K(()=>{switch(e.rank){case 1:return YS(e,t,n);case 2:switch(r){case 1:return kp(e,t,n);case 2:return bR(e,t,n);default:throw new H(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return kp(e,t,n);case 2:return ZS(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return bR(e,t,n);default:throw new H(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return kp(e,t,n);case 2:return H0(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return H0(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return bR(e,t,n);default:throw new H(`The axis is not within the rank of the tensor ${r}`)}default:throw new H(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function u7(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),tr(e,t)}function BK(e,t){switch(e.rank){case 1:return NB([e,t]);case 2:return IB([e,t],0);case 3:return DB([e,t],0);case 4:return OB([e,t],0);default:throw new H(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function O5(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new H(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return _o(e,t)}function T3(e,t=0,n=1,r,i){return QI(e,t,n,r,i)}function xl(e,t,n,r){if(e.rank<2||t.rank<2)throw new ht(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){const i=e.shape.slice(-1)[0],s=t.shape.slice(-2)[0];if(i!==s)throw new ht(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return E5({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?F5(e.rank,r,_u()):null,activation:n});{const i=e.shape.slice(),s=i.pop();e=j(e,[-1,s]);const o=t.shape.slice(),a=o.pop(),u=o.pop(),l=[...o,a],c=Array.from({length:t.rank},(p,m)=>m===0?t.rank-2:m<=t.rank-2?m-1:m);t=j(Tt(t,c),[u,-1]);const f=[...i,...l];return j(E5({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?F5(e.rank,r,_u()):null,activation:n}),f)}}function zle(e,t,n){return K(()=>(Array.isArray(t)?t=qr(t,"int32"):t=Ce(t,"int32"),Py(e,t,n)))}function oC(e){return U(e,e)}function F5(e,t,n){const r=t.shape;if(t.rank!==1&&t.rank!==e)throw new H(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?j(t,[1,r[0],1,1,1]):j(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?j(t,[1,1,1,1,r[0]]):j(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?j(t,[1,r[0],1,1]):j(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?j(t,[1,1,1,r[0]]):j(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?j(t,[1,r[0],1]):j(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?j(t,[1,1,r[0]]):j(t,[1].concat(r))}else if(e<3)return t;throw new H(`Unsupported input rank by biasAdd: ${t.rank}`)}function Ru(e,t,n){return K(()=>(n==null&&(n=_u()),sr(n),de(e,F5(e.rank,t,n))))}function nPe(e,t=1){if(t!==1)throw new ht(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return Fy(e)}function rPe(e){return K(()=>Ue(e,de(ar(e),1)))}function Ble(e,t,n,r){return K(()=>x8(e,t,n,r))}function iPe(e){return K(()=>{const t=de(.5,U(.2,e));return ys(t,0,1)})}function aC(e,t,n=!1){return n?e():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const sPe=["fanIn","fanOut","fanAvg"],oPe=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aPe(e){Bm(sPe,"FanMode",e)}function uPe(e){Bm(oPe,"Distribution",e)}class Ba extends zm{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class l7 extends Ba{apply(t,n){return lr(t,n)}}l7.className="Zeros";pe(l7);class A3 extends Ba{apply(t,n){return ls(t,n)}}A3.className="Ones";pe(A3);class c7 extends Ba{constructor(t){if(super(),typeof t!="object")throw new H(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new H(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return K(()=>U(Ze(this.value),ls(t,n)))}getConfig(){return{value:this.value}}}c7.className="Constant";pe(c7);class f7 extends Ba{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return Jd(t,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}f7.className="RandomUniform";pe(f7);class d7 extends Ba{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ht(`randomNormal does not support dType ${n}.`);return T3(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}d7.className="RandomNormal";pe(d7);class h7 extends Ba{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ht(`truncatedNormal does not support dType ${n}.`);return c3(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}h7.className="TruncatedNormal";pe(h7);let p7=class extends Ba{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return K(()=>{if(t.length!==2||t[0]!==t[1])throw new H("Identity matrix initializer can only be used for 2D square matrices.");return U(this.gain,qI(t[0]))})}getConfig(){return{gain:this.gain}}};p7.className="Identity";pe(p7);function lPe(e,t="channelsLast"){let n,r;if(sr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){const i=hd(e,2);n=e[1]*i,r=e[0]*i}else if(t==="channelsLast"){const i=hd(e,0,e.length-2);n=e[e.length-2]*i,r=e[e.length-1]*i}}else{const i=hd(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}class vs extends Ba{constructor(t){if(super(),t.scale<0)throw new H(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,aPe(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,uPe(this.distribution),this.seed=t.seed}apply(t,n){const r=lPe(t),i=r[0],s=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,i):this.mode==="fanOut"?o/=Math.max(1,s):o/=Math.max(1,(i+s)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ht(`${this.getClassName()} does not support dType ${n}.`);return c3(t,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Jd(t,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}vs.className="VarianceScaling";pe(vs);class N3 extends vs{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return vs.className}}N3.className="GlorotUniform";pe(N3);class I3 extends vs{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return vs.className}}I3.className="GlorotNormal";pe(I3);class D3 extends vs{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return vs.className}}D3.className="HeNormal";pe(D3);class O3 extends vs{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return vs.className}}O3.className="HeUniform";pe(O3);class F3 extends vs{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return vs.className}}F3.className="LeCunNormal";pe(F3);class R3 extends vs{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return vs.className}}R3.className="LeCunUniform";pe(R3);class m7 extends Ba{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,n){return K(()=>{if(t.length<2)throw new ht("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=ee(t.slice(0,-1)),i=t[t.length-1],s=r*i;s>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${s}) elements: Slowness may result.`);const o=[Math.max(i,r),Math.min(i,r)],a=T3(o,0,1,n,this.seed),u=k8.qr(a,!1);let l=u[0];const f=u[1].flatten().stridedSlice([0],[Math.min(i,r)*Math.min(i,r)],[Math.min(i,r)+1]);return l=U(l,f.sign()),r<i&&(l=l.transpose()),U(Ze(this.gain),l.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}m7.className="Orthogonal";pe(m7);const UK={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function WK(e,t={}){return iC(e,Co.getMap().classNameMap,t,"initializer")}function Ln(e){return o7(e)}function Dn(e){if(typeof e=="string"){const t=e in UK?UK[e]:e;if(t==="GlorotNormal")return new I3;if(t==="GlorotUniform")return new N3;if(t==="HeNormal")return new D3;if(t==="HeUniform")return new O3;if(t==="LeCunNormal")return new F3;if(t==="LeCunUniform")return new R3;{const n={};return n.className=t,n.config={},WK(n)}}else return e instanceof Ba?e:WK(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function R5(e){return Array.isArray(e)&&Array.isArray(e[0])}function KE(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function nt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new H(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function zt(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new H(`Expected exactly 1 Shape; got ${e.length}`)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YE(e){let t=0;for(const n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,i)=>r*i);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const VK="Variable";class Ule{constructor(t,n="float32",r=VK,i=!0,s=null){this.dtype=n??"float32",this.shape=t.shape,this.id=Fle(),r=r??VK,this.originalName=Mle(r),this.name=Ple(this.originalName),this.trainable_=i,this.constraint=s,this.val=b8(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),cPe(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function cPe(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function M5(e){return e.map(t=>t.read())}function g7(e){e.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fr{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Eu{constructor(t,n,r,i,s,o,a){this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=s,this.outputTensorIndex=a,this.id=Fle(),o!=null&&(this.originalName=Mle(o),this.name=Ple(this.originalName)),this.rank=n.length}}let fPe=0,M3=class{constructor(t,n){this.callArgs=n,this.id=fPe++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const r of t.inboundLayers)r!=null&&r.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},dPe=0;class St extends zm{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=dPe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const r=this.getClassName();n=fc(r)+"_"+E3(r)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let r;if(t.batchInputShape!=null)r=t.batchInputShape;else if(t.inputShape!=null){let s=null;t.batchSize!=null&&(s=t.batchSize),r=[s].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;i==null&&(i=t.inputDType),i==null&&(i="float32"),this.dtype=i}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new ga(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new H(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return ns(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return ns(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new rl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new rl(`Layer ${this.name} is not connected, no input to return.`);return ns(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new rl(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new rl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return ns(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const n=Zt(t);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=Zt(this.inputSpec);if(n.length!==r.length)throw new H(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${t}`);for(let i=0;i<n.length;i++){const s=n[i],o=r[i];if(o==null)continue;const a=s.rank;if(o.ndim!=null&&a!==o.ndim)throw new H(`Input ${i} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new H(`Input ${i} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new H(`Input ${i} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&s.dtype!==o.dtype)throw new H(`Input ${i} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${s.dtype}.`);if(o.axes){const u=s.shape;for(const l in o.axes){const c=Number(l),f=o.axes[l],d=c>=0?u[c]:u[u.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new H(`Input ${i} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${f} but got shape ${u}.`)}}if(o.shape!=null)for(let u=0;u<o.shape.length;++u){const l=o.shape[u],c=s.shape[u];if(l!=null&&c!=null&&l!==c)throw new H(`Input ${i} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${s.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const r=Zt(t),i=mPe(t),s=gPe(t);if(i===s)throw new H("Arguments to apply() must be all SymbolicTensors or all Tensors");return Cp(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const o=[];for(const a of Zt(t))o.push(a.shape);this.build(ns(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let o=this.call(t,n);this.supportsMasking&&this.setMaskMetadata(t,o);const a=Zt(o),u=[];for(let l of a)r.indexOf(l)!==-1&&(l=l.clone()),u.push(l);if(o=ns(u),this.activityRegularizer!=null)throw new ht("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=hPe(t),a=this.computeOutputShape(o);let u;const l=pPe(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?u=a.map((c,f)=>new Eu(l,c,this,Zt(t),n,this.name,f)):u=new Eu(l,a,this,Zt(t),n,this.name),this.addInboundNode(t,u,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new ht("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return u}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,i)=>{r!=null&&t[i]!=null&&t[i]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new rl(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);t.indexOf(r)===-1&&t.push(r)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new rl(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ga(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return YE(this.weights)}build(t){this.built=!0}getWeights(t=!1){return M5(t?this.trainableWeights:this.weights)}setWeights(t){K(()=>{const n=this.weights;if(n.length!==t.length)throw new H(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const r=[],i=M5(n);for(let s=0;s<i.length;++s){const o=i[s],a=n[s],u=t[s];if(!$t(o.shape,u.shape))throw new H(`Layer weight shape ${o.shape} not compatible with provided weight shape ${u.shape}`);r.push([a,u])}g7(r)})}addWeight(t,n,r,i,s,o,a,u){if(this._addedWeightNames.indexOf(t)!==-1)throw new H(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(i=u!=null?u():Dn("zeros"));const l=i.apply(n,r),c=new Ule(l,r,t,o,a);return l.dispose(),s!=null&&this.addLoss(()=>s.apply(c.read())),o==null&&(o=!0),o?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=Zt(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(t,n,r){if(!this.supportsMasking)return;const i=this.computeMask(t,r),s=Zt(n),o=Zt(i);if(s.length!==o.length)throw new Error(`${this.name} outputs ${s.length} tensors but ${s.length} masks for those tensors`);for(let a=0;a<s.length;a++)s[a].kerasMask=o[a]}addInboundNode(t,n,r,i,s,o,a=null){const u=Zt(t);n=Zt(n),r=Zt(r),i=Zt(i),s=KE(s),o=KE(o);const l=[],c=[],f=[];for(const d of u)l.push(d.sourceLayer),c.push(d.nodeIndex),f.push(d.tensorIndex);new M3({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:f,inputTensors:u,outputTensors:n,inputMasks:r,outputMasks:i,inputShapes:s,outputShapes:o},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function hPe(e){e=Zt(e);const t=[];for(const n of e)t.push(n.shape);return ns(t)}function pPe(e){return"float32"}function Wle(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{const r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const i=[];for(let s=0;s<r.inboundLayers.length;s++){const o=r.inputTensors[s],a=r.inboundLayers[s],u=r.nodeIndices[s],l=Wle(o,a,u);for(const c of l)i.indexOf(c)===-1&&i.push(c)}return i}}}function mPe(e){let t=!0;for(const n of Zt(e))if(!(n instanceof Eu)){t=!1;break}return t}function gPe(e){let t=!0;for(const n of Zt(e))if(n instanceof Eu){t=!1;break}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class By extends St{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:E3("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new H("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new H("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new H("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=t.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const i=new Eu(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new M3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new H(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}By.className="InputLayer";pe(By);function Vle(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new H("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new By({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yPe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return Ce(t,e.dtype)}catch{throw new H(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}class Hf{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Hf)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=yPe(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new H(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Eu){if(this.id2Value[t.id]==null)throw new H(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new H(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof Eu){if(this.id2Value[t.id]==null)throw new H(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new H(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&at(this.id2Mask)}}const ZE=new Ile,QE=new Ile;function bPe(e){ZE!=null&&ZE.setMaxEntries(e),QE!=null&&QE.setMaxEntries(e)}function Lv(e,t,n,r){const i=n==null?!1:n.training,s=Array.isArray(e),o=s?e:[e],a=o.map(p=>p.name),u=[],l=t.names();for(const p of a)l.indexOf(p)!==-1?u.push(t.getValue(p)):u.push(null);const c=a.join(",")+"|"+t.names().sort().join(",");let f=ZE.get(c),d;if(f==null){const p=vPe(o,t);f=p.sorted,d=p.recipientCounts,ZE.put(c,f),QE.put(c,d)}d={},i||Object.assign(d,QE.get(c));const h=new Hf(t);for(let p=0;p<f.length;++p){const m=f[p],g=m.sourceLayer;if(g instanceof By)continue;const y=[],b=[],v=[];let x=!1;for(const E of m.inputs){const _=h.getValue(E),T=h.getMask(E);y.push(_),b.push(T),T!=null&&(x=!0),i||(d[E.name]--,d[E.name]===0&&!t.hasKey(E)&&a.indexOf(E.name)===-1&&!_.isDisposed&&E.sourceLayer.stateful!==!0&&v.push(_))}x&&(n=n||{},n.mask=b[0]);const w=Zt(g.apply(y,n));let S=null;g.supportsMasking&&(S=g.computeMask(y,b));const C=wPe(m),k=Array.isArray(C)?C:[C];for(let E=0;E<k.length;++E){h.hasKey(k[E])||h.add(k[E],w[E],Array.isArray(S)?S[0]:S);const _=a.indexOf(k[E].name);_!==-1&&(u[_]=w[E])}i||at(v)}return h.disposeMasks(),s?u:u[0]}function vPe(e,t){A(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){const i=jK(e[0],t);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of e){const{sorted:o,recipientMap:a}=jK(s,t);for(const u of o)i.has(u.name)||(n.push(u),i.add(u.name));for(const u in a)r[u]==null&&(r[u]=new Set),a[u].forEach(l=>r[u].add(l))}}return{sorted:n,recipientCounts:xPe(r)}}function xPe(e){const t={};for(const n in e)t[n]=e[n].size;return t}function jK(e,t){const n=new Set,r=[],i={};for(const a of t.names())n.add(a);const s=[],o=[];for(s.push(e);s.length>0;){const a=s[s.length-1];if(n.has(a.name)){s.pop();continue}const u=o[o.length-1]===s.length-1;if(a.inputs.length===0||u)s.pop(),r.push(a),n.add(a.name),u&&o.pop();else{o.push(s.length-1);for(const l of a.inputs)i[l.name]==null&&(i[l.name]=new Set),i[l.name].add(a.name),!n.has(l.name)&&s.push(l)}}return{sorted:r,recipientMap:i}}function wPe(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(const i of e.sourceLayer.inboundNodes[r].outputTensors)if(i.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SPe=Y();SPe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,bPe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function y7(e,t){return K(()=>Or(Le(U(e,e),t,!0)))}class uC extends zm{getConfig(){return{}}}class b7 extends uC{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return K(()=>{const n=y7(t,this.axis),r=ys(n,0,this.maxValue);return U(t,Ue(r,de(wr(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}b7.className="MaxNorm";pe(b7);class v7 extends uC{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return K(()=>Ue(t,de(wr(),y7(t,this.axis))))}getConfig(){return{axis:this.axis}}}v7.className="UnitNorm";pe(v7);class x7 extends uC{apply(t){return Fu(t)}}x7.className="NonNeg";pe(x7);class w7 extends uC{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return K(()=>{const n=y7(t,this.axis),r=de(U(this.rate,ys(n,this.minValue,this.maxValue)),U(1-this.rate,n));return U(t,Ue(r,de(wr(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}w7.className="MinMaxNorm";pe(w7);const HK={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Cr(e){return o7(e)}function GK(e,t={}){return iC(e,Co.getMap().classNameMap,t,"constraint")}function kr(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in HK?HK[e]:e,config:{}};return GK(n)}else return e instanceof uC?e:GK(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CPe(e){return new b7(e)}function kPe(e){return new v7(e)}function $Pe(){return new x7}function _Pe(e){return new w7(e)}const EPe=Object.freeze(Object.defineProperty({__proto__:null,maxNorm:CPe,minMaxNorm:_Pe,nonNeg:$Pe,unitNorm:kPe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function TPe(){return new l7}function APe(){return new A3}function NPe(e){return new c7(e)}function IPe(e){return new f7(e)}function DPe(e){return new d7(e)}function OPe(e){return new h7(e)}function FPe(e){return new p7(e)}function RPe(e){return new vs(e)}function MPe(e){return new N3(e)}function PPe(e){return new I3(e)}function LPe(e){return new D3(e)}function zPe(e){return new O3(e)}function BPe(e){return new F3(e)}function UPe(e){return new R3(e)}function WPe(e){return new m7(e)}const VPe=Object.freeze(Object.defineProperty({__proto__:null,constant:NPe,glorotNormal:PPe,glorotUniform:MPe,heNormal:LPe,heUniform:zPe,identity:FPe,leCunNormal:BPe,leCunUniform:UPe,ones:APe,orthogonal:WPe,randomNormal:DPe,randomUniform:IPe,truncatedNormal:OPe,varianceScaling:RPe,zeros:TPe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function If(e){if(e==null)return;const t=[],n=[],r=[];for(const i in e){const s=e[i];if(typeof s!="number"){const o=s;t.push(o.data()),n.push(i),r.push(o)}}if(t.length>0){const i=await Promise.all(t);for(let s=0;s<i.length;++s)e[n[s]]=i[s][0];at(r)}}function jle(e){if(e!=null)for(const t in e){const n=e[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var qK;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(qK||(qK={}));const jPe=125;class X0{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class Hle{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class HPe extends X0{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const i in n){const s=n[i];if(typeof s=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+s*r;else{let o;i in this.totals?o=this.totals[i]:this.totals[i]=0;const a=K(()=>de(this.totals[i],U(s,r)));this.totals[i]=a,o!=null&&o.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:K(()=>{const i=U(Ue(1,this.seen),this.totals[r]);n[r]=i,this.totals[r].dispose(),xr(n[r])}))}}class Gle extends X0{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const t=[],n=[],r=[];for(const s in this.history){const o=this.history[s];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const u=o[a];t.push(u.data()),n.push(s),r.push(a)}}const i=await Promise.all(t);for(let s=0;s<i.length;++s)this.history[n[s]][r[s]].dispose(),this.history[n[s]][r[s]]=i[s][0]}}class qle extends X0{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||z8,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=jPe),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");zE(this.yieldEvery)&&(this.maybeWait=W5e(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,r){const i=[];this.yield!=null&&(await If(r),i.push(this.yield(t,n,r))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await If(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const r=[];this.epochEnd!=null&&(await If(n),r.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(t,n){this.batchBegin!=null&&(await If(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const r=[];this.batchEnd!=null&&(await If(n),r.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):zE(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(r)}async onTrainBegin(t){this.trainBegin!=null&&(await If(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await If(t),await this.trainEnd(t))}}function Xle(e,t){return e==null&&(e={}),e instanceof X0?[e]:Array.isArray(e)&&e[0]instanceof X0?e:Zt(e).map(r=>new qle(r,t))}class yo{constructor(){}static registerCallbackConstructor(t,n){A(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),yo.checkForDuplicate(n),yo.constructors[t]==null&&(yo.constructors[t]=[]),yo.constructors[t].push(n)}static checkForDuplicate(t){for(const n in yo.constructors)yo.constructors[+n].forEach(i=>{if(i===t)throw new H("Duplicate callback constructor.")})}static clear(){yo.constructors={}}static createCallbacks(t){const n=[];for(const r in yo.constructors){const i=+r;t>=i&&n.push(...yo.constructors[i])}return n.map(r=>new r)}}yo.constructors={};function Kle(e,t,n,r,i,s,o,a,u){const l=new Gle,c=[new HPe,...yo.createCallbacks(t)];e!=null&&c.push(...e),c.push(l);const f=new Hle(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:s,batchSize:o,verbose:t,doValidation:a,metrics:u}),{callbackList:f,history:l}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gu(e,t={},n=!1){return iC(e,Co.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JE(e,t){return K(()=>{e.dtype!=="float32"&&(e=Ce(e,"float32"));const n=Le(oC(e),t,!0),r=Rm(n.shape,wr()),i=Or(Vl(n,r));return Ue(e,i)})}function Um(e,t){return K(()=>Pn(oC(Re(t,e)),-1))}function P3(e,t){return K(()=>Pn(ar(Re(t,e)),-1))}function Uy(e,t){return K(()=>{const n=Re(e,t),r=ys(ar(e),wr(),Number.MAX_VALUE),i=ar(Ue(n,r));return U(100,Pn(i,-1))})}function GPe(e,t){return K(()=>{const n=ys(t,wr(),Number.MAX_VALUE),r=to(de(1,n)),i=ys(e,wr(),Number.MAX_VALUE),s=to(de(1,i));return Pn(oC(Re(r,s)),-1)})}function qPe(e,t){return K(()=>{const n=Vl(0,Re(1,U(e,t)));return Pn(oC(n),-1)})}function XPe(e,t){return K(()=>{const n=Vl(0,Re(1,U(e,t)));return Pn(n,-1)})}function KPe(e,t){return K(()=>{const n=Le(U(e,t),-1),r=Lo(U(Re(1,e),t),-1);return Vl(0,de(1,Re(r,n)))})}function YPe(e,t){return K(()=>{const n=Math.log(2),r=Re(t,e),i=Re(de(r,Mm(U(-2,r))),n);return Pn(i,-1)})}function Iw(e,t,n=!1){return K(()=>{if(n)t=QS(t);else{const r=Le(t,t.shape.length-1,!0);t=Ue(t,r)}return t=ys(t,wr(),1-wr()),yn(Le(U(Ce(e,"float32"),to(t)),t.shape.length-1))})}function eT(e,t,n=!1){return K(()=>{const r=Ce(My(ePe(e)),"int32");t=ys(t,wr(),1-wr());const i=t.shape,s=j(V0(r,i[i.length-1]),i);return Iw(s,t,n)})}function ZPe(e,t){if(!$t(e.shape,t.shape))throw new H(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return K(()=>{const n=Fu(t),r=yn(ar(t));return de(Re(n,U(t,e)),VS(bs(r)))})}function L3(e,t){return K(()=>{let n;return n=ys(t,wr(),1-wr()),n=to(Ue(n,Re(1,n))),Pn(ZPe(e,n),-1)})}function QPe(e,t){return K(()=>{const n=ys(e,wr(),1),r=ys(t,wr(),1);return Le(U(e,to(Ue(n,r))),-1)})}function JPe(e,t){return K(()=>{const n=to(de(wr(),t));return Pn(Re(t,U(e,n)),-1)})}function S7(e,t){return K(()=>{const n=JE(e,-1),r=JE(t,-1),i=U(n,r);return yn(Le(i,-1))})}const tT={meanSquaredError:Um,meanAbsoluteError:P3,meanAbsolutePercentageError:Uy,meanSquaredLogarithmicError:GPe,squaredHinge:qPe,hinge:XPe,categoricalHinge:KPe,logcosh:YPe,categoricalCrossentropy:Iw,sparseCategoricalCrossentropy:eT,binaryCrossentropy:L3,kullbackLeiblerDivergence:QPe,poisson:JPe,cosineProximity:S7};function vR(e){if(typeof e=="string"){if(e in tT)return tT[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new H(t)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function C7(e,t){return K(()=>{const n=U(.5,no(t)),r=vl(Ki(t,n),e.dtype);return Pn(eo(e,r),-1)})}function k7(e,t){return K(()=>vl(eo(Wp(e,-1),Wp(t,-1)),"float32"))}function Yle(e,t){return K(()=>Ce(Le(Oa(eo(e,1),eo(t,1))),"float32"))}function eLe(e,t){return K(()=>Ce(Le(Oa(eo(e,1),eo(t,0))),"float32"))}function tLe(e,t){return K(()=>Ce(Le(Oa(eo(e,0),eo(t,1))),"float32"))}function Zle(e,t){return K(()=>{const n=Yle(e,t),r=tLe(e,t),i=de(n,r);return Ce(Ir(Ki(i,0),Ue(n,i),0),"float32")})}function nLe(e,t){return K(()=>{const n=Yle(e,t),r=eLe(e,t),i=de(n,r);return Ce(Ir(Ki(i,0),Ue(n,i),0),"float32")})}function Qle(e,t){return L3(e,t)}function Jle(e,t){return e.rank===t.rank&&(e=eh(e,[e.rank-1])),t=Wp(t,-1),t.dtype!==e.dtype&&(t=Ce(t,e.dtype)),Ce(eo(e,t),"float32")}const rLe=Um,iLe=Um,sLe=P3,oLe=P3,aLe=Uy,uLe=Uy,$7=Iw,lLe=S7,ece=eT,nT={binaryAccuracy:C7,categoricalAccuracy:k7,precision:Zle,categoricalCrossentropy:$7,sparseCategoricalCrossentropy:ece,mse:rLe,MSE:iLe,mae:sLe,MAE:oLe,mape:aLe,MAPE:uLe,cosine:lLe};function cLe(e){if(typeof e=="string"&&e in nT)return nT[e];if(typeof e!="string"&&e!=null)return e;throw new H(`Unknown metric ${e}`)}function i$(e){if(il(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(const n of Object.keys(tT))if(tT[n]===e){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(nT))if(nT[n]===e){t=n;break}return t!==void 0?t:e.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fLe(e){const t={Adagrad:()=>Ff.adagrad(.01),Adadelta:()=>Ff.adadelta(1,.95,wr()),Adam:()=>Ff.adam(.001,.9,.999,wr()),Adamax:()=>Ff.adamax(.002,.9,.999,wr(),0),RMSProp:()=>Ff.rmsprop(.001,.9,0,wr()),SGD:()=>Ff.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new H(`Unknown Optimizer ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const XK=1*1024*1024;function KK(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!P5(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(e);r.length>XK&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${XK}.`)}}function P5(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t)if(typeof n!="string"||!P5(e[n]))return!1;return!0}else if(Array.isArray(e)){for(const t of e)if(!P5(t))return!1;return!0}else return!1;else{const t=typeof e;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dLe(e,t,n,r=console.log){const i=pLe(e),s=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(t*c)));let o;if(!i){s.push("Receives inputs"),o=[];for(const c in e.nodesByDepth)o.push(...e.nodesByDepth[c])}r("_".repeat(t)),rT(s,n,r),r("=".repeat(t));const a=e.layers;for(let c=0;c<a.length;++c)i?mLe(a[c],n,r):gLe(a[c],n,o,r),r((c===a.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const u=hLe(e),l=YE(e.nonTrainableWeights);r(`Total params: ${u+l}`),r(`Trainable params: ${u}`),r(`Non-trainable params: ${l}`),r("_".repeat(t))}function hLe(e){let t;return e.collectedTrainableWeights!=null?t=YE(e.collectedTrainableWeights):t=YE(e.trainableWeights),t}function pLe(e){let t=!0;const n=[],r=[];for(const i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(const i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of e.layers){let s=!1;for(const o of i.inboundNodes)if(r.indexOf(o)!==-1)if(s){t=!1;break}else s=!0;if(!t)break}return t}function rT(e,t,n=console.log){let r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function mLe(e,t,n){let r,i;try{i=e.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}const s=e.name,o=e.getClassName(),a=[`${s} (${o})`,i,r,e.countParams().toString()];rT(a,t,n)}function gLe(e,t,n,r){let i,s;try{s=e.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{s="multiple"}try{i=JSON.stringify(e.outputShape)}catch{i="multiple"}const o=[];for(const f of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let d=0;d<f.inboundLayers.length;++d){const h=f.inboundLayers[d].name,p=f.nodeIndices[d],m=f.tensorIndices[d];o.push(`${h}[${p}][${m}]`)}const a=e.name,u=e.getClassName(),l=o.length===0?"":o[0],c=[`${a} (${u})`,s,i,e.countParams().toString(),l];rT(c,t,r);for(let f=1;f<o.length;++f)rT(["","","","",o[f]],t,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tce(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function Dw(e,t){if(e===null)return null;if(typeof e=="string")return tp(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];tce(t,i,s)?n.push(s):n.push(Dw(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r];if(r==="name"&&typeof i=="string")n[r]=i;else{const s=tp(r);n[s]=Dw(i,s)}}return n}}function L5(e,t){if(e==null)return null;if(typeof e=="string")return fc(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];tce(t,i,s)?n.push(s):n.push(L5(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r],s=fc(r);(r==="name"||r==="className")&&typeof i=="string"?n[s]=i:n[s]=L5(i,r)}return n}}/** @license See the LICENSE file. */const z3="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const yLe=e=>{const t=Object.keys(e);if(t.length===0)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Za extends St{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=E3(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],dd(this.inputs).length!==this.inputs.length)throw new H(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);dd(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const v=b.sourceLayer,x=b.nodeIndex,w=b.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(x),this.outputLayersTensorIndices.push(w)}for(const b of this.inputs){const v=b.sourceLayer,x=b.nodeIndex,w=b.tensorIndex;il(x===0,"input layer has >1 nodes"),il(w===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(x),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const v=this.inputLayers[b];if(!(v instanceof By))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${b} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},r={},i={},s={},o={},a=[],u=(b,v,x,w,S,C)=>{(w==null||S==null||C==null)&&(w=b.sourceLayer,S=b.nodeIndex,C=b.tensorIndex);const k=w.inboundNodes[S];if(x.indexOf(k)!==-1)throw new ga(`The tensor ${b.name} at layer "${w.name}" is part of a cycle.`);if(v.indexOf(k)!==-1)return;this.containerNodes.add(Za.nodeKey(w,S)),w.id in o||(o[w.id]=Object.keys(o).length),x.indexOf(k)===-1&&x.push(k);const E=k.inboundLayers.length;for(let _=0;_<E;_++){const T=k.inputTensors[_],D=k.inboundLayers[_],O=k.nodeIndices[_],M=k.tensorIndices[_];u(T,v,x,D,O,M)}for(v.push(k);x.indexOf(k)>=0;)x.splice(x.indexOf(k),1);a.push(k)},l=[],c=[];for(const b of this.outputs)u(b,l,c);const f=a.slice().reverse();for(const b of f){r[b.id]=b,b.id in n||(n[b.id]=0);let v=n[b.id];const x=i[b.outboundLayer.id]==null?0:i[b.outboundLayer.id];v=Math.max(v,x),i[b.outboundLayer.id]=v,s[b.outboundLayer.id]=b.outboundLayer,n[b.id]=v;for(let w=0;w<b.inboundLayers.length;w++){const S=b.inboundLayers[w],C=b.nodeIndices[w],k=S.inboundNodes[C],E=n[k.id]==null?0:n[k.id];n[k.id]=Math.max(v+1,E),r[k.id]=k}}const d={};for(const b in n){const v=n[b];v in d||(d[v]=[]),d[v].push(r[b])}const h={};for(const b in i){const v=i[b];v in h||(h[v]=[]),h[v].push(s[b])}let p=Object.keys(h).map(b=>parseInt(b,10)).sort(t$);this.layers=[];for(const b of p){const v=h[b];v.sort((x,w)=>{const S=o[x.id],C=o[w.id];return S<C?-1:S>C?1:0});for(const x of v)x instanceof Za&&this.internalContainerRefs.push(x),this.layers.push(x)}this.layersByDepth=h,p=Object.keys(d).map(b=>parseInt(b,10)).sort(t$);const m=this.inputs.slice(),g=[];for(const b of p)for(const v of d[b]){const x=v.outboundLayer;if(x!=null){for(const w of v.inputTensors)if(m.indexOf(w)===-1)throw new ga(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${x.name}". The following previous layers were accessed without issue: ${g}`);for(const w of v.outputTensors)m.push(w);g.push(x.name)}}this.nodesByDepth=d;const y=this.layers.map(b=>b.name);for(const b of y){const v=y.filter(x=>x===b).length;if(v!==1)throw new ga(`The name "${b}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new M3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new H("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const r={};let i=0;const s=yLe(t);s&&this.parseWeights(t);for(const a of this.layers)for(const[u,l]of a.weights.entries()){const c=s?`${l.name.split("/").slice(0,-1).join("/")+"/"}${u}`:l.originalName;if(r[c]!=null)throw new H(`Duplicate weight name: ${c}`);r[c]=l,i++}const o=[];for(const a in t){let u=a;if(r[a]==null){const l=a.split("/");u=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(r[u]!=null)o.push([r[u],t[a]]);else if(n)throw new H(`Provided weight data has no target variable: ${a}`);delete r[u]}if(n){const a=[];for(const u in r)a.push(u);if(a.length>0)throw new H(`${a.length} of ${i} weights are not set: ${a}`)}g7(o)}parseWeights(t){for(const n in Object.keys(t)){const r=n.split("/"),i=["vars","layer_checkpoint_dependencies"],s=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!i.includes(o)).join("/");s!==n&&(t[s]=t[n],delete t[n])}}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${z3}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const r=L5(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return K(()=>{t=Zt(t);const r=new Hf;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return Lv(this.outputs,r,n)})}computeMask(t,n){return K(()=>{t=Zt(t);let r;return n==null?r=Xp(null,t.length):r=Zt(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const n=KE(t);if(n.length!==this.inputLayers.length)throw new H(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const u=this.inputLayers[a],l=n[a],c=u.name+"_0_0";r[c]=l}const i=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(t$);if(i.length>1)for(const a of i){const u=this.nodesByDepth[a];for(const l of u){const c=l.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(c.id)!==-1)continue;const f=[];for(let m=0;m<l.inboundLayers.length;m++){const g=l.inboundLayers[m],y=l.nodeIndices[m],b=l.tensorIndices[m],v=`${g.name}_${y}_${b}`,x=r[v];f.push(x)}const d=c.computeOutputShape(ns(f)),h=KE(d),p=c.inboundNodes.indexOf(l);for(let m=0;m<h.length;m++){const g=`${c.name}_${p}_${m}`;r[g]=h[m]}}}const s=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const u=this.outputLayers[a],l=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],f=`${u.name}_${l}_${c}`;o.push(f)}for(let a=0;a<o.length;a++){const u=o[a];il(u in r),s.push(r[u])}return ns(s)}runInternalGraph(t,n){n==null&&(n=Xp(null,t.length));const r={};for(let u=0;u<this.inputs.length;++u){const l=this.inputs[u],c=t[u],f=n[u];r[l.id]=[c,f]}const i=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(t$);for(const u of i){const l=this.nodesByDepth[u];for(const c of l){const f=c.outboundLayer,d=c.inputTensors,h=c.outputTensors,p=new Array;for(const m of d)m.id in r&&p.push(r[m.id]);if(p.length===d.length){let m={},g,y,b,v;if(c.callArgs!=null&&(m=c.callArgs),p.length===1){const[x,w]=p[0];m.mask==null&&(m.mask=w),b=Zt(f.call(x,m)),v=Zt(f.computeMask(x,w)),g=[x],y=[w]}else g=p.map(x=>x[0]),y=p.map(x=>x[1]),m.mask==null&&(m.mask=y),b=Zt(f.call(g,m)),v=Zt(f.computeMask(g,y));if(f.activityRegularizer)throw new ht("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let x=0;x<h.length;++x){const w=h[x],S=b[x],C=v[x];r[w.id]=[S,C]}}}}const s=[],o=[],a=[];for(const u of this.outputs){il(u.id in r,`Could not compute output ${u.name} : ${u.id}`);const[l,c]=r[u.id];a.push(l.shape),s.push(l),o.push(c)}return[s,o,a]}buildNodeConversionMap(t){const n={};let r;for(const i of this.layers){r=i instanceof Za?1:0;for(let s=0;s<i.inboundNodes.length;s++){const o=Za.nodeKey(i,s);this.containerNodes.has(o)&&(n[o]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new H("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const r of this.layers)if(r.name===t)return r;throw new H(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new H(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return K(()=>{const t=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const i=Za.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),u=o.getConfig(),l=[];for(let f=0;f<o.inboundNodes.length;f++){const d=o.inboundNodes[f],h=Za.nodeKey(o,f);let p={};if(this.containerNodes.has(h)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const m=[];for(let g=0;g<d.inboundLayers.length;g++){const y=d.inboundLayers[g],b=d.nodeIndices[g],v=d.tensorIndices[g],x=Za.nodeKey(y,b);let w=n[x];w==null&&(w=0),m.push([y.name,w,v,p])}l.push(m)}}}const c={};c.name=o.name,c.className=a,c.config=u,c.inboundNodes=l,r.push(c)}t.layers=r;const i=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],u=this.inputLayersNodeIndices[o],l=Za.nodeKey(a,u);if(!this.containerNodes.has(l))continue;let c=n[l];c==null&&(c=0);const f=this.inputLayersTensorIndices[o];i.push([a.name,c,f])}t.inputLayers=i;const s=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],u=this.outputLayersNodeIndices[o],l=Za.nodeKey(a,u);if(!this.containerNodes.has(l))continue;let c=n[l];c==null&&(c=0);const f=this.outputLayersTensorIndices[o];s.push([a.name,c,f])}return t.outputLayers=s,t}static fromConfig(t,n,r={},i=!1){const s={},o={};function a(g,y){g.name in o?o[g.name].push(y):o[g.name]=[y]}function u(g,y){const b=[];let v;for(const x of y){const w=x[0],S=x[1],C=x[2];if(v=x[3]==null?{}:x[3],!(w in s)){a(g,y);return}const k=s[w];if(k.inboundNodes.length<=S){a(g,y);return}const E=k.inboundNodes[S];b.push(E.outputTensors[C])}b.length>0&&g.apply(ns(b),v)}function l(g){const y=g.name,b=gu(g,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(i),s[y]=b,g.inboundNodes.forEach(x=>{if(!(x instanceof Array))throw new H(`Corrupted configuration, expected array for nodeData: ${x}`);a(b,x)})}const c=n.name,f=n.layers;for(const g of f)l(g);for(;!U5e(o);)for(const g of f){const y=s[g.name];if(y.name in o){const b=o[y.name];delete o[y.name];for(const v of b)u(y,v)}}const d=[],h=[],p=n.inputLayers;for(const g of p){const y=g[0],b=g[1],v=g[2];il(y in s);const w=s[y].inboundNodes[b].outputTensors;d.push(w[v])}const m=n.outputLayers;for(const g of m){const y=g[0],b=g[1],v=g[2];il(y in s);const w=s[y].inboundNodes[b].outputTensors;h.push(w[v])}return new t({inputs:d,outputs:h,name:c})}get stateful(){if(this._stateful)throw new H("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){K(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bLe(e,t,n){const r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(i=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){const i=[];return t.forEach(s=>{s in e?i.push(e[s]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function nce(e,t){return bLe(e,t,"classWeight")}async function rce(e,t,n,r){if(n!=null){const i=K(()=>{if(e.shape.length===1)return gl(e);if(e.shape.length===2){if(e.shape[1]>1)return Wp(e,1);if(e.shape[1]===1)return j(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await i.data());at(i);const o=[];return s.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),qr(o,"float32")}else return null}function vLe(e,t){return U(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const xLe=32;function ice(e,t){let n,r;const i=t;n=i.xs,r=i.ys,A(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const s=YK("input",e.inputNames,n),o=YK("output",e.outputNames,r),a=s[0].shape[0];A(s.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),A(o.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let u=0;u<s.length;u++)A(s[u].shape[0]===a,()=>`Batch size mismatch: input ${e.inputNames[u]} has ${s[u].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);for(let u=0;u<o.length;u++)A(o[u].shape[0]===a,()=>`Batch size mismatch: output ${e.outputNames[u]} has ${o[u].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);return{xs:s,ys:o}}function YK(e,t,n){if(n instanceof Rt)return[n];if(Array.isArray(n))return A(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{const r=[];for(const i of t){if(n[i]==null)throw new H(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function wLe(e){if(e.length===3)throw new ht("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function SLe(e,t,n){const r=n.batchesPerEpoch!=null;if(A(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),A(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),A(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),A(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),A(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const i=n.validationData!=null;let s,o;if(i)if(ZK(n.validationData))A(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=wLe(n.validationData);s=g.xs,o=g.ys}const a=e.makeTrainFunction(),u=e.getDedupedMetricsNames();let l;i?l=u.slice().concat(u.map(g=>"val_"+g)):l=u.slice();const c=Xle(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:d,history:h}=Kle(c,f,n.epochs,null,null,CLe(t,n),null,i,l);d.setModel(e),e.history=h,await d.onTrainBegin(),e.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await t.iterator();for(;p<n.epochs;){const g={};await d.onEpochBegin(p);let y=0,b=0;for(r||(m=await t.iterator());!r||y<n.batchesPerEpoch;){const v=await m.next();if(r&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){const{xs:x,ys:w}=ice(e,v.value),S={};S.batch=b,S.size=x[0].shape[0],await d.onBatchBegin(b,S);const C=[];if(n.classWeight!=null){const _=nce(n.classWeight,e.outputNames);for(let T=0;T<_.length;++T)C.push(await rce(w[T],null,_[T]))}const k=x.concat(w).concat(C),E=a(k);at(k);for(let _=0;_<u.length;++_){const T=u[_],D=E[_];S[T]=D,xr(D)}await d.onBatchEnd(b,S),jle(S),b++,y++}if(r?y>=n.batchesPerEpoch:v.done){if(i){let x;ZK(n.validationData)?x=Zt(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=Zt(e.evaluate(s,o,{batchSize:n.validationBatchSize==null?xLe:n.validationBatchSize,verbose:0}));for(let w=0;w<e.metricsNames.length;++w)g[`val_${e.metricsNames[w]}`]=x[w]}break}if(e.stopTraining_)break}if(await d.onEpochEnd(p,g),p++,e.stopTraining_)break}return await d.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function CLe(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function ZK(e){return typeof e.iterator=="function"}function kLe(e){return typeof e.next=="function"}async function $Le(e,t,n){n=n||{};const r=n.batches!=null,i=e.testFunction;let s=[];if(n.verbose>0)throw new ht("Verbose mode is not implemented yet.");A(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=kLe(t)?t:await t.iterator();let a=0,u=0;for(;!r||u<n.batches;){const l=await o.next();if(s=K(()=>{if(l.value){const{xs:c,ys:f}=ice(e,l.value),d=c.concat(f),h=K(()=>i(d));if(at(d),u===0)for(let m=0;m<h.length;++m)s.push(Ze(0));const p=d[0].shape[0];for(let m=0;m<h.length;++m){const g=h[m],y=s[m];s[m]=K(()=>de(s[m],U(p,g))),u>0&&at(y)}at(h),a+=p,++u}return s}),l.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let l=0;l<s.length;++l){const c=s[l];s[l]=Ue(s[l],a),at(c)}return ns(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xR(e){A(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function Kb(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>kp(r,t,n-t)):kp(e,t,n-t)}function z5(e,t){return K(()=>e==null?null:Array.isArray(e)?e.map(n=>z5(n,t)):zle(e,t.dtype==="int32"?t:Ce(t,"int32")))}function wR(e,t){const n=[];let r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function sce(e){const t=[];e instanceof Rt&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(r.rank===1)t.push(sC(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Xa(e,t){if(e==null)return;const n=[];if(t instanceof Rt)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(const i in t){const s=t[i];n.push(s.id)}const r=[];if(e instanceof Rt)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(e!=null)for(const i in e){const s=e[i];n.indexOf(s.id)===-1&&r.push(s)}r.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _Le(e){return e instanceof Rt}function B5(e){return Array.isArray(e)}function QK(e){return!_Le(e)&&!B5(e)}function JK(e,t,n,r=!0,i=""){if(t==null||t.length===0){if(e!=null){let o=!1;if(B5(e)&&e.length>0)o=!0;else if(QK(e)){for(const a in e)if(e.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new H(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(o=>null);let s;if(QK(e)){e=e,s=[];for(const o of t){if(e[o]==null)throw new H(`No data provided for "${o}". Need data for each key in: ${t}`);s.push(e[o])}}else if(B5(e)){if(e=e,e.length!==t.length)throw new H(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);s=e}else{if(e=e,t.length>1)throw new H(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);s=[e]}if(s=sce(s),n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const a=s[o];if(a.shape.length!==n[o].length)throw new H(`Error when checking ${i}: expected ${t[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let u=0;u<n[o].length;++u){if(u===0&&!r)continue;const l=a.shape[u],c=n[o][u];if(c!=null&&c>=0&&l!==c)throw new H(`${i} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${i} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return s}function ELe(e,t,n){const r=dd(e.map(s=>s.shape[0]));r.sort();const i=dd(t.map(s=>s.shape[0]));if(i.sort(),r.length>1)throw new H(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(i.length>1)throw new H(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&i.length>0&&!$t(r,i))throw new H(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function TLe(e,t,n){const r=[Um,L3,Iw];for(let i=0;i<e.length;++i){const s=e[i],o=t[i],a=n[i];if(o!=null){if(o===Iw&&s.shape[s.shape.length-1]===1)throw new H(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const u=s.shape.slice(1),l=a.slice(1);for(let c=0;c<u.length;++c){const f=u[c],d=l[c];if(d!=null&&f!==d)throw new H(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function eY(e,t,n,r=!0,i=""){let s;if(Array.isArray(e)){if(e.length!==t.length)throw new H(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);s=e}else{if(t.length>1)throw new H(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);s=[e]}if(n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const a=s[o];if(a.shape.length!==n[o].length)throw new H(`Error when checking ${i}: expected ${t[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let u=0;u<n[o].length;++u){if(u===0&&!r)continue;const l=a.shape[u],c=n[o][u];if(c!=null&&c!==l)throw new H(`Error when checking ${i}: expected ${t[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function ALe(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{const r=[];for(const i of t){let s=n.hasOwnProperty(i)?n[i]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}const NLe="layers-model";class Oc extends Za{constructor(t){super(t),this.isTraining=!1}summary(t,n,r=console.log){if(!this.built)throw new H("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");dLe(this,t,n,r)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=fLe(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof df))throw new H("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const o in t.loss)if(this.outputNames.indexOf(o)===-1)throw new H(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)t.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(vR(t.loss[o]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new H(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(a=>vR(a))}else{const o=vR(t.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],u=this.outputNames[o];this.feedOutputNames.push(u),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Cp("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const i=ALe(t.metrics,this.outputNames),s=(o,a,u)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([u,o])};Cp("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=i[o];(l=>{const c="";let f,d,h;for(const p of l){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[o];g[g.length-1]===1||this.lossFunctions[o]===L3?["accuracy","acc"].indexOf(p)!==-1?d=C7:["crossentropy","ce"].indexOf(p)!==-1&&(d=Qle):this.lossFunctions[o]===eT?["accuracy","acc"].indexOf(p)!==-1?d=Jle:["crossentropy","ce"].indexOf(p)!==-1&&(d=ece):["accuracy","acc"].indexOf(p)!==-1?d=k7:["crossentropy","ce"].indexOf(p)!==-1&&(d=$7);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),h=d,f=c+y}else h=cLe(p),f=c+i$(p);let m;Cp(f,()=>{m=h}),s(o,f,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,r={}){const i=r.batchSize==null?32:r.batchSize;xR(i);const o=this.standardizeUserDataXY(t,n,!0,i);try{const a=o[0].concat(o[1]);this.makeTestFunction();const u=this.testFunction,l=this.testLoop(u,a,i,r.verbose,r.steps);return ns(l)}finally{Xa(o[0],t),Xa(o[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),$Le(this,t,n)}checkNumSamples(t,n,r,i="steps"){let s;if(r!=null){if(s=null,n!=null)throw new H(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?s=t[0].shape[0]:s=t.shape[0];else throw new H(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return s}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new H("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),i=r?n:[n],s=this.retrieveSymbolicTensors(i),o=new Hf;if(t instanceof Rt&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new H(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let u=0;u<this.inputs.length;++u)o.add(this.inputs[u],t[u])}else for(const u of this.inputs){const l=t[u.name];if(l==null)throw new H(`No value is provided for the model's input ${u.name}`);o.add(u,l)}const a=Lv(s,o);return r?a:a[0]}retrieveSymbolicTensors(t){const n=Xp(null,t.length);let r=t.length;for(const i of this.layers){const s=Array.isArray(i.output)?i.output:[i.output],o=s.map(a=>a.name);for(let a=0;a<t.length;++a){const u=o.indexOf(t[a]);if(u!==-1&&(n[a]=s[u],r--),r===0)break}if(r===0)break}if(r>0){const i=[];throw n.forEach((s,o)=>{s==null&&i.push(t[o])}),new H(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return n}predictLoop(t,n=32,r=!1){return K(()=>{const i=this.checkNumSamples(t);if(r)throw new ht("Verbose predictLoop() is not implemented yet.");const s=wR(i,n),o=this.outputs.map(a=>[]);for(let a=0;a<s.length;++a)K(()=>{const l=s[a][0],c=s[a][1],f=Kb(t,l,c),d=[];if(Array.isArray(f))for(let p=0;p<f.length;++p)d.push({key:this.inputs[p],value:f[p]});else d.push({key:this.inputs[0],value:f});const h=new Hf(d);return Lv(this.outputs,h)}).forEach((l,c)=>o[c].push(l));return ns(o.map(a=>tr(a,0)))})}predict(t,n={}){const r=sce(t);eY(r,this.inputNames,this.feedInputShapes,!1);try{const i=n.batchSize==null?32:n.batchSize;return xR(i),this.predictLoop(r,i)}finally{Xa(r,t)}}predictOnBatch(t){eY(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,r=!0,i){if(this.optimizer_==null)throw new ga("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const s=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===eT?s.push(a.slice(0,a.length-1).concat([1])):s.push(a)}if(t=JK(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=JK(n,this.feedOutputNames,s,!1,"target"),ELe(t,n),TLe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&t[0].shape[0]%i!==0)throw new H(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,r,i,s=!0,o){const[a,u]=this.standardizeUserDataXY(t,n,s,o);if(r!=null)throw new Error("sample weight is not supported yet.");let l=null;if(i!=null){const c=nce(i,this.outputNames);l=[];for(let f=0;f<c.length;++f)l.push(await rce(u[f],null,c[f]))}return[a,u,l]}testLoop(t,n,r,i=0,s){return K(()=>{const o=this.checkNumSamples(n,r,s,"steps"),a=[];if(i>0)throw new ht("Verbose mode is not implemented yet.");if(s!=null)throw new ht("steps mode in testLoop() is not implemented yet");{const u=wR(o,r),l=qr($u(0,o));for(let c=0;c<u.length;++c){const f=u[c][0],d=u[c][1],h=kp(l,f,d-f),p=z5(n,h),m=t(p);if(c===0)for(let g=0;g<m.length;++g)a.push(Ze(0));for(let g=0;g<m.length;++g){const y=m[g];a[g]=de(a[g],U(d-f,y))}}for(let c=0;c<a.length;++c)a[c]=Ue(a[c],o)}return a})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let r=0;r<t.length;++r){const i=t[r];let s=i;if(LK(t,i)>1){const o=LK(t.slice(0,r),i);s+=`_${o}`}n.push(s)}return n}makeTrainFunction(){return t=>{const n=[],r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const f=[];for(let m=0;m<this.inputs.length;++m)f.push({key:this.inputs[m],value:r[m]});const d=new Hf(f),h=Lv(this.outputs,d,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let y=g(i[m],h[m]);s[m]!=null&&(y=vLe(y,s[m]));const b=Pn(y);n.push(b),m===0?p=y:p=de(p,y)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const y=this.metricsTensors[m][0],b=this.metricsTensors[m][1];g=Pn(y(i[b],h[b]))}xr(g),o.push(g)}return p=Pn(p),this.calculateLosses().forEach(m=>{p=de(p,m)}),p},u=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(a,!0,u)].concat(o)}}makeTestFunction(){this.testFunction=t=>K(()=>{const n=[];let r;const i=t.slice(0,this.inputs.length),s=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let l=0;l<this.inputs.length;++l)o.push({key:this.inputs[l],value:i[l]});const a=new Hf(o),u=Lv(this.outputs,a);for(let l=0;l<this.lossFunctions.length;++l){const c=this.lossFunctions[l],f=Pn(c(s[l],u[l]));l===0?r=f:r=de(r,f),n.push(r)}for(let l=0;l<this.metricsTensors.length;++l){const c=this.metricsTensors[l][0],f=this.metricsTensors[l][1],d=Pn(c(s[f],u[f]));n.push(d)}return n})}async fit(t,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let i,s,o,a,u,l,c,f,d;try{const h=r.batchSize==null?32:r.batchSize;xR(h);const m=await this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,!1,h);i=m[0],s=m[1],d=m[2];let g=!1,y;if(r.validationData!=null&&r.validationData.length>0){if(g=!0,r.validationData.length===2)u=r.validationData[0],l=r.validationData[1];else throw r.validationData.length===3?new ht("validationData including sample weights is not supported yet."):new H(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const _=await this.standardizeUserData(u,l,null,null,!0,h);c=_[0],f=_[1],y=c.concat(f)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){g=!0;const E=Math.floor(i[0].shape[0]*(1-r.validationSplit)),_=i[0].shape[0];c=Kb(i,E,_),o=i,i=Kb(i,0,E),f=Kb(s,E,_),a=s,s=Kb(s,0,E),y=c.concat(f)}else r.validationSteps!=null&&(g=!0);const b=i.concat(s).concat(d);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let w,S;g?(this.makeTestFunction(),w=this.testFunction,S=x.slice().concat(x.map(E=>"val_"+E))):(w=null,y=[],S=x.slice());const C=Xle(r.callbacks,r.yieldEvery);return await this.fitLoop(v,b,x,h,r.epochs,r.verbose,C,w,y,r.shuffle,S,r.initialEpoch,null,null)}finally{this.isTraining=!1,Xa(i,t),Xa(s,n),Xa(o,t),Xa(a,n),Xa(c,u),Xa(f,l),d!=null&&at(d)}}async fitLoop(t,n,r,i,s,o,a,u,l,c,f,d,h,p){i==null&&(i=32),s==null&&(s=1),c==null&&(c=!0),d==null&&(d=0);let m=!1;if(u!=null&&l!=null&&(m=!0),p!=null&&(m=!0,h==null))throw new H("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(n,i,h,"steps_per_epoch");let y;g!=null&&(y=$u(0,g)),o==null&&(o=1);const{callbackList:b,history:v}=Kle(a,o,s,d,g,h,i,m,f);b.setModel(this),this.history=v,await b.onTrainBegin(),this.stopTraining_=!1;for(let x=d;x<s;++x){await b.onEpochBegin(x);const w={};if(h!=null)throw new ht("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new ht("batch shuffling is not implemneted yet");c&&Zz(y);const S=qr(y),C=wR(g,i);for(let k=0;k<C.length;++k){const E={};if(await b.onBatchBegin(k,E),K(()=>{const _=C[k][0],T=C[k][1],D=kp(S,_,T-_);E.batch=k,E.size=T-_;const O=z5(n,D),M=t(O);for(let I=0;I<r.length;++I){const P=r[I],V=M[I];E[P]=V,xr(V)}if(k===C.length-1&&m){const I=this.testLoop(u,l,i);for(let P=0;P<r.length;++P){const V=r[P],F=I[P];xr(F),w["val_"+V]=F}}}),await b.onBatchEnd(k,E),jle(E),this.stopTraining_)break}S.dispose()}if(await b.onEpochEnd(x,w),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,n){return SLe(this,t,n)}async trainOnBatch(t,n){const r=await this.standardizeUserData(t,n),i=r[0],s=r[1],a=this.makeTrainFunction()(i.concat(s)),u=[];for(const l of a){const c=await l.data();u.push(c[0])}return at(a),Xa(r[0],t),Xa(r[1],n),ns(u)}getNamedWeights(t){const n=[],r=t!=null&&t.trainableOnly,i=r?this.trainableWeights:this.weights,s=this.getWeights(r);for(let o=0;o<i.length;++o)r&&!i[o].trainable||n.push({name:i[o].originalName,tensor:s[o]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=x5().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-x5().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=fc(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>fc(n))}else{const n=Object.keys(this.loss);t={};const r=this.loss;for(const i of n)if(typeof r[i]=="string")t[i]=fc(r[i]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[fc(i$(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>fc(i$(t)));{const t={};for(const n in this.metrics)t[n]=fc(i$(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Dw(t.optimizer_config),r=gu(n);let i;if(typeof t.loss=="string")i=tp(t.loss);else if(Array.isArray(t.loss))i=t.loss.map(o=>tp(o));else if(t.loss!=null){i={};for(const o in t.loss)i[o]=tp(t.loss[o])}let s;if(Array.isArray(t.metrics))s=t.metrics.map(o=>tp(o));else if(t.metrics!=null){s={};for(const o in t.metrics)s[o]=tp(t.metrics[o])}this.compile({loss:i,metrics:s,optimizer:r})}async save(t,n){if(typeof t=="string"){const l=Sae(t);if(l.length===0)throw new H(`Cannot find any save handlers for URL '${t}'`);if(l.length>1)throw new H(`Found more than one (${l.length}) save handlers for URL '${t}'`);t=l[0]}if(t.save==null)throw new H("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await w5(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:NLe,generatedBy:`TensorFlow.js tfjs-layers v${z3}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const l="optimizer",{data:c,specs:f}=await w5(await this.optimizer.getWeights(),l);r.specs.push(...f),r.data=xae([r.data,c])}return this.userDefinedMetadata!=null&&(KK(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,t.save(a)}setUserDefinedMetadata(t){KK(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}Oc.className="Model";pe(Oc);class oce extends Oc{}oce.className="Functional";pe(oce);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function ILe(e,t){"modelTopology"in e||(e={modelTopology:e}),e=e;let n=e.modelTopology;n.model_config!=null&&(n=n.model_config);const r=Dw(n),i=gu(r,t);if(e.weightsManifest!=null){const s=await Lue(e.weightsManifest,e.pathPrefix,i.weights.map(a=>a.originalName)),o={};for(const a of i.weights)o[a.originalName]=s[a.originalName];i.loadWeights(o),at(s)}return i}async function DLe(e,t){if(t==null&&(t={}),typeof e=="string"){const n=Cae(e,t);if(n.length===0)n.push(Uue(e,t));else if(n.length>1)throw new H(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return OLe(e,void 0,t)}async function OLe(e,t,n){if(n==null&&(n={}),e.load==null)throw new H("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await e.load();let i=r.modelTopology;i.model_config!=null&&(i=i.model_config);const s=n.strict==null?!0:n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&s,a=gu(Dw(i),t,o),u=r.trainingConfig;if(u!=null&&a.loadTrainingConfig(u),r.userDefinedMetadata!=null&&a.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new H("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:l,optimizerWeights:c}=FLe(r.weightData,r.weightSpecs);a.loadWeights(l,s),a.optimizer!=null&&c.length>0&&await a.optimizer.setWeights(c),at(l),at(c.map(f=>f.tensor))}return a}function FLe(e,t){const n=cB(e,t),r={},i=[];return t.forEach(s=>{s.group==="optimizer"?i.push({name:s.name,tensor:n[s.name]}):r[s.name]=n[s.name]}),{modelWeights:r,optimizerWeights:i}}let B3=class U5 extends Oc{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:E3("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new H(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof U5||t instanceof Oc;let r;if(n){if(r=t,r.outputs.length!==1)throw new H("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new H("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new H("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=Vle({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new H(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new H("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Wle(this.outputs[0])}this.inboundNodes=[],new M3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Xp(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(zt(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Oc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,r=console.log){this.built||this.build(),super.summary(t,n,r)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,r={}){if(!this.built)throw new ga("The model needs to be compiled before being used.");return this.model.evaluate(t,n,r)}async evaluateDataset(t,n){if(!this.built)throw new ga("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,r={}){if(!this.built)throw new ga("The model needs to be compiled before being used.");return this.model.fit(t,n,r)}async fitDataset(t,n){if(!this.built)throw new ga("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,r={},i=!1){let s,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new H("Legacy serialization format not supported yet.");s=n}else A(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=n.layers,delete n.layers,o=n;const a=new t(o);if(!(a instanceof U5))throw new ht(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const u of s){const c=gu(u,void 0,i);i&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(t){if(this.model==null)throw new H("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new H("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),t.push(r)}return{name:this.name,layers:t}}};B3.className="Sequential";pe(B3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RLe(e){return new Oc(e)}function ace(e){return new B3(e)}function uce(e){return Vle(e)}function MLe(e,t){yo.registerCallbackConstructor(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let xi=class extends zm{getConfig(){return{}}};class lce extends xi{apply(t,n=1){return nPe(t,n)}}lce.className="elu";pe(lce);class cce extends xi{apply(t){return n3(t)}}cce.className="selu";pe(cce);class fce extends xi{apply(t){return Fu(t)}}fce.className="relu";pe(fce);class dce extends xi{apply(t){return K(()=>Ed(6,Fu(t)))}}dce.className="relu6";pe(dce);let hce=class extends xi{apply(t){return t}};hce.className="linear";pe(hce);class pce extends xi{apply(t){return mu(t)}}pce.className="sigmoid";pe(pce);class mce extends xi{apply(t){return iPe(t)}}mce.className="hardSigmoid";pe(mce);class gce extends xi{apply(t){return Mm(t)}}gce.className="softplus";pe(gce);class yce extends xi{apply(t){return rPe(t)}}yce.className="softsign";pe(yce);class bce extends xi{apply(t){return _d(t)}}bce.className="tanh";pe(bce);let _7=class extends xi{apply(t,n=-1){return QS(t,n)}};_7.className="softmax";pe(_7);class vce extends xi{apply(t,n=-1){return KI(t,n)}}vce.className="logSoftmax";pe(vce);class xce extends xi{apply(t){return K(()=>K(()=>{const n=Math.sqrt(2),r=U(.5,de(1,GI(Ue(t,n))));return U(t,r)}))}}xce.className="gelu";pe(xce);class wce extends xi{apply(t){return K(()=>U(.5,U(t,de(1,_d(U(Or(Ue(2,Math.PI)),de(t,U(.044715,Il(t,3)))))))))}}wce.className="gelu_new";pe(wce);class Sce extends xi{apply(t){return K(()=>U(t,_d(Mm(t))))}}Sce.className="mish";pe(Sce);class Cce extends xi{apply(t,n=1){return K(()=>U(mu(U(t,n)),t))}}Cce.className="swish";pe(Cce);function Ad(e){return e.getClassName()}function SR(e,t={}){return iC(e,Co.getMap().classNameMap,t,"activation")}function Nd(e){if(e==null){const t={};return t.className="linear",t.config={},SR(t)}if(typeof e=="string"){const t={};return t.className=e,t.config={},SR(t)}else return e instanceof xi?e:SR(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function E7(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}class kce extends zm{}class lC extends kce{constructor(t){super(),E7(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return K(()=>{let n=lr([1]);return this.hasL1&&(n=de(n,Le(U(this.l1,ar(t))))),this.hasL2&&(n=de(n,Le(U(this.l2,oC(t))))),j(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}lC.className="L1L2";pe(lC);function PLe(e){return E7(e),new lC({l1:e!=null?e.l1:null,l2:0})}function LLe(e){return E7(e),new lC({l2:e!=null?e.l2:null,l1:0})}const tY={l1l2:"L1L2"};function cn(e){return o7(e)}function nY(e,t={}){return iC(e,Co.getMap().classNameMap,t,"regularizer")}function On(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in tY?tY[e]:e,config:{}};return nY(n)}else return e instanceof kce?e:nY(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class T7 extends St{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=nt(t);let r=Fu(t);return this.maxValue!=null&&(r=ys(r,0,this.maxValue)),r}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}T7.className="ReLU";pe(T7);class A7 extends St{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=nt(t);return WS(r,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}A7.className="LeakyReLU";pe(A7);class N7 extends St{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Dn(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=On(t.alphaRegularizer),this.alphaConstraint=kr(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new H(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=zt(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)n[i-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let i=1;i<t.length;++i)r[i]=t[i];this.inputSpec=[new fr({ndim:t.length,axes:r})],this.built=!0}call(t,n){return t=nt(t),KS(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Ln(this.alphaInitializer),alphaRegularizer:cn(this.alphaRegularizer),alphaConstraint:Cr(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}N7.className="PReLU";pe(N7);let I7=class extends St{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new ht(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=nt(t);return Fy(r)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}};I7.className="ELU";pe(I7);class D7 extends St{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const r=nt(t);return U(r,Ce(Ki(r,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}D7.className="ThresholdedReLU";pe(D7);class O7 extends St{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new _7().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){return K(()=>{let r=nt(t);const i=n.mask;if(i!=null){const s=U(Re(ls(r.shape),Ce(i,r.dtype)),Ze(-1e9));r=de(r,s)}return this.axis instanceof Array?this.axis.length>1?bs(Re(r,jS(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}O7.className="Softmax";pe(O7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function g0(e,t,n){if(typeof e=="number")return Xp(e,t);if(e.length!==t)throw new H(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){const i=e[r];if(!Q5e(i))throw new H(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function yu(e,t,n,r,i=1){if(e==null)return e;const s=t+(t-1)*(i-1);let o;return n==="same"?o=e:o=e-s+1,Math.floor((o+r-1)/r)}function sl(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+Td([n-t,0]);else if(r==="same")e=e*t;else throw new H(`Unsupport padding mode: ${r}.`);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function F7(e,t){return K(()=>(sr(t),t==="channelsFirst"?Tt(e,[0,2,3,1]):e))}function $ce(e,t){return K(()=>(sr(t),t==="channelsFirst"?Tt(e,[0,2,3,4,1]):e))}function zLe(e,t,n,r=1,i="valid",s,o=1){return K(()=>{if(s==null&&(s=_u()),sr(s),e.shape.length!==3)throw new H(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new H(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new H(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(s==="channelsFirst"&&(e=Tt(e,[0,2,1])),i==="causal")throw new ht("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=WI(e,t,r,i==="same"?"same":"valid","NWC",o);return n!=null&&(a=Ru(a,n)),a})}function rY(e,t,n,r=[1,1],i="valid",s,o,a=null){return K(()=>{if(s==null&&(s=_u()),sr(s),e.rank!==3&&e.rank!==4)throw new H(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new H(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let u=F7(e,s);if(i==="causal")throw new ht("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=kue({x:u,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),s==="channelsFirst"&&(u=Tt(u,[0,3,1,2])),u})}function BLe(e,t,n,r=[1,1,1],i="valid",s,o){return K(()=>{if(s==null&&(s=_u()),sr(s),e.rank!==4&&e.rank!==5)throw new H(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new H(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let a=$ce(e,s);if(i==="causal")throw new ht("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=RB(a,t,r,i==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Ru(a,n)),s==="channelsFirst"&&(a=Tt(a,[0,4,1,2,3])),a})}class U3 extends St{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",U3.verifyArgs(n),this.rank=t,Nr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new ht(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=g0(n.kernelSize,t,"kernelSize"),this.strides=g0(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,qo(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,sr(this.dataFormat),this.activation=Nd(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Dn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=kr(n.biasConstraint),this.biasRegularizer=On(n.biasRegularizer),this.activityRegularizer=On(n.activityRegularizer),this.dilationRate=g0(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new H(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new H(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new H(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(il("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!a7(t.kernelSize,"number",1,3))throw new H(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ad(this.activation),useBias:this.useBias,biasInitializer:Ln(this.biasInitializer),biasRegularizer:cn(this.biasRegularizer),activityRegularizer:cn(this.activityRegularizer),biasConstraint:Cr(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class Wy extends U3{constructor(t,n){super(t,n),this.kernel=null,Wy.verifyArgs(n),this.filters=n.filters,Nr(this.filters,"filters"),this.kernelInitializer=Dn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=kr(n.kernelConstraint),this.kernelRegularizer=On(n.kernelRegularizer)}build(t){t=zt(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new H(`The channel dimension of the input should be defined. Found ${t[n]}`);const r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return K(()=>{t=nt(t);let r;const i=this.bias==null?null:this.bias.read(),s=Ole(this.activation.getClassName());if(s!=null&&this.rank===2)r=rY(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=zLe(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=rY(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=BLe(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new ht("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=zt(t);const n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){const o=yu(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);n.push(o)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Ln(this.kernelInitializer),kernelRegularizer:cn(this.kernelRegularizer),kernelConstraint:Cr(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new H(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class Vy extends Wy{constructor(t){super(2,t),Vy.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!a7(t.kernelSize,"number",1,2))throw new H(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}Vy.className="Conv2D";pe(Vy);class jy extends Wy{constructor(t){super(3,t),jy.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new H(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}jy.className="Conv3D";pe(jy);class R7 extends Vy{constructor(t){if(super(t),this.inputSpec=[new fr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new H(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=zt(t),t.length!==4)throw new H("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new H("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new fr({ndim:4,axes:{[n]:r}})],this.built=!0}call(t,n){return K(()=>{let r=nt(t);if(r.shape.length!==4)throw new H(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const u=i[o],l=i[a],c=this.kernelSize[0],f=this.kernelSize[1],d=this.strides[0],h=this.strides[1],p=sl(u,d,c,this.padding),m=sl(l,h,f,this.padding),g=[s,p,m,this.filters];this.dataFormat!=="channelsLast"&&(r=Tt(r,[0,2,3,1]));let y=VI(r,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=Tt(y,[0,3,1,2])),this.bias!=null&&(y=Ru(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(t){t=zt(t);const n=t.slice();let r,i,s;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3):(r=3,i=1,s=2);const o=this.kernelSize[0],a=this.kernelSize[1],u=this.strides[0],l=this.strides[1];return n[r]=this.filters,n[i]=sl(n[i],u,o,this.padding),n[s]=sl(n[s],l,a,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}R7.className="Conv2DTranspose";pe(R7);class M7 extends jy{constructor(t){if(super(t),this.inputSpec=[new fr({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new H(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=zt(t),t.length!==5)throw new H("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new H("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new fr({ndim:5,axes:{[n]:r}})],this.built=!0}call(t,n){return K(()=>{let r=nt(t);if(r.shape.length!==5)throw new H(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let o,a,u;this.dataFormat==="channelsFirst"?(u=2,o=3,a=4):(u=1,o=2,a=3);const l=i[u],c=i[o],f=i[a],d=this.kernelSize[0],h=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],y=this.strides[2],b=sl(l,m,d,this.padding),v=sl(c,g,h,this.padding),x=sl(f,y,p,this.padding),w=[s,b,v,x,this.filters];this.dataFormat!=="channelsLast"&&(r=Tt(r,[0,2,3,4,1]));let S=MB(r,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Tt(S,[0,4,1,2,3])),this.bias!==null&&(S=Ru(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(t){t=zt(t);const n=t.slice();let r,i,s,o;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3,o=4):(r=4,i=1,s=2,o=3);const a=this.kernelSize[0],u=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],f=this.strides[1],d=this.strides[2];return n[r]=this.filters,n[i]=sl(n[i],c,a,this.padding),n[s]=sl(n[s],f,u,this.padding),n[o]=sl(n[o],d,l,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}M7.className="Conv3DTranspose";pe(M7);class _ce extends Wy{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new H("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new H("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new H(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Dn(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=On(n.depthwiseRegularizer),this.depthwiseConstraint=kr(n.depthwiseConstraint),this.pointwiseInitializer=Dn(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=On(n.pointwiseRegularizer),this.pointwiseConstraint=kr(n.pointwiseConstraint)}build(t){if(t=zt(t),t.length<this.rank+2)throw new H(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new H(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),s=[];for(let a=0;a<this.rank;++a)s.push(1);s.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new fr({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(t,n){return K(()=>{t=nt(t);let r;if(this.rank===1)throw new ht("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=Tt(t,[0,2,3,1])),r=r3(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Ru(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Tt(r,[0,3,1,2])),r})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Ln(this.depthwiseInitializer),t.pointwiseInitializer=Ln(this.pointwiseInitializer),t.depthwiseRegularizer=cn(this.depthwiseRegularizer),t.pointwiseRegularizer=cn(this.pointwiseRegularizer),t.depthwiseConstraint=Cr(this.depthwiseConstraint),t.pointwiseConstraint=Cr(this.pointwiseConstraint),t}}_ce.className="SeparableConv";class P7 extends _ce{constructor(t){super(2,t)}}P7.className="SeparableConv2D";pe(P7);class cC extends Wy{constructor(t){super(1,t),cC.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!a7(t.kernelSize,"number",1,1))throw new H(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}cC.className="Conv1D";pe(cC);class L7 extends St{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return K(()=>{if(t=nt(t),this.dataFormat==="channelsLast"){const r=r$(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return r$(r,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=r$(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return r$(r,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}L7.className="Cropping2D";pe(L7);class z7 extends St{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,sr(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,K5e(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],r=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,r]}else{const n=t[1]==null?null:this.size[0]*t[1],r=t[2]==null?null:this.size[1]*t[2];return[t[0],n,r,t[3]]}}call(t,n){return K(()=>{let r=nt(t);const i=r.shape;if(this.dataFormat==="channelsFirst"){r=Tt(r,[0,2,3,1]);const s=this.size[0]*i[2],o=this.size[1]*i[3],a=this.interpolation==="nearest"?Eo.resizeNearestNeighbor(r,[s,o]):Eo.resizeBilinear(r,[s,o]);return Tt(a,[0,3,1,2])}else{const s=this.size[0]*i[1],o=this.size[1]*i[2];return this.interpolation==="nearest"?Eo.resizeNearestNeighbor(r,[s,o]):Eo.resizeBilinear(r,[s,o])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}z7.className="UpSampling2D";pe(z7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ULe(e,t,n=[1,1],r="valid",i,s){return K(()=>{i==null&&(i=_u()),sr(i);let o=F7(e,i);if(e.rank!==4)throw new H(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new H(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=Oy(o,t,n,r==="same"?"same":"valid","NHWC",s),i==="channelsFirst"&&(o=Tt(o,[0,3,1,2])),o})}class B7 extends U3{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Dn(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=kr(t.depthwiseConstraint),this.depthwiseRegularizer=On(t.depthwiseRegularizer)}build(t){if(t=zt(t),t.length<4)throw new H(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new H(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const r=t[n],i=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return K(()=>{t=nt(t);let r=ULe(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Ru(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(t){t=zt(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,s=yu(n,this.kernelSize[0],this.padding,this.strides[0]),o=yu(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],i,s,o]:[t[0],s,o,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Ln(this.depthwiseInitializer),t.depthwiseRegularizer=cn(this.depthwiseRegularizer),t.depthwiseConstraint=Cr(this.depthwiseRegularizer),t}}B7.className="DepthwiseConv2D";pe(B7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ece(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new H("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(s){return s==null||Array.isArray(s)?s:[s]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function Tce(e,t,n,r=!1,i,s,o=!1,a=!1){return K(()=>{const u=t.shape.length;if(u<3)throw new H(`Input should be at least 3D, but is ${u}D.`);const l=[1,0].concat($u(2,u));t=Tt(t,l),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=Ce(Ce(i,"bool"),"float32"),i.rank===u-1&&(i=jr(i,-1)),i=Tt(i,l)),r&&(t=Uo(t,0),i!=null&&(i=Uo(i,0)));const c=[];let f,d=n;const h=t.shape[0],p=Wo(t);let m;i!=null&&(m=Wo(i));for(let y=0;y<h;++y){const b=p[y],v=K(()=>e(b,d));if(i==null)f=v[0],d=v[1];else{const x=K(()=>{const w=m[y],S=Re(no(w),w),C=de(U(v[0],w),U(d[0],S)),k=d.map((E,_)=>de(U(v[1][_],w),U(E,S)));return{output:C,newStates:k}});f=x.output,d=x.newStates}a&&c.push(f)}let g;return a&&(g=Hi(c,1)),[f,g,d]})}class Mu extends St{constructor(t){super(t);let n;if(t.cell==null)throw new H("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new j3({cells:t.cell}):n=t.cell,n.stateSize==null)throw new H("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new fr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return $u(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){R5(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let i;if(this.returnSequences?i=[t[0],t[1],r]:i=[t[0],r],this.returnState){const s=[];for(const o of n)s.push([t[0],o]);return[i].concat(s)}else return i}computeMask(t,n){return K(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const i=this.states.map(s=>null);return[r].concat(i)}else return r})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<t;++r)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new ht("Constants support is not implemented in RNN yet.");R5(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new fr({shape:[n,null,...r]});const i=[t[0]].concat(t.slice(2));this.cell.build(i);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!$t(this.stateSpec.map(o=>o.shape[o.shape.length-1]),s))throw new H(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(o=>new fr({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){K(()=>{if(!this.stateful)throw new rl("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new H("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>lr([r,i])):this.states_=[lr([r,this.cell.stateSize])];else if(t==null)at(this.states_),this.keptStates!=null&&(at(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>lr([r,i])):this.states_[0]=lr([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new H(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):at(this.states_);for(let i=0;i<this.states_.length;++i){const s=t[i],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,a=[r,o];if(!$t(s.shape,a))throw new H(`State ${i} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${s.shape}`);this.states_[i]=s}}this.states_=this.states_.map(i=>xr(i.clone()))})}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=Ece(t,r,i,this.numConstants);t=s.inputs,r=s.initialState,i=s.constants;let o=[],a=[];if(r!=null){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(const l of r)this.stateSpec.push(new fr({shape:l.shape}));a=a.concat(this.stateSpec)}if(i!=null&&(n.constants=i,o=o.concat(i),this.numConstants=i.length),o[0]instanceof Eu){const l=[t].concat(o),c=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=c;const d=super.apply(l,n);return this.inputSpec=f,d}else return super.apply(t,n)}call(t,n){return K(()=>{const r=n==null?null:n.mask,i=n==null?null:n.training;let s=n==null?null:n.initialState;t=nt(t),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(t));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==o)throw new H(`RNN Layer has ${o} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:i},l=Tce((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},t,s,this.goBackwards,r,null,this.unroll,this.returnSequences),c=l[0],f=l[1],d=l[2];this.stateful&&this.resetStates(d,i);const h=this.returnSequences?f:c;return this.returnState?[h].concat(d):h})}getInitialState(t){return K(()=>{let n=lr(t.shape);return n=Le(n,[1,2]),n=sC(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?O5(n,[1,r]):n):this.cell.stateSize>1?[O5(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Mu.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(t,n,r={}){const i=n.cell,s=gu(i,r);return new t(Object.assign(n,{cell:s}))}}Mu.className="RNN";pe(Mu);class fC extends St{}class W3 extends fC{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Nr(this.units,"units"),this.activation=Nd(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Dn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Dn(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Dn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=On(t.kernelRegularizer),this.recurrentRegularizer=On(t.recurrentRegularizer),this.biasRegularizer=On(t.biasRegularizer),this.kernelConstraint=kr(t.kernelConstraint),this.recurrentConstraint=kr(t.recurrentConstraint),this.biasConstraint=kr(t.biasConstraint),this.dropout=q0([1,Td([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=q0([1,Td([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=zt(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return K(()=>{if(t=t,t.length!==2)throw new H(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let r=t[1];t=t[0];const i=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Id({ones:()=>no(t),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Id({ones:()=>no(r),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let s;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?s=xl(U(t,o),this.kernel.read()):s=xl(t,this.kernel.read()),this.bias!=null&&(s=Ru(s,this.bias.read())),a!=null&&(r=U(r,a));let u=de(s,xl(r,this.recurrentKernel.read()));return this.activation!=null&&(u=this.activation.apply(u)),[u,u]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Ad(this.activation),useBias:this.useBias,kernelInitializer:Ln(this.kernelInitializer),recurrentInitializer:Ln(this.recurrentInitializer),biasInitializer:Ln(this.biasInitializer),kernelRegularizer:cn(this.kernelRegularizer),recurrentRegularizer:cn(this.recurrentRegularizer),biasRegularizer:cn(this.biasRegularizer),activityRegularizer:cn(this.activityRegularizer),kernelConstraint:Cr(this.kernelConstraint),recurrentConstraint:Cr(this.recurrentConstraint),biasConstraint:Cr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),n)}}W3.className="SimpleRNNCell";pe(W3);class U7 extends Mu{constructor(t){t.cell=new W3(t),super(t)}call(t,n){return K(()=>{this.cell.dropoutMask!=null&&(at(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(at(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return new t(n)}}U7.className="SimpleRNN";pe(U7);class V3 extends fC{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new H("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Nr(this.units,"units"),this.activation=Nd(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Nd(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Dn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Dn(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Dn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=On(t.kernelRegularizer),this.recurrentRegularizer=On(t.recurrentRegularizer),this.biasRegularizer=On(t.biasRegularizer),this.kernelConstraint=kr(t.kernelConstraint),this.recurrentConstraint=kr(t.recurrentConstraint),this.biasConstraint=kr(t.biasConstraint),this.dropout=q0([1,Td([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=q0([1,Td([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=zt(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return K(()=>{if(t=t,t.length!==2)throw new H(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training==null?!1:n.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Id({ones:()=>no(t),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Id({ones:()=>no(i),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,o=this.recurrentDropoutMask;let a,u,l;0<this.dropout&&this.dropout<1&&(t=U(t,s[0]));let c=xl(t,this.kernel.read());this.useBias&&(c=Ru(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=U(i,o[0]));const f=this.recurrentKernel.read(),[d,h]=ps(f,[2*this.units,this.units],f.rank-1),p=xl(i,d),[m,g,y]=ps(c,3,c.rank-1),[b,v]=ps(p,2,p.rank-1);a=this.recurrentActivation.apply(de(m,b)),u=this.recurrentActivation.apply(de(g,v));const x=xl(U(u,i),h);l=this.activation.apply(de(y,x));const w=de(U(a,i),U(de(1,yn(a)),l));return[w,w]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Ad(this.activation),recurrentActivation:Ad(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ln(this.kernelInitializer),recurrentInitializer:Ln(this.recurrentInitializer),biasInitializer:Ln(this.biasInitializer),kernelRegularizer:cn(this.kernelRegularizer),recurrentRegularizer:cn(this.recurrentRegularizer),biasRegularizer:cn(this.biasRegularizer),activityRegularizer:cn(this.activityRegularizer),kernelConstraint:Cr(this.kernelConstraint),recurrentConstraint:Cr(this.recurrentConstraint),biasConstraint:Cr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),n)}}V3.className="GRUCell";pe(V3);class W7 extends Mu{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new V3(t),super(t)}call(t,n){return K(()=>{this.cell.dropoutMask!=null&&(at(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(at(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}W7.className="GRU";pe(W7);class dC extends fC{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Nr(this.units,"units"),this.activation=Nd(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Nd(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Dn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Dn(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Dn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=On(t.kernelRegularizer),this.recurrentRegularizer=On(t.recurrentRegularizer),this.biasRegularizer=On(t.biasRegularizer),this.kernelConstraint=kr(t.kernelConstraint),this.recurrentConstraint=kr(t.recurrentConstraint),this.biasConstraint=kr(t.biasConstraint),this.dropout=q0([1,Td([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=q0([1,Td([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=zt(t);const r=t[t.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const s=this.biasInitializer,o=this.units;i=new(n=class extends Ba{apply(u,l){const c=s.apply([o]),f=new A3().apply([o]),d=s.apply([o*2]);return BK(BK(c,f),d)}},n.className="CustomInit",n)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return K(()=>{const r=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new H(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let i=t[1];const s=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Id({ones:()=>no(t),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Id({ones:()=>no(i),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let u,l,c,f;0<this.dropout&&this.dropout<1&&(t=U(t,o[0]));let d=xl(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=U(i,a[0])),d=de(d,xl(i,this.recurrentKernel.read())),this.useBias&&(d=Ru(d,this.bias.read()));const[h,p,m,g]=ps(d,4,d.rank-1);u=this.recurrentActivation.apply(h),l=this.recurrentActivation.apply(p),c=de(U(l,s),U(u,this.activation.apply(m))),f=this.recurrentActivation.apply(g);const y=U(f,this.activation.apply(c));return[y,y,c]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Ad(this.activation),recurrentActivation:Ad(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ln(this.kernelInitializer),recurrentInitializer:Ln(this.recurrentInitializer),biasInitializer:Ln(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:cn(this.kernelRegularizer),recurrentRegularizer:cn(this.recurrentRegularizer),biasRegularizer:cn(this.biasRegularizer),activityRegularizer:cn(this.activityRegularizer),kernelConstraint:Cr(this.kernelConstraint),recurrentConstraint:Cr(this.recurrentConstraint),biasConstraint:Cr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),n)}}dC.className="LSTMCell";pe(dC);class V7 extends Mu{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new dC(t),super(t)}call(t,n){return K(()=>{this.cell.dropoutMask!=null&&(at(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(at(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}V7.className="LSTM";pe(V7);class j3 extends fC{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return K(()=>{t=t;let r=t.slice(1);const i=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?i.push(r.splice(0,a.stateSize.length)):i.push(r.splice(0,1));i.reverse();const s=[];let o;for(let a=0;a<this.cells.length;++a){const u=this.cells[a];r=i[a],a===0?o=[t[0]].concat(r):o=[o[0]].concat(r),o=u.call(o,n),s.push(o.slice(1))}r=[];for(const a of s.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(t){R5(t)&&(t=t[0]),t=t;let n;this.cells.forEach((r,i)=>{Cp(`RNNCell_${i}`,()=>{r.build(t),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=s=>({className:s.getClassName(),config:s.getConfig()}),i={cells:this.cells.map(n)};return Object.assign(Object.assign({},t),i)}static fromConfig(t,n,r={}){const i=[];for(const s of n.cells)i.push(gu(s,r));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return M5(t)}setWeights(t){const n=[];for(const r of this.cells){const i=r.weights.length,s=t.splice(i);for(let o=0;o<r.weights.length;++o)n.push([r.weights[o],s[o]])}g7(n)}}j3.className="StackedRNNCells";pe(j3);function Id(e){const{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:s}=e,o=()=>s!=null?s(t(),n):Ble(t(),n),a=()=>aC(o,t,r);return!i||i<=1?xr(a().clone()):Array(i).fill(void 0).map(a).map(l=>xr(l.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var WLe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Ace extends Mu{constructor(t){if(t.unroll)throw new ht("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new ht("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new fr({ndim:5})]}call(t,n){return K(()=>{if(this.cell.dropoutMask!=null&&(at(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(at(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new H("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return K(()=>{const{stateSize:n}=this.cell,r=t.shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)],o=lr(s);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(t,n=!1){K(()=>{if(!this.stateful)throw new rl("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)];if(r[0]==null)throw new H("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>lr(s)):this.states_=[lr(s)];else if(t==null)at(this.states_),this.keptStates!=null&&(at(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>lr(s)):this.states_[0]=lr(s);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new H(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):at(this.states_);for(let a=0;a<this.states_.length;++a){const u=t[a],l=s;if(!$t(u.shape,l))throw new H(`State ${a} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${u.shape}`);this.states_[a]=u}}this.states_=this.states_.map(a=>xr(a.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:r,kernelSize:i,padding:s,strides:o,dilationRate:a}=this.cell,u=n==="channelsFirst",l=t[u?3:2],c=t[u?4:3],f=yu(l,i[0],s,o[0],a[0]),d=yu(c,i[1],s,o[1],a[1]);return[...t.slice(0,2),...u?[r,f,d]:[f,d,r]]}}Ace.className="ConvRNN2D";class H3 extends dC{constructor(t){const{filters:n,kernelSize:r,strides:i,padding:s,dataFormat:o,dilationRate:a}=t;super(Object.assign(Object.assign({},t),{units:n})),this.filters=n,Nr(this.filters,"filters"),this.kernelSize=g0(r,2,"kernelSize"),this.kernelSize.forEach(u=>Nr(u,"kernelSize")),this.strides=g0(i||1,2,"strides"),this.strides.forEach(u=>Nr(u,"strides")),this.padding=s||"valid",qo(this.padding),this.dataFormat=o||"channelsLast",sr(this.dataFormat),this.dilationRate=g0(a||1,2,"dilationRate"),this.dilationRate.forEach(u=>Nr(u,"dilationRate"))}build(t){var n;t=zt(t);const r=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[r]==null)throw new H(`The channel dimension of the input should be defined. Found ${t[r]}`);const i=t[r],s=4,o=this.kernelSize.concat([i,this.filters*s]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*s]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){const l=this.biasInitializer,c=this.filters;u=new(n=class extends Ba{apply(d,h){const p=l.apply([c]),m=ls([c]),g=l.apply([c*2]);return u7([p,m,g])}},n.className="CustomInit",n)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*s],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return K(()=>{if(t.length!==3)throw new H(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training||!1,i=t[0],s=t[1],o=t[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Id({ones:()=>no(i),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const u=this.dropoutMask,l=(q,J,ne)=>!J||!J[ne]?q:U(J[ne],q);let c=l(i,u,0),f=l(i,u,1),d=l(i,u,2),h=l(i,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Id({ones:()=>no(s),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=l(s,p,0),g=l(s,p,1),y=l(s,p,2),b=l(s,p,3);const v=3,[x,w,S,C]=ps(this.kernel.read(),a,v),[k,E,_,T]=this.useBias?ps(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,x,k,this.padding),f=this.inputConv(f,w,E,this.padding),d=this.inputConv(d,S,_,this.padding),h=this.inputConv(h,C,T,this.padding);const[D,O,M,I]=ps(this.recurrentKernel.read(),a,v);m=this.recurrentConv(m,D),g=this.recurrentConv(g,O),y=this.recurrentConv(y,M),b=this.recurrentConv(b,I);const P=this.recurrentActivation.apply(de(c,m)),V=this.recurrentActivation.apply(de(f,g)),F=de(U(V,o),U(P,this.activation.apply(de(d,y)))),B=U(this.recurrentActivation.apply(de(h,b)),this.activation.apply(F));return[B,B,F]})}getConfig(){const t=super.getConfig(),n=WLe(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(t,n,r,i){const s=qc(t,n,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Ru(s,r,this.dataFormat):s}recurrentConv(t,n){return qc(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}H3.className="ConvLSTM2DCell";pe(H3);class j7 extends Ace{constructor(t){const n=new H3(t);super(Object.assign(Object.assign({},t),{cell:n}))}static fromConfig(t,n){return new t(n)}}j7.className="ConvLSTM2D";pe(j7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class G3 extends St{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,r=[];for(let i=0;i<this.noiseShape.length;++i)r.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return r}call(t,n){return K(()=>{this.invokeCallHook(t,n);const r=nt(t);if(0<this.rate&&this.rate<1){const i=n.training==null?!1:n.training,s=this.getNoiseShape(r);return aC(()=>Ble(r,this.rate,s,this.seed),()=>r,i)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}G3.className="Dropout";pe(G3);class H7 extends G3{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}H7.className="SpatialDropout1D";pe(H7);class G7 extends St{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,Nr(this.units,"units"),this.activation=Nd(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=Dn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Dn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=kr(t.kernelConstraint),this.biasConstraint=kr(t.biasConstraint),this.kernelRegularizer=On(t.kernelRegularizer),this.biasRegularizer=On(t.biasRegularizer),this.activityRegularizer=On(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=zt(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=zt(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return K(()=>{this.invokeCallHook(t,n);const r=nt(t),i=Ole(this.activation.getClassName());let s;return i!=null?s=xl(r,this.kernel.read(),i,this.bias?this.bias.read():null):(s=xl(r,this.kernel.read()),this.bias!=null&&(s=Ru(s,this.bias.read())),this.activation!=null&&(s=this.activation.apply(s))),s})}getConfig(){const t={units:this.units,activation:Ad(this.activation),useBias:this.useBias,kernelInitializer:Ln(this.kernelInitializer),biasInitializer:Ln(this.biasInitializer),kernelRegularizer:cn(this.kernelRegularizer),biasRegularizer:cn(this.biasRegularizer),activityRegularizer:cn(this.activityRegularizer),kernelConstraint:Cr(this.kernelConstraint),biasConstraint:Cr(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}G7.className="Dense";pe(G7);let q7=class extends St{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=zt(t);for(const n of t.slice(1))if(n==null)throw new H(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],hd(t,1)]}call(t,n){return K(()=>{this.invokeCallHook(t,n);let r=nt(t);if(this.dataFormat==="channelsFirst"&&r.rank>1){const i=[0];for(let s=2;s<r.rank;++s)i.push(s);i.push(1),r=Tt(r,i)}return tPe(r)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}};q7.className="Flatten";pe(q7);class X7 extends St{constructor(t){super(t),this.supportsMasking=!0,this.activation=Nd(t.activation)}call(t,n){return K(()=>{this.invokeCallHook(t,n);const r=nt(t);return this.activation.apply(r)})}getConfig(){const t={activation:Ad(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}X7.className="Activation";pe(X7);class K7 extends St{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return K(()=>(t=nt(t),J5e(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}K7.className="RepeatVector";pe(K7);class Y7 extends St{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const r="Total size of new array must be unchanged.",i=n.slice();let s=1,o=null;for(let u=0;u<i.length;++u){const l=i[u];if(this.isUnknown(l))if(o===null)o=u;else throw new H("Can only specifiy one unknown dimension.");else s*=l}const a=hd(t);if(o!==null){if(s===0||a%s!==0)throw new H(r);i[o]=a/s}else if(a!==s)throw new H(r);return i}computeOutputShape(t){let n=!1;for(let r=0;r<t.length;++r)if(this.isUnknown(t[r])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return K(()=>{this.invokeCallHook(t,n);const r=nt(t),i=r.shape,s=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return j(r,s)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}Y7.className="Reshape";pe(Y7);class Z7 extends St{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=$u(1,t.dims.length+1);if(!$t(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new fr({ndim:this.dims.length+1})]}computeOutputShape(t){t=zt(t);const n=t.slice();return this.dims.forEach((r,i)=>{n[i+1]=t[r]}),n}call(t,n){return Tt(nt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}Z7.className="Permute";pe(Z7);class Q7 extends St{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const r=nt(t);return Ew(Hp(r,this.maskValue),-1)}call(t,n){return K(()=>{this.invokeCallHook(t,n);const r=nt(t),o=Ew(Hp(r,this.maskValue),-1,!0);return U(r,Ce(o,r.dtype))})}}Q7.className="Masking";pe(Q7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class J7 extends St{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Zt(t.inputLength))}this.inputDim=t.inputDim,Nr(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Nr(this.outputDim,"outputDim"),this.embeddingsInitializer=Dn(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=On(t.embeddingsRegularizer),this.activityRegularizer=On(t.activityRegularizer),this.embeddingsConstraint=kr(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return K(()=>this.maskZero?(t=nt(t),Hp(t,Nt(t))):null)}computeOutputShape(t){if(t=zt(t),this.inputLength==null)return[...t,this.outputDim];const n=Zt(this.inputLength);if(n.length!==t.length-1)throw new H(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let r=0;for(let i=0;i<n.length;++i){const s=n[i],o=t[i+1];if(s!=null&&o!=null&&s!==o)throw new H(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);s==null&&(n[r]=o),r++}}return[t[0],...n,this.outputDim]}call(t,n){return K(()=>{this.invokeCallHook(t,n);let r=nt(t);r.dtype!=="int32"&&(r=vl(r,"int32"));const i=zle(this.embeddings.read(),j(r,[r.size]));return j(i,zt(this.computeOutputShape(r.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ln(this.embeddingsInitializer),embeddingsRegularizer:cn(this.embeddingsRegularizer),activityRegularizer:cn(this.activityRegularizer),embeddingsConstraint:Cr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}J7.className="Embedding";pe(J7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Wm extends St{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new ht}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const r=t.slice(0,t.length-n.length);for(let i=0;i<n.length;++i){const s=t[t.length-n.length+i],o=n[i];if(s==null||o==null||s<0||o<0)r.push(null);else if(s===1)r.push(o);else if(o===1)r.push(s);else{if(s!==o)throw new H("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));r.push(s)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[zt(t)]),t=t,t.length<2)throw new H(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const s of t)s!=null&&s[0]!==null&&n.push(s[0]);if(n=dd(n),n.length>1)throw new H(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=t[0]==null?null:t[0].slice(1);for(let s=1;s<t.length;++s){const o=t[s]==null?null:t[s].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const i=t.map(s=>s.length);t.indexOf(null)===-1&&dd(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return K(()=>{if(t=t,this.reshapeRequired){const r=[],i=t.map(s=>s.rank);if(i.indexOf(null)===-1){const s=Td(i);for(let o of t){const a=o.rank;for(let u=0;u<s-a;++u)o=sC(o,1);r.push(o)}return this.mergeFunction(r)}else{let s=!1;for(const u of t){const l=u.rank;if(l==null){const c=u.shape,f=c[0],d=c.slice(1).concat([f]);let h=j(u,[f].concat(hd(c.slice(1))));h=Tt(h,[1,0]),h=j(h,d),r.push(h),s=!0}else if(l>1){const c=$u(1,l).concat([0]);r.push(Tt(u,c)),s=!0}else r.push(u)}let o=this.mergeFunction(r);const a=o.rank;if(s){if(a==null){const u=o.shape,l=u.length,c=u[l-1],f=[c].concat(u.slice(0,u.length-1));o=j(Tt(j(o,[-1,c]),[1,0]),f)}else if(a>1){const u=[a-1].concat($u(0,a-1));o=Tt(o,u)}}return o}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let i=1;i<t.length;++i){const s=t[i]==null?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,s)}let r=[];for(const i of t)i!=null&&i[0]!==null&&r.push(i[0]);return r=dd(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(t,n){return K(()=>{if(n==null)return null;if(!Array.isArray(n))throw new H("`mask` should be an Array");if(!Array.isArray(t))throw new H("`inputs` should be an Array");if(n.length!==t.length)throw new H(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:jr(i,0));let r=n[0];for(let i=1;i<n.length-1;++i)r=Oa(r,n[i]);return r})}}class e9 extends Wm{constructor(t){super(t)}mergeFunction(t){return K(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=de(n,t[r]);return n})}}e9.className="Add";pe(e9);class t9 extends Wm{constructor(t){super(t)}mergeFunction(t){return K(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=U(n,t[r]);return n})}}t9.className="Multiply";pe(t9);class n9 extends Wm{constructor(t){super(t)}mergeFunction(t){return K(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=de(n,t[r]);return U(1/t.length,n)})}}n9.className="Average";pe(n9);class r9 extends Wm{constructor(t){super(t)}mergeFunction(t){return K(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=Vl(n,t[r]);return n})}}r9.className="Maximum";pe(r9);class i9 extends Wm{constructor(t){super(t)}mergeFunction(t){return K(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=Ed(n,t[r]);return n})}}i9.className="Minimum";pe(i9);class s9 extends Wm{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new H("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const i of t)if(i!=null){n=!1;break}if(n)return;const r=[];for(let i=0;i<t.length;++i){const s=t[i].slice();s.splice(this.axis,1);let o=!1;for(const a of r)if($t(a,s)){o=!0;break}o||r.push(s)}if(r.length>1)throw new H("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return K(()=>u7(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new H("A `Concatenate` layer should be called on a list of inputs.");const n=t,r=n[0].slice(),i=this.axis<0?r.length+this.axis:this.axis;for(const s of n.slice(1)){if(r[i]==null||s[i]==null){r[i]=null;break}r[i]+=s[i]}return r}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new H("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new H("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new H(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return K(()=>{let r=!0;if(n.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const i=[];for(let o=0;o<t.length;++o)n[o]==null?i.push(Ce(no(t[o]),"bool")):n[o].rank<t[o].rank?i.push(jr(n[o],-1)):i.push(n[o]);const s=tr(i,this.axis);return UI(s,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}s9.className="Concatenate";pe(s9);function Yb(e,t){for(;e<0;)e+=t;return e}function VLe(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new ht("batchDot is not implemented for tensors of 4D or higher rank yet");if(A(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),A(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new ht("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);const s=n;return K(()=>{let o;if(r>i){o=r-i;const u=[];for(let l=0;l<o;++l)u.push(1);t=j(t,t.shape.concat(u))}else if(i>r){o=i-r;const u=[];for(let l=0;l<o;++l)u.push(1);e=j(e,e.shape.concat(u))}else o=0;let a;if(e.shape.length===2&&t.shape.length===2)s[0]===s[1]?a=Le(U(e,t),s[0]):a=Le(U(Tt(e,[1,0]),t),s[1]);else{const u=s[0]!==e.shape.length-1,l=s[1]===t.shape.length-1;a=vt(e,t,u,l)}if(o>0){let u;r>i?u=r+i-3:u=r-1;const l=[];for(let c=u;c<u+o;++c)l.push(c);a=eh(a,l)}return a.shape.length===1&&(a=jr(a,1)),a})}class o9 extends Wm{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){A(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],r=t[1];if(n.length>3||r.length>3)throw new ht("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);if(n[i[0]]!==r[i[1]])throw new H(`Dimension incompatibility: ${n[i[0]]} !== ${r[i[1]]}`)}mergeFunction(t){if(t.length!==2)throw new H(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],r=t[1],i;return Array.isArray(this.axes)?i=this.axes.map((s,o)=>Yb(s,t[o].shape.length)):i=[Yb(this.axes,n.shape.length),Yb(this.axes,r.shape.length)],this.normalize&&(n=JE(n,i[0]),r=JE(r,i[1])),VLe(n,r,i)}interpretAxes(t,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[Yb(this.axes,t.length),Yb(this.axes,n.length)],r}computeOutputShape(t){A(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),r=t[1].slice();if(n.length>3||r.length>3)throw new ht("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);n.splice(i[0],1),r.splice(i[1],1),r.splice(0,1);const s=n.concat(r);return s.length===1&&s.push(1),s}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}o9.className="Dot";pe(o9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class a9 extends St{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return K(()=>{this.invokeCallHook(t,n);const r=nt(t);return aC(()=>de(T3(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}a9.className="GaussianNoise";pe(a9);class u9 extends St{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return K(()=>{this.invokeCallHook(t,n);const r=nt(t);return this.rate>0&&this.rate<1?aC(()=>{const s=Math.sqrt(this.rate/(1-this.rate));return U(r,T3(r.shape,1,s))},()=>r,n.training||!1):r})}}u9.className="GaussianDropout";pe(u9);class l9 extends St{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||nt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return K(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(t);return aC(()=>{const s=nt(t),u=-1.6732632423543772*1.0507009873554805;let l=lf(Jd(r),this.rate);l=vl(l,"float32");const c=((1-this.rate)*(1+this.rate*u**2))**-.5,f=-c*u*this.rate,d=de(U(s,l),U(de(l,-1),u));return de(U(d,c),f)},()=>nt(t),n.training||!1)}return t})}}l9.className="AlphaDropout";pe(l9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ow(e,t,n,r,i,s=.001){let o;if(e.rank===2)o=$B(e,t,n,r,i,s);else if(e.rank===3)o=_B(e,t,n,r,i,s);else if(e.rank===4)o=EB(e,t,n,r,i,s);else throw new ht(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return o}function jLe(e,t,n,r,i=.001){return K(()=>{const s=qS(e,r),o=s.mean,a=s.variance;return[Ow(e,o,a,n,t,i),o,a]})}function HLe(e,t,n,r,i=.001){return K(()=>{const s=qS(e,r),o=s.mean,a=s.variance,u=[];for(const p of $u(0,e.rank))r.indexOf(p)!==-1?u.push(1):u.push(e.shape[p]);const l=j(o,u),c=j(a,u),f=t==null?null:j(t,u),d=n==null?null:j(n,u);return[Ow(e,l,c,d,f,i),o,a]})}function GLe(e,t,n,r,i=.001){return $t(r.slice().sort(),$u(0,e.rank-1))?jLe(e,t,n,r,i):HLe(e,t,n,r,i)}class c9 extends St{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Dn(t.betaInitializer||"zeros"),this.gammaInitializer=Dn(t.gammaInitializer||"ones"),this.movingMeanInitializer=Dn(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Dn(t.movingVarianceInitializer||"ones"),this.betaConstraint=kr(t.betaConstraint),this.gammaConstraint=kr(t.gammaConstraint),this.betaRegularizer=On(t.betaRegularizer),this.gammaRegularizer=On(t.gammaRegularizer)}build(t){t=zt(t);const n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(r==null)throw new H(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new fr({ndim:t.length,axes:{[n]:r}})];const i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return K(()=>{const r=n.training==null?!1:n.training,i=nt(t),s=i.shape,o=s.length,a=$u(0,o),u=this.axis>=0?this.axis:this.axis+o;a.splice(u,1);const l=Xp(1,o);l[u]=s[u];const c=a.slice();c.sort();const f=!$t(c,$u(0,o).slice(0,o-1)),d=()=>{if(f){const b=j(this.movingMean.read(),l),v=j(this.movingVariance.read(),l),x=this.center?j(this.beta.read(),l):null,w=this.scale?j(this.gamma.read(),l):null;return Ow(i,b,v,x,w,this.epsilon)}else return Ow(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return d();const[h,p,m]=GLe(i,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(b,v,x)=>{K(()=>{const w=1-x,S=b.read(),C=U(Re(S,v),w);b.write(Re(S,C))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),h})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ln(this.betaInitializer),gammaInitializer:Ln(this.gammaInitializer),movingMeanInitializer:Ln(this.movingMeanInitializer),movingVarianceInitializer:Ln(this.movingVarianceInitializer),betaRegularizer:cn(this.betaRegularizer),gammaRegularizer:cn(this.gammaRegularizer),betaConstraint:Cr(this.betaConstraint),gammaConstraint:Cr(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}c9.className="BatchNormalization";pe(c9);class f9 extends St{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Dn(t.betaInitializer||"zeros"),this.gammaInitializer=Dn(t.gammaInitializer||"ones"),this.betaRegularizer=On(t.betaRegularizer),this.gammaRegularizer=On(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=zt(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=n);for(const s of this.axis)if(s<0||s>=n)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==dd(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(s=>t[s]),i=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(t,n){const r=nt(t),i=r.shape,s=i.length;return K(()=>{let{mean:a,variance:u}=qS(r,this.axis,!0);const l=Xp(1,s);for(const m of this.axis)l[m]=i[m];const c=m=>m!=null&&m.shape.length!==s?j(m,l):m;let f=this.scale?c(this.gamma.read()):null,d=this.center?c(this.beta.read()):null;const h=[],p=[];for(let m=0;m<s;++m)this.axis.indexOf(m)!==-1?(h.push(i[m]),p.push(1)):(h.push(1),p.push(i[m]));return a=_o(a,h),u=_o(u,h),f!=null&&(f=_o(f,p)),d!=null&&(d=_o(d,p)),Ow(r,a,u,d,f,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ln(this.betaInitializer),gammaInitializer:Ln(this.gammaInitializer),betaRegularizer:cn(this.betaRegularizer),gammaRegularizer:cn(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}f9.className="LayerNormalization";pe(f9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qLe(e,t,n){return K(()=>{if(e.rank!==4)throw new H(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new H("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=_u()),n!=="channelsLast"&&n!=="channelsFirst")throw new H(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],cf(e,r)})}class d9 extends St{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?_u():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new H(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,r;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],r=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new H(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new H(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);r=t.padding[1]}this.padding=[n,r]}this.inputSpec=[new fr({ndim:4})]}computeOutputShape(t){t=zt(t);let n,r;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?r=t[3]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],t[1],n,r]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?r=t[2]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],n,r,t[3]])}call(t,n){return K(()=>qLe(nt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}d9.className="ZeroPadding2D";pe(d9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function q3(e,t,n,r,i,s){return K(()=>{sr(i),Rle(s),qo(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=_u()),s==null&&(s="max"),e=F7(e,i);let o;const a=r==="same"?"same":"valid";return s==="max"?o=GS(e,t,n,a):o=LS(e,t,n,a),i==="channelsFirst"&&(o=Tt(o,[0,3,1,2])),o})}function Nce(e,t,n,r,i,s){return K(()=>{sr(i),Rle(s),qo(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=_u()),s==null&&(s="max"),e=$ce(e,i);let o;const a=r==="same"?"same":"valid";return s==="max"?o=YB(e,t,n,a):o=kB(e,t,n,a),i==="channelsFirst"&&(o=Tt(o,[0,4,1,2,3])),o})}class Ice extends St{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new H(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(Nr(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new H(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);Nr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,qo(this.padding),this.inputSpec=[new fr({ndim:3})]}computeOutputShape(t){t=zt(t);const n=yu(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return K(()=>{this.invokeCallHook(t,n),t=sC(nt(t),2);const r=this.poolingFunction(nt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return eh(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class h9 extends Ice{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return sr(s),qo(i),q3(t,n,r,i,s,"max")}}h9.className="MaxPooling1D";pe(h9);class p9 extends Ice{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return sr(s),qo(i),q3(t,n,r,i,s,"avg")}}p9.className="AveragePooling1D";pe(p9);class Dce extends St{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new H(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Nr(this.poolSize,"poolSize"),Nr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,sr(this.dataFormat),qo(this.padding),this.inputSpec=[new fr({ndim:4})]}computeOutputShape(t){t=zt(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=yu(n,this.poolSize[0],this.padding,this.strides[0]),r=yu(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r]:[t[0],n,r,t[3]]}call(t,n){return K(()=>(this.invokeCallHook(t,n),this.poolingFunction(nt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class m9 extends Dce{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return sr(s),qo(i),q3(t,n,r,i,s,"max")}}m9.className="MaxPooling2D";pe(m9);class g9 extends Dce{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return sr(s),qo(i),q3(t,n,r,i,s,"avg")}}g9.className="AveragePooling2D";pe(g9);class Oce extends St{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new H(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Nr(this.poolSize,"poolSize"),Nr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,sr(this.dataFormat),qo(this.padding),this.inputSpec=[new fr({ndim:5})]}computeOutputShape(t){t=zt(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=yu(n,this.poolSize[0],this.padding,this.strides[0]),r=yu(r,this.poolSize[1],this.padding,this.strides[1]),i=yu(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r,i]:[t[0],n,r,i,t[4]]}call(t,n){return K(()=>(this.invokeCallHook(t,n),this.poolingFunction(nt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class y9 extends Oce{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return sr(s),qo(i),Nce(t,n,r,i,s,"max")}}y9.className="MaxPooling3D";pe(y9);class b9 extends Oce{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return sr(s),qo(i),Nce(t,n,r,i,s,"avg")}}b9.className="AveragePooling3D";pe(b9);class Fce extends St{constructor(t){super(t),this.inputSpec=[new fr({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new ht}}class v9 extends Fce{constructor(t){super(t||{})}call(t,n){return K(()=>{const r=nt(t);return Pn(r,1)})}}v9.className="GlobalAveragePooling1D";pe(v9);class x9 extends Fce{constructor(t){super(t||{})}call(t,n){return K(()=>{const r=nt(t);return Lo(r,1)})}}x9.className="GlobalMaxPooling1D";pe(x9);class Rce extends St{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,sr(this.dataFormat),this.inputSpec=[new fr({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new ht}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class w9 extends Rce{call(t,n){return K(()=>{const r=nt(t);return this.dataFormat==="channelsLast"?Pn(r,[1,2]):Pn(r,[2,3])})}}w9.className="GlobalAveragePooling2D";pe(w9);class S9 extends Rce{call(t,n){return K(()=>{const r=nt(t);return this.dataFormat==="channelsLast"?Lo(r,[1,2]):Lo(r,[2,3])})}}S9.className="GlobalMaxPooling2D";pe(S9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mce extends St{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,r={}){const i=n.layer,s=gu(i,r);delete n.layer;const o={layer:s};return Object.assign(o,n),new t(o)}}class C9 extends Mce{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=zt(t),t.length<3)throw new H(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=zt(t);const n=[t[0]].concat(t.slice(2)),r=this.layer.computeOutputShape(n),i=t[1];return[r[0],i].concat(r.slice(1))}call(t,n){return K(()=>(t=nt(t),Tce((o,a)=>[nt(this.layer.call(o,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}C9.className="TimeDistributed";pe(C9);function XLe(e){Bm(X5e,"BidirectionalMergeMode",e)}const KLe="concat";class k9 extends Mce{constructor(t){super(t);const n=t.layer.getConfig(),r={};r.className=t.layer.getClassName(),r.config=n,this.forwardLayer=gu(r),n.goBackwards=n.goBackwards!==!0;const i={};if(i.className=t.layer.getClassName(),i.config=n,this.backwardLayer=gu(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?KLe:t.mergeMode,XLe(this.mergeMode),t.weights)throw new ht("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,r=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,r)),this.backwardLayer.setWeights(t.slice(r))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,i,s;return this.returnState&&(s=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):this.mergeMode==null?i=[r,r.slice()]:i=[r],this.returnState?this.mergeMode==null?i.concat(s).concat(s.slice()):[r].concat(s).concat(s.slice()):ns(i)}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=Ece(t,r,i,this.numConstants);if(t=s.inputs,r=s.initialState,i=s.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(r==null||r.length===0)&&i==null)return super.apply(t,n);const o=[],a=[];if(r!=null){const l=r.length;if(l%2>0)throw new H("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push(...r);const c=r.map(f=>new fr({shape:f.shape}));this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),a.push(...c)}if(i!=null)throw new ht("Support for constants in Bidirectional layers is not implemented yet.");const u=o[0]instanceof Eu;for(const l of o)if(l instanceof Eu!==u)throw new H("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const l=[t].concat(o),c=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=c;const d=super.apply(l,n);return this.inputSpec=f,d}else return super.apply(t,n)}call(t,n){return K(()=>{const r=n.initialState;let i,s;if(r==null)i=this.forwardLayer.call(t,n),s=this.backwardLayer.call(t,n);else{const u=r.slice(0,r.length/2),l=r.slice(r.length/2);i=this.forwardLayer.call(t,Object.assign(n,{initialState:u})),s=this.backwardLayer.call(t,Object.assign(n,{initialState:l}))}let o;this.returnState&&(Array.isArray(i)&&(o=i.slice(1).concat(s.slice(1))),i=i[0],s=s[0]),this.returnSequences&&(s=Uo(s,1));let a;return this.mergeMode==="concat"?a=u7([i,s]):this.mergeMode==="sum"?a=de(i,s):this.mergeMode==="ave"?a=U(.5,de(i,s)):this.mergeMode==="mul"?a=U(i,s):this.mergeMode==null&&(a=[i,s]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Cp(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Cp(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const s=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(s).concat(s):[r].concat(s).concat(s)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const r=gu(n.layer);if(delete n.layer,n.numConstants!=null)throw new ht("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=n;return i.layer=r,new t(i)}}k9.className="Bidirectional";pe(k9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $9 extends St{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return K(()=>(t=nt(t),t.dtype!=="float32"&&(t=vl(t,"float32")),de(U(t,this.scale),this.offset)))}}$9.className="Rescaling";pe($9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:YLe,cropAndResize:ZLe}=Eo;class _9 extends St{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,n,r,i,s,o,a,u){return K(()=>{let l,c=!1;const f=n/o,d=r/a,h=(i+n)/o,p=(s+r)/a,m=[f,d,h,p],g=[];t.rank===3?(c=!0,l=Hi([t])):l=t;for(let w=0;w<l.shape[0];w++)g.push(m);const y=hs(g,[g.length,4]),b=Gp(0,g.length,1,"int32"),x=ZLe(l,y,b,[i,s],"nearest");return vl(c?nt(Wo(x)):x,u)})}upsize(t,n,r,i){return K(()=>{const s=YLe(t,[n,r]);return vl(s,i)})}call(t,n){return K(()=>{const r=nt(t),i=r.dtype,s=r.shape,o=s[s.length-3],a=s[s.length-2];let u=0;o!==this.height&&(u=Math.floor((o-this.height)/2));let l=0;return a!==this.width&&(l=Math.floor((a-this.width)/2),l===0&&(l=1)),u>=0&&l>=0?this.centerCrop(r,u,l,this.height,this.width,o,a,i):this.upsize(t,this.height,this.width,i)})}getConfig(){const t={height:this.height,width:this.width},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=zt(t);const n=t.length-3,r=t.length-2;return t[n]=this.height,t[r]=this.width,t}}_9.className="CenterCrop";pe(_9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QLe(e,t,n,r){let i=nt(e);if(i.dtype!=="int32"&&(i=vl(i,"int32")),t==="int")return i;const s=i.shape;if(i.rank===0&&(i=jr(i,-1)),t==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=jr(i,-1)),i.rank>2)throw new H(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${i.rank}.`);const o=["multiHot","oneHot"].includes(t),a=i;let u;if(typeof r<"u"&&t==="count"?u=qE(a,r,n,o):u=qE(a,[],n,o),t!=="tfIdf")return u;if(r)return U(u,r);throw new H("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class E9 extends St{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){return t=zt(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,n){return K(()=>{t=nt(t),t.dtype!=="int32"&&(t=vl(t,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new H(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=nt(n.countWeights)}const i=Lo(t),s=U0(t),o=Ki(this.numTokens,i).bufferSync().get(0),a=lf(s,0).bufferSync().get(0);if(!(o&&a))throw new H(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return QLe(t,this.outputMode,this.numTokens,r)})}}E9.className="CategoryEncoding";pe(E9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const JLe=["bilinear","nearest"],iY=new Set(JLe);class T9 extends St{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(iY.has(t.interpolation))this.interpolation=t.interpolation;else throw new H(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!t.cropToAspectRatio}computeOutputShape(t){t=zt(t);const n=t[2];return[this.height,this.width,n]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return K(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Eo.resizeBilinear(t,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Eo.resizeNearestNeighbor(t,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...iY]} are supported`)})}}T9.className="Resizing";pe(T9);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Pce{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}Pce.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Lce extends St{constructor(t){super(t),this.randomGenerator=new Pce(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(t,n),t}}Lce.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const e6e=["bilinear","nearest"],sY=new Set(e6e);class A9 extends Lce{constructor(t){super(t);const{factor:n,interpolation:r="bilinear"}=t;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new H(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new H(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new H(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(sY.has(r))this.interpolation=r;else throw new H(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=zt(t);const n=t[2];return[this.imgHeight,-1,n]}call(t,n){return K(()=>{const r=nt(t);this.imgHeight=r.shape[r.shape.length-3];const i=r.shape[r.shape.length-2];this.widthFactor=Jd([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let s=this.widthFactor.dataSync()[0]*i;s=Math.round(s);const o=[this.imgHeight,s];switch(this.interpolation){case"bilinear":return Eo.resizeBilinear(t,o);case"nearest":return Eo.resizeNearestNeighbor(t,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...sY]} are supported`)}})}}A9.className="RandomWidth";pe(A9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t6e(e){return new By(e)}function n6e(e){return new I7(e)}function r6e(e){return new T7(e)}function i6e(e){return new A7(e)}function s6e(e){return new N7(e)}function o6e(e){return new O7(e)}function a6e(e){return new D7(e)}function u6e(e){return new cC(e)}function N9(e){return new Vy(e)}function l6e(e){return new R7(e)}function c6e(e){return new jy(e)}function f6e(e){return new M7(e)}function d6e(e){return new P7(e)}function h6e(e){return new L7(e)}function p6e(e){return new z7(e)}function m6e(e){return new B7(e)}function g6e(e){return new X7(e)}function I9(e){return new G7(e)}function X3(e){return new G3(e)}function y6e(e){return new H7(e)}function zce(e){return new q7(e)}function b6e(e){return new K7(e)}function v6e(e){return new Y7(e)}function x6e(e){return new Z7(e)}function w6e(e){return new J7(e)}function S6e(e){return new e9(e)}function C6e(e){return new n9(e)}function k6e(e){return new s9(e)}function $6e(e){return new r9(e)}function _6e(e){return new i9(e)}function E6e(e){return new t9(e)}function T6e(e){return new o9(e)}function A6e(e){return new c9(e)}function N6e(e){return new f9(e)}function I6e(e){return new d9(e)}function D9(e){return new p9(e)}function D6e(e){return D9(e)}function O6e(e){return D9(e)}function O9(e){return new g9(e)}function F6e(e){return O9(e)}function R6e(e){return O9(e)}function F9(e){return new b9(e)}function M6e(e){return F9(e)}function P6e(e){return F9(e)}function L6e(e){return new v9(e)}function z6e(e){return new w9(e)}function Bce(e){return new x9(e)}function Uce(e){return new S9(e)}function Wce(e){return new h9(e)}function K3(e){return new m9(e)}function B6e(e){return new y9(e)}function U6e(e){return new W7(e)}function W6e(e){return new V3(e)}function V6e(e){return new V7(e)}function j6e(e){return new dC(e)}function H6e(e){return new U7(e)}function G6e(e){return new W3(e)}function q6e(e){return new j7(e)}function X6e(e){return new H3(e)}function K6e(e){return new Mu(e)}function Y6e(e){return new j3(e)}function Z6e(e){return new k9(e)}function Q6e(e){return new C9(e)}const J6e=Bce,eze=Uce,tze=Wce,nze=K3;function rze(e){return new a9(e)}function ize(e){return new u9(e)}function sze(e){return new l9(e)}function oze(e){return new Q7(e)}function aze(e){return new $9(e)}function uze(e){return new _9(e)}function lze(e){return new T9(e)}function cze(e){return new E9(e)}function fze(e){return new A9(e)}const dze=Object.freeze(Object.defineProperty({__proto__:null,Layer:St,RNN:Mu,RNNCell:fC,activation:g6e,add:S6e,alphaDropout:sze,average:C6e,averagePooling1d:D9,averagePooling2d:O9,averagePooling3d:F9,avgPool1d:D6e,avgPool2d:F6e,avgPool3d:M6e,avgPooling1d:O6e,avgPooling2d:R6e,avgPooling3d:P6e,batchNormalization:A6e,bidirectional:Z6e,categoryEncoding:cze,centerCrop:uze,concatenate:k6e,conv1d:u6e,conv2d:N9,conv2dTranspose:l6e,conv3d:c6e,conv3dTranspose:f6e,convLstm2d:q6e,convLstm2dCell:X6e,cropping2D:h6e,dense:I9,depthwiseConv2d:m6e,dot:T6e,dropout:X3,elu:n6e,embedding:w6e,flatten:zce,gaussianDropout:ize,gaussianNoise:rze,globalAveragePooling1d:L6e,globalAveragePooling2d:z6e,globalMaxPool1d:J6e,globalMaxPool2d:eze,globalMaxPooling1d:Bce,globalMaxPooling2d:Uce,gru:U6e,gruCell:W6e,input:uce,inputLayer:t6e,layerNormalization:N6e,leakyReLU:i6e,lstm:V6e,lstmCell:j6e,masking:oze,maxPool1d:tze,maxPool2d:nze,maxPooling1d:Wce,maxPooling2d:K3,maxPooling3d:B6e,maximum:$6e,minimum:_6e,multiply:E6e,permute:x6e,prelu:s6e,randomWidth:fze,reLU:r6e,repeatVector:b6e,rescaling:aze,reshape:v6e,resizing:lze,rnn:K6e,separableConv2d:d6e,simpleRNN:H6e,simpleRNNCell:G6e,softmax:o6e,spatialDropout1d:y6e,stackedRNNCells:Y6e,thresholdedReLU:a6e,timeDistributed:Q6e,upSampling2d:p6e,zeroPadding2d:I6e},Symbol.toStringTag,{value:"Module"}));function hze(e,t){return C7(e,t)}function pze(e,t){return Qle(e,t)}function mze(e,t){return Jle(e,t)}function gze(e,t){return k7(e,t)}function yze(e,t){return $7(e,t)}function bze(e,t){return Zle(e,t)}function vze(e,t){return nLe(e,t)}function xze(e,t){return S7(e,t)}function wze(e,t){return P3(e,t)}function Sze(e,t){return Uy(e,t)}function Cze(e,t){return Uy(e,t)}function kze(e,t){return Uy(e,t)}function $ze(e,t){return Um(e,t)}function _ze(e,t){return Um(e,t)}function Eze(e,t){return Um(e,t)}const Tze=Object.freeze(Object.defineProperty({__proto__:null,MAPE:Cze,MSE:_ze,binaryAccuracy:hze,binaryCrossentropy:pze,categoricalAccuracy:gze,categoricalCrossentropy:yze,cosineProximity:xze,mape:kze,meanAbsoluteError:wze,meanAbsolutePercentageError:Sze,meanSquaredError:$ze,mse:Eze,precision:bze,recall:vze,sparseCategoricalAccuracy:mze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Aze=Object.freeze(Object.defineProperty({__proto__:null,modelFromJSON:ILe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nze(e){return new lC(e)}function Ize(e){return PLe(e)}function Dze(e){return LLe(e)}const Oze=Object.freeze(Object.defineProperty({__proto__:null,l1:Ize,l1l2:Nze,l2:Dze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Vce extends X0{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof Oc))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function s$(e,t){return e<t}function oY(e,t){return e>t}class jce extends Vce{constructor(t){if(super(),t==null&&(t={}),t.restoreBestWeights)throw new ht("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=s$:this.mode==="max"?this.monitorFunc=oY:this.monitor.indexOf("acc")!==-1?this.monitorFunc=oY:this.monitorFunc=s$,this.monitorFunc===s$&&(this.minDelta*=-1)}async onTrainBegin(t){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===s$?1/0:-1/0}async onEpochEnd(t,n){await If(n);const r=this.getMonitorValue(n);r!=null&&(this.monitorFunc(r-this.minDelta,this.best)?(this.best=r,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))}async onTrainEnd(t){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(t){t==null&&(t={});const n=t[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(t)}`),n}}function Fze(e){return new jce(e)}const Rze={earlyStopping:Fze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mze=Y();Mze.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ds;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ds||(Ds={}));var aY;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(aY||(aY={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R9={};function Pze(e,t){const n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};R9[e]=n}function Hce(e){return R9[e]}function Lze(e){delete R9[e]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $(e,t,n,r,i){const s=t.inputParams[e];if(s&&s.inputIndexStart!==void 0){const a=s.inputIndexStart,u=s.inputIndexEnd===0?void 0:s.inputIndexEnd===void 0?a+1:s.inputIndexEnd,l=a<0?t.inputNames.length+a:a;if(s.type==="tensor")return Hr(t.inputNames[l],n,r,i);if(s.type==="tensors"){const d=t.inputs.slice(a,u);return t.inputNames.slice(a,u).filter((p,m)=>{var g;return((g=d[m])===null||g===void 0?void 0:g.op)!=="NoOp"}).map(p=>Hr(p,n,r,i))}const c=Hr(t.inputNames[l],n,r,i),f=c.dataSync();return s.type==="number"?f[0]:Po(c.shape,f)}const o=t.attrParams[e];return o&&o.value}function Hr(e,t,n,r){const[i,s]=Rs(e,n);if(r!=null){const a=r.getHashTableHandleByName(i);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!t[iT(i,a)]);return o!==void 0?t[iT(i,o)][s]:void 0}function uY(e,t,n){return t[iT(e,n.currentContextId)]}function dc(e,t){const[n,r,i]=Rs(e,t);return[iT(n,t&&t.currentContextId),r,i]}function iT(e,t){return t?`${e}-${t}`:e}function Rs(e,t){if(e==="")return["",0,void 0];const n=t!=null&&t.parseNodeNameCache!=null;if(n){const s=t.parseNodeNameCache.get(e);if(s!=null)return s}const r=e.split(":");let i;if(r.length===1)i=[e,0,void 0];else{const s=r[0],o=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);i=[s,a,o]}return n&&t.parseNodeNameCache.set(e,i),i}function P_(e,t,n){let r=$("pad",e,t,n);if(r==="explicit"){r=$("explicitPaddings",e,t,n);const i=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)i[s][0]=r[s*2],i[s][1]=r[s*2+1];return i}return r}function hc(e){return e.kept?e:gl(e)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zze=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Bze=Object.freeze(Object.defineProperty({__proto__:null,json:zze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uze=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Wze=Object.freeze(Object.defineProperty({__proto__:null,json:Uze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vze=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],jze=Object.freeze(Object.defineProperty({__proto__:null,json:Vze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hze=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Gze=Object.freeze(Object.defineProperty({__proto__:null,json:Hze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qze=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Xze=Object.freeze(Object.defineProperty({__proto__:null,json:qze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kze=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Yze=Object.freeze(Object.defineProperty({__proto__:null,json:Kze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zze=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Qze=Object.freeze(Object.defineProperty({__proto__:null,json:Zze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jze=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],eBe=Object.freeze(Object.defineProperty({__proto__:null,json:Jze},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tBe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],nBe=Object.freeze(Object.defineProperty({__proto__:null,json:tBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rBe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],iBe=Object.freeze(Object.defineProperty({__proto__:null,json:rBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sBe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],oBe=Object.freeze(Object.defineProperty({__proto__:null,json:sBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aBe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],uBe=Object.freeze(Object.defineProperty({__proto__:null,json:aBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lBe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],cBe=Object.freeze(Object.defineProperty({__proto__:null,json:lBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fBe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],dBe=Object.freeze(Object.defineProperty({__proto__:null,json:fBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hBe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],pBe=Object.freeze(Object.defineProperty({__proto__:null,json:hBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mBe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],gBe=Object.freeze(Object.defineProperty({__proto__:null,json:mBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yBe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],bBe=Object.freeze(Object.defineProperty({__proto__:null,json:yBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vBe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],xBe=Object.freeze(Object.defineProperty({__proto__:null,json:vBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wBe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],SBe=Object.freeze(Object.defineProperty({__proto__:null,json:wBe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lY{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[Bze,Wze,jze,Gze,Xze,Yze,Qze,eBe,nBe,iBe,oBe,uBe,cBe,dBe,pBe,gBe,bBe,xBe,SBe],n=[].concat(...t.map(r=>r.json));this.opMappers=n.reduce((r,i)=>(r[i.tfOpName]=i,r),{})}transformGraph(t,n={}){const r=t.node,i=[],s=[],o=[],a=r.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op.startsWith("Placeholder")?i.push(m[g.name]):g.op==="Const"?s.push(m[g.name]):(g.input==null||g.input.length===0)&&o.push(m[g.name]),m),{});let u=[];const l=[];let c={},f={};n!=null&&(c=this.mapSignatureEntries(n.inputs),f=this.mapSignatureEntries(n.outputs));const d=Object.keys(a);d.forEach(m=>{const g=a[m];g.inputNames.forEach((y,b)=>{const[v,,x]=dc(y),w=a[v];if(w.outputs!=null){const S=w.outputs.indexOf(x);if(S!==-1){const C=`${v}:${S}`;g.inputNames[b]=C}}g.inputs.push(w),w.children.push(g)})}),Object.keys(f).length===0?d.forEach(m=>{const g=a[m];g.children.length===0&&l.push(g)}):Object.keys(f).forEach(m=>{const[g]=dc(m),y=a[g];y!=null&&(y.signatureKey=f[m],l.push(y))}),Object.keys(c).length>0?Object.keys(c).forEach(m=>{const[g]=dc(m),y=a[g];y&&(y.signatureKey=c[m],u.push(y))}):u=i;let h={};t.library!=null&&t.library.function!=null&&(h=t.library.function.reduce((m,g)=>(m[g.signature.name]=this.mapFunction(g),m),{}));const p={nodes:a,inputs:u,outputs:l,weights:s,placeholders:i,signature:n,functions:h};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(t){return Object.keys(t||{}).reduce((n,r)=>(n[t[r].name]=r,n),{})}mapNode(t){const n=Hce(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const r={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(i=>i.startsWith("^")?i.slice(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((i,s)=>(i[s.name]={type:s.type,inputIndexStart:s.start,inputIndexEnd:s.end},i),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((i,s)=>{const o=s.type;let a;switch(s.type){case"string":a=W5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=W5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"string[]":a=K5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=K5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number":a=j5(t.attr,s.tfName,s.defaultValue||0),a===void 0&&s.tfDeprecatedName&&(a=j5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number[]":a=X5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=X5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool":a=V5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=V5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool[]":a=Z5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=Z5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape":a=q5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=q5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape[]":a=Y5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=Y5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype":a=H5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=H5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype[]":a=G5(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=G5(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"func":a=cY(t.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=cY(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${s.type} for op: ${t.op}`)}return i[s.name]={value:a,type:o},i},{})),r}mapFunction(t){const n=t.nodeDef,r=[],i=[];let s={};n!=null&&(s=n.reduce((f,d)=>(f[d.name]=this.mapNode(d),d.op==="Const"&&i.push(f[d.name]),f),{}));const o=[],a=[];t.signature.inputArg.forEach(f=>{const[d]=dc(f.name),h={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:M9(f.type),type:"dtype"}},children:[]};h.signatureKey=f.name,o.push(h),s[d]=h}),Object.keys(s).forEach(f=>{const d=s[f];d.inputNames.forEach((h,p)=>{const[m,,g]=dc(h),y=s[m];if(y.outputs!=null){const b=y.outputs.indexOf(g);if(b!==-1){const v=`${m}:${b}`;d.inputNames[p]=v}}d.inputs.push(y),y.children.push(d)})});const l=t.ret;t.signature.outputArg.forEach(f=>{const[d,h]=dc(l[f.name]),p=s[d];p!=null&&(p.defaultOutput=h,a.push(p))});const c=this.mapArgsToSignature(t);return{nodes:s,inputs:o,outputs:a,weights:i,placeholders:r,signature:c}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:t.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,t.ret),n),{})}}mapArgToTensorInfo(t,n){let r=t.name;return n!=null&&(r=n[r]),{name:r,dtype:t.type}}}function CBe(e){const t=Y().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Gce(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):CBe(e);return t?n:n.toLowerCase()}function W5(e,t,n,r=!1){const i=e[t];return i!=null?Gce(i.s,r):n}function V5(e,t,n){const r=e[t];return r?r.b:n}function j5(e,t,n){const r=e[t]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function M9(e){switch(typeof e=="string"&&(e=Ds[e]),e){case Ds.DT_FLOAT:case Ds.DT_HALF:return"float32";case Ds.DT_INT32:case Ds.DT_INT64:case Ds.DT_INT8:case Ds.DT_UINT8:return"int32";case Ds.DT_BOOL:return"bool";case Ds.DT_DOUBLE:return"float32";case Ds.DT_STRING:return"string";case Ds.DT_COMPLEX64:case Ds.DT_COMPLEX128:return"complex64";default:return null}}function cY(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function H5(e,t,n){const r=e[t];return r&&r.type?M9(r.type):n}function G5(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map(i=>M9(i)):n}function qce(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function q5(e,t,n){const r=e[t];return r&&r.shape?qce(r.shape):n}function X5(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(i=>typeof i=="number"?i:parseInt(i,10)):n}function K5(e,t,n,r=!1){const i=e[t];return i&&i.list&&i.list.s?i.list.s.map(s=>Gce(s,r)):n}function Y5(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(i=>qce(i)):n}function Z5(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kBe{constructor(t,n,r){this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(i=>this.getInput(i)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((i,s)=>(i[s]=this.getAttr(s),i),{}))}getInput(t){return Hr(t,this.tensorMap,this.context)}getAttr(t,n){const r=this.node.rawAttrs[t];if(r.tensor!=null)return Hr(t,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return j5(this.node.rawAttrs,t,n);if(r.s!=null)return W5(this.node.rawAttrs,t,n);if(r.b!=null)return V5(this.node.rawAttrs,t,n);if(r.shape!=null)return q5(this.node.rawAttrs,t,n);if(r.type!=null)return H5(this.node.rawAttrs,t,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return X5(this.node.rawAttrs,t,n);if(r.list.s!=null)return K5(this.node.rawAttrs,t,n);if(r.list.shape!=null)return Y5(this.node.rawAttrs,t,n);if(r.list.b!=null)return Z5(this.node.rawAttrs,t,n);if(r.list.type!=null)return G5(this.node.rawAttrs,t,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const si=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:aB,abs:ar,acos:mB,acosh:gB,add:de,addN:Iae,all:UI,any:Ew,argMax:Wp,argMin:yB,asin:bB,asinh:vB,atan:xB,atan2:wB,atanh:SB,avgPool:LS,avgPool3d:kB,basicLSTMCell:Dae,batchNorm:Dy,batchNorm2d:$B,batchNorm3d:_B,batchNorm4d:EB,batchToSpaceND:zS,bincount:TB,bitwiseAnd:Oae,booleanMaskAsync:bue,broadcastArgs:Fae,broadcastTo:Sp,buffer:mt,cast:Ce,ceil:AB,clipByValue:ys,clone:gl,complex:Gc,concat:tr,concat1d:NB,concat2d:IB,concat3d:DB,concat4d:OB,conv1d:WI,conv2d:qc,conv2dTranspose:VI,conv3d:RB,conv3dTranspose:MB,cos:BS,cosh:jI,cosineWindow:h3,cumprod:Nw,cumsum:HI,denseBincount:qE,depthToSpace:PB,depthwiseConv2d:Oy,diag:Mae,dilation2d:LB,div:Ue,divNoNan:zB,dot:BB,dropout:x8,einsum:ep,elu:Fy,enclosingPowerOfTwo:w8,ensureShape:Pae,equal:eo,erf:GI,euclideanNorm:WB,exp:bs,expandDims:jr,expm1:VB,eye:qI,fft:JS,fill:Rm,floor:My,floorDiv:BI,fused:Eue,gather:Py,gatherND:Sue,greater:Ki,greaterEqual:lf,ifft:G0,imag:US,image:Eo,inTopKAsync:Cue,irfft:a3,isFinite:jB,isInf:HB,isNaN:GB,leakyRelu:WS,less:W0,lessEqual:Qd,linalg:k8,linspace:Bae,localResponseNormalization:qB,log:to,log1p:VS,logSigmoid:XB,logSoftmax:KI,logSumExp:jS,logicalAnd:Oa,logicalNot:HS,logicalOr:YI,logicalXor:KB,losses:Fue,lowerBound:Wae,matMul:vt,max:Lo,maxPool:GS,maxPool3d:YB,maxPoolWithArgmax:Vae,maximum:Vl,mean:Pn,meshgrid:jae,min:U0,minimum:Ed,mirrorPad:ZB,mod:QB,moments:qS,movingAverage:vue,mul:U,multiRNNCell:Hae,multinomial:Gae,neg:yn,norm:Ry,notEqual:Hp,oneHot:V0,ones:ls,onesLike:no,op:z,outerProduct:qae,pad:cf,pad1d:Xae,pad2d:Kae,pad3d:Yae,pad4d:Zae,pool:JB,pow:Il,prelu:KS,print:pB,prod:e8,raggedGather:Qae,raggedRange:Jae,raggedTensorToTensor:eue,rand:tue,randomGamma:sue,randomNormal:QI,randomStandardNormal:oue,randomUniform:Jd,randomUniformInt:aue,range:Gp,real:j0,reciprocal:c8,relu:Fu,relu6:JI,reshape:j,reverse:Uo,reverse1d:uue,reverse2d:lue,reverse3d:cue,reverse4d:fue,rfft:eC,round:e3,rsqrt:t3,scalar:Ze,scatterND:xue,searchSorted:ZI,selu:n3,separableConv2d:r3,setdiff1dAsync:due,sigmoid:mu,sign:f8,signal:Oue,sin:i3,sinh:s3,slice:At,slice1d:YS,slice2d:o3,slice3d:ZS,slice4d:H0,softmax:QS,softplus:Mm,spaceToBatchND:XS,sparse:Rue,sparseToDense:wue,spectral:Due,split:ps,sqrt:Or,square:rn,squaredDifference:u3,squeeze:eh,stack:Hi,step:Lm,stridedSlice:d8,string:Mue,sub:Re,sum:Le,tan:h8,tanh:_d,tensor:hs,tensor1d:qr,tensor2d:yl,tensor3d:p8,tensor4d:hue,tensor5d:pue,tensor6d:mue,tensorScatterUpdate:gue,tile:_o,topk:g8,transpose:Tt,truncatedNormal:c3,unique:y8,unsortedSegmentSum:f3,unstack:Wo,upperBound:yue,variable:b8,where:Ir,whereAsync:v8,zeros:lr,zerosLike:Nt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Be=(e,t,n,r=si)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add($("a",e,t,n),$("b",e,t,n))];case"AddN":return[r.addN($("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod($("a",e,t,n),$("b",e,t,n))];case"Mul":return[r.mul($("a",e,t,n),$("b",e,t,n))];case"RealDiv":case"Div":return[r.div($("a",e,t,n),$("b",e,t,n))];case"DivNoNan":return[r.divNoNan($("a",e,t,n),$("b",e,t,n))];case"FloorDiv":return[r.floorDiv($("a",e,t,n),$("b",e,t,n))];case"Sub":return[r.sub($("a",e,t,n),$("b",e,t,n))];case"Minimum":return[r.minimum($("a",e,t,n),$("b",e,t,n))];case"Maximum":return[r.maximum($("a",e,t,n),$("b",e,t,n))];case"Pow":return[r.pow($("a",e,t,n),$("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference($("a",e,t,n),$("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Be=(e,t,n,r=si)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r.abs($("x",e,t,n))];case"Acos":return[r.acos($("x",e,t,n))];case"Acosh":return[r.acosh($("x",e,t,n))];case"Asin":return[r.asin($("x",e,t,n))];case"Asinh":return[r.asinh($("x",e,t,n))];case"Atan":return[r.atan($("x",e,t,n))];case"Atan2":return[r.atan2($("x",e,t,n),$("y",e,t,n))];case"Atanh":return[r.atanh($("x",e,t,n))];case"Ceil":return[r.ceil($("x",e,t,n))];case"Complex":return[r.complex($("real",e,t,n),$("imag",e,t,n))];case"Cos":return[r.cos($("x",e,t,n))];case"Cosh":return[r.cosh($("x",e,t,n))];case"Elu":return[r.elu($("x",e,t,n))];case"Erf":return[r.erf($("x",e,t,n))];case"Exp":return[r.exp($("x",e,t,n))];case"Expm1":return[r.expm1($("x",e,t,n))];case"Floor":return[r.floor($("x",e,t,n))];case"Log":return[r.log($("x",e,t,n))];case"Log1p":return[r.log1p($("x",e,t,n))];case"Imag":return[r.imag($("x",e,t,n))];case"Neg":return[r.neg($("x",e,t,n))];case"Reciprocal":return[r.reciprocal($("x",e,t,n))];case"Real":return[r.real($("x",e,t,n))];case"Relu":return[r.relu($("x",e,t,n))];case"Round":return[r.round($("x",e,t,n))];case"Selu":return[r.selu($("x",e,t,n))];case"Sigmoid":return[r.sigmoid($("x",e,t,n))];case"Sin":return[r.sin($("x",e,t,n))];case"Sign":return[r.sign($("x",e,t,n))];case"Sinh":return[r.sinh($("x",e,t,n))];case"Softplus":return[r.softplus($("x",e,t,n))];case"Sqrt":return[r.sqrt($("x",e,t,n))];case"Square":return[r.square($("x",e,t,n))];case"Tanh":return[r.tanh($("x",e,t,n))];case"Tan":return[r.tan($("x",e,t,n))];case"ClipByValue":return[r.clipByValue($("x",e,t,n),$("clipValueMin",e,t,n),$("clipValueMax",e,t,n))];case"Relu6":return[r.relu6($("x",e,t,n))];case"Rsqrt":return[r.rsqrt(Hr(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu($("x",e,t,n),$("alpha",e,t,n))];case"Prelu":return[r.prelu($("x",e,t,n),$("alpha",e,t,n))];case"IsNan":return[r.isNaN(Hr(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(Hr(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(Hr(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ia(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){A(e.length===t.length,()=>n+` Shapes ${e} and ${t} must match`);for(let r=0;r<e.length;r++){const i=e[r],s=t[r];A(i<0||s<0||i===s,()=>n+` Shapes ${e} and ${t} must match`)}}}function fY(e){return!(typeof e=="number"||e.some(t=>t<0))}function Zb(e,t,n){let r=Q5(e,n);const i=!fY(r);if(i&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&t.forEach(s=>{r=Q5(s.shape,r)}),!fY(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Q5(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let r=0;r<e.length;++r){const i=e[r],s=t[r];if(i>=0&&s>=0&&i!==s)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=i>=0?i:s}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EBe{constructor(t,n,r,i,s,o,a){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=s,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Ze(0),xr(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const n=this.tensors[t];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(t){return t.map(n=>this.read(n))}write(t,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),ia(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);r.tensor=n,xr(n),r.written=!0,this.tensors[t]=r}writeMany(t,n){if(t.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${n.length}.`);t.forEach((r,i)=>this.write(r,n[i]))}gather(t,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(t)t=t.slice(0,this.size());else{t=[];for(let i=0;i<this.size();i++)t.push(i)}if(t.length===0)return hs([],[0].concat(this.elementShape));const r=this.readMany(t);return ia(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Hi(r,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return hs([],[0].concat(this.elementShape));const n=[];for(let i=0;i<this.size();i++)n.push(i);const r=this.readMany(n);return ia(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),tr(r,0)}scatter(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const r=Math.max(...t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(t,Wo(n,0))}split(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const i=t.map(u=>(r+=u,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const s=r===0?0:n.size/r,o=[];K(()=>{n=j(n,[1,r,s]);for(let u=0;u<t.length;++u){const c=[0,u===0?0:i[u-1],0],f=[1,t[u],s];o[u]=j(At(n,c,f),this.elementShape)}return o});const a=[];for(let u=0;u<t.length;u++)a[u]=u;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kp{get id(){return this.idTensor.id}constructor(t,n,r,i=-1){this.tensors=t,this.elementShape=n,this.elementDtype=r,t!=null&&t.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);ia(n,s.shape,"TensorList shape mismatch: "),xr(s)}),this.idTensor=Ze(0),this.maxNumElements=i,xr(this.idTensor)}copy(){return new Kp([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);ia(t,this.elementShape,"TensorList shape mismatch: ");const i=Zb(this.elementShape,this.tensors,t);return K(()=>{const s=this.tensors.map(o=>j(o,i));return Hi(s,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Zb(this.elementShape,this.tensors,t),i=this.tensors.pop();return i.kept=!1,ia(i.shape,t,"TensorList shape mismatch: "),j(i,r)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(ia(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");xr(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const n=new Kp([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let r=0;r<Math.min(this.tensors.length,t);++r)n.tensors[r]=this.tensors[r];return n}getItem(t,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);ia(this.tensors[t].shape,n,"TensorList shape mismatch: ");const i=Zb(this.elementShape,this.tensors,n);return j(this.tensors[t],i)}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);ia(this.elementShape,n.shape,"TensorList shape mismatch: "),xr(n),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=n}gather(t,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);ia(this.elementShape,r,"TensorList shape mismatch: "),t=t.slice(0,this.size());const i=Zb(this.elementShape,this.tensors,r);return t.length===0?hs([],[0].concat(i)):K(()=>{const s=t.map(o=>j(this.tensors[o],i));return Hi(s,0)})}concat(t,n){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);ia(this.elementShape,n,"TensorList shape mismatch: ");const r=Zb(this.elementShape,this.tensors,n);return this.size()===0?hs([],[0].concat(r)):K(()=>{const i=this.tensors.map(s=>j(s,r));return tr(i,0)})}}function TBe(e,t,n){const r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);const i=e.shape.slice(1);ia(i,t,"TensorList shape mismatch: ");const s=Wo(e);return new Kp(s,t,r)}function ABe(e,t,n,r){return new Kp([],e,t,r)}function NBe(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const i=Math.max(...t);if(r!=null&&r!==-1&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const s=new Kp([],n,e.dtype,r),o=Wo(e,0);return t.forEach((a,u)=>{s.setItem(a,o[u])}),s}function IBe(e,t,n){let r=0;const i=t.map(c=>(r+=c,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${e.shape}`);const s=e.shape.slice(1),o=Q5(s,n),a=r===0?0:e.size/r,u=K(()=>{const c=[];e=j(e,[1,r,a]);for(let f=0;f<t.length;++f){const h=[0,f===0?0:i[f-1],0],p=[1,t[f],a];c[f]=j(At(e,h,p),o)}return e.dispose(),c}),l=new Kp([],n,e.dtype,t.length);for(let c=0;c<u.length;c++)l.setItem(c,u[c]);return l}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DBe=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=$("thenBranch",e,t,n),i=$("elseBranch",e,t,n),s=$("cond",e,t,n),o=$("args",e,t,n);return(await s.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=$("body",e,t,n),i=$("cond",e,t,n),s=$("args",e,t,n),o=await n.functionMap[i].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap),a=s.map(c=>c.id);let u=await o[0].data();o.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let l=s;for(;u[0];){const c=l;l=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const f=l.map(h=>h.id);c.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&f.indexOf(h.id)===-1&&h.dispose()});const d=await n.functionMap[i].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);u=await d[0].data(),d.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&f.indexOf(h.id)===-1&&h.dispose()})}return l}case"LoopCond":{const r=$("pred",e,t,n);return[hc(r)]}case"Switch":{const r=$("pred",e,t,n);let i=$("data",e,t,n);return i.kept||(i=hc(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=e.inputNames.find(i=>Hr(i,t,n)!==void 0);if(r){const i=Hr(r,t,n);return[hc(i)]}return}case"Enter":{const r=$("frameName",e,t,n),i=$("tensor",e,t,n);return n.enterFrame(r),[hc(i)]}case"Exit":{const r=$("tensor",e,t,n);return n.exitFrame(),[hc(r)]}case"NextIteration":{const r=$("tensor",e,t,n);return n.nextIteration(),[hc(r)]}case"TensorArrayV3":{const r=$("size",e,t,n),i=$("dtype",e,t,n),s=$("elementShape",e,t,n),o=$("dynamicSize",e,t,n),a=$("clearAfterRead",e,t,n),u=$("identicalElementShapes",e,t,n),l=$("name",e,t,n),c=new EBe(l,i,r,s,u,o,a);return n.addTensorArray(c),[c.idTensor,Ze(1)]}case"TensorArrayWriteV3":{const r=$("tensorArrayId",e,t,n),i=$("index",e,t,n),s=$("tensor",e,t,n),o=n.getTensorArray(r.id);return o.write(i,s),[o.idTensor]}case"TensorArrayReadV3":{const r=$("tensorArrayId",e,t,n),i=$("index",e,t,n);return[n.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=$("tensorArrayId",e,t,n),i=$("indices",e,t,n),s=$("dtype",e,t,n);return[n.getTensorArray(r.id).gather(i,s)]}case"TensorArrayScatterV3":{const r=$("tensorArrayId",e,t,n),i=$("indices",e,t,n),s=$("tensor",e,t,n),o=n.getTensorArray(r.id);return o.scatter(i,s),[o.idTensor]}case"TensorArrayConcatV3":{const r=$("tensorArrayId",e,t,n),i=n.getTensorArray(r.id),s=$("dtype",e,t,n);return[i.concat(s)]}case"TensorArraySplitV3":{const r=$("tensorArrayId",e,t,n),i=$("tensor",e,t,n),s=$("lengths",e,t,n),o=n.getTensorArray(r.id);return o.split(s,i),[o.idTensor]}case"TensorArraySizeV3":{const r=$("tensorArrayId",e,t,n),i=n.getTensorArray(r.id);return[Ze(i.size(),"int32")]}case"TensorArrayCloseV3":{const r=$("tensorArrayId",e,t,n),i=n.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=$("tensorListId",e,t,n),i=$("index",e,t,n),s=$("tensor",e,t,n),o=n.getTensorList(r.id);return o.setItem(i,s),[o.idTensor]}case"TensorListGetItem":{const r=$("tensorListId",e,t,n),i=$("index",e,t,n),s=$("elementShape",e,t,n),o=$("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(i,s,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=$("indices",e,t,n),i=$("tensor",e,t,n),s=$("elementShape",e,t,n),o=$("numElements",e,t,n),a=NBe(i,r,s,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=$("elementShape",e,t,n),i=$("elementDType",e,t,n);let s;e.op==="TensorListReserve"?s="numElements":s="maxNumElements";const o=$(s,e,t,n),a=e.op==="TensorListReserve"?-1:o,u=ABe(r,i,o,a);return n.addTensorList(u),[u.idTensor]}case"TensorListGather":{const r=$("tensorListId",e,t,n),i=$("indices",e,t,n),s=$("elementShape",e,t,n),o=$("elementDType",e,t,n);return[n.getTensorList(r.id).gather(i,o,s)]}case"TensorListStack":{const r=$("tensorListId",e,t,n),i=$("elementShape",e,t,n),s=$("elementDType",e,t,n),o=$("numElements",e,t,n);return[n.getTensorList(r.id).stack(i,s,o)]}case"TensorListFromTensor":{const r=$("tensor",e,t,n),i=$("elementShape",e,t,n),s=$("elementDType",e,t,n),o=TBe(r,i,s);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=$("tensorListId",e,t,n),i=n.getTensorList(r.id),s=$("dtype",e,t,n),o=$("elementShape",e,t,n);return[i.concat(s,o)]}case"TensorListPushBack":{const r=$("tensorListId",e,t,n),i=$("tensor",e,t,n),s=n.getTensorList(r.id);return s.pushBack(i),[s.idTensor]}case"TensorListPopBack":{const r=$("tensorListId",e,t,n),i=$("elementShape",e,t,n),s=$("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(i,s)]}case"TensorListSplit":{const r=$("tensor",e,t,n),i=$("elementShape",e,t,n),s=$("lengths",e,t,n),o=IBe(r,s,i);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=$("tensorListId",e,t,n),i=n.getTensorList(r.id);return[Ze(i.size(),"int32")]}case"TensorListResize":{const r=$("tensorListId",e,t,n),i=$("size",e,t,n),o=n.getTensorList(r.id).resize(i);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dY(e,t,n){const[r,i]=$("fusedOps",e,t,n),s=r==="biasadd",o=!s,a=i==="prelu",u=r==="fusedbatchnorm",l=$("numArgs",e,t,n);if(s){if(a&&l!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&s&&l!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=$("strides",e,t,n),f=P_(e,t,n),d=$("dataFormat",e,t,n).toUpperCase(),h=$("dilations",e,t,n);let[p,m]=$("args",e,t,n);o&&(m=p,p=void 0);const g=$("leakyreluAlpha",e,t,n);return{stride:c,pad:f,dataFormat:d,dilations:h,biasArg:p,preluArg:m,activationFunc:i,leakyreluAlpha:g}}const OBe=(e,t,n,r=si)=>{switch(e.op){case"Conv1D":{const i=$("stride",e,t,n),s=$("pad",e,t,n),o=$("dataFormat",e,t,n).toUpperCase(),a=$("dilation",e,t,n);return[r.conv1d($("x",e,t,n),$("filter",e,t,n),i,s,o,a)]}case"Conv2D":{const i=$("strides",e,t,n),s=P_(e,t,n),o=$("dataFormat",e,t,n).toUpperCase(),a=$("dilations",e,t,n);return[r.conv2d($("x",e,t,n),$("filter",e,t,n),[i[1],i[2]],s,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:i,pad:s,dataFormat:o,dilations:a,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:f}=dY(e,t,n);return[r.fused.conv2d({x:$("x",e,t,n),filter:$("filter",e,t,n),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:s,dataFormat:o,dilations:a,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:f}=dY(e,t,n);return[r.fused.depthwiseConv2d({x:$("x",e,t,n),filter:$("filter",e,t,n),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=$("outputShape",e,t,n),s=$("strides",e,t,n),o=P_(e,t,n);return[r.conv2dTranspose($("x",e,t,n),$("filter",e,t,n),i,[s[1],s[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=$("strides",e,t,n),s=P_(e,t,n),o=$("dilations",e,t,n),a=$("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d($("input",e,t,n),$("filter",e,t,n),[i[1],i[2]],s,a,[o[1],o[2]])]}case"Conv3D":{const i=$("strides",e,t,n),s=$("pad",e,t,n),o=$("dataFormat",e,t,n).toUpperCase(),a=$("dilations",e,t,n);return[r.conv3d($("x",e,t,n),$("filter",e,t,n),[i[1],i[2],i[3]],s,o,[a[1],a[2],a[3]])]}case"AvgPool":{const i=$("strides",e,t,n),s=$("pad",e,t,n),o=$("kernelSize",e,t,n);return[r.avgPool($("x",e,t,n),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPool":{const i=$("strides",e,t,n),s=$("pad",e,t,n),o=$("kernelSize",e,t,n);return[r.maxPool($("x",e,t,n),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPoolWithArgmax":{const i=$("strides",e,t,n),s=$("pad",e,t,n),o=$("kernelSize",e,t,n),a=$("includeBatchInIndex",e,t,n),{result:u,indexes:l}=r.maxPoolWithArgmax($("x",e,t,n),[o[1],o[2]],[i[1],i[2]],s,a);return[u,l]}case"AvgPool3D":{const i=$("strides",e,t,n),s=$("pad",e,t,n),o=$("kernelSize",e,t,n);return[r.avgPool3d($("x",e,t,n),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"MaxPool3D":{const i=$("strides",e,t,n),s=$("pad",e,t,n),o=$("kernelSize",e,t,n);return[r.maxPool3d($("x",e,t,n),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"Dilation2D":{const i=$("strides",e,t,n),s=$("pad",e,t,n),o=$("dilations",e,t,n),a=i[1],u=i[2],l=o[1],c=o[2];return[r.dilation2d($("x",e,t,n),$("filter",e,t,n),[a,u],s,[l,c],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FBe=(e,t,n,r=si)=>{switch(e.op){case"Fill":{const i=$("shape",e,t,n),s=$("dtype",e,t,n),o=$("value",e,t,n);return[r.fill(i,o,s)]}case"LinSpace":{const i=$("start",e,t,n),s=$("stop",e,t,n),o=$("num",e,t,n);return[r.linspace(i,s,o)]}case"Multinomial":{const i=$("logits",e,t,n),s=$("numSamples",e,t,n),o=$("seed",e,t,n);return[r.multinomial(i,s,o)]}case"OneHot":{const i=$("indices",e,t,n),s=$("depth",e,t,n),o=$("onValue",e,t,n),a=$("offValue",e,t,n),u=$("dtype",e,t,n);return[r.oneHot(i,s,o,a,u)]}case"Ones":return[r.ones($("shape",e,t,n),$("dtype",e,t,n))];case"OnesLike":return[r.onesLike($("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal($("shape",e,t,n),$("dtype",e,t,n),$("seed",e,t,n))];case"RandomUniform":return[r.randomUniform($("shape",e,t,n),$("minval",e,t,n),$("maxval",e,t,n),$("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt($("shape",e,t,n),$("minval",e,t,n),$("maxval",e,t,n),$("seed",e,t,n))];case"Range":{const i=$("start",e,t,n),s=$("stop",e,t,n),o=$("step",e,t,n);return[r.range(i,s,o,$("dtype",e,t,n))]}case"TruncatedNormal":{const i=$("shape",e,t,n),s=$("mean",e,t,n),o=$("stdDev",e,t,n),a=$("seed",e,t,n);return[r.truncatedNormal(i,s,o,$("dtype",e,t,n),a)]}case"Zeros":return[r.zeros($("shape",e,t,n),$("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike($("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CR(e,t,n){const r=$("boxes",e,t,n),i=$("scores",e,t,n),s=$("maxOutputSize",e,t,n),o=$("iouThreshold",e,t,n),a=$("scoreThreshold",e,t,n),u=$("softNmsSigma",e,t,n);return{boxes:r,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:a,softNmsSigma:u}}const RBe=async(e,t,n,r,i=si)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:s,scores:o,maxOutputSize:a,iouThreshold:u,scoreThreshold:l,softNmsSigma:c}=CR(e,t,n),f=await i.image.nonMaxSuppressionWithScoreAsync(s,o,a,u,l,c);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:s,scores:o,maxOutputSize:a,iouThreshold:u,scoreThreshold:l}=CR(e,t,n),c=$("padToMaxOutputSize",e,t,n),f=await i.image.nonMaxSuppressionPaddedAsync(s,o,a,u,l,c);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:s,scores:o,maxOutputSize:a,iouThreshold:u,scoreThreshold:l}=CR(e,t,n);return[await i.image.nonMaxSuppressionAsync(s,o,a,u,l)]}case"Where":{const s=i.cast($("condition",e,t,n),"bool"),o=[await i.whereAsync(s)];return s.dispose(),o}case"ListDiff":return i.setdiff1dAsync($("x",e,t,n),$("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MBe=(e,t,n,r=si)=>{switch(e.op){case"LowerBound":{const i=$("sortedSequence",e,t,n),s=$("values",e,t,n);return[r.lowerBound(i,s)]}case"TopKV2":{const i=$("x",e,t,n),s=$("k",e,t,n),o=$("sorted",e,t,n),a=r.topk(i,s,o);return[a.values,a.indices]}case"UpperBound":{const i=$("sortedSequence",e,t,n),s=$("values",e,t,n);return[r.upperBound(i,s)]}case"Unique":{const i=$("x",e,t,n),s=r.unique(i);return[s.values,s.indices]}case"UniqueV2":{const i=$("x",e,t,n),s=$("axis",e,t,n),o=r.unique(i,s);return[o.values,o.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PBe=(e,t,n,r=si)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const i=$("default",e,t,n);return[Hr(e.name,t,n)||i];case"Placeholder":return[Hr(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=$("x",e,t,n);return[hc(c)]}case"IdentityN":return $("x",e,t,n).map(c=>hc(c));case"Snapshot":const s=$("x",e,t,n);return[hc(s)];case"Shape":return[r.tensor1d($("x",e,t,n).shape,"int32")];case"ShapeN":return $("x",e,t,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar($("x",e,t,n).size,"int32")];case"Rank":return[r.scalar($("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=$("x",e,t,n),a=$("data",e,t,n),u=$("message",e,t,n),l=$("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,l));return[o];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LBe{get id(){return this.handle.id}constructor(t,n){this.keyDType=t,this.valueDType=n,this.handle=Ze(0),this.tensorMap=new Map,xr(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ze(this.size(),"int32")}async import(t,n){this.checkKeyAndValueTensor(t,n);const r=await t.data();return this.tensorMap.forEach(i=>i.dispose()),this.tensorMap.clear(),K(()=>{const i=Wo(n),s=r.length,o=i.length;A(s===o,()=>`The number of elements doesn't match, keys has ${s} elements, the values has ${o} elements.`);for(let a=0;a<s;a++){const u=r[a],l=i[a];xr(l),this.tensorMap.set(u,l)}return this.handle})}async find(t,n){this.checkKeyAndValueTensor(t,n);const r=await t.data();return K(()=>{const i=[];for(let s=0;s<r.length;s++){const o=r[s],a=this.findWithDefault(o,n);i.push(a)}return Hi(i)})}findWithDefault(t,n){const r=this.tensorMap.get(t);return r??n}checkKeyAndValueTensor(t,n){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zBe=async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{const i=r.getHashTableHandleByName(e.name);if(i!=null)return[i];{const s=$("keyDType",e,t,n),o=$("valueDType",e,t,n),a=new LBe(s,o);return r.addHashTable(e.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const i=$("tableHandle",e,t,n,r),s=$("keys",e,t,n),o=$("values",e,t,n);return[await r.getHashTableById(i.id).import(s,o)]}case"LookupTableFind":case"LookupTableFindV2":{const i=$("tableHandle",e,t,n,r),s=$("keys",e,t,n),o=$("defaultValue",e,t,n);return[await r.getHashTableById(i.id).find(s,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=$("tableHandle",e,t,n,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BBe=(e,t,n,r=si)=>{switch(e.op){case"ResizeBilinear":{const i=$("images",e,t,n),s=$("size",e,t,n),o=$("alignCorners",e,t,n),a=$("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(i,[s[0],s[1]],o,a)]}case"ResizeNearestNeighbor":{const i=$("images",e,t,n),s=$("size",e,t,n),o=$("alignCorners",e,t,n),a=$("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(i,[s[0],s[1]],o,a)]}case"CropAndResize":{const i=$("image",e,t,n),s=$("boxes",e,t,n),o=$("boxInd",e,t,n),a=$("cropSize",e,t,n),u=$("method",e,t,n),l=$("extrapolationValue",e,t,n);return[r.image.cropAndResize(i,s,o,a,u,l)]}case"ImageProjectiveTransformV3":{const i=$("images",e,t,n),s=$("transforms",e,t,n),o=$("outputShape",e,t,n),a=$("fillValue",e,t,n),u=$("interpolation",e,t,n),l=$("fillMode",e,t,n);return[r.image.transform(i,s,u.toLowerCase(),l.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UBe=(e,t,n,r=si)=>{switch(e.op){case"Equal":return[r.equal($("a",e,t,n),$("b",e,t,n))];case"NotEqual":return[r.notEqual($("a",e,t,n),$("b",e,t,n))];case"Greater":return[r.greater($("a",e,t,n),$("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual($("a",e,t,n),$("b",e,t,n))];case"Less":return[r.less($("a",e,t,n),$("b",e,t,n))];case"LessEqual":return[r.lessEqual($("a",e,t,n),$("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd($("a",e,t,n),$("b",e,t,n))];case"LogicalNot":return[r.logicalNot($("a",e,t,n))];case"LogicalOr":return[r.logicalOr($("a",e,t,n),$("b",e,t,n))];case"Select":case"SelectV2":return[r.where($("condition",e,t,n),$("a",e,t,n),$("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd($("a",e,t,n),$("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WBe=(e,t,n,r=si)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul($("a",e,t,n),$("b",e,t,n),$("transposeA",e,t,n),$("transposeB",e,t,n))];case"Einsum":return[r.einsum($("equation",e,t,n),...$("tensors",e,t,n))];case"Transpose":return[r.transpose($("x",e,t,n),$("perm",e,t,n))];case"_FusedMatMul":const[i,s]=$("fusedOps",e,t,n),o=i==="biasadd",a=s==="prelu",u=$("numArgs",e,t,n),l=$("leakyreluAlpha",e,t,n);if(o){if(a&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,f]=$("args",e,t,n);return[r.fused.matMul({a:$("a",e,t,n),b:$("b",e,t,n),transposeA:$("transposeA",e,t,n),transposeB:$("transposeB",e,t,n),bias:c,activation:s,preluActivationWeights:f,leakyreluAlpha:l})];case"MatrixBandPart":return[r.linalg.bandPart($("a",e,t,n),$("numLower",e,t,n),$("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VBe=(e,t,n,r=si)=>{switch(e.op){case"EuclideanNorm":return[r.euclideanNorm($("x",e,t,n),$("axis",e,t,n),$("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm($("x",e,t,n),$("mean",e,t,n),$("variance",e,t,n),$("offset",e,t,n),$("scale",e,t,n),$("epsilon",e,t,n))];case"FusedBatchNormV3":return[r.batchNorm($("x",e,t,n),$("mean",e,t,n),$("variance",e,t,n),$("offset",e,t,n),$("scale",e,t,n),$("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization($("x",e,t,n),$("radius",e,t,n),$("bias",e,t,n),$("alpha",e,t,n),$("beta",e,t,n))];case"Softmax":return[r.softmax($("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax($("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jBe=(e,t,n,r=si)=>{switch(e.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:s}=r.raggedGather($("paramsNestedSplits",e,t,n),$("paramsDenseValues",e,t,n),$("indices",e,t,n),$("outputRaggedRank",e,t,n));return i.concat(s)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:s}=r.raggedRange($("starts",e,t,n),$("limits",e,t,n),$("splits",e,t,n));return[i,s]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor($("shape",e,t,n),$("values",e,t,n),$("defaultValue",e,t,n),$("rowPartitionTensors",e,t,n),$("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HBe=(e,t,n,r=si)=>{switch(e.op){case"Max":{const a=$("axis",e,t,n),u=$("keepDims",e,t,n);return[r.max($("x",e,t,n),a,u)]}case"Mean":{const a=$("axis",e,t,n),u=$("keepDims",e,t,n);return[r.mean($("x",e,t,n),a,u)]}case"Min":{const a=$("axis",e,t,n),u=$("keepDims",e,t,n);return[r.min($("x",e,t,n),a,u)]}case"Sum":{const a=$("axis",e,t,n),u=$("keepDims",e,t,n);return[r.sum($("x",e,t,n),a,u)]}case"All":{const a=$("axis",e,t,n),u=$("keepDims",e,t,n);return[r.all($("x",e,t,n),a,u)]}case"Any":{const a=$("axis",e,t,n),u=$("keepDims",e,t,n);return[r.any($("x",e,t,n),a,u)]}case"ArgMax":{const a=$("axis",e,t,n);return[r.argMax($("x",e,t,n),a)]}case"ArgMin":{const a=$("axis",e,t,n);return[r.argMin($("x",e,t,n),a)]}case"Prod":{const a=$("axis",e,t,n),u=$("keepDims",e,t,n);return[r.prod($("x",e,t,n),a,u)]}case"Cumprod":{const a=$("axis",e,t,n),u=$("exclusive",e,t,n),l=$("reverse",e,t,n);return[r.cumprod($("x",e,t,n),a,u,l)]}case"Cumsum":{const a=$("axis",e,t,n),u=$("exclusive",e,t,n),l=$("reverse",e,t,n);return[r.cumsum($("x",e,t,n),a,u,l)]}case"Bincount":const i=$("x",e,t,n),s=$("weights",e,t,n),o=$("size",e,t,n);return[r.bincount(i,s,o)];case"DenseBincount":{const a=$("x",e,t,n),u=$("weights",e,t,n),l=$("size",e,t,n),c=$("binaryOutput",e,t,n);return[r.denseBincount(a,u,l,c)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GBe=(e,t,n,r=si)=>{switch(e.op){case"ConcatV2":case"Concat":{const i=$("n",e,t,n),s=$("axis",e,t,n);let o=$("tensors",e,t,n);return o=o.slice(0,i),[r.concat(o,s)]}case"Gather":{const i=$("x",e,t,n),s=$("indices",e,t,n);return[r.gather(i,r.cast(s,"int32"),0)]}case"GatherV2":{const i=$("axis",e,t,n),s=$("batchDims",e,t,n),o=$("x",e,t,n),a=$("indices",e,t,n);return[r.gather(o,r.cast(a,"int32"),i,s)]}case"Reverse":{const i=$("dims",e,t,n),s=[];for(let a=0;a<i.length;a++)i[a]&&s.push(a);const o=$("x",e,t,n);return[r.reverse(o,s)]}case"ReverseV2":{const i=$("axis",e,t,n),s=$("x",e,t,n);return[r.reverse(s,i)]}case"Slice":{const i=$("begin",e,t,n),s=$("size",e,t,n);return[r.slice($("x",e,t,n),i,s)]}case"StridedSlice":{const i=$("begin",e,t,n),s=$("end",e,t,n),o=$("strides",e,t,n),a=$("beginMask",e,t,n),u=$("endMask",e,t,n),l=$("ellipsisMask",e,t,n),c=$("newAxisMask",e,t,n),f=$("shrinkAxisMask",e,t,n),d=$("x",e,t,n);return[r.stridedSlice(d,i,s,o,a,u,l,c,f)]}case"Pack":return K(()=>{const i=$("axis",e,t,n),s=$("tensors",e,t,n),o=s[0].shape,a=r.squeeze(s[0]).shape,u=s.map(l=>{const c=$t(l.shape,o);if(!c&&!$t(r.squeeze(l).shape,a))throw new Error("the input tensors shape does not match");return c?l:r.reshape(l,o)});return[r.stack(u,i)]});case"Unpack":{const i=$("axis",e,t,n),s=$("tensor",e,t,n);return r.unstack(s,i)}case"Tile":{const i=$("reps",e,t,n);return[r.tile($("x",e,t,n),i)]}case"Split":case"SplitV":{const i=$("axis",e,t,n),s=$("numOrSizeSplits",e,t,n),o=$("x",e,t,n);return r.split(o,s,i)}case"ScatterNd":{const i=$("indices",e,t,n),s=$("values",e,t,n),o=$("shape",e,t,n);return[r.scatterND(i,s,o)]}case"GatherNd":{const i=$("x",e,t,n),s=$("indices",e,t,n);return[r.gatherND(i,s)]}case"SparseToDense":{const i=$("sparseIndices",e,t,n),s=$("outputShape",e,t,n),o=$("sparseValues",e,t,n),a=$("defaultValue",e,t,n);return[r.sparseToDense(i,o,s,o.dtype===a.dtype?a:r.cast(a,o.dtype))]}case"TensorScatterUpdate":{const i=$("indices",e,t,n),s=$("values",e,t,n),o=$("tensor",e,t,n);return[r.tensorScatterUpdate(o,i,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qBe=(e,t,n,r=si)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:s,emptyRowIndicator:o,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows($("indices",e,t,n),$("values",e,t,n),$("denseShape",e,t,n),$("defaultValue",e,t,n));return[i,s,o,a]}case"SparseReshape":{const{outputIndices:i,outputShape:s}=r.sparse.sparseReshape($("inputIndices",e,t,n),$("inputShape",e,t,n),$("newShape",e,t,n));return[i,s]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean($("data",e,t,n),$("indices",e,t,n),$("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum($("data",e,t,n),$("indices",e,t,n),$("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XBe=(e,t,n,r=si)=>{switch(e.op){case"FFT":return[r.fft($("x",e,t,n))];case"IFFT":return[r.ifft($("x",e,t,n))];case"RFFT":return[r.rfft($("x",e,t,n))];case"IRFFT":return[r.irfft($("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KBe=(e,t,n,r=si)=>{switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace($("input",e,t,n),$("pattern",e,t,n),$("rewrite",e,t,n),$("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:i,nGramsSplits:s}=r.string.stringNGrams($("data",e,t,n),$("dataSplits",e,t,n),$("separator",e,t,n),$("nGramWidths",e,t,n),$("leftPad",e,t,n),$("rightPad",e,t,n),$("padWidth",e,t,n),$("preserveShortSequences",e,t,n));return[i,s]}case"StringSplit":{const{indices:i,values:s,shape:o}=r.string.stringSplit($("input",e,t,n),$("delimiter",e,t,n),$("skipEmpty",e,t,n));return[i,s,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast($("input",e,t,n),$("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YBe=(e,t,n,r=si)=>{switch(e.op){case"Cast":return[r.cast($("x",e,t,n),$("dtype",e,t,n))];case"ExpandDims":{const i=$("axis",e,t,n);return[r.expandDims($("x",e,t,n),i)]}case"Squeeze":{const i=$("axis",e,t,n);return[r.squeeze($("x",e,t,n),i)]}case"Reshape":return[r.reshape($("x",e,t,n),$("shape",e,t,n))];case"EnsureShape":return[r.ensureShape($("x",e,t,n),$("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad($("x",e,t,n),$("padding",e,t,n),$("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad($("x",e,t,n),$("padding",e,t,n),$("constantValue",e,t,n))];case"SpaceToBatchND":{const i=$("blockShape",e,t,n),s=$("paddings",e,t,n);return[r.spaceToBatchND($("x",e,t,n),i,s)]}case"BatchToSpaceND":{const i=$("blockShape",e,t,n),s=$("crops",e,t,n);return[r.batchToSpaceND($("x",e,t,n),i,s)]}case"DepthToSpace":{const i=$("blockSize",e,t,n),s=$("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace($("x",e,t,n),i,s)]}case"BroadcastTo":return[r.broadcastTo($("x",e,t,n),$("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs($("s0",e,t,n),$("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hY(e,t,n,r,i=K){const s=((o,a,u)=>{switch(o.category){case"arithmetic":return i(()=>$Be(o,a,u));case"basic_math":return i(()=>_Be(o,a,u));case"control":return DBe(o,a,u);case"convolution":return i(()=>OBe(o,a,u));case"creation":return i(()=>FBe(o,a,u));case"dynamic":return RBe(o,a,u);case"evaluation":return i(()=>MBe(o,a,u));case"image":return i(()=>BBe(o,a,u));case"graph":return i(()=>PBe(o,a,u));case"logical":return i(()=>UBe(o,a,u));case"matrices":return i(()=>WBe(o,a,u));case"normalization":return i(()=>VBe(o,a,u));case"ragged":return i(()=>jBe(o,a,u));case"reduction":return i(()=>HBe(o,a,u));case"slice_join":return i(()=>GBe(o,a,u));case"sparse":return i(()=>qBe(o,a,u));case"spectral":return i(()=>XBe(o,a,u));case"string":return i(()=>KBe(o,a,u));case"transformation":return i(()=>YBe(o,a,u));case"hash_table":return zBe(o,a,u,r);case"custom":const l=Hce(o.op);if(l&&l.customExecutor)return l.customExecutor(new kBe(o,a,u));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return Vc(s)?s.then(o=>[].concat(o)):[].concat(s)}class pY{constructor(t={},n={},r={},i={},s){this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=i,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,n){return{id:t,frameName:n,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(t);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mY(e,t,n,r){const i=new Set,s=[];let o=null,a=null;const u=new Set,l=new Set(Object.keys(e).map(d=>Rs(d)[0]));r=r||[];const c=new Set(r.map(d=>Rs(d.name)[0])),f=[...t];for(;f.length>0;){const d=f.pop();if((np(d)||i8e(d)||s8e(d))&&o==null&&(o=d,a=o.children.map(h=>h.name).filter(h=>i.has(h))),i.add(d.name),n[d.name]==null&&!l.has(d.name)&&!c.has(d.name)){if(d.inputs.length===0){s.push(d.name);continue}d.inputs.forEach(h=>{u.has(h.name)||(u.add(h.name),f.push(h))})}}return{inputs:e,outputs:t,usedNodes:i,missingInputs:s,dynamicNode:o,syncInputs:a}}function ZBe(e,t){const{usedNodes:n,inputs:r}=t,i=Object.keys(r).map(g=>Rs(g)[0]).map(g=>e.nodes[g]),s=e.initNodes||[],o=g=>n.has(typeof g=="string"?g:g.name);function a(g){return[...new Map(g.map(y=>[y.name,y])).values()]}const u=a([...i,...e.weights,...s]).filter(o),l=a([...u,...Object.values(e.nodes)]).filter(o),c=new Map(l.map(g=>[g.name,g])),f={};for(const g of l){f[g.name]=f[g.name]||0;for(const y of g.children)o(y)||(f[y.name]=Number.POSITIVE_INFINITY),f[y.name]=(f[y.name]||0)+1}const d=Object.entries(f).filter(([,g])=>g===0).map(([g])=>g),h=[...d];for(;d.length>0;){const g=d.pop(),y=c.get(g);for(const b of y.children.filter(o))--f[b.name]===0&&(h.push(b.name),d.push(b.name))}const p=h.map(g=>c.get(g)),m=QBe(p,u);return JBe(m,u),m}function QBe(e,t){const n=new Map(e.map(o=>[o.name,o])),r=t.map(o=>o.name),i=new Set(r);for(;r.length>0;){const o=r.pop(),a=n.get(o);for(const u of a.children)!n.has(u.name)||i.has(u.name)||(i.add(u.name),r.push(u.name))}return e.filter(o=>i.has(o.name))}class o$ extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}function JBe(e,t){const n=new Map(e.map((a,u)=>[a.name,u])),r=new Set(t.map(a=>a.name)),i=a=>r.has(typeof a=="string"?a:a.name),s=new Set(e.map(a=>a.name)),o=a=>s.has(typeof a=="string"?a:a.name);for(const a of e){for(const u of a.children.filter(o)){if(!n.has(u.name))throw new o$(`Child ${u.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(u.name))throw new o$(`Node ${a.name} is scheduled to run after its child ${u.name}.`)}if(!i(a))for(const u of a.inputs){if(!n.has(u.name))throw new o$(`Input ${u.name} of node ${a.name} is unreachable.`);if(n.get(u.name)>n.get(a.name))throw new o$(`Node ${a.name} is scheduled to run before its input ${u.name}.`)}}}function e8e(e){const t=new Map(e.map((a,u)=>[a.name,u])),n=Number.MAX_SAFE_INTEGER,r=e.map((a,u)=>np(a)?n:u),i=a=>{const u=r[t.get(a.name)];return u??-1},s=e.map((a,u)=>a.children.map(i).reduce((l,c)=>Math.max(l,c),r[u])),o=new Map;for(let a=0;a<e.length;++a){const u=s[a];if(u===n)continue;const l=e[a],c=e[u];o.has(c.name)||o.set(c.name,[]),o.get(c.name).push(l)}return o}const t8e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),n8e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),r8e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function np(e){return t8e.has(e.op)}function i8e(e){return n8e.has(e.op)}function s8e(e){return r8e.has(e.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sT{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const n=Object.keys(t).map(r=>t[r].map(i=>i.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(r=>{this._functionExecutorMap[r]=new sT(t.functions[r],this)})}getCompilationKey(t,n){const r=t.map(s=>s.name).sort(),i=n.map(s=>s.name).sort();return r.join(this.SEPARATOR)+"--"+i.join(this.SEPARATOR)}compile(t,n){const r=mY(t,n,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:s,syncInputs:o}=r;if(s!=null)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(i.length>0){const l=n.map(f=>f.name),c=Object.keys(t);throw new Error(`Cannot compute the outputs [${l}] from the provided inputs [${c}]. Missing the following inputs: [${i}]`)}const a=ZBe(this.graph,r),u=e8e(a);return{orderedNodes:a,nodeLiveUntilMap:u}}cloneAndKeepTensor(t){if(t==null)return null;const n=t.clone();return xr(n),n}cloneTensorList(t){return t?t.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(t,n){this.disposeIntermediateTensors(),t=this.mapInputs(t);const r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);const i=r.map(d=>this.graph.nodes[Rs(d)[0]]),s=n.map(d=>Rs(d)[0]),o=new Set(s);let a=s.map(d=>this.graph.nodes[d]);a.length===0&&(a=this._outputs);const u=this.getCompilationKey(i,a);let l=this.compiledMap.get(u);l==null&&(l=this.compile(t,a),this.compiledMap.set(u,l));try{this.keepIntermediateTensors=Y().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const c={},f={};return K(()=>{const d=new pY(this.weightMap,c,f,this.functionExecutorMap,this.parseNodeNameCache),h=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(y=>{const[b,v]=Rs(y,d),x=[];x[v]=t[y],h[b]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[b]=this.cloneTensorList(x))});const p=this.getFrozenTensorIds(h),{orderedNodes:m,nodeLiveUntilMap:g}=l;for(const y of m){if(h[y.name])continue;const b=hY(y,h,d,this._resourceManager);if(Vc(b))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);h[y.name]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[y.name]=this.cloneTensorList(b)),this.checkTensorForDisposalWithNodeLiveUntilInfo(y,h,d,p,o,g.get(y.name))}return this.parent==null&&d.dispose(p),n.map(y=>Hr(y,h,d))})}getFrozenTensorIds(t){const n=[].concat.apply([],Object.keys(t).map(r=>t[r]).map(r=>r.map(i=>i.id)));return new Set(n)}checkTensorForDisposal(t,n,r,i,s,o,a){if(!(np(n)||o.has(t))){for(const u of r[t])u!=null&&(a[u.id]=(a[u.id]||0)+n.children.length);for(const u of n.inputs){if(np(u))continue;const l=uY(u.name,r,i);if(l!=null)for(const c of l){if(!c||c.kept||s.has(c.id))continue;const f=a[c.id];f===1?(c.dispose(),delete a[c.id]):f!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,n,r,i,s,o){function a(u){return np(u)||s.has(u.name)}if(!(np(t)||o==null))for(const u of o){if(a(u))continue;const l=uY(u.name,n,r);for(const c of l)!c||c.kept||i.has(c.id)||c.dispose()}}async executeAsync(t,n){return this._executeAsync(t,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(const n of t)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,n,r=!1,i={},s={}){this.disposeIntermediateTensors(),r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=Y().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const o=new pY(this.weightMap,i,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(t,o,n,r),u=n.map(d=>Hr(d,a,o)),l=u.map(d=>d.id),c=Object.keys(t).map(d=>t[d].id),f=new Set([...l,...c,...this.weightIds]);return Object.values(a).forEach(d=>{d.forEach(h=>{h&&!h.isDisposed&&!f.has(h.id)&&h.dispose()})}),this.parent==null&&o.dispose(f),u}async executeFunctionAsync(t,n,r){const i=t.reduce((s,o,a)=>(s[this.inputs[a].name]=o,s),{});return this._executeAsync(i,this.outputNodes,!0,n,r)}async executeWithControlFlow(t,n,r,i){const s=Object.keys(t),o=s.map(x=>this.graph.nodes[Rs(x)[0]]),a=r.map(x=>Rs(x)[0]),u=new Set(a);let l=a.map(x=>this.graph.nodes[x]);l.length===0&&(l=this._outputs);const{usedNodes:c,missingInputs:f,dynamicNode:d,syncInputs:h}=mY(t,l,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(x=>({node:x,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(t).forEach(x=>{const[w,S]=Rs(x),C=[];C[S]=t[x],m[w]=C});const g={},y=this.getFrozenTensorIds(m),b={};for(;p.length>0;){const x=this.processStack(o,p,n,m,b,y,u,g,c);await Promise.all(x)}d==null&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=l.filter(x=>!np(x)&&!Hr(x.name,m,n)).map(x=>x.name);if(v.length>0){let x="";throw d!=null&&(x=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${v}] from the provided inputs [${s}]. Consider providing the following inputs: [${f}]. ${x}`)}return m}processStack(t,n,r,i,s,o,a,u,l){const c=[];for(;n.length>0;){const f=n.pop();r.currentContext=f.contexts;let d="";if(f.node.op==="Enter"&&$("isConstant",f.node,i,r)&&([d]=dc(f.node.name,r)),i[f.node.name]==null){const h=hY(f.node,i,r,this._resourceManager);d||([d]=dc(f.node.name,r));const p=r.currentContext;Vc(h)?c.push(h.then(m=>(i[d]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(m)),r.currentContext=p,this.checkTensorForDisposal(d,f.node,i,r,o,a,u),this.processChildNodes(f.node,n,r,i,s,l),m))):(i[d]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(h)),this.checkTensorForDisposal(d,f.node,i,r,o,a,u),this.processChildNodes(f.node,n,r,i,s,l))}else this.processChildNodes(f.node,n,r,i,s,l)}return c}processChildNodes(t,n,r,i,s,o){t.children.forEach(a=>{const[u]=dc(a.name,r);s[u]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(l=>!!Hr(l,i,r))&&(s[u]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(l=>!!Hr(l,i,r))&&(s[u]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{const r=t[n],[i]=Rs(n),s=this.graph.nodes[i];if(s.attrParams.shape&&s.attrParams.shape.value){const o=s.attrParams.shape.value,a=o.length===r.shape.length&&r.shape.every((u,l)=>o[l]===-1||o[l]===u);A(a,()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&A(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(t){var n,r;const i={};for(const s in t){const o=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[s];o!=null?i[o.name]=t[s]:i[s]=t[s]}return i}checkInputs(t){const n=Object.keys(t).filter(r=>{const[i]=Rs(r);return this.graph.nodes[i]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>{var r,i;const s=(i=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||i===void 0?void 0:i[n];return s!=null?s.name:n},{})}checkOutputs(t){t.forEach(n=>{const[r]=Rs(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class o8e{constructor(t={},n={}){this.hashTableNameToHandle=t,this.hashTableMap=n}addHashTable(t,n){this.hashTableNameToHandle[t]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a8e="?tfjs-format=file",u8e="model.json";class P9{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,n={},r=O8){this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new o8e}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const n=this.io.getLoadHandlers(t,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[t]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return Vc(t)?t.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(t)}loadSync(t){const n=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,n)}async loadStreaming(t){if(t.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await vae(t.getWeightStream(),t.weightSpecs);return this.loadWithWeightMap(t,n)}loadWithWeightMap(t,n){this.artifacts=t;const r=this.artifacts.modelTopology;let i=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const s=this.artifacts.userDefinedMetadata;s.signature!=null&&(i=s.signature),s.structuredOutputKeys!=null&&(this.structuredOutputKeys=s.structuredOutputKeys)}if(this.signature=i,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new sT(lY.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const s=lY.Instance.transformGraph(t.modelInitializer);this.initializer=new sT(s),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}async save(t,n){if(typeof t=="string"){const r=this.io.getSaveHandlers(t);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${t}'`);t=r[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}addStructuredOutputNames(t){if(this.structuredOutputKeys){const n=t instanceof Rt?[t]:t,r={};return n.forEach((i,s)=>r[this.structuredOutputKeys[s]]=i),r}return t}predict(t,n){const r=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(t,n){const r=await this.executeAsync(t,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(t){var n;if(!(t instanceof Rt)&&!Array.isArray(t)){const s=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(s!=null)for(const o in s){const a=s[o];a.resourceId!=null&&(t[o]=this.resourceIdToCapturedInput[a.resourceId])}return t}t=Array.isArray(t)?t:[t];const r=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${t.length} input tensors provided.`);let i=0;return this.inputNodes.reduce((s,o)=>{var a,u,l;const c=(l=(u=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||u===void 0?void 0:u[o])===null||l===void 0?void 0:l.resourceId;return c!=null?s[o]=this.resourceIdToCapturedInput[c]:s[o]=t[i++],s},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let i=0;i<r.length;i++){const s=r[i],o=n[s];this.resourceIdToCapturedInput[o.resourceId]=t[i]}}}execute(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const r=this.executor.execute(t,n);return r.length>1?r:r[0]}async executeAsync(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(t,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((n,r)=>(n[r]=[t[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&at(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function l8e(e,t={},n=O8){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=f8e(e));const r=new P9(e,t,n);return await r.load(),r}function c8e(e){if(e==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){const[r,i]=e;if(!r)throw new Error("modelJSON must be the first element of the array");if(!i||!(i instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");const s=GE(r.weightsManifest),o=dB(r,s,i);t=XE(o)}else if("load"in e)t=e;else if("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e)t=XE(e);else throw new Error("Unknown model format");const n=new P9(t);return n.load(),n}function f8e(e){return e.endsWith("/")||(e=e+"/"),`${e}${u8e}${a8e}`}/** @license See the LICENSE file. */const Xce="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function d8e(e,t){return oT(e,t)}function oT(e,t,n=new Map,r=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse)if(K0(e)){const s=Array.isArray(e)?[]:{};r.add(e);for(const o in e){const a=e[o],u=oT(a,t,n,r);s[o]=u}return r.delete(e),e.__proto__&&(s.__proto__=e.__proto__),s}else throw new Error(`Can't recurse into non-iterable type: ${e}`);else return n.set(e,i.value),i.value}function h8e(e,t=Yce){return Kce(e,t)}function Kce(e,t,n=new Set){const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse)if(K0(r)){const s=Array.isArray(r)?[]:{};n.add(r);for(const o in r){const a=e.map(l=>l[o]),u=Kce(a,t,n);s[o]=u}return n.delete(r),s}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return i.value}function Yce(e){return e===null?null:K0(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function Zce(e,t){const n=new Map;oT(e,t,n);for(const i of Array.from(n.keys())){const s=n.get(i);if(Vc(s)){const o=await s;n.set(i,o)}}return oT(e,t,n)}function K0(e){let t=!1;if(Y().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Rt)&&!(e instanceof Promise)&&!t)}function p8e(e){return e==null||m8e(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Rt||yr(e)}function m8e(e){return e===null||typeof e!="object"&&typeof e!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function g8e(e){return d8e(e,y8e)}function y8e(e){return e instanceof Rt?{value:e.clone(),recurse:!1}:K0(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Qce{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const n of t)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+t),r=this.get(n);return this.set(n,this.pop()),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Y3 extends Qce{constructor(){super(Y3.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=this.capacity*2,n=new Array(t),r=this.length();for(let i=0;i<r;i++)n[i]=this.get(this.wrap(this.begin+i));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r}}Y3.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function Jce(e){return new x8e(e)}function L9(e){return new w8e(e)}function b8e(e,t){return new efe(e,t)}function v8e(e,t=Gf.FAIL){return new N8e(e,t)}class Fr{async toArray(){const t=[];let n=await this.next();for(;!n.done;)t.push(n.value),n=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),n=[];let r=await t.next();for(;!r.done;)n.push(r.value),r=await t.next();return n}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let n=await this.next(),r=t(n.value);for(;!n.done&&r;)n=await this.next(),r=t(n.value)}handleErrors(t){return new T8e(this,t)}filter(t){return new _8e(this,t)}map(t){return new E8e(this,t)}mapAsync(t){return new gY(this,t)}serialMapAsync(t){return new gY(this,t).serial()}flatmap(t){return new A8e(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(n=>n===!0)}rowMajorBatch(t,n=!0){return new $8e(this,t,n)}columnMajorBatch(t,n=!0,r=Yce){return this.rowMajorBatch(t,n).map(s=>h8e(s,r))}concatenate(t,n){return new efe(Jce([this,t]),n)}take(t){return t<0||t==null?this:new k8e(this,t)}skip(t){return t<0||t==null?this:new C8e(this,t)}prefetch(t){return new tfe(this,t)}shuffle(t,n){return new I8e(this,t,n)}serial(){return new S8e(this)}}class x8e extends Fr{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:g8e(t),done:!1}}}class w8e extends Fr{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}}}class S8e extends Fr{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class C8e extends Fr{constructor(t,n){super(),this.upstream=t,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;at(t.value)}return this.upstream.next()}}class k8e extends Fr{constructor(t,n){super(),this.upstream=t,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class $8e extends Fr{constructor(t,n,r=!0){super(),this.upstream=t,this.batchSize=n,this.enableSmallLastBatch=r,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(n.value)}return{value:t,done:!1}}}class _8e extends Fr{constructor(t,n){super(),this.upstream=t,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;at(t.value)}}}class E8e extends Fr{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const n=Hc(t.value),r=this.transform(t.value),i=Hc(r);for(const s of n)zI(s,i)||s.dispose();return{value:r,done:!1}}}class T8e extends Fr{constructor(t,n){super(),this.upstream=t,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class gY extends Fr{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const n=Hc(t.value),r=await this.transform(t.value),i=Hc(r);for(const s of n)zI(s,i)||s.dispose();return{value:r,done:!1}}}class z9 extends Fr{constructor(){super(),this.outputQueue=new Y3,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class A8e extends z9{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const t=await this.upstream.next();if(t.done)return!1;const n=Hc(t.value),r=this.transform(t.value),i=Hc(r);this.outputQueue.pushAll(r);for(const s of n)zI(s,i)||s.dispose();return!0}}class efe extends Fr{constructor(t,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,this.iterator==null){const r=await this.moreIterators.next();if(r.done)return{value:null,done:!0};this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(t)):n}}var Gf;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(Gf||(Gf={}));class N8e extends Fr{constructor(t,n=Gf.FAIL){super(),this.iterators=t,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(t){await t;let n=0,r=0;function i(o){return o instanceof Fr?{value:o.next().then(u=>(n++,u.done&&r++,u.value)),recurse:!1}:{value:null,recurse:!0}}const s=await Zce(this.iterators,i);if(n===r)return{value:null,done:!0};if(r>0)switch(this.mismatchMode){case Gf.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Gf.SHORTEST:return{value:null,done:!0};case Gf.LONGEST:}return this.count++,{value:s,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class tfe extends Fr{constructor(t,n){super(),this.upstream=t,this.bufferSize=n,this.buffer=new Qce(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class I8e extends tfe{constructor(t,n,r){super(t,n),this.upstream=t,this.windowSize=n,this.upstreamExhausted=!1,this.random=Ly.alea(r||Vr().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),n=await this.buffer.shuffleExcise(t);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Hy{constructor(){this.size=null}batch(t,n=!0){const r=this;A(t>0,()=>`batchSize needs to be positive, but it is
      ${t}`);let i;return this.size===1/0||this.size==null?i=this.size:n?i=Math.ceil(this.size/t):i=Math.floor(this.size/t),Fs(async()=>(await r.iterator()).columnMajorBatch(t,n,F8e),i)}concatenate(t){const n=this;let r;return this.size===1/0||t.size===1/0?r=1/0:this.size!=null&&t.size!=null?r=this.size+t.size:r=null,Fs(async()=>(await n.iterator()).concatenate(await t.iterator()),r)}filter(t){const n=this;let r;return this.size===1/0?r=1/0:r=null,Fs(async()=>(await n.iterator()).filter(i=>K(()=>t(i))),r)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const n=this;return Fs(async()=>(await n.iterator()).map(r=>K(()=>t(r))),this.size)}mapAsync(t){const n=this;return Fs(async()=>(await n.iterator()).mapAsync(t),this.size)}prefetch(t){if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return Fs(async()=>(await n.iterator()).prefetch(t),this.size)}repeat(t){const n=this;let r;return this.size!=null&&t>0?r=this.size*t:t===0?r=0:this.size!=null&&(t===void 0||t<0)?r=1/0:r=null,Fs(async()=>{const i=L9(async()=>({value:await n.iterator(),done:!1}));return b8e(i.take(t))},r)}skip(t){const n=this;let r;return this.size!=null&&t>=0&&this.size>=t?r=this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?r=0:r=null,Fs(async()=>(await n.iterator()).skip(t),r)}shuffle(t,n,r=!0){if(t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const i=this,s=Ly.alea(n||Vr().toString());return Fs(async()=>{let o=s.int32();return r&&(o+=s.int32()),(await i.iterator()).shuffle(t,o.toString())},this.size)}take(t){const n=this;let r;return this.size!=null&&this.size>t?r=t:this.size!=null&&this.size<=t?r=this.size:r=null,Fs(async()=>(await n.iterator()).take(t),r)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}Hy.MAX_BUFFER_SIZE=1e4;function Fs(e,t=null){return new class extends Hy{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function D8e(e){return Fs(async()=>Jce(e),e.length)}function O8e(e){if(!K0(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=t==null?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(const n in e)t=t==null?e[n].size:Math.min(t,e[n].size);return Fs(async()=>{const n=await Zce(e,r=>{if(r instanceof Hy)return{value:r.iterator(),recurse:!1};if(K0(r))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return v8e(n,Gf.SHORTEST)},t)}function F8e(e){if(e===null)return null;const t=e[0];return p8e(t)?{value:R8e(e),recurse:!1}:{value:null,recurse:!0}}function R8e(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Rt?Hi(e):hs(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class nfe extends Hy{constructor(t){super(),this.input=t}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(i=>(i.endsWith("\r")&&(i=i.slice(0,-1)),i))}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const a$='"',Qb=Symbol("out"),yY=Symbol("field"),u$=Symbol("quote"),kR=Symbol("quoteafterquote"),bY=Symbol("quoteinquote");class rfe extends Hy{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const t=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&A(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const n=this.fullColumnNames.reduce((i,s)=>(i[s]=i[s]+1||1,i),{}),r=Object.keys(n).filter(i=>n[i]>1);if(A(r.length===0,()=>"Duplicate column names found: "+r.toString()),this.columnConfigs){for(const i of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(i)===-1)throw new Error('The key "'+i+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const n=await(await this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const r=n.value;return this.parseRow(r,!1)}else return null}constructor(t,n){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new nfe(t),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(A(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let t=await this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(n=>this.makeDataElement(n))}makeDataElement(t){const n=this.parseRow(t),r={},i={};for(let s=0;s<this.fullColumnNames.length;s++){const o=this.fullColumnNames[s],a=this.columnConfigs?this.columnConfigs[o]:null;if(!(this.configuredColumnsOnly&&!a)){const u=n[s];let l=null;if(u==="")if(a&&a.default!==void 0)l=a.default;else{if(a&&(a.required||a.isLabel))throw new Error(`Required column ${o} is empty in this line: ${t}`);l=void 0}else{const c=Number(u);if(isNaN(c))a&&a.dtype==="bool"?l=this.getBoolean(u):l=u;else if(!a||!a.dtype)l=c;else switch(a.dtype){case"float32":l=c;break;case"int32":l=Math.floor(c);break;case"bool":l=this.getBoolean(u);break;default:l=c}}a&&a.isLabel?i[o]=l:r[o]=l}}return Object.keys(i).length===0?r:{xs:r,ys:i}}getBoolean(t){return t==="1"||t.toLowerCase()==="true"?1:0}parseRow(t,n=!0){const r=[];let i=0;const s=t.length;let o=Qb;for(let a=0;a<s;a++)switch(o){case Qb:switch(t.charAt(a)){case a$:i=a+1,o=u$;break;case this.delimiter:if(i=a+1,this.delimiter===" "&&this.delimWhitespace)break;r.push(""),o=Qb;break;default:o=yY,i=a;break}break;case yY:switch(t.charAt(a)){case this.delimiter:r.push(t.substring(i,a)),o=Qb,i=a+1;break}break;case u$:switch(t.charAt(a)){case a$:o=kR;break}break;case kR:switch(t.charAt(a)){case this.delimiter:r.push(t.substring(i,a-1)),o=Qb,i=a+1;break;case a$:o=u$;break;default:o=bY;break}break;case bY:switch(t.charAt(a)){case a$:o=u$;break}break}if(o===kR?r.push(t.substring(i,s-1)):r.push(t.substring(i)),n&&r.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${r}`);return r}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class B9 extends Fr{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(!Y().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const n=new B9(t);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(r){throw new Error(`Error thrown while initializing video stream: ${r.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,n;const r=await this.getAudioData();if(this.includeSpectrogram){const i=this.flattenQueue(r.freqDataQueue);t=this.getTensorFromAudioDataArray(i,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const i=this.flattenQueue(r.timeDataQueue);n=this.getTensorFromAudioDataArray(i,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const t=[],n=[];let r=0;return new Promise(i=>{const s=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:n}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++r===this.numFrames&&(clearInterval(s),i({freqDataQueue:t,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const n=t[0].length,r=new Float32Array(t.length*n);return t.forEach((i,s)=>r.set(i,s*n)),r}getTensorFromAudioDataArray(t,n){const r=new Float32Array(ee(n));return r.set(t,r.length-t.length),hs(r,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class U9 extends Fr{constructor(t,n){if(super(),this.webcamVideoElement=t,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=qr([0],"int32"),this.webcamConfig.centerCrop){const r=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,i=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,s=(1-r)/2,o=(1-i)/2,a=s+r,u=i+o;this.cropBox=yl([o,s,u,a],[1,4])}else this.cropBox=yl([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,n={}){if(!Y().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}const r=new U9(t,n);return await r.start(),r}async start(){this.webcamConfig.facingMode&&A(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=Gue(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{t.dispose()}else return{value:t,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return K(()=>{const n=jr(Ce(t,"float32"),0);let r;r=Eo.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const i=r.shape;return j(r,i.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class ife{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class sfe extends Fr{split(t){return new M8e(this,t)}}class M8e extends sfe{constructor(t,n){super(),this.upstream=t,this.impl=new P8e(t,n)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class P8e extends z9{constructor(t,n){super(),this.upstream=t,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const t=await this.upstream.next();if(t.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=t.value.split(this.separator);n[0]=this.carryover+n[0];for(const r of n.slice(0,-1))this.outputQueue.push(r);return this.carryover=n[n.length-1],!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class L8e extends Fr{decodeUTF8(){return new z8e(this)}}class z8e extends sfe{constructor(t){super(),this.upstream=t,this.impl=new B8e(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class B8e extends z9{constructor(t){if(super(),this.upstream=t,Y().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=require("string_decoder");this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const t=await this.upstream.next();let n;if(t.done)return!1;n=t.value;let r;return Y().get("IS_BROWSER")?r=this.decoder.decode(n,{stream:!0}):r=this.decoder.write(Buffer.from(n.buffer)),this.outputQueue.push(r),!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class ofe extends L8e{constructor(t,n={}){super(),this.file=t,this.options=n,A(t instanceof Uint8Array||(Y().get("IS_BROWSER")?t instanceof File||t instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((n,r)=>{const i=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,i)));else{const s=new FileReader;s.onload=a=>{let u=s.result;if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),!(u instanceof Uint8Array))return r(new TypeError("FileReader returned unknown type."));n(u)},s.onabort=a=>r(new Error("Aborted")),s.onerror=a=>r(new Error(a.type));const o=this.file.slice(this.offset,i);s.readAsArrayBuffer(o)}this.offset=i}),done:!1}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function U8e(e,t={},n){let r,i;typeof e=="string"?r=e:(r=e.url,i=W8e(e));const s=await lae(r,i);if(s.ok){const o=new Uint8Array(await s.arrayBuffer());return new ofe(o,t)}else throw new Error(s.statusText)}const W8e=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function afe(e){return typeof e=="string"&&e.slice(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class ufe extends ife{constructor(t,n={}){super(),this.input=t,this.options=n}async iterator(){if(afe(this.input)&&Y().get("IS_NODE")){const t=require("fs");this.input=t.readFileSync(this.input.slice(7))}return new ofe(this.input,this.options)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class lfe extends ife{constructor(t,n={}){super(),this.url=t,this.fileOptions=n}async iterator(){return afe(this.url)?new ufe(this.url,this.fileOptions).iterator():U8e(this.url,this.fileOptions)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function V8e(e,t={}){return new rfe(new lfe(e),t)}function j8e(e){const t=L9(e);return Fs(async()=>t)}function H8e(e){return Fs(async()=>{const t=await e();return L9(()=>t.next())})}async function G8e(e,t){return U9.create(e,t)}async function q8e(e){return B9.create(e)}/** @license See the LICENSE file. */const cfe="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X8e=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:rfe,Dataset:Hy,FileDataSource:ufe,TextLineDataset:nfe,URLDataSource:lfe,array:D8e,csv:V8e,func:j8e,generator:H8e,microphone:q8e,version_data:cfe,webcam:G8e,zip:O8e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Be(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&A(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K8e=d3;class hC extends AN{nextDataId(){return hC.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Yz(this,Ja())}write(t,n,r){this.firstUse&&(this.firstUse=!1,Y().get("IS_NODE")&&So(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:r,refCount:1}),i}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&cl(r[0])){const s=r.map(o=>ml(o));i=this.write(s,t,n)}else i=this.write(r,t,n);return{dataId:i,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,r,i,s){this.data.set(t,{values:n,dtype:i,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:r}=this.data.get(t);if(n==="complex64"){const i=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return Xc(i,s)}return qoe(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>jc(i));return mt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return mt(t.shape,t.dtype,n)}makeOutput(t,n,r){return Ja().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(t);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=Vr();return t(),{kernelMs:Vr()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Be([t],"where");const n=this.readSync(t.dataId);return K8e(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}hC.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ffe(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const Y8e=e=>{const{x:t}=e.inputs,n=e.backend;Be(t,"abs");let r=new Float32Array(ee(t.shape));const i=n.data.get(t.dataId).values;return r=ffe(i),n.makeOutput(r,t.shape,t.dtype)},Z8e={kernelName:D2,backendName:"cpu",kernelFunc:Y8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function or(e){return(t,n,r,i,s)=>{const o=ut(t,n),a=o.length,u=Ye(o),l=ee(o),c=Dr(s,l),f=t.length,d=n.length,h=Ye(t),p=Ye(n),m=jp(t,o),g=jp(n,o);if(m.length+g.length===0)for(let y=0;y<c.length;++y)c[y]=e(r[y%r.length],i[y%i.length]);else for(let y=0;y<c.length;++y){const b=Dm(y,a,u),v=b.slice(-f);m.forEach(C=>v[C]=0);const x=pu(v,f,h),w=b.slice(-d);g.forEach(C=>w[C]=0);const S=pu(w,d,p);c[y]=e(r[x],i[S])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bs(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),u=n.data.get(a.dataId);return u.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(i.shape,"float32",o)},a}const Q8e={kernelName:LN,backendName:"cpu",kernelFunc:Bs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aT(e,t,n="float32"){if(n==="complex64"){const i=aT(e,t,"float32"),s=aT(e,t,"float32");return Bs({inputs:{real:i,imag:s},backend:e})}const r=ei(ee(t),n);return e.makeTensorInfo(t,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const J8e={kernelName:ry,backendName:"cpu",kernelFunc:Ol};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yp(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const e7e={kernelName:yI,backendName:"cpu",kernelFunc:Yp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dfe(e,t,n,r){if(r==="int32"){const i=Int32Array.from(e);return[t,"int32",i]}if(r==="bool"){const i=Xd([0],n),[s,o]=or((a,u)=>a!==u?1:0)(t,[],e,i,"bool");return[o,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Dd(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return Ol({inputs:{x:i},backend:n});const c=aT(n,i.shape,i.dtype),f=Dd({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),d=Bs({inputs:{real:f,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),d}if(i.dtype==="complex64"){const c=Yp({inputs:{input:i},backend:n}),f=Dd({inputs:{x:c},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(c),f}if(!Jz(i.dtype,s)){const c=Ol({inputs:{x:i},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:s}}const o=n.data.get(i.dataId).values,[a,u,l]=dfe(o,i.shape,i.dtype,s);return n.makeTensorInfo(a,u,l)}const t7e={kernelName:j1,backendName:"cpu",kernelFunc:Dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(e,t,n,r){return n==null?({inputs:i,backend:s})=>{const{a:o,b:a}=i,u=s;Be([o,a],e);const l=u.data.get(o.dataId).values,c=u.data.get(a.dataId).values,f=o.dtype==="string"?Kc(l):l,d=o.dtype==="string"?Kc(c):c,h=r||o.dtype,[p,m]=t(o.shape,a.shape,f,d,h);return u.makeTensorInfo(m,h,p)}:({inputs:i,backend:s})=>{const{a:o,b:a}=i,u=s;if(o.dtype==="complex64"||a.dtype==="complex64"){const l=Dd({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),c=u.data.get(l.dataId),f=c.complexTensorInfos.real,d=c.complexTensorInfos.imag,h=u.data.get(f.dataId).values,p=u.data.get(d.dataId).values,m=Dd({inputs:{x:a},backend:u,attrs:{dtype:"complex64"}}),g=u.data.get(m.dataId),y=g.complexTensorInfos.real,b=g.complexTensorInfos.imag,v=u.data.get(y.dataId).values,x=u.data.get(b.dataId).values,[w,S,C]=n(o.shape,a.shape,h,p,v,x),k=u.makeTensorInfo(C,"float32",w),E=u.makeTensorInfo(C,"float32",S),_=Bs({inputs:{real:k,imag:E},backend:u});return u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(k),u.disposeIntermediateTensorInfo(E),_}else{const l=u.data.get(o.dataId).values,c=u.data.get(a.dataId).values,f=r||o.dtype,[d,h]=t(o.shape,a.shape,l,c,f);return u.makeTensorInfo(h,f,d)}}}function W9(e){return(t,n,r,i,s,o)=>{const a=ut(t,n),u=ee(a),l=a.length,c=Ye(a),f=Dr("float32",u),d=Dr("float32",u),h=jp(t,a),p=jp(n,a),m=Xc(r,i),g=Xc(s,o),y=t.length,b=Ye(t),v=n.length,x=Ye(n);if(h.length+p.length===0)for(let w=0;w<f.length;w++){const S=w%m.length,C=w%g.length,k=e(m[S*2],m[S*2+1],g[C*2],g[C*2+1]);f[w]=k.real,d[w]=k.imag}else for(let w=0;w<f.length;w++){const S=Dm(w,l,c),C=S.slice(-y);h.forEach(D=>C[D]=0);const k=pu(C,y,b),E=S.slice(-v);p.forEach(D=>E[D]=0);const _=pu(E,v,x),T=e(m[k*2],m[k*2+1],g[_*2],g[_*2+1]);f[w]=T.real,d[w]=T.imag}return[f,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hfe=or((e,t)=>e+t),n7e=W9((e,t,n,r)=>({real:e+n,imag:t+r})),Y0=$r(Om,hfe,n7e),r7e={kernelName:Om,backendName:"cpu",kernelFunc:Y0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(e,t,n,r,i){const s=ee(r),o=ei(i,n);for(let a=0;a<e.length;a++){const u=e[a];if(u<0)throw new Error("Input x must be non-negative!");u>=i||(s>0?o[u]+=t[a]:o[u]+=1)}return o}function pfe(e,t,n,r=!1){const i=e.shape[0],s=e.shape[1],o=mt([i,n],t.dtype);for(let a=0;a<i;a++)for(let u=0;u<s;u++){const l=e.get(a,u);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?o.set(1,a,l):t.size>0?o.set(o.get(a,l)+t.get(a,u),a,l):o.set(o.get(a,l)+1,a,l))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe=or((e,t)=>e&t),i7e=$r(B2,mfe),s7e={kernelName:B2,backendName:"cpu",kernelFunc:i7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jl(e){return(t,n,r)=>{const i=qn(n,t.length);for(let s=0;s<t.length;++s)i[s]=e(t[s],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jt(e,t,n){const r=jl(t);return nh(e,r,n)}function nh(e,t,n){return({inputs:r,attrs:i,backend:s})=>{const{x:o}=r;Be(o,e);const a=s,u=a.data.get(o.dataId).values;let l;if(o.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");l=Kc(u)}else l=u;const c=n||o.dtype,f=t(l,c,i);return a.makeTensorInfo(o.shape,c,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gfe=jl(e=>Math.ceil(e)),o7e=nh(H1,gfe),a7e={kernelName:H1,backendName:"cpu",kernelFunc:o7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yfe(e,t,n,r){const i=qn(n,ee(t));if(r&&n!=="string"){let s=0;e.forEach(o=>{const a=ee(o.shape);i.set(o.vals,s),s+=a})}else{let s=0;e.forEach(o=>{const a=n==="string"?Kc(o.vals):o.vals;let u=0;for(let l=0;l<o.shape[0];++l){const c=l*t[1]+s;for(let f=0;f<o.shape[1];++f)i[c+f]=a[u++]}s+=o.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bfe=or((e,t)=>e===t?1:0),vfe=$r(K2,bfe,null,"bool"),u7e={kernelName:K2,backendName:"cpu",kernelFunc:vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xfe=jl(e=>Math.exp(e)),wfe=nh(Q1,xfe,"float32"),l7e={kernelName:Q1,backendName:"cpu",kernelFunc:wfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sfe=jl(e=>Math.expm1(e)),c7e=nh(J1,Sfe),f7e={kernelName:J1,backendName:"cpu",kernelFunc:c7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cfe=jl(e=>Math.floor(e)),d7e=nh(ey,Cfe),h7e={kernelName:ey,backendName:"cpu",kernelFunc:d7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe=or((e,t)=>Math.floor(e/t)),p7e=$r(ty,kfe,null,"int32"),m7e={kernelName:ty,backendName:"cpu",kernelFunc:p7e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(e,t,n,r,i,s,o,a,u){const l=mt([r,s],n);for(let c=0;c<r;c++){const f=[];let d=0;for(let h=0;h<i;h++){const p=e[c*i+h];d+=p*o[h],f.push(p)}if(d<0||d>=u/s)throw new Error(`Invalid indices: ${f} does not index into ${a}`);for(let h=0;h<s;h++)l.values[c*s+h]=t.get(...t.indexToLoc(d*s+h))}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _fe(e,t,n){const r=mt(n,e.dtype);for(let i=0;i<r.size;++i){const o=r.indexToLoc(i).slice(),a=o[0],u=o[2],l=t.locToIndex([a,u]);o[2]=t.values[l];const c=e.locToIndex(o);0<=c&&c<e.values.length&&(r.values[i]=e.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Efe=or((e,t)=>e>t?1:0),g7e=$r(J2,Efe,null,"bool"),y7e={kernelName:J2,backendName:"cpu",kernelFunc:g7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tfe=or((e,t)=>e>=t?1:0),b7e=$r(ny,Tfe,null,"bool"),v7e={kernelName:ny,backendName:"cpu",kernelFunc:b7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Afe=or((e,t)=>e<t?1:0),x7e=$r(tS,Afe,null,"bool"),w7e={kernelName:tS,backendName:"cpu",kernelFunc:x7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nfe=or((e,t)=>e<=t?1:0),S7e=$r(nS,Nfe,null,"bool"),C7e={kernelName:nS,backendName:"cpu",kernelFunc:S7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(e,t,n){const r=(t-e)/(n-1),i=ei(n,"float32");i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe=jl(e=>Math.log(e)),k7e=nh(ay,Dfe),$7e={kernelName:ay,backendName:"cpu",kernelFunc:k7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ofe(e,t,n,r){const i=Dr(r,ee(n));for(let s=0;s<i.length;++s){const o=s*t;let a=e[o];for(let u=0;u<t;++u){const l=e[o+u];(Number.isNaN(l)||l>a)&&(a=l)}i[s]=a}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe=or((e,t)=>Math.max(e,t)),_7e=$r(ly,Ffe),E7e={kernelName:ly,backendName:"cpu",kernelFunc:_7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rfe=or((e,t)=>Math.min(e,t)),T7e=$r(cy,Rfe),A7e={kernelName:cy,backendName:"cpu",kernelFunc:T7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j9=or((e,t)=>e*t),N7e=W9((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),Z3=$r(dy,j9,N7e),I7e={kernelName:dy,backendName:"cpu",kernelFunc:Z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mfe(e,t,n){const r=of(-1,n);return j9([],t,r,e,n)}function D7e(e){const{inputs:t,backend:n}=e,{x:r}=t;Be(r,"neg");const i=n.data.get(r.dataId).values,[s,o]=Mfe(i,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}const O7e={kernelName:hS,backendName:"cpu",kernelFunc:D7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe=or((e,t)=>e!==t?1:0),F7e=$r(pS,Pfe,null,"bool"),R7e={kernelName:pS,backendName:"cpu",kernelFunc:F7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(e,t,n,r,i){const s=t.length,o=ee(t),a=Ye(t),u=Ye(i),l=Dr(n,ee(i));for(let c=0;c<o;++c){const f=Dm(c,s,a),d=new Array(f.length);for(let p=0;p<d.length;p++)d[p]=f[r[p]];const h=pu(d,s,u);l[h]=e[c]}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xs(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:s}=n;Be(i,"transpose");const o=i.shape.length,a=new Array(o);for(let f=0;f<a.length;f++)a[f]=i.shape[s[f]];const u=r.data.get(i.dataId).values,l=H9(u,i.shape,i.dtype,s,a);return{dataId:r.write(l,a,i.dtype),shape:a,dtype:i.dtype}}const M7e={kernelName:wp,backendName:"cpu",kernelFunc:xs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lfe(e,t,n,r){const[i,s]=Lr(e,r),o=ms(t,"int32"),a=ei(ee(i),o),u=ee(s);for(let l=0;l<a.length;++l){const c=l*u;let f=1;for(let d=0;d<u;++d)f*=n[c+d];a[l]=f}return{outVals:a,outShape:i,outDtype:o}}function P7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Be(i,"prod");const a=i.shape.length,u=wt(s,i.shape),l=Bn(u,a);let c=u,f=i;const d=[];l!=null&&(f=xs({inputs:{x:i},backend:n,attrs:{perm:l}}),d.push(f),c=ir(c.length,a));const h=n.data.get(f.dataId).values,{outVals:p,outShape:m,outDtype:g}=Lfe(f.shape,f.dtype,h,c);let y=m;return o&&(y=rr(m,u)),d.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(y,g,p)}const L7e={kernelName:xS,backendName:"cpu",kernelFunc:P7e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7e(e,t,n){e.forEach((r,i)=>{if(r<0||r>=n){const s=Dm(i,t.length,Ye(t)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function B7e(e,t){for(let n=0;n<e.length;++n){const r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function U7e(e,t,n,r){const i=[];let s=0;const o=t.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);B7e(n,r);let u=1;for(let l=0;l<t.length-1;++l){u*=t[l];const c=t[l+1];for(let f=1;f<u+1;++f)a[l].push(f*c)}for(let l=0;l<e.length;++l){let c=e[l],f=e[l]+1;for(let d=0;d<n.length;++d){const h=n[d],p=d+t.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-h[c];for(let y=c;y<f;++y)a[p].push(h[y+1]+g)}c=h[c],f=h[f]}f!==c&&(i.push([c,f]),s+=f-c)}return{outSplits:a,valueSlices:i,numValues:s}}function W7e(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n].length,i=qn("int32",r);t.push(i),e[n].forEach((s,o)=>i[o]=s)}return t}function vY(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function V7e(e,t,n,r,i,s){const o=vY(t,2)[1],a=vY(s,2)[1];let u=0;for(const l of n)for(let c=l[0];c<l[1];++c){for(let f=0;f<r;++f)i[u*a+f]=e[c*o+f];++u}}function j7e(e,t,n,r,i){const s=t.slice();s[0]=i;const o=qn(n,ee(s)),a=e.length,u=a===0?0:a/t[0];return V7e(e,t,r,u,o,s),[o,s]}function zfe(e,t,n,r,i,s,o,a){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const u=t[0][0]-1;if(z7e(s,o,u),r.length===0)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:c,valueSlices:f,numValues:d}=U7e(s,o,e,l),h=W7e(c),p=j7e(n,r,i,f,d);return[h,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY=2147483647;function Bfe(e,t,n,r,i,s,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=t.length===0,u=i.length===0,l=o.length===0,c=[];a||c.push(t[0]),u||c.push(i[0]),l||c.push(o[0]);for(let g=1;g<c.length;++g)if(c[g]!==c[g-1])throw new Error("starts, limits, and deltas must have the same shape");const f=c.length===0?1:c[0],d=qn("int32",f+1);d[0]=0;for(let g=0;g<f;++g){const y=a?e[0]:e[g],b=u?r[0]:r[g],v=l?s[0]:s[g];if(v===0)throw new Error("Requires delta != 0");let x;if(v>0&&b<y||v<0&&b>y)x=0;else if(x=Math.ceil(Math.abs((b-y)/v)),x>xY)throw new Error(`Requires ((limit - start) / delta) <= ${xY}`);d[g+1]=d[g]+x}const h=d[f],p=qn(n,h);let m=0;for(let g=0;g<f;++g){const y=d[g+1]-d[g];let b=a?e[0]:e[g];const v=l?s[0]:s[g];for(let x=0;x<y;++x)p[m++]=b,b+=v}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ea=su;class uT{constructor(t,n,r,i,s,o,a,u,l,c){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=u,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=sle(c),this.raggedRank=ole(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===ea.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===ea.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case ea.VALUE_ROWIDS:return uT.getMaxWidthValueRowID(n);case ea.ROW_SPLITS:return uT.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ea[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){const s=t[i+1]-t[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let r=0,i=t[0],s=0;for(let o=1;o<n;++o){const a=t[o];a!==i&&(i=a,s=Math.max(o-r,s),r=o)}return Math.max(n-r,s)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return SY(t,r)}calculateOutputSize(t){const n=this.valuesShape,r=this.defaultValueShape;ale(r,n);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=ile(this.raggedRank,i,n);o[0]<0&&(o[0]=t);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(t,n,r){const i=Math.min(t,r),s=[];let o=0;for(let a=0;a<i;++a,o+=n)s.push(o);for(let a=i;a<t;++a)s.push(-1);return A(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,n,r,i){const s=t.length,o=[];for(let a=0;a<s-1;++a){const u=t[a+1]-t[a];let l=Math.min(i,u),c=n[a];c===-1&&(l=0);for(let f=0;f<l;++f)o.push(c),c+=r;for(let f=0;f<u-l;++f)o.push(-1)}if(s>0&&o.length!==t[s-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,n,r,i){const s=t.length,o=[];if(s===0)return[];let a=0,u=t[0];if(u>=n.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${n.length}`);let l=n[u];o.push(l);for(let c=1;c<s;++c){const f=t[c];if(f===u)l>=0&&(++a,a<i?l+=r:l=-1);else{if(a=0,u=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);l=n[f]}o.push(l)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,n,r,i){const s=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case ea.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,i);case ea.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,i);default:throw new Error(`Unsupported partition type: ${ea[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ea.FIRST_DIM_SIZE:return t[0];case ea.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ea.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ea[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let u=i.length-2;u>=0;--u)i[u]=i[u+1]*r[u+1];const s=SY(r,!1),o=qn(this.valuesDType,ee(s));if(i[0]*r[0]>0){let u=this.calculateFirstParentOutputIndex(n,i[0],r[0]);for(let l=1;l<=this.raggedRank;++l)u=this.calculateOutputIndex(l-1,u,i[l],r[l]);this.setOutput(this.raggedRank,u,o,s)}return[s,o]}setOutput(t,n,r,i){if(r.length===0)return;const s=this.values,o=r;let a=i.slice();a=a.slice(t+1);const u=ee(a),l=n.length;let c=this.defaultValue;if(c.length!==u&&c.length!==1){const p=this.defaultValueShape;K(()=>{const m=j(c,p);c=Sp(m,a).dataSync()})}let f=0,d=0,h=0;for(let p=0;p<=l;++p){let m=p<l?n[p]:-1;if(m===h){++h;continue}if(d<h){const g=s.subarray(f*u),y=o.subarray(d*u),b=(h-d)*u;wY(y,g,b)}if(p>=l){const g=r.length;m=Math.floor(g/u)}if(m>h)if(this.defaultValue.length===1)o.subarray(h*u,m*u).fill(this.defaultValue[0]),h=m;else for(;m>h;){const g=o.slice(h*u);wY(g,c,u),++h}m<0?(f=p+1,d=h):(f=p,d=h,h=d+1)}}}function wY(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function SY(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function Ufe(e,t,n,r,i,s,o,a,u,l){return new uT(e,t,n,r,i,s,o,a,u,l).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wfe(e,t,n,r){const i=e===t,s=e<t&&n<0,o=t<e&&n>1;if(i||s||o)return ei(0,r);const a=Math.abs(Math.ceil((t-e)/n)),u=ei(a,r);t<e&&n===1&&(n=-1),u[0]=e;for(let l=1;l<u.length;l++)u[l]=u[l-1]+n;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vfe=jl(e=>1/Math.sqrt(e)),H7e=nh(by,Vfe),G7e={kernelName:by,backendName:"cpu",kernelFunc:H7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hp(e,t,n,r,i,s,o,a,u,l){const c=[r/i,i],f=e.values,d=t.values;if(r===0)return mt(n,t.dtype);const h=u instanceof hr?u:mt(c,t.dtype);typeof u=="string"||typeof u=="number"?h.values.fill(u):typeof u=="boolean"&&h.values.fill(+u);for(let p=0;p<s;p++){const m=[];let g=0;for(let y=0;y<o;y++){const b=f[p*o+y];m.push(b),g+=b*a[y]}if(g<0||g>=r/i)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let y=0;y<i;y++)l?h.values[g*i+y]+=d[p*i+y]:h.values[g*i+y]=t.rank===0?d[0]:d[p*i+y]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7e=jl(e=>1/(1+Math.exp(-e))),jfe=Jt(Cy,e=>1/(1+Math.exp(-e))),X7e={kernelName:Cy,backendName:"cpu",kernelFunc:jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hfe(e,t,n,r,i){const s=M8(r,t,n),o=ee(n),a=Ye(r);if(s){const f=P8(t,a);return i==="string"?e.slice(f,f+o):e.subarray(f,f+o)}const u=i==="string"?Kc(e):e,l=mt(r,i,u),c=mt(n,i);for(let f=0;f<c.size;++f){const d=c.indexToLoc(f),h=d.map((p,m)=>p+t[m]);c.set(l.get(...h),...d)}return i==="string"?Ele(c.values):c.values}function Zp(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:o}=r;Be(i,"slice");const[a,u]=C3(i,s,o);F8(i,a,u);const l=n.data.get(i.dataId).values,c=Hfe(l,a,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,c)}const K7e={kernelName:_S,backendName:"cpu",kernelFunc:Zp};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(e,t,n,r,i,s,o){const a=t[0],u=s[0],l=new Array(u),c=new Array(a),f=t[1];if(u===0){if(a!==0)throw new Error(ple(a));const g=qn(n,0),y=qn(i,0);return[g,[0,f],y,l,c]}let d=!0,h=0;const p=new Array(u).fill(0);for(let g=0;g<a;++g){const y=e[g*f];if(y<0)throw new Error(mle(g,y));if(y>=u)throw new Error(gle(g,y,u));++p[y],d=d&&y>=h,h=y}let m=!0;for(let g=0;g<u;++g){const y=p[g]===0;l[g]=y,m=m&&!y,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&d){const g=e,y=r;for(let b=0;b<a;++b)c[b]=b;return[g,[a,f],y,l,c]}else{const g=p[u-1],y=qn(n,g*f),b=qn(i,g),v=new Array(u).fill(0);for(let x=0;x<a;++x){const w=e[x*f],S=v[w],C=(w===0?0:p[w-1])+S;v[w]++;for(let k=0;k<f;++k)y[C*f+k]=e[x*f+k];b[C]=r[x],c[x]=C}for(let x=0;x<u;++x)if(v[x]===0){const S=x===0?0:p[x-1];y[S*f+0]=x;for(let C=1;C<f;++C)y[S*f+C]=0;b[S]=o}return[y,[g,f],b,l,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qfe(e,t,n,r,i){const s=ee(r),o=t[0],a=i.length,u=[];let l=1,c=-1;for(let g=0;g<a;++g){const y=i[g];if(y===-1){if(c!==-1)throw new Error(yle(c,g));c=g,u.push(1)}else{if(y<0)throw new Error(ble(g,y));l*=y,u.push(y)}}if(c!==-1){if(l<=0)throw new Error(vle());const g=Math.trunc(s/l);if(l*g!==s)throw new Error(xle(r,u));u[c]=g}if(ee(u)!==s)throw new Error(wle(r,u));const d=r.length,h=[];if(d>0){h[d-1]=1;for(let g=d-2;g>=0;--g)h[g]=h[g+1]*r[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*u[g+1]}const m=qn(n,o*a);for(let g=0;g<o;++g){let y=0;for(let b=0;b<d;++b)y+=e[g*d+b]*h[b];for(let b=0;b<a;++b)m[g*a+b]=Math.trunc(y/p[b]),y%=p[b]}return[m,[o,a],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(e,t,n,r,i,s=!1,o=0){const a=r.length,u=[t[0],e.length/t[0]],l=u[1],f=a>0?i[a-1]+1:0;if(f<0)throw new Error(I5());const d=t.slice();d[0]=f;const h=d.reduce((v,x)=>v*x,1),p=qn(n,h);if(a===0)return f>0&&p.fill(o),[p,d];if(f<=0)throw new Error(I5());let m=0,g=1,y=0,b=i[m];for(;;){let v=0;if(g<a){if(v=i[g],b===v){++g;continue}if(b>=v)throw new Error(Sle())}if(b<0||b>=f)throw new Error(Cle(b,f));b>y&&p.fill(o,y*l,b*l);for(let x=m;x<g;++x){const w=r[x];if(w<0||w>=u[0])throw new Error(kle(x,r[x],u[0]));for(let S=0;S<l;S++)p[b*l+S]+=e[w*l+S]}if(s)for(let x=0;x<l;x++)p[b*l+x]/=g-m;if(m=g,++g,y=b+1,b=v,g>a)break}return y<f&&p.fill(o,y*l,f*l),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y7e=jl(e=>Math.sqrt(e)),Z7e=Jt($y,e=>Math.sqrt(e)),Q7e={kernelName:$y,backendName:"cpu",kernelFunc:Z7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe=or((e,t)=>{const n=e-t;return n*n}),J7e=$r(_y,Xfe),e9e={kernelName:_y,backendName:"cpu",kernelFunc:J7e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=jl((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),t9e=nh(IS,Kfe),n9e={kernelName:IS,backendName:"cpu",kernelFunc:t9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yfe(e,t,n,r){const i=mt(e,t.dtype);for(let s=0;s<i.size;s++){const o=i.indexToLoc(s),a=new Array(o.length);for(let u=0;u<a.length;u++)a[u]=o[u]*n[u]+r[u];i.set(t.get(...a),...o)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r9e{constructor(t,n,r,i,s,o){this.separator=ml(t),this.nGramWidths=n,this.leftPad=ml(r),this.rightPad=ml(i),this.padWidth=s,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const r=this.getPadWidth(n);return Math.max(0,t+2*r-n+1)}createNGrams(t,n,r,i,s,o){for(let a=0;a<s;++a){const u=this.getPadWidth(o),l=Math.max(0,u-a),c=Math.max(0,u-(s-(a+1))),f=o-(l+c),d=n+(l>0?0:a-u);let h=0;h+=l*this.leftPad.length;for(let b=0;b<f;++b)h+=t[d+b].length;h+=c*this.rightPad.length;const p=l+c+f-1;h+=p*this.separator.length,r[i+a]=new Uint8Array(h);const m=r[i+a];let g=0;const y=b=>b.forEach(v=>m[g++]=v);for(let b=0;b<l;++b)y(this.leftPad),y(this.separator);for(let b=0;b<f-1;++b)y(t[d+b]),y(this.separator);if(f>0){y(t[d+f-1]);for(let b=0;b<c;++b)y(this.separator),y(this.rightPad)}else{for(let b=0;b<c-1;++b)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(t,n){const r=t.length,i=n.length;if(i>0){let u=n[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let l=1;l<i;++l){let c=n[l]>=u;if(c=c&&n[l]<=r,!c)throw new Error(`Invalid split value ${n[l]}, must be in [${u}, ${r}]`);u=n[l]}if(u!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${u}`)}const s=i-1,o=qn("int32",i);if(r===0||i===0){const u=new Array(r);for(let l=0;l<=s;++l)o[l]=0;return[u,o]}o[0]=0;for(let u=1;u<=s;++u){const l=n[u]-n[u-1];let c=0;this.nGramWidths.forEach(f=>{c+=this.getNumNGrams(l,f)}),this.preserveShort&&l>0&&c===0&&(c=1),o[u]=o[u-1]+c}const a=new Array(o[s]);for(let u=0;u<s;++u){const l=n[u];let c=o[u];if(this.nGramWidths.forEach(f=>{const d=n[u+1]-n[u],h=this.getNumNGrams(d,f);this.createNGrams(t,l,a,c,h,f),c+=h}),this.preserveShort&&c===o[u]){const f=n[u+1]-n[u];if(f===0)continue;const d=f+2*this.padWidth;this.createNGrams(t,l,a,c,1,d)}}return[a,o]}}function Zfe(e,t,n,r,i,s,o,a){return new r9e(n,r,i,s,o,a).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9e(e,t,n,r){if(!e.length)return;if(t.length===0){for(let s=0;s<e.length;++s)r.push(e.subarray(s,s+1));return}if(t.length===1){const s=t[0];let o=e.indexOf(s);for(;o!==-1;){const a=e.subarray(0,o);(!n||a.length!==0)&&r.push(a),e=e.subarray(o+1),o=e.indexOf(s)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let s=0;s<e.length+1;s++)if(s===e.length||t.indexOf(e[s])!==-1){const o=e.subarray(i,s);(!n||o.length!==0)&&r.push(o),i=s+1}}function Qfe(e,t,n){const r=e.length,i=[];let s=0,o=0;const a=new Array(r);for(let d=0;d<r;++d){const h=i.length;i9e(e[d],t,n,i);const p=i.length-h;a[d]=p,s+=p,o=Math.max(o,p)}const u=qn("int32",s*2),l=new Array(s),c=[r,o];let f=0;for(let d=0;d<r;++d)for(let h=0;h<a[d];++h)u[f*2]=d,u[f*2+1]=h,l[f]=i[f],++f;return[u,l,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jfe(e,t){const n=qn("int32",e.length);for(let r=0;r<e.length;++r)n[r]=uae(e[r]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede=or((e,t)=>e-t),s9e=W9((e,t,n,r)=>({real:e-n,imag:t-r})),q9=$r(Ey,ede,s9e),o9e={kernelName:Ey,backendName:"cpu",kernelFunc:q9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(e,t){const n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];const r=mt(n,e.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),o=new Array(e.rank);for(let u=0;u<o.length;u++)o[u]=s[u]%e.shape[u];const a=e.locToIndex(o);r.values[i]=e.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zv=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function nde(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,u=t-n+1,l=Math.log(a),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(a-c)/a)*Math.sign(u-a/2),d=Math.max(n,Math.floor(t-u*c/a+f)),h=Math.min(r,Math.floor(t+(a-u)*c/a+f));nde(e,t,d,h)}const i=e[t];let s=n,o=r;for(bc(e,n,t),zv(e[r],i)>0&&bc(e,n,r);s<o;){for(bc(e,s,o),s++,o--;zv(e[s],i)<0;)s=s+1;for(;zv(e[o],i)>0;)o=o-1}zv(e[n],i)===0?bc(e,n,o):(o=o+1,bc(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}}function rde(e,t,n,r,i){const s=t[t.length-1],[o,a]=[e.length/s,s],u=Dr(n,o*r),l=Dr("int32",o*r);for(let f=0;f<o;f++){const d=f*a,h=e.subarray(d,d+a);let p=new Array(h.length);h.forEach((b,v)=>p[v]={value:b,index:v}),r<p.length&&(nde(p,r),p=p.slice(0,r)),i&&p.sort(zv);const m=f*r,g=u.subarray(m,m+r),y=l.subarray(m,m+r);for(let b=0;b<r;b++)g[b]=p[b].value,y[b]=p[b].index}const c=t.slice();return c[c.length-1]=r,[mt(c,n,u),mt(c,"int32",l)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(e,t,n,r){const i=wt(t,n)[0],s=[1,n[0],1];for(let p=0;p<i;p++)s[0]*=n[p];s[1]=n[i];for(let p=i+1;p<n.length;p++)s[2]*=n[p];const o=new Map,a=new Int32Array(n[i]),u=new hr(s,r,e),l=[],c=s[0]===1&&s[2]===1;for(let p=0;p<n[i];p++){let m;if(c)m=e[p].toString();else{const y=[];for(let b=0;b<s[0];b++)for(let v=0;v<s[2];v++)y.push(u.get(b,p,v));m=y.join(",")}const g=o.get(m);if(g!=null)a[p]=g;else{const y=o.size;o.set(m,y),a[p]=y,l.push(p)}}const f=s.slice();f[1]=o.size;const d=new hr(f,r);l.forEach((p,m)=>{for(let g=0;g<s[0];g++)for(let y=0;y<s[2];y++)d.set(u.get(g,p,y),g,m,y)});const h=n.slice();return h[i]=f[1],{outputValues:d.values,outputShape:h,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sde=Object.freeze(Object.defineProperty({__proto__:null,addImpl:hfe,bincountImpl:V9,bincountReduceImpl:pfe,bitwiseAndImpl:mfe,castImpl:dfe,ceilImpl:gfe,concatImpl:yfe,equalImpl:bfe,expImpl:xfe,expm1Impl:Sfe,floorDivImpl:kfe,floorImpl:Cfe,gatherNdImpl:$fe,gatherV2Impl:_fe,greaterEqualImpl:Tfe,greaterImpl:Efe,lessEqualImpl:Nfe,lessImpl:Afe,linSpaceImpl:Ife,logImpl:Dfe,maxImpl:Ofe,maximumImpl:Ffe,minimumImpl:Rfe,multiplyImpl:j9,negImpl:Mfe,notEqualImpl:Pfe,prodImpl:Lfe,raggedGatherImpl:zfe,raggedRangeImpl:Bfe,raggedTensorToTensorImpl:Ufe,rangeImpl:Wfe,rsqrtImpl:Vfe,scatterImpl:hp,sigmoidImpl:q7e,simpleAbsImpl:ffe,sliceImpl:Hfe,sparseFillEmptyRowsImpl:Gfe,sparseReshapeImpl:qfe,sparseSegmentReductionImpl:G9,sqrtImpl:Y7e,squaredDifferenceImpl:Xfe,staticRegexReplaceImpl:Kfe,stridedSliceImpl:Yfe,stringNGramsImpl:Zfe,stringSplitImpl:Qfe,stringToHashBucketFastImpl:Jfe,subImpl:ede,tileImpl:tde,topKImpl:rde,transposeImpl:H9,uniqueImpl:ide},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const ode="4.20.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */uB("cpu",()=>new hC,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ade=Jt(Y1,e=>e>=0?e:Math.exp(e)-1),a9e={kernelName:Y1,backendName:"cpu",kernelFunc:ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r;Be([i],"leakyRelu");const o=ee(i.shape),a=n.data.get(i.dataId).values,u=Dr("float32",o);for(let l=0;l<a.length;l++)u[l]=a[l]<0?s*a[l]:a[l];return n.makeTensorInfo(i.shape,"float32",u)}const u9e={kernelName:eS,backendName:"cpu",kernelFunc:ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9e=or((e,t)=>e<0?t*e:e);function lde(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;Be([r,i],"prelu");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,[a,u]=l9e(r.shape,i.shape,s,o,"float32");return n.makeTensorInfo(u,"float32",a)}const c9e={kernelName:vS,backendName:"cpu",kernelFunc:lde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cde=Jt(my,e=>Math.max(0,e)),f9e={kernelName:my,backendName:"cpu",kernelFunc:cde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fde=Jt(gy,e=>Math.min(Math.max(0,e),6)),d9e={kernelName:gy,backendName:"cpu",kernelFunc:fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lT(e,t,n,r,i){if(n==="linear")return Ol({inputs:{x:t},backend:e});if(n==="relu")return cde({inputs:{x:t},backend:e});if(n==="elu")return ade({inputs:{x:t},backend:e});if(n==="relu6")return fde({inputs:{x:t},backend:e});if(n==="prelu")return lde({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return ude({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n==="sigmoid")return jfe({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bn(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,o=ee(i.shape),a=Qz(s,o),u=ee(a);A(o===u,()=>`The new shape (${a}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const l=n.data.get(i.dataId);if(l.complexTensorInfos!=null){const c=l.complexTensorInfos.real,f=l.complexTensorInfos.imag;c.shape=a,f.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}const h9e={kernelName:wS,backendName:"cpu",kernelFunc:bn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;Be([i,s],"matMul");const u=i.shape.length,l=s.shape.length,c=o?i.shape[u-2]:i.shape[u-1],f=a?s.shape[l-1]:s.shape[l-2],d=o?i.shape[u-1]:i.shape[u-2],h=a?s.shape[l-2]:s.shape[l-1],p=i.shape.slice(0,-2),m=s.shape.slice(0,-2),g=ee(p),y=ee(m),v=ut(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([d,h]);A(c===f,()=>`Error in matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${o} and transposeB=${a} must match.`);const x=o?[g,c,d]:[g,d,c],w=a?[y,h,f]:[y,f,h],S=bn({inputs:{x:i},backend:n,attrs:{shape:x}}),C=bn({inputs:{x:s},backend:n,attrs:{shape:w}}),k=o?S.shape[1]:S.shape[2],E=o?S.shape[2]:S.shape[1],_=a?C.shape[1]:C.shape[2],T=Math.max(g,y),D=n.data.get(S.dataId).values,O=n.data.get(C.dataId).values,M=Ye(S.shape),I=Ye(C.shape),[P,V,F]=o?[M[0],1,M[1]]:[M[0],M[1],1],[B,q,J]=a?[1,I[1],I[0]]:[I[1],1,I[0]],ne=E*_,re=mt([T,E,_],S.dtype),ae=re.values,le=n.blockSize;for(let me=0;me<T;me++){const Oe=me%g,Me=me%y;for(let X=0;X<E;X+=le){const oe=Math.min(X+le,E);for(let fe=0;fe<_;fe+=le){const W=Math.min(fe+le,_);for(let Ve=0;Ve<k;Ve+=le){const ke=Math.min(Ve+le,k);for(let Ke=X;Ke<oe;Ke++)for(let He=fe;He<W;He++){let Z=0;for(let Ee=Ve;Ee<ke;Ee++){const it=D[Oe*P+Ke*V+Ee*F],qt=O[Ee*B+He*q+Me*J];Z+=it*qt}ae[me*ne+(Ke*_+He)]+=Z}}}}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(v,re.dtype,re.values)}const p9e={kernelName:L2,backendName:"cpu",kernelFunc:dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9e(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:f}=r;let d,h,p;const m=[];d=dde({inputs:{a:i,b:s},attrs:{transposeA:u,transposeB:l},backend:n}),o&&(h=Y0({inputs:{a:d,b:o},backend:n}),m.push(d),d=h),c&&(p=lT(n,d,c,a,f),m.push(d),d=p);for(const y of m)n.disposeIntermediateTensorInfo(y);return d}const g9e={kernelName:xw,backendName:"cpu",kernelFunc:m9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y9e=Jt(P1,e=>Math.acos(e)),b9e={kernelName:P1,backendName:"cpu",kernelFunc:y9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v9e=Jt(L1,e=>Math.acosh(e)),x9e={kernelName:L1,backendName:"cpu",kernelFunc:v9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9e(e){const{inputs:t,backend:n}=e,r=t;Be(t,"addN");const i=r.map(a=>n.data.get(a.dataId).values),s=mt(r[0].shape,r[0].dtype),o=s.values;for(let a=0;a<r.length;a++){const u=i[a];for(let l=0;l<o.length;l++)o[l]+=u[l]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}const S9e={kernelName:O2,backendName:"cpu",kernelFunc:w9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Be(i,"all");const a=wt(s,i.shape);let u=a;const l=Bn(u,i.shape.length);let c=i;l!=null&&(c=xs({inputs:{x:i},backend:n,attrs:{perm:l}}),u=ir(u.length,i.shape.length)),ii("all",u,c.shape.length);const[f,d]=Lr(c.shape,u),h=ee(d),p=ei(ee(f),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const b=y*h;let v=m[b];for(let x=0;x<h;++x){const w=m[b+x];v=v&&w}p[y]=v}l!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(f,c.dtype,p);if(o){const y=rr(f,a),b=bn({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}const k9e={kernelName:DN,backendName:"cpu",kernelFunc:C9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Be(i,"any");const a=wt(s,i.shape);let u=a;const l=Bn(u,i.shape.length);let c=i;l!=null&&(c=xs({inputs:{x:i},backend:n,attrs:{perm:l}}),u=ir(u.length,i.shape.length)),ii("any",u,c.shape.length);const[f,d]=Lr(c.shape,u),h=ee(d),p=ei(ee(f),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const b=y*h;let v=m[b];for(let x=0;x<h;++x){const w=m[b+x];v=v||w}p[y]=v}l!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(f,c.dtype,p);if(o){const y=rr(f,a),b=bn({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}const _9e={kernelName:ON,backendName:"cpu",kernelFunc:$9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Be(i,"argMax");let o=wt(s,i.shape);const a=Bn(o,i.shape.length);let u=i;const l=[];a!=null&&(u=xs({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=ir(o.length,u.shape.length)),o=[o[0]],ii("argMax",o,u.shape.length);const[c,f]=Lr(u.shape,o),d=ee(c),h=ei(d,"int32"),p=ee(f),m=n.data.get(u.dataId).values;for(let g=0;g<h.length;++g){const y=g*p;let b=m[y],v=0;for(let x=0;x<p;++x){const w=m[y+x];w>b&&(b=w,v=x)}h[g]=v}return l.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",h)}const T9e={kernelName:F2,backendName:"cpu",kernelFunc:E9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Be(i,"argMin");let o=wt(s,i.shape);const a=Bn(o,i.shape.length);let u=i;const l=[];a!=null&&(u=xs({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=ir(o.length,u.shape.length)),o=[o[0]],ii("argMin",o,u.shape.length);const[c,f]=Lr(u.shape,o),d=ee(c),h=ei(d,"int32"),p=ee(f),m=n.data.get(u.dataId).values;for(let g=0;g<h.length;++g){const y=g*p;let b=m[y],v=0;for(let x=0;x<p;++x){const w=m[y+x];w<b&&(b=w,v=x)}h[g]=v}return l.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",h)}const N9e={kernelName:R2,backendName:"cpu",kernelFunc:A9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I9e=Jt(z1,e=>Math.asin(e)),D9e={kernelName:z1,backendName:"cpu",kernelFunc:I9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O9e=Jt(B1,e=>Math.asinh(e)),F9e={kernelName:B1,backendName:"cpu",kernelFunc:O9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R9e=Jt(U1,e=>Math.atan(e)),M9e={kernelName:U1,backendName:"cpu",kernelFunc:R9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P9e=or((e,t)=>Math.atan2(e,t)),L9e=$r(V1,P9e),z9e={kernelName:V1,backendName:"cpu",kernelFunc:L9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B9e=Jt(W1,e=>Math.atanh(e)),U9e={kernelName:W1,backendName:"cpu",kernelFunc:B9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(e,t,n,r,i,s){const o=i.strideHeight,a=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,p=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=mt(i.outShape,n),g=m.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],b=i.outShape[2]*i.outShape[3],v=i.outShape[3];for(let x=0;x<i.batchSize;++x){const w=x*y,S=x*r[0];for(let C=0;C<i.inChannels;++C)for(let k=0;k<i.outHeight;++k){const E=k*o-d,_=Math.max(0,E),T=Math.min(i.inHeight,c+E),D=w+k*b;for(let O=0;O<i.outWidth;++O){const M=O*a-h,I=Math.max(0,M),P=Math.min(i.inWidth,f+M);let V=p,F=0,B=0;for(let J=_;J<T;J+=u){const ne=S+J*r[1];for(let re=I;re<P;re+=l){const ae=ne+re*r[2],le=e[ae+C];s==="max"&&le>V?V=le:s==="avg"&&(F+=le,B++)}if(isNaN(V))break}const q=D+O*v+C;g[q]=s==="avg"?F/B:V}}}return m}function hde(e,t,n,r,i=!1,s=!1){const o=mt(r.outShape,"int32"),a=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,m=mt(t,n,e);for(let g=0;g<r.batchSize;++g)for(let y=0;y<r.inChannels;++y)for(let b=0;b<r.outHeight;++b){const v=b*a-h;let x=v;for(;x<0;)x+=l;const w=Math.min(r.inHeight,f+v);for(let S=0;S<r.outWidth;++S){const C=S*u-p;let k=C;for(;k<0;)k+=c;const E=Math.min(r.inWidth,d+C);let _=Number.NEGATIVE_INFINITY,T=-1;for(let D=x;D<w;D+=l){const O=D-v;for(let M=k;M<E;M+=c){const I=M-C,P=m.get(g,D,M,y);P>_&&(_=P,i?T=s?((g*r.inHeight+D)*r.inWidth+M)*r.inChannels+y:(D*r.inWidth+M)*r.inChannels+y:T=O*d+I)}}o.set(T,g,b,S,y)}}return o}function pde(e,t,n,r,i,s){const o=i.strideDepth,a=i.strideHeight,u=i.strideWidth,l=i.dilationDepth,c=i.dilationHeight,f=i.dilationWidth,d=i.effectiveFilterDepth,h=i.effectiveFilterHeight,p=i.effectiveFilterWidth,m=i.padInfo.front,g=i.padInfo.top,y=i.padInfo.left,b=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=mt(i.outShape,n),x=v.values,w=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],S=i.outShape[2]*i.outShape[3]*i.outShape[4],C=i.outShape[3]*i.outShape[4],k=i.outShape[4];for(let E=0;E<i.batchSize;++E){const _=E*w,T=E*r[0];for(let D=0;D<i.inChannels;++D)for(let O=0;O<i.outDepth;++O){const M=O*o-m;let I=M;for(;I<0;)I+=l;const P=Math.min(i.inDepth,d+M),V=_+O*S;for(let F=0;F<i.outHeight;++F){const B=F*a-g;let q=B;for(;q<0;)q+=c;const J=Math.min(i.inHeight,h+B),ne=V+F*C;for(let re=0;re<i.outWidth;++re){const ae=re*u-y;let le=ae;for(;le<0;)le+=f;const me=Math.min(i.inWidth,p+ae),Oe=ne+re*k;let Me=b,X=0,oe=0;for(let W=I;W<P;W+=l){const Ve=T+W*r[1];for(let ke=q;ke<J;ke+=c){const Ke=Ve+ke*r[2];for(let He=le;He<me;He+=f){const Z=Ke+He*r[3],Ee=e[Z+D];if(s==="max"&&Ee>Me?Me=Ee:s==="avg"&&(X+=Ee,oe++),isNaN(Me))break}if(isNaN(Me))break}if(isNaN(Me))break}const fe=Oe+D;x[fe]=s==="avg"?X/Math.max(oe,1):Me}}}}return v}function W9e(e,t){const n=mt(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,s=t.strideWidth,o=t.dilationDepth,a=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,h=t.padInfo.top,p=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){const b=y*r-d;let v=b;for(;v<0;)v+=o;const x=Math.min(t.inDepth,l+b);for(let w=0;w<t.outHeight;++w){const S=w*i-h;let C=S;for(;C<0;)C+=a;const k=Math.min(t.inHeight,c+S);for(let E=0;E<t.outWidth;++E){const _=E*s-p;let T=_;for(;T<0;)T+=u;const D=Math.min(t.inWidth,f+_);let O=Number.NEGATIVE_INFINITY,M=-1;for(let I=v;I<x;I+=o){const P=I-b;for(let V=C;V<k;V+=a){const F=V-S;for(let B=T;B<D;B+=u){const q=B-_,J=e.get(m,I,V,B,g);J>=O&&(O=J,M=P*c*f+F*c+q)}}}n.set(M,m,y,w,E,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Be(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;A(ri(o,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=za(i.shape,s,o,l,a,u);let f;if(c.filterWidth===1&&c.filterHeight===1&&$t(c.inShape,c.outShape))f=Ol({inputs:{x:i},backend:n});else{const d=n.data.get(i.dataId).values,h=Ye(i.shape),p=X9(d,i.shape,i.dtype,h,c,"avg");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const j9e={kernelName:M2,backendName:"cpu",kernelFunc:V9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:l}=r;Be(i,"avgPool3d");const c=af(i.shape,s,o,1,a,u,l),f=n.data.get(i.dataId).values,d=pde(f,i.shape,i.dtype,Ye(i.shape),c,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const G9e={kernelName:P2,backendName:"cpu",kernelFunc:H9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9e(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:u,dimRoundingMode:l}=r;Be([i,s],"avgPool3DGrad");const c=af(s.shape,o,a,1,u,l),f=c.strideDepth,d=c.strideHeight,h=c.strideWidth,p=c.filterDepth,m=c.filterHeight,g=c.filterWidth,y=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,S=c.effectiveFilterWidth,C=x-1-c.padInfo.front,k=S-1-c.padInfo.left,E=w-1-c.padInfo.top,_=mt(s.shape,"float32"),T=1/(p*m*g),D=n.bufferSync(i);for(let O=0;O<c.batchSize;++O)for(let M=0;M<c.inChannels;++M)for(let I=0;I<c.inDepth;++I)for(let P=0;P<c.inHeight;++P)for(let V=0;V<c.inWidth;++V){const F=I-C,B=P-E,q=V-k;let J=0;for(let ne=0;ne<x;ne+=y){const re=(F+ne)/f;if(!(re<0||re>=c.outDepth||Math.floor(re)!==re))for(let ae=0;ae<w;ae+=b){const le=(B+ae)/d;if(!(le<0||le>=c.outHeight||Math.floor(le)!==le))for(let me=0;me<S;me+=v){const Oe=(q+me)/h;if(Oe<0||Oe>=c.outWidth||Math.floor(Oe)!==Oe)continue;const Me=D.get(O,re,le,Oe,M);J+=Me}}}_.set(J*T,O,I,P,V,M)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const X9e={kernelName:RN,backendName:"cpu",kernelFunc:q9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9e(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s;Be([i,s],"avgPoolGrad");const{filterSize:a,strides:u,pad:l}=r,c=za(o.shape,a,u,1,l),f=c.strideHeight,d=c.strideWidth,h=c.filterHeight,p=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,y=c.effectiveFilterHeight,b=c.effectiveFilterWidth,v=b-1-c.padInfo.left,x=y-1-c.padInfo.top,w=mt(o.shape,"float32"),S=1/(h*p),C=n.data.get(i.dataId).values,k=mt(i.shape,"float32",C);for(let E=0;E<c.batchSize;++E)for(let _=0;_<c.inChannels;++_)for(let T=0;T<c.inHeight;++T)for(let D=0;D<c.inWidth;++D){const O=T-x,M=D-v;let I=0;for(let P=0;P<y;P+=m){const V=(O+P)/f;if(!(V<0||V>=c.outHeight||Math.floor(V)!==V))for(let F=0;F<b;F+=g){const B=(M+F)/d;if(B<0||B>=c.outWidth||Math.floor(B)!==B)continue;const q=k.get(E,V,B,_);I+=q}}w.set(I*S,E,T,D,_)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Y9e={kernelName:FN,backendName:"cpu",kernelFunc:K9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,scale:s,offset:o,mean:a,variance:u}=t;A(a.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Be([i,a,u,s,o],"batchNorm");let{varianceEpsilon:l}=r;l==null&&(l=.001);const c=n.data.get(i.dataId).values,f=n.data.get(a.dataId).values,d=n.data.get(u.dataId).values,h=s?n.data.get(s.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),g=p.length,y=h.length,b=d.length,v=f.length;let x=0,w=0,S=0,C=0;for(let k=0;k<c.length;++k)m[k]=p[x++]+(c[k]-f[w++])*h[S++]/Math.sqrt(d[C++]+l),x>=g&&(x=0),w>=v&&(w=0),S>=y&&(S=0),C>=b&&(C=0);return n.makeTensorInfo(i.shape,i.dtype,m)}const Q9e={kernelName:Z2,backendName:"cpu",kernelFunc:Z9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:o}=r;Be([i],"batchToSpaceND");const a=s.reduce((y,b)=>y*b),u=tC(i.shape,s,a),l=nC(u.length,s.length),c=rC(i.shape,s,a),f=V8(o,s.length),d=j8(c,o,s.length),h=bn({inputs:{x:i},backend:n,attrs:{shape:u}}),p=xs({inputs:{x:h},backend:n,attrs:{perm:l}}),m=bn({inputs:{x:p},backend:n,attrs:{shape:c}}),g=Zp({inputs:{x:m},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const eUe={kernelName:z2,backendName:"cpu",kernelFunc:J9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o}=r,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,l=V9(a,u,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,l)}const nUe={kernelName:MN,backendName:"cpu",kernelFunc:tUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rUe(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,a=ut(Array.from(s),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const iUe={kernelName:PN,backendName:"cpu",kernelFunc:rUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sUe=Jt(G1,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),oUe={kernelName:G1,backendName:"cpu",kernelFunc:sUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aUe=e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(ee(t.shape)),i=n.data.get(t.dataId),s=i.complexTensorInfos.real,o=i.complexTensorInfos.imag,a=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values;for(let l=0;l<a.length;l++){const c=a[l],f=u[l];r[l]=Math.hypot(c,f)}return n.makeOutput(r,t.shape,"float32")},uUe={kernelName:U2,backendName:"cpu",kernelFunc:aUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const lUe={kernelName:rI,backendName:"cpu",kernelFunc:Z0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=wt(i,t[0].shape)[0],o=t.map(m=>m.shape);B8(o,s);let a=bl(t.map(m=>m.shape),s);if(ee(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const u=t.filter(m=>ee(m.shape)>0);if(u.length===1)return Ol({inputs:{x:u[0]},backend:n});if(u[0].dtype==="complex64"){const m=u.map(x=>Yp({inputs:{input:x},backend:n})),g=u.map(x=>Z0({inputs:{input:x},backend:n})),y=Q0({inputs:m,backend:n,attrs:{axis:s}}),b=Q0({inputs:g,backend:n,attrs:{axis:s}}),v=Bs({inputs:{real:y,imag:b},backend:n});return m.forEach(x=>n.disposeIntermediateTensorInfo(x)),g.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),v}const l=u.map(m=>{const y=[-1,ee(m.shape.slice(s))];return bn({inputs:{x:m},backend:n,attrs:{shape:y}})}),c=l.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=bl(l.map(m=>m.shape),1);const f=l[0].shape[0]===1,d=yfe(c,a,t[0].dtype,f),h=bl(u.map(m=>m.shape),s),p=n.makeTensorInfo(h,t[0].dtype,d);return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const cUe={kernelName:W2,backendName:"cpu",kernelFunc:Q0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mde(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:u,dilations:l,dimRoundingMode:c}=r;Be([i,s],"conv2d");const f=uf(u),d=Pr(i.shape,s.shape,o,l,a,c,!1,f),h=d.filterHeight,p=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,y=d.padInfo.left,b=d.padInfo.top,v=d.dataFormat==="channelsLast",x=new hr(d.outShape,i.dtype),w=Ye(i.shape),S=Ye(s.shape),C=w[0],k=v?w[1]:w[2],E=v?w[2]:1,_=v?1:w[1],T=x.strides[0],D=v?x.strides[1]:x.strides[2],O=v?x.strides[2]:1,M=v?1:x.strides[1],I=n.data.get(i.dataId).values,P=n.data.get(s.dataId).values,V=x.values;for(let F=0;F<d.batchSize;++F){const B=F*C,q=F*T;for(let J=0;J<d.outHeight;++J){const ne=q+J*D,re=J*d.strideHeight-b;for(let ae=0;ae<h;++ae){const le=re+ae*m;if(le<0||le>=d.inHeight)continue;const me=ae*S[0],Oe=B+le*k;for(let Me=0;Me<d.outWidth;++Me){const X=ne+Me*O,oe=Me*d.strideWidth-y;for(let fe=0;fe<p;++fe){const W=oe+fe*g;if(W<0||W>=d.inWidth)continue;const Ve=me+fe*S[1],ke=Oe+W*E;let Ke=Ve;for(let He=0;He<d.inChannels;++He){const Z=I[ke+He*_];for(let Ee=0;Ee<d.outChannels;++Ee)V[X+Ee*M]+=Z*P[Ke+Ee];Ke+=d.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,V)}const fUe={kernelName:V2,backendName:"cpu",kernelFunc:mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:u,dimRoundingMode:l,filterShape:c}=r;Be([i,s],"conv2dBackpropFilter");const f=uf(u),d=Pr(i.shape,c,o,1,a,l,!1,f),{strideHeight:h,strideWidth:p,filterHeight:m,filterWidth:g}=d,y=d.dataFormat==="channelsLast",b=new hr(d.filterShape,"float32"),v=d.padInfo.left,x=d.padInfo.top,w=n.data.get(i.dataId).values,S=n.data.get(s.dataId).values,C=new hr(i.shape,i.dtype,w),k=new hr(s.shape,s.dtype,S);for(let E=0;E<m;++E){const _=Math.max(0,Math.ceil((x-E)/h)),T=Math.min(d.outHeight,(d.inHeight+x-E)/h);for(let D=0;D<g;++D){const O=Math.max(0,Math.ceil((v-D)/p)),M=Math.min(d.outWidth,(d.inWidth+v-D)/p);for(let I=0;I<d.inChannels;++I)for(let P=0;P<d.outChannels;++P){let V=0;for(let F=0;F<d.batchSize;++F)for(let B=_;B<T;++B){const q=E+B*h-x;for(let J=O;J<M;++J){const ne=D+J*p-v;y?V+=C.get(F,q,ne,I)*k.get(F,B,J,P):V+=C.get(F,I,q,ne)*k.get(F,P,B,J)}}b.set(V,E,D,I,P)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const hUe={kernelName:zN,backendName:"cpu",kernelFunc:dUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pUe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:u,dataFormat:l,dimRoundingMode:c}=r;Be([i,s],"conv2dBackpropInput");const f=Ye(s.shape),d=Ye(i.shape);let h=uf(l);const p=Pr(o,s.shape,a,1,u,c,!1,h),m=new hr(p.inShape,"float32"),g=m.values,y=n.data.get(i.dataId).values,b=n.data.get(s.dataId).values,[v,x,w]=f,{batchSize:S,filterHeight:C,filterWidth:k,inChannels:E,inHeight:_,inWidth:T,outChannels:D,outHeight:O,outWidth:M,strideHeight:I,strideWidth:P}=p;h=p.dataFormat;const V=C-1-p.padInfo.top,F=k-1-p.padInfo.left,B=h==="channelsLast",q=m.strides[0],J=B?m.strides[1]:m.strides[2],ne=B?m.strides[2]:1,re=B?1:m.strides[1],ae=d[0],le=B?d[1]:d[2],me=B?d[2]:1,Oe=B?1:d[1];for(let Me=0;Me<S;++Me)for(let X=0;X<E;++X)for(let oe=0;oe<_;++oe){const fe=oe-V,W=Math.max(0,Math.ceil(fe/I)),Ve=Math.min(O,(C+fe)/I);for(let ke=0;ke<T;++ke){const Ke=ke-F,He=Math.max(0,Math.ceil(Ke/P)),Z=Math.min(M,(k+Ke)/P);let Ee=0;for(let qt=W;qt<Ve;++qt){const Gu=qt*I-fe;for(let Zi=He;Zi<Z;++Zi){const dt=Zi*P-Ke,po=ae*Me+le*qt+me*Zi,ja=v*(C-1-Gu)+x*(k-1-dt)+w*X;for(let Ha=0;Ha<D;++Ha){const Qi=y[po+Oe*Ha],qu=b[ja+Ha];Ee+=Qi*qu}}}const it=q*Me+J*oe+ne*ke+re*X;g[it]=Ee}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const mUe={kernelName:j2,backendName:"cpu",kernelFunc:pUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r;Be([i,s],"conv3d");const l=Yd(i.shape,s.shape,o,u,a),{filterDepth:c,filterHeight:f,filterWidth:d,dilationDepth:h,dilationHeight:p,dilationWidth:m,padInfo:g}=l,y=g.front,b=g.left,v=g.top,x=new hr(l.outShape,i.dtype),w=n.data.get(i.dataId).values,S=n.data.get(s.dataId).values,C=x.values,k=Ye(i.shape),E=Ye(s.shape);for(let _=0;_<l.batchSize;++_){const T=_*k[0],D=_*x.strides[0];for(let O=0;O<l.outDepth;++O){const M=D+O*x.strides[1],I=O*l.strideDepth-y;for(let P=0;P<c;++P){const V=I+P*h;if(V<0||V>=l.inDepth)continue;const F=P*E[0],B=T+V*k[1];for(let q=0;q<l.outHeight;++q){const J=M+q*x.strides[2],ne=q*l.strideHeight-v;for(let re=0;re<f;++re){const ae=ne+re*p;if(ae<0||ae>=l.inHeight)continue;const le=F+re*E[1],me=B+ae*k[2];for(let Oe=0;Oe<l.outWidth;++Oe){const Me=J+Oe*l.outChannels,X=Oe*l.strideWidth-b;for(let oe=0;oe<d;++oe){const fe=X+oe*m;if(fe<0||fe>=l.inWidth)continue;const W=le+oe*E[2],Ve=me+fe*l.inChannels;let ke=W;for(let Ke=0;Ke<l.inChannels;++Ke){const He=w[Ve+Ke];for(let Z=0;Z<l.outChannels;++Z)C[Me+Z]+=He*S[ke+Z];ke+=l.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const yUe={kernelName:H2,backendName:"cpu",kernelFunc:gUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:u}=r;Be([i,s],"conv3dBackpropFilterV2");const l=Ye(i.shape),c=Ye(s.shape),f=Yd(i.shape,u,o,1,a),d=f.strideDepth,h=f.strideHeight,p=f.strideWidth,m=f.filterDepth,g=f.filterHeight,y=f.filterWidth,b=new hr(f.filterShape,"float32"),v=b.values,[x,w,S,C]=b.strides,k=n.data.get(s.dataId).values,[E,_,T,D]=c,O=n.data.get(i.dataId).values,[M,I,P,V]=l,F=f.padInfo.front,B=f.padInfo.left,q=f.padInfo.top;for(let J=0;J<m;++J){const ne=Math.max(0,Math.ceil((F-J)/d)),re=Math.min(f.outDepth,(f.inDepth+F-J)/d),ae=J*x;for(let le=0;le<g;++le){const me=Math.max(0,Math.ceil((q-le)/h)),Oe=Math.min(f.outHeight,(f.inHeight+q-le)/h),Me=le*w+ae;for(let X=0;X<y;++X){const oe=Math.max(0,Math.ceil((B-X)/p)),fe=Math.min(f.outWidth,(f.inWidth+B-X)/p),W=X*S+Me;for(let Ve=0;Ve<f.inChannels;++Ve){const ke=Ve*C+W;for(let Ke=0;Ke<f.outChannels;++Ke){let He=0;for(let Z=0;Z<f.batchSize;++Z){const Ee=Z*M,it=Z*E;for(let qt=ne;qt<re;++qt){const Zi=(J+qt*d-F)*I+Ee,dt=qt*_+it;for(let po=me;po<Oe;++po){const Ha=(le+po*h-q)*P+Zi,Qi=po*T+dt;for(let qu=oe;qu<fe;++qu){const Mb=(X+qu*p-B)*V+Ha,Pb=qu*D+Qi;He+=O[Mb+Ve]*k[Pb+Ke]}}}}v[ke+Ke]=He}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const vUe={kernelName:BN,backendName:"cpu",kernelFunc:bUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xUe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:u}=r;Be([i],"conv3dBackpropInputV2");const l=Ye(i.shape),c=Ye(s.shape),f=Yd(u,s.shape,a,1,o),d=new hr(f.inShape,"float32"),h=d.values,[p,m,g,y]=d.strides,b=n.data.get(i.dataId).values,[v,x,w,S]=l,C=n.data.get(s.dataId).values,[k,E,_,T]=c,{batchSize:D,filterDepth:O,filterHeight:M,filterWidth:I,inChannels:P,inDepth:V,inHeight:F,inWidth:B,outChannels:q,outDepth:J,outHeight:ne,outWidth:re,strideDepth:ae,strideHeight:le,strideWidth:me}=f,Oe=O-1-f.padInfo.front,Me=M-1-f.padInfo.top,X=I-1-f.padInfo.left;for(let oe=0;oe<D;++oe)for(let fe=0;fe<P;++fe)for(let W=0;W<V;++W){const Ve=W-Oe,ke=Math.max(0,Math.ceil(Ve/ae)),Ke=Math.min(J,(O+Ve)/ae);for(let He=0;He<F;++He){const Z=He-Me,Ee=Math.max(0,Math.ceil(Z/le)),it=Math.min(ne,(M+Z)/le);for(let qt=0;qt<B;++qt){const Gu=qt-X,Zi=Math.max(0,Math.ceil(Gu/me)),dt=Math.min(re,(I+Gu)/me);let po=0;for(let ja=ke;ja<Ke;++ja){const Ha=ja*ae-Ve;for(let Qi=Ee;Qi<it;++Qi){const qu=Qi*le-Z;for(let Ch=Zi;Ch<dt;++Ch){const Mb=Ch*me-Gu,Pb=v*oe+x*ja+w*Qi+S*Ch,Ga=k*(O-1-Ha)+E*(M-1-qu)+_*(I-1-Mb)+T*fe;for(let Cg=0;Cg<q;++Cg){const OF=b[Pb+Cg],FF=C[Ga+Cg];po+=OF*FF}}}}h[p*oe+m*W+g*He+y*qt+fe]=po}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const wUe={kernelName:UN,backendName:"cpu",kernelFunc:xUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SUe=Jt(q1,e=>Math.cos(e)),CUe={kernelName:q1,backendName:"cpu",kernelFunc:SUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kUe=Jt(X1,e=>Math.cosh(e)),$Ue={kernelName:X1,backendName:"cpu",kernelFunc:kUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ue(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:u,extrapolationValue:l}=r,[c,f,d,h]=i.shape,p=s.shape[0],[m,g]=a,y=mt([p,m,g,h],"float32"),b=n.data.get(s.dataId).values,v=n.data.get(o.dataId).values,x=n.data.get(i.dataId).values,w=Ye(i.shape),S=Ye(y.shape);for(let C=0;C<p;C++){const k=C*4,E=b[k],_=b[k+1],T=b[k+2],D=b[k+3],O=v[C];if(O>=c)continue;const M=m>1?(T-E)*(f-1)/(m-1):0,I=g>1?(D-_)*(d-1)/(g-1):0;for(let P=0;P<m;P++){const V=m>1?E*(f-1)+P*M:.5*(E+T)*(f-1);if(V<0||V>f-1){for(let F=0;F<g;F++)for(let B=0;B<h;B++){const q=B+F*S[2]+P*S[1]+C*S[0];y.values[q]=l}continue}if(u==="bilinear"){const F=Math.floor(V),B=Math.ceil(V),q=V-F;for(let J=0;J<g;J++){const ne=g>1?_*(d-1)+J*I:.5*(_+D)*(d-1);if(ne<0||ne>d-1){for(let me=0;me<h;me++){const Oe=me+J*S[2]+P*S[1]+C*S[0];y.values[Oe]=l}continue}const re=Math.floor(ne),ae=Math.ceil(ne),le=ne-re;for(let me=0;me<h;me++){let Oe=me+re*w[2]+F*w[1]+O*w[0];const Me=x[Oe];Oe=me+ae*w[2]+F*w[1]+O*w[0];const X=x[Oe];Oe=me+re*w[2]+B*w[1]+O*w[0];const oe=x[Oe];Oe=me+ae*w[2]+B*w[1]+O*w[0];const fe=x[Oe],W=Me+(X-Me)*le,Ve=oe+(fe-oe)*le;Oe=me+J*S[2]+P*S[1]+C*S[0],y.values[Oe]=W+(Ve-W)*q}}}else for(let F=0;F<g;++F){const B=g>1?_*(d-1)+F*I:.5*(_+D)*(d-1);if(B<0||B>d-1){for(let ne=0;ne<h;ne++){const re=ne+F*S[2]+P*S[1]+C*S[0];y.values[re]=l}continue}const q=Math.round(B),J=Math.round(V);for(let ne=0;ne<h;ne++){const re=ne+q*w[2]+J*w[1]+O*w[0],ae=ne+F*S[2]+P*S[1]+C*S[0];y.values[ae]=x[re]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const EUe={kernelName:VN,backendName:"cpu",kernelFunc:_Ue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;Be(i,"cumprod");const u=Bn([s],i.shape.length);let l=i;u!=null&&(l=xs({inputs:{x:i},backend:n,attrs:{perm:u}}));const c=ir(1,i.shape.length)[0];if(c!==l.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${c}`);const f=ms(l.dtype,"int32"),d=IN(ee(l.shape),f),h=n.data.get(l.dataId).values,p=l.shape[l.shape.length-1],m=a?(y,b)=>y+p-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=p)for(let b=0;b<p;b++){const v=m(y,b);if(b===0)d[v]=o?1:h[v];else{const x=m(y,b-1);d[v]=o?h[x]*d[x]:h[v]*d[x]}}const g=n.makeTensorInfo(l.shape,f,d);if(u!=null){const y=Zd(u),b=xs({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),b}return g}const AUe={kernelName:WN,backendName:"cpu",kernelFunc:TUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;Be(i,"cumsum");const u=Bn([s],i.shape.length);let l=i;u!=null&&(l=xs({inputs:{x:i},backend:n,attrs:{perm:u}}));const c=ir(1,i.shape.length)[0];if(c!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${c}`);const f=ms(l.dtype,"int32"),d=ei(ee(l.shape),f),h=n.data.get(l.dataId).values,p=l.shape[l.shape.length-1],m=a?(y,b)=>y+p-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=p)for(let b=0;b<p;b++){const v=m(y,b);if(b===0)d[v]=o?0:h[v];else{const x=m(y,b-1);d[v]=o?h[x]+d[x]:h[v]+d[x]}}const g=n.makeTensorInfo(l.shape,f,d);if(u!=null){const y=Zd(u),b=xs({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),b}return g}const IUe={kernelName:G2,backendName:"cpu",kernelFunc:NUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(i.shape.length===1){const u=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=V9(u,l,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,c)}else if(i.shape.length===2){const u=n.bufferSync(i),l=n.bufferSync(s),c=pfe(u,l,o,a);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const OUe={kernelName:jN,backendName:"cpu",kernelFunc:DUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:o}=r;A(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=i.shape[0],u=i.shape[1],l=i.shape[2],c=i.shape[3],f=u*s,d=l*s,h=c/(s*s),p=n.data.get(i.dataId).values,m=new Float32Array(a*f*d*h);let g=0;for(let y=0;y<a;++y)for(let b=0;b<f;++b){const v=Math.floor(b/s),x=b%s;for(let w=0;w<d;++w){const S=Math.floor(w/s),C=w%s,k=(x*s+C)*h;for(let E=0;E<h;++E){const T=E+k+c*(S+l*(v+u*y));m[g++]=p[T]}}}return n.makeTensorInfo([a,f,d,h],i.dtype,m)}const RUe={kernelName:HN,backendName:"cpu",kernelFunc:FUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u,dimRoundingMode:l}=r;Be([i,s],"depthwiseConv2DNative");const c=Ye(i.shape),f=Ye(s.shape);let d=u;d==null&&(d=[1,1]),A(ri(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const h=Pr(i.shape,s.shape,o,d,a,l,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=h,v=b.left,x=b.top,w=h.outChannels/h.inChannels,S=new hr(h.outShape,i.dtype),C=n.data.get(i.dataId).values,k=n.data.get(s.dataId).values,E=S.values;for(let _=0;_<h.batchSize;++_){const T=_*c[0],D=_*S.strides[0];for(let O=0;O<h.outHeight;++O){const M=D+O*S.strides[1],I=O*h.strideHeight-x;for(let P=0;P<p;++P){const V=I+P*g;if(V<0||V>=h.inHeight)continue;const F=P*f[0],B=T+V*c[1];for(let q=0;q<h.outWidth;++q){const J=M+q*S.strides[2],ne=q*h.strideWidth-v;for(let re=0;re<m;++re){const ae=ne+re*y;if(ae<0||ae>=h.inWidth)continue;const le=F+re*f[1],me=B+ae*h.inChannels;let Oe=J,Me=le;for(let X=0;X<h.inChannels;++X){const oe=C[me+X];for(let fe=0;fe<w;++fe)E[Oe+fe]+=oe*k[Me+fe];Oe+=w,Me+=w}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const MUe={kernelName:q2,backendName:"cpu",kernelFunc:gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,filterShape:c}=r;Be([i,s],"depthwiseConv2dNativeBackpropFilter");const f=Pr(i.shape,c,o,a,u,l,!0),{strideHeight:d,strideWidth:h,filterHeight:p,filterWidth:m}=f,g=new hr(f.filterShape,"float32"),y=f.padInfo.left,b=f.padInfo.top,v=f.outChannels/f.inChannels,x=n.data.get(i.dataId).values,w=new hr(i.shape,i.dtype,x),S=n.data.get(s.dataId).values,C=new hr(s.shape,s.dtype,S);for(let k=0;k<p;++k){const E=Math.max(0,Math.ceil((b-k)/d)),_=Math.min(f.outHeight,(f.inHeight+b-k)/d);for(let T=0;T<m;++T){const D=Math.max(0,Math.ceil((y-T)/h)),O=Math.min(f.outWidth,(f.inWidth+y-T)/h);for(let M=0;M<f.outChannels;++M){const I=Math.trunc(M/v),P=M%v;let V=0;for(let F=0;F<f.batchSize;++F)for(let B=E;B<_;++B){const q=k+B*d-b;for(let J=D;J<O;++J){const ne=T+J*h-y;V+=w.get(F,q,ne,I)*C.get(F,B,J,M)}}g.set(V,k,T,I,P)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const LUe={kernelName:GN,backendName:"cpu",kernelFunc:PUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zUe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,inputShape:c}=r;Be([i,s],"depthwiseConv2DNativeBackpropInput");const f=Ye(i.shape),d=Ye(s.shape),h=Pr(c,s.shape,o,a,u,l,!0),p=new hr(h.inShape,"float32"),m=p.values,[g,y,b]=p.strides,v=n.data.get(i.dataId).values,[x,w,S]=f,C=n.data.get(s.dataId).values,[k,E,_]=d,{batchSize:T,filterHeight:D,filterWidth:O,inChannels:M,inHeight:I,inWidth:P,outChannels:V,outHeight:F,outWidth:B,strideHeight:q,strideWidth:J}=h,ne=D-1-h.padInfo.top,re=O-1-h.padInfo.left,ae=V/M;for(let le=0;le<T;++le)for(let me=0;me<M;++me)for(let Oe=0;Oe<I;++Oe){const Me=Oe-ne,X=Math.max(0,Math.ceil(Me/q)),oe=Math.min(F,(D+Me)/q);for(let fe=0;fe<P;++fe){const W=fe-re,Ve=Math.max(0,Math.ceil(W/J)),ke=Math.min(B,(O+W)/J);let Ke=0;for(let He=X;He<oe;++He){const Z=He*q-Me;for(let Ee=Ve;Ee<ke;++Ee){const it=Ee*J-W,qt=x*le+w*He+S*Ee,Gu=k*(D-1-Z)+E*(O-1-it)+_*me;for(let Zi=0;Zi<ae;++Zi){const dt=me*ae+Zi,po=v[qt+dt],ja=C[Gu+Zi];Ke+=po*ja}}}m[g*le+y*Oe+b*fe+me]=Ke}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const BUe={kernelName:qN,backendName:"cpu",kernelFunc:zUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UUe(e){const{inputs:t,backend:n}=e,{x:r}=t,i=ee(r.shape),s=n.data.get(r.dataId).values,o=mt([i,i],r.dtype),a=o.values;for(let l=0;l<s.length;l++)a[l*i+l]=s[l];const u=[...r.shape,...r.shape];return n.makeTensorInfo(u,o.dtype,o.values)}const WUe={kernelName:XN,backendName:"cpu",kernelFunc:UUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VUe={kernelName:X2,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i}=e,{strides:s,pad:o,dilations:a}=n,u=t,l=u.data.get(r.dataId).values,c=r.shape.length,f=u.data.get(i.dataId).values,d=i.shape.length,{batchSize:h,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:S,filterWidth:C,dilationHeight:k,dilationWidth:E,outShape:_}=PS(r.shape,i.shape,s,o,"NHWC",a),T=ee(_),D=_.length,O=qn(r.dtype,T);for(let I=0;I<h;++I)for(let P=0;P<y;++P){const V=P*x-v.top;for(let F=0;F<b;++F){const B=F*w-v.left;for(let q=0;q<g;++q){let J=Number.MIN_SAFE_INTEGER;for(let re=0;re<S;++re){const ae=V+re*k;if(ae>=0&&ae<p)for(let le=0;le<C;++le){const me=B+le*E;if(me>=0&&me<m){const Oe=pu([I,ae,me,q],c,Ye(r.shape)),Me=pu([re,le,q],d,Ye(i.shape)),X=l[Oe]+f[Me];X>J&&(J=X)}}}const ne=pu([I,P,F,q],D,Ye(_));O[ne]=J}}}return{dataId:u.write(Xd(O,r.dtype),_,r.dtype),shape:_,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jUe={kernelName:WE,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:o,pad:a,dilations:u}=n,l=t,c=Po(r.shape,l.data.get(r.dataId).values),f=Po(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:h,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:S,dilationHeight:C,dilationWidth:k,outShape:E}=PS(r.shape,i.shape,o,a,"NHWC",u);A(s.rank===E.length,()=>`Error in ${WE}, dy must have the same rank as output ${E.length}, but got ${s.rank}`);const _=Po(E,l.data.get(s.dataId).values),T=eB(i.shape,i.dtype);for(let O=0;O<d;++O)for(let M=0;M<g;++M){const I=M*v-b.top;for(let P=0;P<y;++P){const V=P*x-b.left;for(let F=0;F<m;++F){let B=Number.MIN_SAFE_INTEGER,q=0,J=0;for(let ne=0;ne<w;++ne){const re=I+ne*C;if(re>=0&&re<h)for(let ae=0;ae<S;++ae){const le=V+ae*k;if(le>=0&&le<p){const me=c[O][re][le][F]+f[ne][ae][F];me>B&&(B=me,q=ne,J=ae)}}}T[q][J][F]+=_[O][M][P][F]}}}return{dataId:l.write(Xd(T,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HUe={kernelName:UE,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:o,pad:a,dilations:u}=n,l=t,c=Po(r.shape,l.data.get(r.dataId).values),f=Po(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:h,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:S,dilationHeight:C,dilationWidth:k,outShape:E}=PS(r.shape,i.shape,o,a,"NHWC",u);A(s.rank===E.length,()=>`Error in ${UE}, dy must have the same rank as output ${E.length}, but got ${s.rank}`);const _=Po(E,l.data.get(s.dataId).values),T=eB(r.shape,r.dtype);for(let O=0;O<d;++O)for(let M=0;M<g;++M){const I=M*v-b.top;for(let P=0;P<y;++P){const V=P*x-b.left;for(let F=0;F<m;++F){let B=Number.MIN_SAFE_INTEGER,q=I<0?0:I,J=V<0?0:V;for(let ne=0;ne<w;++ne){const re=I+ne*C;if(re>=0&&re<h)for(let ae=0;ae<S;++ae){const le=V+ae*k;if(le>=0&&le<p){const me=c[O][re][le][F]+f[ne][ae][F];me>B&&(B=me,q=re,J=le)}}}T[O][q][J][F]+=_[O][M][P][F]}}}return{dataId:l.write(Xd(T,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GUe(e){const{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:s,options:o}=r,{contextOptions:a,imageOptions:u}=o||{},l=(u==null?void 0:u.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const f=s.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${c} type.`);const[d,h]=i.shape.slice(0,2),p=i.shape.length===2?1:i.shape[2],m=n.data.get(i.dataId).values,g=i.dtype==="float32"?255:1,y=new Uint8ClampedArray(h*d*4);for(let v=0;v<d*h;++v){const x=[0,0,0,255*l];for(let S=0;S<p;S++){const C=m[v*p+S];if(i.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(i.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);p===1?(x[0]=C*g,x[1]=C*g,x[2]=C*g):x[S]=C*g}const w=v*4;y[w+0]=Math.round(x[0]),y[w+1]=Math.round(x[1]),y[w+2]=Math.round(x[2]),y[w+3]=Math.round(x[3])}s.width=h,s.height=d;const b=new ImageData(y,h,d);return f.putImageData(b,0,0),i}const qUe={kernelName:KN,backendName:"cpu",kernelFunc:GUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pC(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Be(i,"sum");let a;i.dtype==="bool"?a=Dd({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):a=Ol({inputs:{x:i},backend:n});const u=a.shape.length,l=wt(s,a.shape),c=Bn(l,u);let f=l,d=a;c!=null&&(d=xs({inputs:{x:a},backend:n,attrs:{perm:c}}),f=ir(f.length,u)),ii("sum",f,d.shape.length);const[h,p]=Lr(d.shape,f),m=ms(d.dtype,"int32");let g=aT(n,h,m);const y=ee(p),b=n.data.get(g.dataId).values,v=n.data.get(d.dataId).values;for(let x=0;x<b.length;++x){const w=x*y;let S=0;for(let C=0;C<y;++C)S+=v[w+C];b[x]=S}if(o){const x=rr(g.shape,l),w=g;g=bn({inputs:{x:g},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(d),g}const XUe={kernelName:ES,backendName:"cpu",kernelFunc:pC};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KUe(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:u}=Q8(i,s.length);e7(o.length,u,s);const{path:l,steps:c}=t7(a,u),f=c.length;let d=null,h=o.length;const p=[];for(let m=0;m<f;++m){for(const g of c[m]){const{permutationIndices:y,expandDims:b}=J8(h,u[g]);let v;n7(y)?v=s[g]:(v=xs({inputs:{x:s[g]},backend:n,attrs:{perm:y}}),p.push(v));const x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);$t(v.shape,x)||(v=bn({inputs:{x:v},backend:n,attrs:{shape:x}}),p.push(v)),d===null?d=v:(d=Z3({inputs:{a:v,b:d},backend:n}),p.push(d))}m<f-1&&(l[m]>=0&&(d=pC({inputs:{x:d},backend:n,attrs:{axis:l[m]-(o.length-h),keepDims:!1}}),p.push(d)),h--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const YUe={kernelName:YN,backendName:"cpu",kernelFunc:KUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZUe(e){const{inputs:t,backend:n}=e,{dy:r,y:i}=t;Be([r,i],"eluGrad");const s=new Float32Array(ee(i.shape)),o=n.data.get(i.dataId).values,a=n.data.get(r.dataId).values;for(let u=0;u<o.length;++u){const l=o[u];l>=0?s[u]=a[u]:s[u]=a[u]*(l+1)}return n.makeTensorInfo(i.shape,"float32",s)}const QUe={kernelName:ZN,backendName:"cpu",kernelFunc:ZUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JUe=H8,eWe=G8,tWe=q8,nWe=X8,rWe=K8,iWe=Y8,sWe=Jt(Z1,e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+JUe*n);return t*(1-((((iWe*r+rWe)*r+nWe)*r+tWe)*r+eWe)*r*Math.exp(-n*n))}),oWe={kernelName:Z1,backendName:"cpu",kernelFunc:sWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:s}=r,o=i.shape.length,a=i.shape.slice();let u=s;return s<0&&(A(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+s+1),a.splice(u,0,1),bn({inputs:{x:i},backend:n,attrs:{shape:a}})}const aWe={kernelName:Y2,backendName:"cpu",kernelFunc:cT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uWe=or((e,t)=>e/t),K9=$r(K1,uWe),J5={kernelName:K1,backendName:"cpu",kernelFunc:K9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yde(e,t,n){const r=e.shape,i=r[0],s=r[1],o=n.data.get(e.dataId),a=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,l=[i,s],c=ee(l),f=Dr("float32",c),d=Dr("float32",c);for(let g=0;g<i;g++){const y=Zp({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,s]}}),b=Zp({inputs:{x:u},backend:n,attrs:{begin:[g,0],size:[1,s]}}),v=Bs({inputs:{real:y,imag:b},backend:n}),{real:x,imag:w}=lWe(v,t,n),S=Xc(x,w);for(let C=0;C<s;C++){const k=Z8(S,C);f[g*s+C]=k.real,d[g*s+C]=k.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v)}const h=n.makeTensorInfo(l,"float32",f),p=n.makeTensorInfo(l,"float32",d),m=Bs({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),m}function lWe(e,t,n){const r=ee(e.shape),i=n.data.get(e.dataId),s=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(cWe(r)){const a=eP(s,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){const l=n.makeTensorInfo(u,"float32",a.real),c=n.makeTensorInfo(u,"float32",a.imag),f=n.makeTensorInfo([],"float32",of(r,"float32")),d=Ol({inputs:{x:f},backend:n}),h=J5.kernelFunc({inputs:{a:l,b:f},backend:n}),p=J5.kernelFunc({inputs:{a:c,b:d},backend:n}),m=n.data.get(h.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=Xc(s,o),u=fWe(a,r,t);return ule(u)}}function cWe(e){return(e&e-1)===0}function eP(e,t,n,r,i){if(n===1)return{real:e,imag:t};const s=Xc(e,t),o=n/2,a=lle(s),u=a.real,l=a.imag,c=[u.length],f=i.makeTensorInfo(c,"float32",u),d=i.makeTensorInfo(c,"float32",l),h=Bs({inputs:{real:f,imag:d},backend:i}),p=cle(s),m=p.real,g=p.imag,y=[m.length],b=i.makeTensorInfo(y,"float32",m),v=i.makeTensorInfo(y,"float32",g),x=Bs({inputs:{real:b,imag:v},backend:i}),w=eP(u,l,o,r,i),S=w.real,C=w.imag,k=[S.length],E=i.makeTensorInfo(k,"float32",S),_=i.makeTensorInfo(k,"float32",C),T=Bs({inputs:{real:E,imag:_},backend:i}),D=eP(m,g,o,r,i),O=D.real,M=D.imag,I=[O.length],P=i.makeTensorInfo(I,"float32",O),V=i.makeTensorInfo(I,"float32",M),F=Bs({inputs:{real:P,imag:V},backend:i}),B=dle(n,r),q=[B.real.length],J=i.makeTensorInfo(q,"float32",B.real),ne=i.makeTensorInfo(q,"float32",B.imag),re=Bs({inputs:{real:J,imag:ne},backend:i}),ae=Z3({inputs:{a:re,b:F},backend:i}),le=Y0({inputs:{a:T,b:ae},backend:i}),me=q9({inputs:{a:T,b:ae},backend:i}),Oe=Yp({inputs:{input:le},backend:i}),Me=Yp({inputs:{input:me},backend:i}),X=Z0({inputs:{input:le},backend:i}),oe=Z0({inputs:{input:me},backend:i}),fe=Q0({inputs:[Oe,Me],backend:i,attrs:{axis:0}}),W=Q0({inputs:[X,oe],backend:i,attrs:{axis:0}}),Ve=i.data.get(fe.dataId).values,ke=i.data.get(W.dataId).values;return i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(J),i.disposeIntermediateTensorInfo(ne),i.disposeIntermediateTensorInfo(re),i.disposeIntermediateTensorInfo(ae),i.disposeIntermediateTensorInfo(le),i.disposeIntermediateTensorInfo(me),i.disposeIntermediateTensorInfo(Oe),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(Me),i.disposeIntermediateTensorInfo(oe),i.disposeIntermediateTensorInfo(fe),i.disposeIntermediateTensorInfo(W),{real:Ve,imag:ke}}function fWe(e,t,n){const r=new Float32Array(t*2);for(let i=0;i<t;i++){let s=0,o=0;for(let a=0;a<t;a++){const u=hle(i*a,t,n),l=Z8(e,a);s+=l.real*u.real-l.imag*u.imag,o+=l.real*u.imag+l.imag*u.real}n&&(s/=t,o/=t),fle(r,s,o,i)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dWe(e){const{inputs:t,backend:n}=e,{input:r}=t,i=ee(r.shape),s=r.shape[r.shape.length-1],o=i/s,a=bn({inputs:{x:r},backend:n,attrs:{shape:[o,s]}}),u=yde(a,!1,n),l=bn({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),l}const hWe={kernelName:QN,backendName:"cpu",kernelFunc:dWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(e){const{backend:t,attrs:n}=e,{shape:r,value:i,dtype:s}=n,o=s||Im(i),a=qn(o,ee(r));return mWe(a,i,o),t.makeTensorInfo(r,o,a)}const pWe={kernelName:JN,backendName:"cpu",kernelFunc:Y9};function mWe(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gWe={kernelName:eI,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,i=n,s=Dr(r.dtype,ee(r.shape)),[o,a,u,l]=r.shape,c=i.data.get(r.dataId).values;for(let d=0;d<o;d++){const h=d*u*a*l;for(let p=0;p<a;p++){const m=p*(u*l);for(let g=0;g<u;g++){const y=g*l;for(let b=0;b<l;b++){const v=Math.round(u-g-1),x=h+m+y+b;let w=c[x];if(v>=0&&v<u){const S=v*l,C=h+m+S+b;w=c[C]}s[x]=w}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r;let m=mde({inputs:{x:i,filter:s},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d}});if(o){const g=m;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const y=bn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=Y0({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=Y0({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(h){const g=m;if(c==="NCHW"&&h==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const y=bn({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=lT(n,m,h,y,p),n.disposeIntermediateTensorInfo(y)}else m=lT(n,m,h,a,p);n.disposeIntermediateTensorInfo(g)}return m}const bWe={kernelName:ww,backendName:"cpu",kernelFunc:yWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r;let m=gde({inputs:{x:i,filter:s},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d}});if(o){const g=m;m=Y0({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}if(h){const g=m;m=lT(n,m,h,a,p),n.disposeIntermediateTensorInfo(g)}return m}const xWe={kernelName:Sw,backendName:"cpu",kernelFunc:vWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wWe(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=ee(r.shape),o=i.shape,a=o[o.length-1],[u,l,c,f]=S3(r,i);if(l===0)return n.makeTensorInfo(u,r.dtype,[]);const d=n.data.get(i.dataId).values,h=n.bufferSync(r),p=$fe(d,h,r.dtype,l,a,c,f,r.shape,s);return n.makeTensorInfo(u,r.dtype,p.values)}const SWe={kernelName:tI,backendName:"cpu",kernelFunc:wWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:o,batchDims:a}=r;Be([i,s],"gatherV2");const u=wt(o,i.shape)[0],l=n.data.get(s.dataId).values,c=i.shape[u];for(let x=0;x<l.length;++x){const w=l[x];A(w<=c-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${c-1}]`)}let f=a;a==null&&(f=0);const d=ee(s.shape),h=i7(i,s,u,f),p=bn({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=bn({inputs:{x:s},backend:n,attrs:{shape:[h.batchSize,d/h.batchSize]}}),g=[h.batchSize,h.outerSize,d/h.batchSize,h.sliceSize],y=n.bufferSync(m),b=n.bufferSync(p),v=_fe(b,y,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(h.outputShape,v.dtype,v.values)}const kWe={kernelName:Q2,backendName:"cpu",kernelFunc:CWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $We(e){const{inputs:t,backend:n}=e,{input:r}=t,i=ee(r.shape),s=r.shape[r.shape.length-1],o=i/s,a=bn({inputs:{x:r},backend:n,attrs:{shape:[o,s]}}),u=yde(a,!0,n),l=bn({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),l}const _We={kernelName:nI,backendName:"cpu",kernelFunc:$We};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EWe=Jt(iy,e=>Number.isFinite(e)?1:0,"bool"),TWe={kernelName:iy,backendName:"cpu",kernelFunc:EWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AWe=Jt(sy,e=>Math.abs(e)===1/0?1:0,"bool"),NWe={kernelName:sy,backendName:"cpu",kernelFunc:AWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IWe=Jt(oy,e=>Number.isNaN(e)?1:0,"bool"),DWe={kernelName:oy,backendName:"cpu",kernelFunc:IWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OWe(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,o=Ife(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}const FWe={kernelName:iI,backendName:"cpu",kernelFunc:OWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RWe=Jt(uy,e=>Math.log1p(e)),MWe={kernelName:uy,backendName:"cpu",kernelFunc:RWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PWe=or((e,t)=>e&&t),LWe=$r(rS,PWe,null,"bool"),zWe={kernelName:rS,backendName:"cpu",kernelFunc:LWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BWe=Jt(iS,e=>e?0:1,"bool"),UWe={kernelName:iS,backendName:"cpu",kernelFunc:BWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WWe=or((e,t)=>e||t),VWe=$r(sS,WWe,null,"bool"),jWe={kernelName:sS,backendName:"cpu",kernelFunc:VWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:u}=r;Be(i,"LRN");const l=i.shape[3],c=l-1,f=n.data.get(i.dataId).values,d=ee(i.shape),h=new Float32Array(d);function p(m){const g=m%l;let y=m-g+Math.max(0,g-s);const b=m-g+Math.min(g+s,c);let v=0;for(;y<=b;y++){const x=f[y];v+=x*x}return v}for(let m=0;m<d;m++){const g=p(m),y=f[m]*Math.pow(o+a*g,-u);h[m]=y}return n.makeTensorInfo(i.shape,i.dtype,h)}const GWe={kernelName:oS,backendName:"cpu",kernelFunc:HWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:u,alpha:l,beta:c}=r;Be(o,"LRNGrad");const f=ee(o.shape),d=o.shape[3],h=n.data.get(o.dataId).values,p=n.data.get(i.dataId).values,m=n.data.get(s.dataId).values,g=new Float32Array(f),y=f;for(let b=0;b<y;b++){const v=b%d,x=b-v+Math.max(0,v-a),w=b-v+Math.min(d,v+a+1);let S=0;for(let C=x;C<w;C++)S+=Math.pow(p[C],2);S=l*S+u;for(let C=x;C<w;C++){let k=-2*l*c*p[C]*m[b]/S;b===C&&(k+=Math.pow(S,-c)),k*=h[b],g[C]+=k}}return n.makeTensorInfo(o.shape,i.dtype,g)}const XWe={kernelName:sI,backendName:"cpu",kernelFunc:qWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bde(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=n;let u=i.shape;const l=u.length,c=wt(s,u);let f=c;const d=Bn(f,l);let h=a.data.get(i.dataId).values;if(d!=null){const x=new Array(l);for(let w=0;w<x.length;w++)x[w]=u[d[w]];h=H9(h,u,i.dtype,d,x),f=ir(f.length,l),u=x}Be(i,"max"),ii("max",f,l);const[p,m]=Lr(u,f),g=ee(m),y=Ofe(h,g,p,i.dtype),b=a.write(y,p,i.dtype);let v=p;return o&&(v=rr(p,c)),{dataId:b,shape:v,dtype:i.dtype}}const KWe={kernelName:aS,backendName:"cpu",kernelFunc:bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Be(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;A(ri(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=za(i.shape,s,o,l,a,u);let f;if(c.filterWidth===1&&c.filterHeight===1&&$t(c.inShape,c.outShape))f=Ol({inputs:{x:i},backend:n});else{const d=n.data.get(i.dataId).values,h=Ye(i.shape),p=X9(d,i.shape,i.dtype,h,c,"max");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const ZWe={kernelName:uS,backendName:"cpu",kernelFunc:YWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:l}=r;Be(i,"maxPool3d");const c=af(i.shape,s,o,1,a,u,l),f=n.data.get(i.dataId).values,d=pde(f,i.shape,i.dtype,Ye(i.shape),c,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const JWe={kernelName:lS,backendName:"cpu",kernelFunc:QWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eVe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:u,dimRoundingMode:l}=r;Be([i,s],"maxPool3DGrad");const c=af(s.shape,o,a,1,u,l),f=n.bufferSync(s),d=W9e(f,c),h=c.strideDepth,p=c.strideHeight,m=c.strideWidth,g=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,v=c.effectiveFilterDepth,x=c.effectiveFilterHeight,w=c.effectiveFilterWidth,S=v-1-c.padInfo.front,C=w-1-c.padInfo.left,k=x-1-c.padInfo.top,E=mt(s.shape,"float32"),_=n.bufferSync(i);for(let T=0;T<c.batchSize;++T)for(let D=0;D<c.inChannels;++D)for(let O=0;O<c.inDepth;++O)for(let M=0;M<c.inHeight;++M)for(let I=0;I<c.inWidth;++I){const P=O-S,V=M-k,F=I-C;let B=0;for(let q=0;q<v;q+=g){const J=(P+q)/h;if(!(J<0||J>=c.outDepth||Math.floor(J)!==J))for(let ne=0;ne<x;ne+=y){const re=(V+ne)/p;if(!(re<0||re>=c.outHeight||Math.floor(re)!==re))for(let ae=0;ae<w;ae+=b){const le=(F+ae)/m;if(le<0||le>=c.outWidth||Math.floor(le)!==le)continue;const me=v*x*w-1-d.get(T,J,re,le,D),Oe=q*x*w+ne*w+ae,Me=me===Oe?1:0;if(Me===0)continue;const X=_.get(T,J,re,le,D);B+=X*Me}}}E.set(B,T,O,M,I,D)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const tVe={kernelName:aI,backendName:"cpu",kernelFunc:eVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nVe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:o}=t,a=s;Be([s,o],"maxPoolGrad");const{filterSize:u,strides:l,pad:c,dimRoundingMode:f}=r,d=za(a.shape,u,l,1,c,f),h=n.data.get(a.dataId).values,p=mt(d.outShape,a.dtype,hde(h,a.shape,a.dtype,d).values),m=d.strideHeight,g=d.strideWidth,y=d.dilationHeight,b=d.dilationWidth,v=d.effectiveFilterHeight,x=d.effectiveFilterWidth,w=x-1-d.padInfo.left,S=v-1-d.padInfo.top,C=mt(a.shape,"float32"),k=n.data.get(i.dataId).values,E=mt(i.shape,"float32",k);for(let _=0;_<d.batchSize;++_)for(let T=0;T<d.inChannels;++T)for(let D=0;D<d.inHeight;++D)for(let O=0;O<d.inWidth;++O){const M=D-S,I=O-w;let P=0;for(let V=0;V<v;V+=y){const F=(M+V)/m;if(!(F<0||F>=d.outHeight||Math.floor(F)!==F))for(let B=0;B<x;B+=b){const q=(I+B)/g;if(q<0||q>=d.outWidth||Math.floor(q)!==q)continue;const J=v*x-1-p.get(_,F,q,T),ne=V*x+B,re=J===ne?1:0;if(re===0)continue;const ae=E.get(_,F,q,T);P+=ae*re}}C.set(P,_,D,O,T)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const rVe={kernelName:oI,backendName:"cpu",kernelFunc:nVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iVe(e,t,n,r,i){const s=Ye(t),o=X9(e,t,n,s,i,"max"),a=hde(e,t,n,i,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sVe={kernelName:uI,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:o,includeBatchInIndex:a}=t,u=n;Be(r,"MaxPoolWithArgmax");const l=u.data.get(r.dataId).values,c=za(r.shape,i,s,[1,1],o),[f,d]=iVe(l,r.shape,r.dtype,a,c),h=u.write(f,c.outShape,r.dtype),p=u.write(d,c.outShape,r.dtype);return[{dataId:h,shape:c.outShape,dtype:r.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oVe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=wt(s,i.shape),l=Lr(i.shape,a)[1],c=ee(l),f=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));f.push(d);const h=Dd({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});f.push(h);const p=K9({inputs:{a:h,b:d},backend:n});f.push(p);const m=pC({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:o}});return f.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const aVe={kernelName:cS,backendName:"cpu",kernelFunc:oVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uVe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Be(i,"min");const a=wt(s,i.shape);let u=a;const l=Bn(u,i.shape.length);let c=i;l!=null&&(c=xs({inputs:{x:i},backend:n,attrs:{perm:l}}),u=ir(u.length,i.shape.length)),ii("min",u,c.shape.length);const[f,d]=Lr(c.shape,u),h=ee(d),p=ei(ee(f),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const b=y*h;let v=m[b];for(let x=0;x<h;++x){const w=m[b+x];(Number.isNaN(w)||w<v)&&(v=w)}p[y]=v}l!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(f,c.dtype,p);if(o){const y=rr(f,a),b=bn({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}const lVe={kernelName:fS,backendName:"cpu",kernelFunc:uVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cVe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,mode:o}=r;Be(i,"mirrorPad");const a=s.map((v,x)=>v[0]+i.shape[x]+v[1]),u=s.map(v=>v[0]),l=s.map((v,x)=>v[0]+i.shape[x]),c=o==="reflect"?0:1,f=n.data.get(i.dataId).values,d=i.shape.length,h=Ye(i.shape),p=ee(a),m=a.length,g=Ye(a),y=Dr(i.dtype,p);for(let v=0;v<p;v++){let x=Dm(v,m,g);for(let S=0;S<m;S++)x[S]<u[S]?x[S]=u[S]*2-x[S]-c:x[S]>=l[S]&&(x[S]=(l[S]-1)*2-x[S]+c);x=x.map((S,C)=>S-u[C]);const w=pu(x,d,h);y[v]=f[w]}return{dataId:n.write(y,a,i.dtype),shape:a,dtype:i.dtype}}const fVe={kernelName:dS,backendName:"cpu",kernelFunc:cVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dVe=or((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),hVe=$r(fy,dVe),pVe={kernelName:fy,backendName:"cpu",kernelFunc:hVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vde(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,o=i.shape.length;let a=s;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const u=wt([a],i.shape),l=bde({inputs:{x:i},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),c=rr(l.shape,u),f=bn({inputs:{x:l},backend:n,attrs:{shape:c}}),d=q9({inputs:{a:i,b:f},backend:n}),h=wfe({inputs:{x:d},backend:n}),p=pC({inputs:{x:h},backend:n,attrs:{axis:u,keepDims:!1}}),m=bn({inputs:{x:p},backend:n,attrs:{shape:c}}),g=K9({inputs:{a:h,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const mVe={kernelName:NS,backendName:"cpu",kernelFunc:vde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gVe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r;Be(i,"multinomial");const u=a?i:vde({inputs:{logits:i},backend:n,attrs:{dim:-1}}),l=u.shape[0],c=u.shape[1],f=n.data.get(u.dataId).values,d=[l,s],h=ei(ee(d),"int32");for(let p=0;p<l;++p){const m=p*c,g=new Float32Array(c-1);g[0]=f[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+f[m+v];const y=Ly.alea(o.toString()),b=p*s;for(let v=0;v<s;++v){const x=y();h[b+v]=g.length;for(let w=0;w<g.length;w++)if(x<g[w]){h[b+v]=w;break}}}return a||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(d,"int32",h)}const yVe={kernelName:lI,backendName:"cpu",kernelFunc:gVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bVe=b3;function vVe(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=r;Be(i,"NonMaxSuppression");const l=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,{selectedIndices:f}=bVe(l,c,o,a,u);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const xVe={kernelName:cI,backendName:"cpu",kernelFunc:vVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wVe=v3;function SVe(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:l}=r;Be(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,{selectedIndices:d,validOutputs:h}=wVe(c,f,o,a,u,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const CVe={kernelName:fI,backendName:"cpu",kernelFunc:SVe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kVe=x3;function $Ve(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:l}=r;Be(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,d=o,h=a,p=u,m=l,{selectedIndices:g,selectedScores:y}=kVe(c,f,d,h,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const _Ve={kernelName:dI,backendName:"cpu",kernelFunc:$Ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EVe(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:u}=r;Be(i,"oneHot");const l=ee(i.shape),c=new Float32Array(l*o);c.fill(u);const f=n.data.get(i.dataId).values;for(let d=0;d<l;++d)f[d]>=0&&f[d]<o&&(c[d*o+f[d]]=a);return n.makeTensorInfo([...i.shape,o],s,c)}const TVe={kernelName:gS,backendName:"cpu",kernelFunc:EVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const i=Yp({inputs:{input:r},backend:n}),s=fT({inputs:{x:i},backend:n}),o=Z0({inputs:{input:r},backend:n}),a=fT({inputs:{x:o},backend:n}),u=Bs({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return Y9({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const AVe={kernelName:FS,backendName:"cpu",kernelFunc:fT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xde(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const i=Yp({inputs:{input:r},backend:n}),s=xde({inputs:{x:i},backend:n}),o=Z0({inputs:{input:r},backend:n}),a=fT({inputs:{x:o},backend:n}),u=Bs({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return Y9({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const NVe={kernelName:mS,backendName:"cpu",kernelFunc:xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return cT({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(c=>{ni(s,c.shape,"All tensors passed to stack must have matching shapes"),A(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=t.map(c=>{const f=cT({inputs:{input:c},backend:n,attrs:{dim:i}});return a.push(f),f}),l=Q0({inputs:u,backend:n,attrs:{axis:i}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),l}const IVe={kernelName:yS,backendName:"cpu",kernelFunc:wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DVe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:o}=r;Be(i,"pad");const a=s.map((b,v)=>b[0]+i.shape[v]+b[1]),u=s.map(b=>b[0]),l=n.data.get(i.dataId).values,c=ee(i.shape),f=i.shape.length,d=Ye(i.shape),h=ee(a),p=a.length,m=Ye(a),g=Dr(i.dtype,h);o!==0&&g.fill(o);for(let b=0;b<c;b++){const x=Dm(b,f,d).map((S,C)=>S+u[C]),w=pu(x,p,m);g[w]=l[b]}return{dataId:n.write(g,a,i.dtype),shape:a,dtype:i.dtype}}const Sde={kernelName:bS,backendName:"cpu",kernelFunc:DVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OVe=or((e,t)=>Math.pow(e,t)),FVe=$r(hy,OVe),RVe={kernelName:hy,backendName:"cpu",kernelFunc:FVe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MVe(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,a=i.map(g=>n.data.get(g.dataId).values),u=i.map(g=>g.shape),l=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,[f,d,h]=zfe(a,u,l,s.shape,s.dtype,c,o.shape),p=f.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(h,s.dtype,d);return p.concat([m])}const PVe={kernelName:hI,backendName:"cpu",kernelFunc:MVe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LVe(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[l,c]=Bfe(o,r.shape,r.dtype,a,i.shape,u,s.shape),f=n.makeTensorInfo([l.length],"int32",l),d=n.makeTensorInfo([c.length],r.dtype,c);return[f,d]}const zVe={kernelName:pI,backendName:"cpu",kernelFunc:LVe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BVe(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:u}=r,l=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,f=n.data.get(o.dataId).values,d=a.map(g=>n.data.get(g.dataId).values),h=a.map(g=>g.shape),[p,m]=Ufe(l,i.shape,c,s.shape,s.dtype,f,o.shape,d,h,u);return n.makeTensorInfo(p,s.dtype,m)}const UVe={kernelName:mI,backendName:"cpu",kernelFunc:BVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WVe(e){const{backend:t,attrs:n}=e,{start:r,stop:i,dtype:s,step:o}=n,a=Wfe(r,i,o,s);return t.makeTensorInfo([a.length],s,a)}const VVe={kernelName:gI,backendName:"cpu",kernelFunc:WVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jVe=Jt(py,e=>1/e),HVe={kernelName:py,backendName:"cpu",kernelFunc:jVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GVe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;Be(i,"resizeBilinear");const u=Ye(i.shape),[l,c]=a,[f,d,h,p]=i.shape,m=n.data.get(i.dataId).values,g=new Float32Array(ee([f,l,c,p])),y=[s&&l>1?d-1:d,s&&c>1?h-1:h],b=[s&&l>1?l-1:l,s&&c>1?c-1:c];let v=0;const x=y[0]/b[0],w=y[1]/b[1];for(let S=0;S<f;S++)for(let C=0;C<l;C++){let k;o?k=x*(C+.5)-.5:k=x*C;const E=Math.max(0,Math.floor(k)),_=k-E,T=Math.min(d-1,Math.ceil(k)),D=S*u[0]+E*u[1],O=S*u[0]+T*u[1];for(let M=0;M<c;M++){let I;o?I=w*(M+.5)-.5:I=w*M;const P=Math.max(0,Math.floor(I)),V=I-P,F=Math.min(h-1,Math.ceil(I)),B=D+P*u[2],q=O+P*u[2],J=D+F*u[2],ne=O+F*u[2];for(let re=0;re<p;re++){const ae=m[B+re],le=m[q+re],me=m[J+re],Oe=m[ne+re],Me=ae+(me-ae)*V,X=le+(Oe-le)*V,oe=Me+(X-Me)*_;g[v++]=oe}}}return n.makeTensorInfo([f,l,c,p],"float32",g)}const qVe={kernelName:CS,backendName:"cpu",kernelFunc:GVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XVe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r;Be([s,i],"resizeBilinearGrad");const a=Ye(i.shape),[u,l,c,f]=i.shape,[,d,h]=s.shape,p=new Float32Array(u*l*c*f),m=[o&&d>1?l-1:l,o&&h>1?c-1:c],g=[o&&d>1?d-1:d,o&&h>1?h-1:h],y=m[0]/g[0],b=m[1]/g[1],v=n.data.get(s.dataId).values;let x=0;for(let w=0;w<u;w++){const S=w*a[0];for(let C=0;C<d;C++){const k=C*y,E=Math.floor(k),_=Math.min(Math.ceil(k),l-1),T=S+E*a[1],D=S+_*a[1],O=k-E,M=1-O;for(let I=0;I<h;I++){const P=I*b,V=Math.floor(P),F=Math.min(Math.ceil(P),c-1),B=P-V,q=1-B,J=T+V*a[2],ne=T+F*a[2],re=D+V*a[2],ae=D+F*a[2],le=M*q,me=M*B,Oe=O*q,Me=O*B;for(let X=0;X<f;X++){const oe=v[x++];p[J+X]+=oe*le,p[ne+X]+=oe*me,p[re+X]+=oe*Oe,p[ae+X]+=oe*Me}}}}return n.makeTensorInfo([u,c,l,f],"float32",p)}const KVe={kernelName:vI,backendName:"cpu",kernelFunc:XVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YVe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;Be(i,"resizeNearestNeighbor");const u=Ye(i.shape),[l,c]=a,[f,d,h,p]=i.shape,m=n.data.get(i.dataId).values,g=new Float32Array(f*l*c*p),y=[s&&l>1?d-1:d,s&&c>1?h-1:h],b=[s&&l>1?l-1:l,s&&c>1?c-1:c],v=y[0]/b[0],x=y[1]/b[1];let w=0;for(let S=0;S<f;S++){const C=S*u[0];for(let k=0;k<l;k++){const E=o?v*(k+.5):v*k;let _=Math.min(d-1,s?Math.round(E):Math.floor(E));o&&(_=Math.max(0,_));const T=C+_*u[1];for(let D=0;D<c;D++){const O=o?x*(D+.5):x*D;let M=Math.min(h-1,s?Math.round(O):Math.floor(O));o&&(M=Math.max(0,M));const I=T+M*u[2];for(let P=0;P<p;P++){const V=m[I+P];g[w++]=V}}}}return n.makeTensorInfo([f,l,c,p],i.dtype,g)}const ZVe={kernelName:SS,backendName:"cpu",kernelFunc:YVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QVe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r;Be([s,i],"resizeNearestNeighborGrad");const a=Ye(i.shape),u=Ye(s.shape),[l,c,f,d]=i.shape,[,h,p]=s.shape,m=new Float32Array(l*c*f*d),g=n.data.get(s.dataId).values,y=[o&&h>1?c-1:c,o&&p>1?f-1:f],b=[o&&h>1?h-1:h,o&&p>1?p-1:p],v=y[0]/b[0],x=y[1]/b[1],w=1/v,S=1/x,C=Math.ceil(w)*2+2,k=Math.ceil(S)*2+2;for(let E=0;E<l;E++){const _=E*a[0];for(let T=0;T<c;T++){const D=_+T*a[1],O=Math.floor(T*w),M=Math.floor(O-C/2);for(let I=0;I<f;I++){const P=D+I*a[2],V=Math.floor(I*S),F=Math.floor(V-k/2);for(let B=0;B<d;B++){let q=0;for(let J=0;J<C;J++){const ne=J+M;if(ne<0||ne>=h)continue;const re=_+ne*u[1],ae=ne*v,le=Math.min(c-1,o?Math.round(ae):Math.floor(ae));if(T===le)for(let me=0;me<k;me++){const Oe=me+F;if(Oe<0||Oe>=p)continue;const Me=re+Oe*u[2],X=Oe*x,oe=Math.min(f-1,o?Math.round(X):Math.floor(X));I===oe&&(q+=g[Me+B])}}m[P+B]=q}}}}return n.makeTensorInfo(i.shape,i.dtype,m)}const JVe={kernelName:bI,backendName:"cpu",kernelFunc:QVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r;Be(i,"reverse");const o=i.shape.length,a=wt(s,i.shape);if(o===0)return Ol({inputs:{x:i},backend:n});const u=new hr(i.shape,i.dtype),l=n.bufferSync(i);for(let c=0;c<u.size;c++){const f=u.indexToLoc(c),d=f.slice();a.forEach(h=>d[h]=i.shape[h]-1-d[h]),u.set(l.get(...d),...f)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}const tje={kernelName:kS,backendName:"cpu",kernelFunc:eje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nje={kernelName:MI,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:o}=t,a=n,u=Dr(r.dtype,ee(r.shape)),[l,c,f,d]=r.shape,[h,p]=W8(o,c,f),m=255,g=Math.sin(i),y=Math.cos(i),b=a.data.get(r.dataId).values;for(let x=0;x<l;x++){const w=x*f*c*d;for(let S=0;S<c;S++){const C=S*(f*d);for(let k=0;k<f;k++){const E=k*d;for(let _=0;_<d;_++){const T=[l,S,k,_],D=T[2],O=T[1];let M=(D-h)*y-(O-p)*g,I=(D-h)*g+(O-p)*y;M=Math.round(M+h),I=Math.round(I+p);let P=s;if(typeof s!="number"&&(_===3?P=m:P=s[_]),M>=0&&M<f&&I>=0&&I<c){const F=I*(f*d),B=M*d,q=w+F+B+_;P=b[q]}const V=w+C+E+_;u[V]=P}}}}return{dataId:a.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rje=Jt(yy,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),ije={kernelName:yy,backendName:"cpu",kernelFunc:rje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sje(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:f}=th(s,i,o),d=!0,h=n.bufferSync(i),p=n.bufferSync(s),m=hp(h,p,o,f,l,u,a,c,0,d);return n.makeTensorInfo(o,m.dtype,m.values)}const oje={kernelName:xI,backendName:"cpu",kernelFunc:sje};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aje(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function uje(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function lje(e,t,n,r,i,s){const o=qn("int32",n*i);for(let a=0;a<n;++a){const u=e.slice(a*r,(a+1)*r),l=a*i;for(let c=0;c<i;++c)o[l+c]=s==="left"?aje(u,t[c+l]):uje(u,t[c+l])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cje(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:o}=r,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,l=lje(a,u,i.shape[0],i.shape[1],s.shape[1],o);return n.makeTensorInfo(s.shape,"int32",l)}const fje={kernelName:SI,backendName:"cpu",kernelFunc:cje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dje(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t;Be([r,i,s],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=ms(i.dtype,s.dtype),f=ei(ee(i.shape),c);let d=0;const h=o===0||o>1||i.shape.length===1?1:ee(i.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<h;m++)a[p]===1?f[d++]=u[p]:f[d++]=l[p];return n.makeTensorInfo(i.shape,c,f)}const hje={kernelName:$S,backendName:"cpu",kernelFunc:dje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pje=$3,mje=_3,gje=Jt(vy,e=>e>=0?mje*e:pje*(Math.exp(e)-1)),yje={kernelName:vy,backendName:"cpu",kernelFunc:gje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bje=Jt(Sy,e=>e<0?-1:e>0?1:0),vje={kernelName:Sy,backendName:"cpu",kernelFunc:bje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xje=Jt(xy,e=>Math.sin(e)),wje={kernelName:xy,backendName:"cpu",kernelFunc:xje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sje=Jt(wy,e=>Math.sinh(e)),Cje={kernelName:wy,backendName:"cpu",kernelFunc:Sje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kje=11920928955078125e-23,CY=Math.log(kje)+2,$je=Jt(ky,e=>{const t=e>-CY,n=e<CY,r=Math.exp(e);let i;return n?i=r:t?i=e:i=Math.log(1+r),i}),_je={kernelName:ky,backendName:"cpu",kernelFunc:$je};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:o}=r;Be([i],"spaceToBatchND");const a=ee(s),u=[[0,0]];u.push(...o);for(let S=1+s.length;S<i.shape.length;++S)u.push([0,0]);const l=Sde.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),c=tC(l.shape,s,a,!1),f=nC(c.length,s.length,!1),d=rC(l.shape,s,a,!1),m=bn({inputs:{x:l},backend:n,attrs:{shape:c}}),b=xs({inputs:{x:m},backend:n,attrs:{perm:f}}),w=bn({inputs:{x:b},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),w}const Tje={kernelName:TS,backendName:"cpu",kernelFunc:Eje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aje(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values[0],[f,d,h,p,m]=Gfe(a,r.shape,r.dtype,u,i.dtype,l,c);return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const Nje={kernelName:CI,backendName:"cpu",kernelFunc:Aje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ije(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(n.data.get(i.dataId).values),a=n.data.get(r.dataId).values,u=Array.from(n.data.get(s.dataId).values),[l,c,f]=qfe(a,r.shape,r.dtype,o,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const Dje={kernelName:kI,backendName:"cpu",kernelFunc:Ije};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oje(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[l,c]=G9(o,r.shape,r.dtype,a,u,!0);return n.makeTensorInfo(c,r.dtype,l)}const Fje={kernelName:$I,backendName:"cpu",kernelFunc:Oje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rje(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[l,c]=G9(o,r.shape,r.dtype,a,u);return n.makeTensorInfo(c,r.dtype,l)}const Mje={kernelName:_I,backendName:"cpu",kernelFunc:Rje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pje(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=th(s,i,a),h=!1,p=n.bufferSync(i);let m;switch(s.dtype){case"bool":{const g=n.bufferSync(s),y=!!n.data.get(o.dataId).values[0];m=hp(p,g,a,d,c,l,u,f,y,h);break}case"float32":{const g=n.bufferSync(s),y=n.data.get(o.dataId).values[0];m=hp(p,g,a,d,c,l,u,f,y,h);break}case"int32":{const g=n.bufferSync(s),y=n.data.get(o.dataId).values[0];m=hp(p,g,a,d,c,l,u,f,y,h);break}case"string":{const g=n.bufferSync(s),y=jc(n.data.get(o.dataId).values[0]);m=hp(p,g,a,d,c,l,u,f,y,h);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const Lje={kernelName:EI,backendName:"cpu",kernelFunc:Pje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=wt(o,i.shape)[0],u=r7(i,s,a),l=new Array(i.shape.length).fill(0),c=i.shape.slice();return u.map(f=>{const d=[...c];d[a]=f;const h=Zp({inputs:{x:i},backend:n,attrs:{begin:l,size:d}});return l[a]+=f,h})}const Bje={kernelName:AS,backendName:"cpu",kernelFunc:zje};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uje={kernelName:TI,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,r=t;Be(n,"square");const i=r.data.get(n.dataId).values,s=new Float32Array(i.length);for(let a=0;a<i.length;++a){const u=i[a];s[a]=u*u}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wje=Jt(Iy,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),Vje={kernelName:Iy,backendName:"cpu",kernelFunc:Wje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:o,strides:a,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:d}=r;Be(i,"stridedSlice");const{finalShapeSparse:h,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=L8(i.shape,s,o,a,u,l,c,f,d);let w;if(m)w=bn({inputs:{x:i},backend:n,attrs:{shape:p}});else if(g||y){A(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const S=R8(b,v,x),C=Zp({inputs:{x:i},backend:n,attrs:{begin:b,size:S}});w=bn({inputs:{x:C},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(C)}else{const S=n.bufferSync(i),C=Yfe(h,S,x,b);w=n.makeTensorInfo(p,C.dtype,C.values)}return w}const Hje={kernelName:AI,backendName:"cpu",kernelFunc:jje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gje(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:f}=t,d=n.data.get(c.dataId).values,h=n.data.get(f.dataId).values,[p,m]=Zfe(d,h,i,s,o,a,u,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",m)]}const qje={kernelName:NI,backendName:"cpu",kernelFunc:Gje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xje(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values[0],[l,c,f]=Qfe(a,u,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const Kje={kernelName:II,backendName:"cpu",kernelFunc:Xje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yje(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(s.dataId).values,a=Jfe(o,i);return n.makeTensorInfo(s.shape,"int32",a)}const Zje={kernelName:DI,backendName:"cpu",kernelFunc:Yje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qje=Jt(Ty,e=>Math.tan(e)),Jje={kernelName:Ty,backendName:"cpu",kernelFunc:Qje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eHe=Jt(Ay,e=>Math.tanh(e)),tHe={kernelName:Ay,backendName:"cpu",kernelFunc:eHe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nHe(e){const{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:s}=t,{sliceRank:o,numUpdates:a,sliceSize:u,strides:l,outputSize:c}=th(s,i,r.shape),f=!1,d=n.bufferSync(i),h=n.bufferSync(s),p=n.bufferSync(r),m=hp(d,h,r.shape,c,u,a,o,l,p,f);return n.makeTensorInfo(r.shape,m.dtype,m.values)}const rHe={kernelName:wI,backendName:"cpu",kernelFunc:nHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;Be(i,"tile");const o=tde(n.bufferSync(i),s);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const sHe={kernelName:Ny,backendName:"cpu",kernelFunc:iHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:o}=r;Be(i,"topk");const a=n.data.get(i.dataId).values,[u,l]=rde(a,i.shape,i.dtype,s,o);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}const aHe={kernelName:OI,backendName:"cpu",kernelFunc:oHe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uHe(e){const{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:u,outputShape:l}=n,[c,f,d,h]=i.shape,[p,m]=l??[f,d],g=[c,p,m,h],y=Ye(i.shape),b=y[0],v=y[1],x=y[2],w=Ye(g),S=w[0],C=w[1],k=w[2],E=Dr(i.dtype,ee(g));E.fill(u);const _=r.data.get(i.dataId).values,T=r.data.get(s.dataId).values;for(let O=0;O<c;++O){const M=s.shape[0]===1?T:T.subarray(O*8,O*8+8);for(let I=0;I<p;++I)for(let P=0;P<m;++P)for(let V=0;V<h;++V){let F;const B=M[6]*P+M[7]*I+1;if(B===0)continue;const q=(M[0]*P+M[1]*I+M[2])/B,J=(M[3]*P+M[4]*I+M[5])/B,ne=kY(q,d,a),re=kY(J,f,a);switch(o){case"nearest":F=pHe(_,f,d,b,v,x,O,re,ne,V,u);break;case"bilinear":F=mHe(_,f,d,b,v,x,O,re,ne,V,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const ae=O*S+I*C+P*k+V;E[ae]=F}return r.makeTensorInfo(g,i.dtype,E)}return{dataId:r.write(E,g,i.dtype),shape:i.shape,dtype:i.dtype}}const lHe={kernelName:FI,backendName:"cpu",kernelFunc:uHe};function kY(e,t,n){switch(n){case"reflect":return cHe(e,t);case"wrap":return fHe(e,t);case"nearest":return hHe(e,t);case"constant":default:return dHe(e)}}function cHe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{const r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return Sd(0,n,t-1)}function fHe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{const r=t-1;n-=t*Math.trunc(n/r)}return Sd(0,n,t-1)}function dHe(e,t){return e}function hHe(e,t){return Sd(0,e,t-1)}function Bv(e,t,n,r,i,s,o,a,u,l,c){const f=o*r+a*i+u*s+l;return 0<=a&&a<t&&0<=u&&u<n?e[f]:c}function pHe(e,t,n,r,i,s,o,a,u,l,c){const f=Math.round(a),d=Math.round(u);return Bv(e,t,n,r,i,s,o,f,d,l,c)}function mHe(e,t,n,r,i,s,o,a,u,l,c){const f=Math.floor(a),d=Math.floor(u),h=f+1,p=d+1,m=(p-u)*Bv(e,t,n,r,i,s,o,f,d,l,c)+(u-d)*Bv(e,t,n,r,i,s,o,f,p,l,c),g=(p-u)*Bv(e,t,n,r,i,s,o,h,d,l,c)+(u-d)*Bv(e,t,n,r,i,s,o,h,p,l,c);return(h-a)*m+(a-f)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gHe(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;Be(s,"unique");const o=r.data.get(s.dataId).values,{outputValues:a,outputShape:u,indices:l}=ide(o,i,s.shape,s.dtype);return[r.makeTensorInfo(u,s.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}const yHe={kernelName:RI,backendName:"cpu",kernelFunc:gHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bHe(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i.shape.length,a=i.shape[s],u=new Array(o-1);let l=0;for(let h=0;h<o;h++)h!==s&&(u[l++]=i.shape[h]);const c=new Array(o).fill(0),f=i.shape.slice();f[s]=1;const d=new Array(a);for(let h=0;h<d.length;h++){c[s]=h;const p=Zp({inputs:{x:i},backend:n,attrs:{begin:c,size:f}});d[h]=bn({inputs:{x:p},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(p)}return d}const vHe={kernelName:DS,backendName:"cpu",kernelFunc:bHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:o}=r;Be(i,"unsortedSegmentSum");const a=i.shape.length,u=s.shape.length,l=[],c=[],f=a-u;let d=s;for(let p=0;p<f;++p){const m=cT({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=m,c.push(m)}for(let p=0;p<o;++p){const m=of(p,"int32"),g=n.makeTensorInfo([],"int32",m),y=vfe({inputs:{a:g,b:d},backend:n}),b=Dd({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),v=Z3({inputs:{a:b,b:i},backend:n}),x=pC({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});l.push(x),c.push(g),c.push(y),c.push(b),c.push(v),c.push(x)}const h=wde({inputs:l,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const wHe={kernelName:OS,backendName:"cpu",kernelFunc:xHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SHe=[g9e,Z8e,b9e,x9e,r7e,S9e,k9e,_9e,T9e,N9e,D9e,F9e,M9e,z9e,U9e,j9e,G9e,X9e,Y9e,p9e,Q9e,eUe,nUe,s7e,iUe,t7e,a7e,oUe,Q8e,uUe,cUe,fUe,hUe,mUe,yUe,vUe,wUe,CUe,$Ue,EUe,AUe,IUe,OUe,RUe,MUe,LUe,BUe,WUe,VUe,jUe,HUe,qUe,YUe,a9e,QUe,u7e,oWe,l7e,aWe,f7e,hWe,pWe,gWe,h7e,m7e,bWe,xWe,SWe,kWe,y7e,v7e,J8e,_We,lUe,TWe,NWe,DWe,u9e,w7e,C7e,FWe,$7e,MWe,zWe,UWe,jWe,GWe,XWe,KWe,E7e,ZWe,JWe,tVe,rVe,sVe,aVe,lVe,A7e,fVe,pVe,yVe,I7e,O7e,xVe,CVe,_Ve,R7e,TVe,NVe,IVe,Sde,RVe,c9e,L7e,PVe,zVe,UVe,VVe,e7e,J5,HVe,f9e,d9e,h9e,qVe,KVe,ZVe,JVe,tje,nje,ije,G7e,oje,fje,hje,yje,X7e,vje,wje,Cje,K7e,mVe,_je,Tje,Nje,Dje,Fje,Mje,Lje,Bje,Q7e,Uje,e9e,n9e,Vje,Hje,qje,Kje,Zje,o9e,XUe,Jje,tHe,rHe,sHe,aHe,lHe,M7e,yHe,vHe,wHe,AVe];for(const e of SHe)PI(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rp={},l$={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Cde(e,t){rp[e]=t}function Tu(e,t){if(!(e in rp)||t!=null){const r=kHe(e,t);if(r!==null)rp[e]=r;else return console.log("Could not get context for WebGL version",e),null}const n=rp[e];return n==null||n.isContextLost()?(delete rp[e],Tu(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),rp[e])}function CHe(e){if(!Y().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function kHe(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t??CHe(e);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete rp[e]},!1),Y().getBool("SOFTWARE_WEBGL_ENABLED")&&(l$.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",l$)||n.getContext("experimental-webgl",l$):n.getContext("webgl2",l$)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Fw;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Fw||(Fw={}));var To;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(To||(To={}));var Gr;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Gr||(Gr={}));function mC(e,t){return[t,e]}function $He(e,t){return e*t}function c$(e){const t=ee(e),n=Math.ceil(t/4);return LE(n)}function Gy(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function _He(e,t){const[n,r]=Gy(e,t);return n*r*4}function Z9(e,t){const n=e;let r,i,s,o,a,u,l,c,f,d;return Y().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,s=n.RGBA16F,o=n.RGBA32F,a=n.RED,l=4,c=1,f=n.HALF_FLOAT,d=n.FLOAT,u=n.RGBA8):(r=e.RGBA,i=e.RGBA,s=e.RGBA,o=n.RGBA,a=e.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT,u=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:u,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ie(e,t){const n=t();return Y().getBool("DEBUG")&&EHe(e),n}function EHe(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+$de(e,t))}const THe=596e-10,AHe=65504;function kde(e){return!!(Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||THe<Math.abs(e)&&Math.abs(e)<AHe)}function $de(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function Uv(e,t){return hf(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function _de(e,t){const n=hf(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ie(e,()=>e.shaderSource(n,t)),Ie(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Ede(e,t){const n=hf(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ie(e,()=>e.shaderSource(n,t)),Ie(e,()=>e.compileShader(n)),Y().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw Q9(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const NHe=/ERROR: [0-9]+:([0-9]+):/g;function Q9(e,t){const n=NHe.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}const r=+n[1],i=e.split(`
`),s=i.length.toString().length+2,o=i.map((f,d)=>xp((d+1).toString(),s)+f);let a=0;for(let f=0;f<o.length;f++)a=Math.max(o[f].length,a);const u=o.slice(0,r-1),l=o.slice(r-1,r),c=o.slice(r);console.log(u.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${xp(l[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function Tde(e){return hf(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function Ade(e,t){if(Ie(e,()=>e.linkProgram(t)),!Y().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function L_(e,t){if(Ie(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Nde(e,t){const n=hf(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Ie(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Ie(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function Ide(e,t){const n=hf(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Ie(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),Ie(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function IHe(){return Y().getNumber("WEBGL_VERSION")===2?1:4}function Dde(e){return hf(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function Ode(e,t){const n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){const r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function Fde(e){return hf(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function tP(e,t,n,r,i,s,o){const a=e.getAttribLocation(t,n);return a===-1?!1:(Ie(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Ie(e,()=>e.vertexAttribPointer(a,i,e.FLOAT,!1,s,o)),Ie(e,()=>e.enableVertexAttribArray(a)),!0)}function Rde(e,t,n){Bde(e,n),Ie(e,()=>e.activeTexture(e.TEXTURE0+n)),Ie(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function DHe(e,t){Bde(e,t),Ie(e,()=>e.activeTexture(e.TEXTURE0+t)),Ie(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function Mde(e,t,n){return hf(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function Pde(e,t,n){return e.getUniformLocation(t,n)}function Lde(e,t,n,r){Ie(e,()=>Rde(e,t,r)),Ie(e,()=>e.uniform1i(n,r))}function OHe(e){Ie(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ie(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),Ie(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function z_(e,t,n){Ie(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),Ie(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function nP(e,t){Ie(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Ie(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function Wv(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+zde(e,t))}function zde(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function hf(e,t,n){const r=Ie(e,()=>t());if(r==null)throw new Error(n);return r}function Bde(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Qp(e,t=2){return ee(e.slice(0,e.length-t))}function Jp(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Vv(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Qp(e),...Jp(e)]),t}function Ude(e,t=!1){let n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Y().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Y().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((a,u)=>u>=e.length-2?NN(e[u]):e[u]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=sf(e).newShape);let i=ee(e),s=null;e.length<=1&&i<=n?s=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?s=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);const o=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(s==null||o)if(t){const a=Qp(e);let u=2,l=2;e.length&&([u,l]=Jp(e)),i=a*(u/2)*(l/2),s=LE(i).map(c=>c*2)}else s=LE(i);return s}function f$(e){return e%2===0}function Rw(e,t){if(e=e.slice(-2),t=t.slice(-2),$t(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r||f$(n)&&f$(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&f$(e[0])&&f$(t[0])}let B_,U_;function Wde(e){if(B_==null){const t=Tu(e);B_=t.getParameter(t.MAX_TEXTURE_SIZE)}return B_}function FHe(){B_=null}function RHe(){U_=null}function Vde(e){if(U_==null){const t=Tu(e);U_=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,U_)}function jde(e){if(e===0)return 0;let t;const n=Tu(e);return Ao(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:Ao(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Ao(e,t){return e.getExtension(t)!=null}function rP(e){try{if(Tu(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Hde(e){if(e===0)return!1;const t=Tu(e);if(e===1){if(!Ao(t,"OES_texture_float"))return!1}else if(!Ao(t,"EXT_color_buffer_float"))return!1;return iP(t)}function Gde(e){if(e===0)return!1;const t=Tu(e);if(e===1){if(!Ao(t,"OES_texture_float")||!Ao(t,"WEBGL_color_buffer_float"))return!1}else{if(Ao(t,"EXT_color_buffer_float"))return iP(t);const r="EXT_color_buffer_half_float";if(Ao(t,r)){const i=t.getExtension(r);return MHe(t,i)}return!1}return iP(t)}function iP(e){const t=Z9(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(s),o}function MHe(e,t){const n=Z9(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),a}function qde(e){return e!==2?!1:Tu(e).fenceSync!=null}function qy(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&A(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}const PHe=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:qy,bindCanvasToFramebuffer:OHe,bindColorTextureToFramebuffer:z_,bindTextureToProgramUniformSampler:Lde,bindTextureUnit:Rde,bindVertexBufferToProgramAttribute:tP,callAndCheck:Ie,canBeRepresented:kde,createFragmentShader:Ede,createFramebuffer:Fde,createProgram:Tde,createStaticIndexBuffer:Ide,createStaticVertexBuffer:Nde,createTexture:Dde,createVertexShader:_de,getBatchDim:Qp,getExtensionOrThrow:Uv,getFramebufferErrorMessage:zde,getMaxTexturesInShader:Vde,getNumChannels:IHe,getProgramUniformLocation:Pde,getProgramUniformLocationOrThrow:Mde,getRowsCols:Jp,getShapeAs3D:Vv,getTextureShapeFromLogicalShape:Ude,getWebGLDisjointQueryTimerVersion:jde,getWebGLErrorMessage:$de,getWebGLMaxTextureSize:Wde,hasExtension:Ao,isCapableOfRenderingToFloatTexture:Hde,isDownloadFloatTextureEnabled:Gde,isReshapeFree:Rw,isWebGLFenceEnabled:qde,isWebGLVersionEnabled:rP,linkProgram:Ade,logShaderSourceAndInfoLog:Q9,resetMaxTextureSize:FHe,resetMaxTexturesInShader:RHe,unbindColorTextureFromFramebuffer:nP,unbindTextureUnit:DHe,validateFramebuffer:Wv,validateProgram:L_,validateTextureSize:Ode},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const We=Y();We.registerFlag("HAS_WEBGL",()=>We.getNumber("WEBGL_VERSION")>0);We.registerFlag("WEBGL_VERSION",()=>rP(2)?2:rP(1)?1:0);We.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);We.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>We.get("WEBGL_VERSION")===2);We.registerFlag("WEBGL_CPU_FORWARD",()=>!0);We.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);We.registerFlag("WEBGL_PACK",()=>We.getBool("HAS_WEBGL"));We.registerFlag("WEBGL_PACK_NORMALIZATION",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_CLIP",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_REDUCE",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_LAZILY_UNPACK",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_CONV_IM2COL",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Wde(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Vde(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=We.getNumber("WEBGL_VERSION");return e===0?0:jde(e)});We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>We.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!sB());We.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Hde(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>We.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:We.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));We.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Gde(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_FENCE_API_ENABLED",()=>qde(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>We.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);We.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});We.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>sB()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});We.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);We.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);We.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);We.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);We.registerFlag("WEBGL_EXP_CONV",()=>!1);We.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>We.getBool("IS_TEST"));We.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);We.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);We.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);We.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(){let e,t,n,r,i,s,o,a,u,l;return Y().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",s="outputColor",o="out vec4 outputColor;",a=Y().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",s="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:s,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vm(e,t,n="index"){const r=Ye(t);return r.map((i,s)=>{const o=`int ${e[s]} = ${n} / ${i}`,a=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${i}`:`index -= ${e[s]} * ${i}`;return`${o}; ${a};`}).join("")}function Q3(e,t,n="index"){const r=Ye(t);return r.map((i,s)=>{const o=`int ${e[s]} = ${n} / outShapeStrides[${s}]`,a=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * outShapeStrides[${s}]`:`index -= ${e[s]} * outShapeStrides[${s}]`;return`${o}; ${a};`}).join("")}function LHe(e,t){const n=e.length,r=e.map(s=>`${t}[${s}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let s=n-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}function zHe(e,t,n="index"){const r=e.map((s,o)=>o),i=LHe(r,t);return i.map((s,o)=>{const a=`int ${e[o]} = ${n} / ${i[o]}`,u=o===i.length-1?`int ${e[o+1]} = ${n} - ${e[o]} * ${i[o]}`:`index -= ${e[o]} * ${i[o]}`;return`${a}; ${u};`}).join("")}function J9(e){const t=Ye(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function eU(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const Xde=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:Kde}=Tle;function BHe(e,t,n){const r=[];if(e.forEach(h=>{const p=ee(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?r.push(`uniform float ${h.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${h.name};`),r.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:m}=tU(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${h.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${h.name}Shape;`);break}r.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{r.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const i=r.join(`
`),s=e.map(h=>UHe(h,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=t.texShape,a=Yi(),u=jHe(a);let l,c,f=qHe(a);return t.isPacked?(l=WHe(t.logicalShape,o,n.enableShapeUniforms),c=GHe(a)):(l=VHe(t.logicalShape,o,n.enableShapeUniforms),c=HHe(a)),n.packedInputs&&(f+=ZHe),[f,u,c,i,l,s,n.userCode].join(`
`)}function Xy(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return lGe(e,t);case 1:return fGe(e,t);case 2:return hGe(e,t);case 3:return mGe(e,t);case 4:return yGe(e,t);case 5:return bGe(e);case 6:return vGe(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function Yde(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return uGe(e);case 1:return cGe(e,t);case 2:return dGe(e,t);case 3:return pGe(e,t);default:return gGe(e,t)}}function UHe(e,t,n=!1,r){let i="";n?i+=Yde(e,r):i+=Xy(e,r);const s=e.shapeInfo.logicalShape,o=t.logicalShape;return s.length<=o.length&&(n?i+=xGe(e,t):i+=wGe(e,t)),i}function WHe(e,t,n){switch(e.length){case 0:return Zde();case 1:return QHe(e,t,n);case 2:return oGe(e,t,n);case 3:return eGe(e,t,n);default:return nGe(e,t,n)}}function VHe(e,t,n){switch(e.length){case 0:return Zde();case 1:return JHe(e,t,n);case 2:return aGe(e,t,n);case 3:return tGe(e,t,n);case 4:return rGe(e,t,n);case 5:return iGe(e,t);case 6:return sGe(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function jHe(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function HHe(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function GHe(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function qHe(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${XHe}
    ${KHe}
    ${YHe}
  `}const XHe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,KHe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,YHe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ZHe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Zde(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function QHe(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function JHe(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function eGe(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),s=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function tGe(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Q3(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;const r=Vm(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function nGe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),s=i*Math.ceil(e[e.length-2]/2);let o=s,a="",u="b, r, c";for(let l=2;l<e.length-1;l++)o*=e[e.length-l-1],a=`
      int b${l} = index / ${o};
      index -= b${l} * ${o};
    `+a,u=`b${l}, `+u;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${u});
    }
  `}function rGe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Q3(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Vm(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function iGe(e,t){const n=Vm(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function sGe(e,t){const n=Vm(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function oGe(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if($t(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function aGe(e,t,n){return $t(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function jm(e){return`offset${e}`}function uGe(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Yi();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function lGe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,s]=e.shapeInfo.texShape;if(i===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=jm(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,u]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${u}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function cGe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,s=Yi();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function fGe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Ky(e)}
      }
    `;const i=e.shapeInfo.texShape,s=i[0],o=i[1];if(o===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=jm(n);return o===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function dGe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,o=s[0],a=s[1],u=Yi();if(s!=null&&$t(n,s))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${u.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${u.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `;const l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${l[0]}, ${l[1]}, row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `}function hGe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape;if(s!=null&&$t(n,s)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const d=s[0],h=s[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=sf(n),u=o;if(u.length<n.length){const d=Yy(e,u),h=["row","col"];return`
      ${Xy(d,t)}
      float ${i}(int row, int col) {
        return ${i}(${Zy(h,a)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Ky(e)}
      }
    `;const l=s[0],c=s[1],f=jm(r);return c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${r}, uv);
    }
  `:l===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${l}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function pGe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){const d=n.slice(1),h=[1,2],p=Yy(e,d),m=["b","row","col"];return`
        ${Yde(p,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${Zy(m,h)});
        }
      `}const a=Yi();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const u=o[0],l=o[1],c=Math.ceil(n[2]/2),f=c*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${l}, ${f}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function mGe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],o=n[2],{newShape:a,keptDims:u}=sf(n),l=a;if(l.length<n.length){const m=Yy(e,l),g=["row","col","depth"];return`
        ${Xy(m,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${Zy(g,u)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${o}, 1)));
        ${Ky(e)}
      }
    `;const c=e.shapeInfo.texShape,f=c[0],d=c[1],h=e.shapeInfo.flatOffset;if(d===s&&h==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===o&&h==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=jm(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${f}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function gGe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=Yi();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;const s=e.shapeInfo.logicalShape,o=s.length,a=e.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=u[0],c=u[1],f=Math.ceil(s[o-1]/2);let d=f*Math.ceil(s[o-2]/2),h="int b, int row, int col",p=`b * ${d} + (row / 2) * ${f} + (col / 2)`;for(let m=2;m<o-1;m++)h=`int b${m}, `+h,d*=s[o-m-1],p=`b${m} * ${d} + `+p;return`
    vec4 ${r}(${h}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${l});
      return ${i.texture2D}(${n}, uv);
    }
  `}function yGe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],o=n[2]*s,a=n[1]*o,{newShape:u,keptDims:l}=sf(n);if(u.length<n.length){const b=Yy(e,u),v=["row","col","depth","depth2"];return`
      ${Xy(b,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${Zy(v,l)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${s}, 1)));
        ${Ky(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],h=f[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(h===a&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===s&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;const y=jm(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${d}, ${h}, index + ${y});
      return sampleTexture(${r}, uv);
    }
  `}function bGe(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],s=t[3]*i,o=t[2]*s,a=t[1]*o,{newShape:u,keptDims:l}=sf(t);if(u.length<t.length){const m=Yy(e,u),g=["row","col","depth","depth2","depth3"];return`
      ${Xy(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Zy(g,l)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${s}, ${i})) +
          depth3;
        ${Ky(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],h=f[1];if(h===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${s}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=jm(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${s} +
          depth2 * ${i} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function vGe(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:s}=sf(t);if(i.length<t.length){const g=Yy(e,i),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Xy(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Zy(y,s)});
      }
    `}const o=t[5],a=t[4]*o,u=t[3]*a,l=t[2]*u,c=t[1]*l;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${l}, ${u}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Ky(e)}
      }
    `;const f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===c&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${u}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=jm(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${l} + depth * ${u} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ky(e){const t=e.name,n=ee(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function xGe(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,a=Kde(e.shapeInfo.logicalShape,t.logicalShape),u=an(o),l=o-s;let c;const f=["x","y","z","w","u","v"];s===0?c="":o<2&&a.length>=1?c="coords = 0;":c=a.map(b=>`coords.${f[b+l]} = 0;`).join(`
`);let d="";o<2&&s>0?d="coords":d=e.shapeInfo.logicalShape.map((b,v)=>`coords.${f[v+l]}`).join(", ");let h="return outputValue;";const m=ee(e.shapeInfo.logicalShape)===1,y=ee(t.logicalShape)===1;if(s===1&&!m&&!y)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)o===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(a.length){const b=s-2,v=s-1;a.indexOf(b)>-1&&a.indexOf(v)>-1?h="return vec4(outputValue.x);":a.indexOf(b)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${u} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${d});
      ${h}
    }
  `}function wGe(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=t.texShape,o=e.shapeInfo.texShape,a=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&a===u&&e.shapeInfo.flatOffset==null&&$t(o,s))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const l=an(u),c=Kde(e.shapeInfo.logicalShape,t.logicalShape),f=u-a;let d;const h=["x","y","z","w","u","v"];a===0?d="":u<2&&c.length>=1?d="coords = 0;":d=c.map(m=>`coords.${h[m+f]} = 0;`).join(`
`);let p="";return u<2&&a>0?p="coords":p=e.shapeInfo.logicalShape.map((m,g)=>`coords.${h[g+f]}`).join(", "),`
    float ${i}() {
      ${l} coords = getOutputCoords();
      ${d}
      return get${r}(${p});
    }
  `}function an(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function tU(e,t,n){const{newShape:r,keptDims:i}=sf(t),s=t.length,o=e&&s===3&&t[0]===1,a=o?t.slice(1):r,u=!e&&s>1&&!$t(t,n)&&r.length<s||o;return{useSqueezeShape:u,uniformShape:u?a:t,keptDims:i}}function Yy(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Zy(e,t){return t.map(n=>e[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SGe(e,t,n,r){const i=n.map((c,f)=>{const d={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(d.flatOffset=c.texData.slice.flatOffset),{name:t.variableNames[f],shapeInfo:d}}),s=i.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=BHe(i,o,t),u=Ede(e.gl,a),l=e.createProgram(u);return Y().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:a,webGLProgram:l,inShapeInfos:s,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(l),Object.assign({program:t,fragmentShader:u,source:a,webGLProgram:l,inShapeInfos:s,outShapeInfo:o},Qde(e,t,l)))}function Qde(e,t,n){const r=[],i=[];let s,o,a,u=null,l=null;l=e.getUniformLocation(n,"NAN",!1),Y().getNumber("WEBGL_VERSION")===1&&(u=e.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const f of t.variableNames){const d={name:f,uniform:e.getUniformLocation(n,f,c),offset:e.getUniformLocation(n,`offset${f}`,c)};t.enableShapeUniforms&&(d.shape=e.getUniformLocation(n,`${f}Shape`,c),d.texShape=e.getUniformLocation(n,`${f}TexShape`,c)),r.push(d)}if(t.enableShapeUniforms&&(s=e.getUniformLocation(n,"outShape",c),a=e.getUniformLocation(n,"outShapeStrides",c),o=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(const f of t.customUniforms)i.push(e.getUniformLocation(n,f.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:u,nanLoc:l,outShapeLocation:s,outShapeStridesLocation:a,outTexShapeLocation:o}}function $Y(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{const i=n.logicalShape,s=t[r],o=s.shape;if(!$t(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(n.isUniform&&s.isUniform)return;const a=n.texShape,u=s.isUniform?null:s.texData.texShape;if(!$t(a,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${u} must match`)})}function CGe(e,t,n,r,i){t.program.enableShapeUniforms||($Y(t.inShapeInfos,n),$Y([t.outShapeInfo],[r]));const s=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,o[0],o[1]):e.setOutputMatrixTexture(s.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),Y().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let u=0;u<n.length;++u){const l=n[u],{uniform:c,offset:f,shape:d,texShape:h}=t.variablesLocations[u];if(d){const{uniformShape:p}=tU(t.program.packedInputs,l.shape,l.texData.texShape);switch(p.length){case 1:e.gl.uniform1iv(d,new Int32Array(p));break;case 2:e.gl.uniform2iv(d,new Int32Array(p));break;case 3:e.gl.uniform3iv(d,new Int32Array(p));break;case 4:e.gl.uniform4iv(d,new Int32Array(p));break}}if(h&&e.gl.uniform2i(h,l.texData.texShape[0],l.texData.texShape[1]),c!=null){if(l.isUniform){if(ee(l.shape)<2)e.gl.uniform1f(c,l.uniformValues[0]);else{let p=l.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),e.gl.uniform1fv(c,p)}continue}l.texData.slice!=null&&f!=null&&e.gl.uniform1i(f,l.texData.slice.flatOffset),e.setInputMatrixTexture(l.texData.texture.texture,c,u)}}const a=t.outShapeLocation;if(a)switch(r.shape.length){case 1:e.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(a,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){const u=Ye(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(u));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(u));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(u));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let u=0;u<t.program.customUniforms.length;++u){const l=t.program.customUniforms[u],c=t.customUniformLocations[u],f=i[u];if(l.type==="float")e.gl.uniform1fv(c,f);else if(l.type==="vec2")e.gl.uniform2fv(c,f);else if(l.type==="vec3")e.gl.uniform3fv(c,f);else if(l.type==="vec4")e.gl.uniform4fv(c,f);else if(l.type==="int")e.gl.uniform1iv(c,f);else if(l.type==="ivec2")e.gl.uniform2iv(c,f);else if(l.type==="ivec3")e.gl.uniform3iv(c,f);else if(l.type==="ivec4")e.gl.uniform4iv(c,f);else throw Error(`uniform type ${l.type} is not supported yet.`)}e.executeProgram()}function kGe(e,t,n){let r="";t.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!o.isUniform){const u=o.texData.texShape,{useSqueezeShape:l,uniformShape:c,keptDims:f}=tU(e.packedInputs,o.shape,u);let d="",h="",p="";if(c.length===1&&e.packedInputs){const w=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];d=`${w[0]>1}_${w[1]>1}`}else if(c.length===2&&!e.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!e.packedInputs){const w=Ye(c);p=`${w[0]===u[1]}_${w[w.length-1]===u[1]}`}const m=o.shape.length,g=c.length===2&&$t(o.shape,u),y=ee(o.shape)===1,b=jp(o.shape,n.shape),v=!e.packedInputs&&m===n.shape.length&&$t(u,n.texData.texShape),x=e.packedInputs||c.length>2?"":`${u[0]>1}_${u[1]>1}`;r+=`${m}_${v}_${l?f:""}_${c.length}_${y}_${b}_${g}_${d}_${h}_${p}_${x}_${a}`}else{const u=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${u}_${a}`}});const i=e.userCode;let s=e.constructor.name;return s+="_"+r+"_"+i+`${Y().getNumber("WEBGL_VERSION")}`,s}function wi(e){return Y().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ge{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Fw.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Yi();this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Q3(["r","c","d"],t):Vm(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ge{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Fw.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Yi();this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Q3(["r","c","d"],t):Vm(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EGe{constructor(t){this.variableNames=["A"],this.outTexUsage=To.DOWNLOAD;const n=Yi();this.outputShape=t,this.userCode=`
      ${Xde}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TGe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=To.DOWNLOAD;const n=Yi();this.outputShape=t,this.userCode=`
      ${Xde}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AGe={R:0,G:1,B:2,A:3};class _Y{constructor(t,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=Yi();this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length);let s="result";n&&(s="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const u=r[a];o+=`
          if(offset == ${a}) {
            result = values[${AGe[u]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?eU():J9(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${o}
        }
        ${i.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NGe{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Yi();this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length);let i="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const u=o*2+a;i+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?eU():J9(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${s};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jde(e){const t=Yi(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return _de(e,n)}function ehe(e){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Nde(e,t)}function the(e){const t=new Uint16Array([0,1,2,2,1,3]);return Ide(e,t)}function gC(e,t,n,r,i,s){Ode(t,n);const o=Dde(e),a=e.TEXTURE_2D;return Ie(e,()=>e.bindTexture(a,o)),Ie(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Ie(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Ie(e,()=>e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST)),Ie(e,()=>e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST)),Y().getNumber("WEBGL_VERSION")===1?Ie(e,()=>e.texImage2D(a,0,r,t,n,0,i,s,null)):Ie(e,()=>e.texStorage2D(a,1,r,t,n)),Ie(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:o,texShape:[n,t]}}function nU(e){return e.internalFormatFloat}function nhe(e,t,n,r){const[i,s]=mC(t,n);return gC(e,i,s,nU(r),r.textureFormatFloat,e.FLOAT)}function rU(e){return e.internalFormatHalfFloat}function rhe(e,t,n,r){const[i,s]=mC(t,n);return gC(e,i,s,rU(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function iU(e){return e.downloadTextureFormat}function ihe(e,t,n,r){const[i,s]=mC(t,n);return gC(e,i,s,iU(r),e.RGBA,e.UNSIGNED_BYTE)}function sU(e){return e.internalFormatPackedFloat}function she(e,t,n,r){const[i,s]=Gy(t,n);return gC(e,i,s,sU(r),e.RGBA,e.FLOAT)}function oU(e){return e.internalFormatPackedHalfFloat}function ohe(e,t,n,r){const[i,s]=Gy(t,n);return gC(e,i,s,oU(r),e.RGBA,r.textureTypeHalfFloat)}function ahe(e,t,n){return Ie(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),tP(e,t,"clipSpacePos",n,3,20,0)&&tP(e,t,"uv",n,2,20,12)}function uhe(e,t,n,r,i,s){Ie(e,()=>e.bindTexture(e.TEXTURE_2D,t));let o,a,u;i instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),a=e.FLOAT,u=s.internalFormatPackedFloat),o.set(i),Y().getNumber("WEBGL_VERSION")===2?Ie(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,a,o)):Ie(e,()=>e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,a,o)),Ie(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function lhe(e,t,n){Ie(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?Y().getNumber("WEBGL_VERSION")===2?Ie(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):Ie(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):Y().getNumber("WEBGL_VERSION")===2?Ie(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):Ie(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),Ie(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function che(e,t,n,r){const i=e.createBuffer();Ie(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));const a=4*4*t*n;return Ie(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),Ie(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),Ie(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function fhe(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function dhe(e,t,n,r){const[i,s]=mC(t,n),o=4,a=new Uint8Array($He(t*n,o));return Ie(e,()=>e.readPixels(0,0,i,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function hhe(e,t,n,r,i,s,o,a){const u=e,l=new Float32Array(_He(s,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function phe(e,t,n){const r=new Float32Array(t*n*4);return Ie(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}const IGe=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:ahe,createBufferFromOutputTexture:che,createFloat16MatrixTexture:rhe,createFloat16PackedMatrixTexture:ohe,createFloat32MatrixTexture:nhe,createIndexBuffer:the,createPackedMatrixTexture:she,createUnsignedBytesMatrixTexture:ihe,createVertexBuffer:ehe,createVertexShader:Jde,downloadByteEncodedFloatMatrixFromOutputTexture:dhe,downloadFloat32MatrixFromBuffer:fhe,downloadMatrixFromPackedOutputTexture:phe,downloadPackedMatrixFromBuffer:hhe,getInternalFormatForFloat16MatrixTexture:rU,getInternalFormatForFloat16PackedMatrixTexture:oU,getInternalFormatForFloat32MatrixTexture:nU,getInternalFormatForPackedMatrixTexture:sU,getInternalFormatForUnsignedBytesMatrixTexture:iU,uploadDenseMatrixToTexture:uhe,uploadPixelDataToTexture:lhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W_{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=Y().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,Cde(n,t)):this.gl=Tu(n),t=this.gl,Y().getNumber("WEBGL_VERSION")===2){const s=t;this.createVertexArray=()=>Ie(s,()=>s.createVertexArray()),this.bindVertexArray=o=>Ie(s,()=>s.bindVertexArray(o)),this.deleteVertexArray=o=>Ie(s,()=>s.deleteVertexArray(o)),this.getVertexArray=()=>Ie(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(t!=null){const s=t.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ie(t,()=>s.createVertexArrayOES()),this.bindVertexArray=o=>Ie(t,()=>s.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ie(t,()=>s.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ie(t,()=>t.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Y().getNumber("WEBGL_VERSION")===1){const s="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=Uv(this.gl,s),Ao(this.gl,o))this.textureHalfFloatExtension=Uv(this.gl,o);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ao(this.gl,i))this.colorBufferHalfFloatExtension=Uv(this.gl,i);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ao(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Ao(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=ehe(this.gl),this.indexBuffer=the(this.gl),this.framebuffer=Fde(this.gl),this.textureConfig=Z9(this.gl,this.textureHalfFloatExtension)}get debug(){return Y().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Ie(t,()=>t.finish()),Ie(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Ie(t,()=>t.deleteFramebuffer(this.framebuffer)),Ie(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Ie(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Ie(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),nhe(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),rhe(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),ihe(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),lhe(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,r,i){this.throwIfDisposed(),uhe(this.gl,t,n,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),ohe(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),she(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(nP(this.gl,this.framebuffer),this.outputTexture=null),Ie(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,r){return this.downloadMatrixDriver(t,()=>dhe(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,r,i,s,o){return hhe(this.gl,t,n,r,i,s,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return fhe(this.gl,t,n)}createBufferFromTexture(t,n,r){this.bindTextureToFrameBuffer(t);const i=che(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,r;if(Y().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const o=i.clientWaitSync(s,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},n=s}else Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(t,n,r){return this.downloadMatrixDriver(t,()=>phe(this.gl,n,r))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Jde(n));const r=Tde(n);Ie(n,()=>n.attachShader(r,this.vertexShader)),Ie(n,()=>n.attachShader(r,t)),Ade(n,r);const i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&L_(n,i),i}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const n=this.gl;Ie(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),ahe(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(Ie(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&L_(this.gl,this.program),Ie(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,r=!0){return this.throwIfDisposed(),r?Mde(this.gl,t,n):Pde(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Ie(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Lde(this.gl,t,n,r)}setOutputMatrixTexture(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)}setOutputPackedMatrixTexture(t,n,r){this.throwIfDisposed();const[i,s]=Gy(n,r);this.setOutputMatrixTextureDriver(t,i,s)}setOutputMatrixWriteRegion(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)}setOutputPackedMatrixWriteRegion(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&L_(this.gl,this.program),Wv(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ie(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ie(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Uv(this.gl,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,s),s}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await c5(()=>this.disposed||this.isQueryAvailable(t,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=DGe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Y().platform&&(r=Y().platform.setTimeoutCustom.bind(Y().platform)),c5(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),z_(this.gl,t,this.framebuffer),this.debug&&Wv(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(z_(this.gl,this.outputTexture,this.framebuffer),this.debug&&Wv(this.gl)):nP(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,n,r){this.throwIfDisposed();const i=this.gl;z_(i,t,this.framebuffer),this.debug&&Wv(i),this.outputTexture=t,Ie(i,()=>i.viewport(0,0,n,r)),Ie(i,()=>i.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(t,n,r,i){this.throwIfDisposed(),Ie(this.gl,()=>this.gl.scissor(t,n,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function DGe(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:OGe,bincountImpl:mhe,bincountReduceImpl:FGe,bitwiseAndImpl:RGe,castImpl:MGe,ceilImpl:PGe,concatImpl:LGe,equalImpl:zGe,expImpl:BGe,expm1Impl:UGe,floorImpl:WGe,gatherNdImpl:VGe,gatherV2Impl:jGe,greaterImpl:HGe,greaterEqualImpl:GGe,lessImpl:qGe,lessEqualImpl:XGe,linSpaceImpl:KGe,logImpl:YGe,maxImpl:ZGe,maximumImpl:QGe,minimumImpl:JGe,multiplyImpl:eqe,negImpl:tqe,notEqualImpl:nqe,prodImpl:rqe,raggedGatherImpl:iqe,raggedRangeImpl:sqe,raggedTensorToTensorImpl:oqe,rangeImpl:aqe,rsqrtImpl:uqe,scatterImpl:lqe,sigmoidImpl:cqe,simpleAbsImpl:ghe,sliceImpl:fqe,sparseFillEmptyRowsImpl:dqe,sparseReshapeImpl:hqe,sparseSegmentReductionImpl:yhe,sqrtImpl:pqe,staticRegexReplaceImpl:mqe,stridedSliceImpl:gqe,stringNGramsImpl:yqe,stringSplitImpl:bqe,stringToHashBucketFastImpl:vqe,subImpl:xqe,tileImpl:wqe,topKImpl:Sqe,transposeImpl:aU,uniqueImpl:Cqe}=sde;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bhe(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function Mi(e,t){return t===1?[e]:bhe(e,t)}function kqe(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $qe{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=wi(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Mi("rc",this.rank),r=an(this.rank),i=this.getOutOfBoundsCondition(n),s=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let s=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)s=`${t[t.length-1-o]},`+s;n.push(s)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vhe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length);let r="";for(let i=0;i<4;i++){let s="thisRC = rc;";i%2===1&&(s+="thisRC.z += 1;"),i>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${_qe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?eU():J9(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${r}

        setOutput(result);
      }
    `}}function _qe(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?zHe(["r","c","d"],"inputShape"):Vm(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eqe{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,r){const i=TY(n,r),s=AY(t,i,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const o=EY(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const u=this.freeTextures[s].pop();return this.usedTextures[s].push(u),u}let a;return i===Gr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Gr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Gr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Gr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Gr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(t,n,r,i){if(this.freeTextures==null)return;const s=TY(r,i),o=AY(n,s,i);o in this.freeTextures||(this.freeTextures[o]=[]);const a=EY(n,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),u=Y().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[o],c=l&&l.indexOf(t);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Tqe(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function EY(e,t,n,r,i){const s=Aqe(t,r);let o;if(i){const[u,l]=Gy(e[0],e[1]);o=u*l}else{const[u,l]=mC(e[0],e[1]);o=u*l}const a=Tqe(n,s);return o*a}function Aqe(e,t){switch(e){case Gr.PACKED_2X2_FLOAT32:return sU(t);case Gr.PACKED_2X2_FLOAT16:return oU(t);case Gr.UNPACKED_FLOAT32:return nU(t);case Gr.UNPACKED_FLOAT16:return rU(t);case Gr.PACKED_4X1_UNSIGNED_BYTE:return iU(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function Nqe(e){return Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Gr.PACKED_2X2_FLOAT32:Gr.UNPACKED_FLOAT32:e?Gr.PACKED_2X2_FLOAT16:Gr.UNPACKED_FLOAT16}function TY(e,t){if(e===To.UPLOAD)return Gr.PACKED_2X2_FLOAT32;if(e===To.RENDER||e==null)return Nqe(t);if(e===To.DOWNLOAD||e===To.PIXELS)return Gr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function AY(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fl{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ua="if (isnan(x)) return x;",Iqe="return x;",NY="return abs(x);",Dqe="return (x >= 0.0) ? x : (exp(x) - 1.0);",Oqe=Ua+`
  return (x < 0.0) ? 0.0 : x;
`,Fqe=Ua+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Rf="return x;",Rqe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mqe="return x;",Pqe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Lqe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zqe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Bqe="return 1.0 / (1.0 + exp(-1.0 * x));";class qf{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uqe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length);const n=t.length,r=Mi("rc",n),i=an(n),s=kqe(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wqe=d3,Vqe=1e-7,jqe=1e-4,d$={};function Hqe(e){return e in d$||(d$[e]={}),d$[e]}const Gqe=Y().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),qqe=600;function Xqe(){return Y().global.screen==null?1024:Y().global.screen.height*Y().global.screen.width*window.devicePixelRatio*qqe/1024/1024}class yC extends AN{nextDataId(){return yC.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Y().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof W_)n=t;else{const r=Tu(Y().getNumber("WEBGL_VERSION"),t);n=new W_(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Tu(Y().getNumber("WEBGL_VERSION"));n=new W_(r),this.binaryCache=Hqe(Y().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Eqe(this.gpgpu),this.numMBBeforeWarning=Xqe(),this.texData=new Yz(this,Ja())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,r,i,s,o){const a=this.makeTensorInfo(n,r),u=this.texData.get(a.dataId);u.isPacked=!1,u.texture={texture:t,texShape:[i,s]},u.texShape=[i,s];const l=Vv(n),c=new _Y(l,!1,o),f=this.runWebGLProgram(c,[a],r,[[i,s]]);return f.shape=n,u.texture=null,this.disposeIntermediateTensorInfo(a),f.dataId}write(t,n,r){if((Y().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Y().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:r,values:t,usage:To.UPLOAD,refCount:1}),i}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,r,i,s){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:i,values:n,usage:To.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:r,dtype:i,complexTensorInfos:s,slice:o,shape:a,isPacked:u}=n;if(o!=null){let d;u?d=new qf(a,Rf):d=new fl(a,Rf);const h=this.runWebGLProgram(d,[{dataId:t,shape:a,dtype:i}],i),p=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),p}if(r!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return r;const l=this.activeTimers!=null;let c;l&&(c=Vr());let f;if(i==="complex64"){const d=this.readSync(s.real.dataId),h=this.readSync(s.imag.dataId);f=Xc(d,h)}else f=this.getValuesFromTexture(t);return l&&(this.downloadWaitMs+=Vr()-c),this.convertAndCacheOnCPU(t,f)}async read(t){if(this.pendingRead.has(t)){const p=this.pendingRead.get(t);return new Promise(m=>p.push(m))}const n=this.texData.get(t),{values:r,shape:i,slice:s,dtype:o,complexTensorInfos:a,isPacked:u}=n;if(s!=null){let p;u?p=new qf(i,Rf):p=new fl(i,Rf);const m=this.runWebGLProgram(p,[{dataId:t,shape:i,dtype:o}],o),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(r!=null)return this.convertAndCacheOnCPU(t);if(Y().getBool("DEBUG")&&!Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Y().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,c;if(o!=="complex64"&&Y().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);const p=this.texData.get(c.dataId);l=this.gpgpu.createBufferFromTexture(p.texture.texture,...c$(i))}this.pendingRead.set(t,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];f=Xc(m,g)}else if(l==null)f=this.getValuesFromTexture(t);else{const p=ee(i);f=this.gpgpu.downloadFloat32MatrixFromBuffer(l,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),l!=null){const p=this.gpgpu.gl;Ie(p,()=>p.deleteBuffer(l))}const d=this.convertAndCacheOnCPU(t,f),h=this.pendingRead.get(t);return this.pendingRead.delete(t),h.forEach(p=>p(d)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Ja().removeDataId(t,this),this.pendingDeletes--),d}readToGPU(t,n={}){const r=this.texData.get(t),{values:i,shape:s,slice:o,dtype:a,isPacked:u,texture:l}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let h;u?h=new qf(s,Rf):h=new fl(s,Rf);const p=this.runWebGLProgram(h,[{dataId:t,shape:s,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(l==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(t,n.customTexShape),f=Ja().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:f},d.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>jc(i));return mt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return mt(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const r=t[n];if(!kde(r))throw Y().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:r,isPacked:i}=this.texData.get(t),s=ee(n);if(Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(t),h=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...c$(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(d),p}const o=Y().getBool("WEBGL_PACK")&&i===!0,a=o?Vv(n):n,u=o?new TGe(a):new EGe(a),l=this.runWebGLProgram(u,[{shape:a,dtype:r,dataId:t}],"float32"),c=this.texData.get(l.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(l),f}timerAvailable(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t();const s=Al(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),o=Al(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,i&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(s);a.kernelMs=Boe(u),a.getExtraProfileInfo=()=>u.map((l,c)=>({name:o[c],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Vr(),endMs:null}}endTimer(t){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Vr(),t)}async getQueryTime(t){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:r}=this.texData.get(t);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:r,texShape:i,usage:s,isPacked:o,slice:a}=this.texData.get(t),u=a&&a.origDataId||t,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,s,o)));const c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=Gqe){return Y().getBool("WEBGL_CPU_FORWARD")&&t.every(r=>this.texData.get(r.dataId).texture==null&&ee(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){So("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return Wqe(t.shape,n)}packedUnaryOp(t,n,r){const i=new qf(t.shape,n),s=this.compileAndRun(i,[t],r);return Ja().makeTensorFromTensorInfo(s)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const i=ghe(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,i)}if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,NY,t.dtype);const n=new fl(t.shape,NY),r=this.compileAndRun(n,[t]);return Ja().makeTensorFromTensorInfo(r)}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&cl(r[0])){const s=r.map(o=>ml(o));i=this.write(s,t,n)}else i=this.write(r,t,n);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:n}}makeOutput(t,n,r){return Ja().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,r),this)}unpackTensor(t){const n=new Uqe(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new $qe(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){const r=[Qp(t.shape),...Jp(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},s=[Qp(n),...Jp(n)],o=new vhe(s,r),a=!0,u=[r],l=this.runWebGLProgram(o,[i],t.dtype,u,a);return{dataId:l.dataId,shape:n,dtype:l.dtype}}decode(t,n){const r=this.texData.get(t),{isPacked:i,shape:s,dtype:o}=r;if(n!=null){const d=ee(s),h=n[0]*n[1]*4;A(d<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Vv(s);let u;i?u=new _Ge(a):u=new $Ge(a);const l=!0,c=[n??c$(a)],f=this.runWebGLProgram(u,[{shape:a,dtype:o,dataId:t}],o,c,l,n);return{dtype:o,shape:s,dataId:f.dataId}}runWebGLProgram(t,n,r,i,s=!1,o){const a=this.makeTensorInfo(t.outputShape,r),u=this.texData.get(a.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===Fw.DENSE){const y=o??c$(t.outputShape);u.texShape=y.map(b=>b*2)}if(t.outTexUsage!=null&&(u.usage=t.outTexUsage),ee(a.shape)===0)return u.values=Dr(a.dtype,0),a;const l=[],c=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(y.dataId);if(b.texture==null){if(!t.packedInputs&&ee(y.shape)<=Y().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:b.values};t.packedInputs&&(b.isPacked=!0,b.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!b.isPacked!=!!t.packedInputs)y=b.isPacked?this.unpackTensor(y):this.packTensor(y),l.push(y),b=this.texData.get(y.dataId);else if(b.isPacked&&!Rw(b.shape,y.shape)){const v=y,x=y.shape;y.shape=b.shape,y=this.packedReshape(y,x),l.push(y),b=this.texData.get(y.dataId),v.shape=x}return{shape:y.shape,texData:b,isUniform:!1}});this.uploadToGPU(a.dataId);const f={shape:a.shape,texData:u,isUniform:!1},d=kGe(t,c,f),h=this.getAndSaveBinary(d,()=>SGe(this.gpgpu,t,c,f)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),Y().get("ENGINE_COMPILE_ONLY")||CGe(this.gpgpu,h,c,f,i),l.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(m=this.endTimer(m),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(m)}));const g=Y().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const y=Vr();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!Y().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&s===!1){const y=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),y}return a}compileAndRun(t,n,r,i,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(t,n,r,i,s)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Y().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=K(()=>{if(!Y().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Y().getBool("DEBUG");Y().set("DEBUG",!1);const n=this.abs(Ze(1e-8)).dataSync()[0];if(Y().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Vqe:jqe}uploadToGPU(t){const n=this.texData.get(t),{shape:r,dtype:i,values:s,texture:o,usage:a,isPacked:u}=n;if(o!=null)return;const l=this.activeTimers!=null;let c;l&&(c=Vr());let f=n.texShape;if(f==null&&(f=Ude(r,u),n.texShape=f),s!=null){const d=Vv(r);let h,p=f[1],m=f[0];const g=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(u||!g)&&([p,m]=Gy(f[0],f[1])),u?h=new NGe(d,g):h=new _Y(d,g);const y=g?[m,p]:f,b=this.makeTensorInfo(y,i),v=this.texData.get(b.dataId);g?v.usage=To.PIXELS:v.usage=To.UPLOAD,v.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),p,m,s);const x=[[m,p]],S=this.runWebGLProgram(h,[b],i,x,!0),C=this.texData.get(S.dataId);n.texShape=C.texShape,n.isPacked=C.isPacked,n.usage=C.usage,Y().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=C.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(b),l&&(this.uploadWaitMs+=Vr()-c)}else{const d=this.acquireTexture(f,a,i,u);n.texture=d}}convertAndCacheOnCPU(t,n){const r=this.texData.get(t),{dtype:i}=r;return n!=null&&(r.values=Kqe(n,i)),r.values}acquireTexture(t,n,r,i){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,i)}computeBytes(t,n){return t[0]*t[1]*vw(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(s){throw s}});t.push(r)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await z8(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(Q9(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:i,nanLoc:s,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:u}=Qde(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=r,t.infLoc=i,t.nanLoc=s,t.outShapeLocation=o,t.outShapeStridesLocation=a,t.outTexShapeLocation=u}}createTensorFromGPUData(t,n,r){t.channels=t.channels||"RGBA";const{texture:i,height:s,width:o,channels:a}=t,u=Ja().backend;if(!u.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=u.writeTexture(i,n,r,s,o,a);return Ja().makeTensorFromDataId(l,n,r,u)}}yC.nextDataId=0;function Kqe(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}/** @license See the LICENSE file. */const xhe="4.20.0";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whe(){Y().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oB()&&uB("webgl",()=>new yC,2);const Yqe={forceHalfFloat:whe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uU=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class em{constructor(t,n,r){this.variableNames=["A","B"],this.outputShape=ut(n,r),this.enableShapeUniforms=wi(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hm=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Qy{constructor(t,n,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ut(n,r);const s=this.outputShape.length;this.enableShapeUniforms=wi(s);let o="";if(i)if(s===0||ee(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${an(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const u=Mi("coords",s);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${u[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${u[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${u[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${u[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ro(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Zqe={kernelName:ry,backendName:"webgl",kernelFunc:ro};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rh(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(s.dataId),a=ro({inputs:{x:r},backend:n}),u=ro({inputs:{x:i},backend:n});return o.complexTensorInfos={real:a,imag:u},s}const Qqe={kernelName:LN,backendName:"webgl",kernelFunc:rh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const She="return (a < 0.) ? b * a : a;",Che=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Jqe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r,o=n.makeTensorInfo([],"float32",of(s,"float32")),a=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qy(Che,i.shape,o.shape):new em(She,i.shape,o.shape),u=n.runWebGLProgram(a,[i,o],"float32");return n.disposeIntermediateTensorInfo(o),u}const eXe={kernelName:eS,backendName:"webgl",kernelFunc:Jqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const khe="return (a < 0.) ? b * a : a;",$he=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function tXe(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t,s=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qy($he,r.shape,i.shape):new em(khe,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],"float32")}const nXe={kernelName:vS,backendName:"webgl",kernelFunc:tXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jy="if (isnan(x)) return x;";function Pt({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:s})=>{const{x:o}=i,a=s,u=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const f=a.texData.get(o.dataId),d=n(f.values,u);return a.makeTensorInfo(o.shape,u,d)}const l=Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let c;return l?c=new qf(o.shape,t):c=new fl(o.shape,e),a.runWebGLProgram(c,[o],u)}}function oi({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}){return({inputs:o,backend:a})=>{const{a:u,b:l}=o,c=a;if(r&&u.dtype==="complex64"){const p=c.texData.get(u.dataId),m=c.texData.get(l.dataId),[g,y]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{const[x,w]=v,S={dataId:x.dataId,dtype:x.dtype,shape:u.shape},C={dataId:w.dataId,dtype:w.dtype,shape:l.shape},k=new em(e,u.shape,l.shape);return c.runWebGLProgram(k,[S,C],ms(x.dtype,w.dtype))}),b=rh({inputs:{real:g,imag:y},backend:c});return c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(y),b}const f=s||ms(u.dtype,l.dtype);if((u.dtype==="string"||l.dtype==="string"||c.shouldExecuteOnCPU([u,l]))&&i!=null){const p=c.texData.get(u.dataId).values,m=c.texData.get(l.dataId).values,g=u.dtype==="string"?Kc(p):p,y=u.dtype==="string"?Kc(m):m,[b,v]=i(u.shape,l.shape,g,y,f),x=c.makeTensorInfo(v,f),w=c.texData.get(x.dataId);return w.values=b,x}const d=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let h;return d?h=new Qy(t,u.shape,l.shape,n):h=new em(e,u.shape,l.shape),c.runWebGLProgram(h,[u,l],f)}}function Mw(e,t=!1){if(e==="linear")return t?Mqe:Iqe;if(e==="relu")return t?Lqe:Oqe;if(e==="elu")return t?Pqe:Dqe;if(e==="relu6")return t?zqe:Fqe;if(e==="prelu")return t?$he:khe;if(e==="leakyrelu")return t?Che:She;if(e==="sigmoid")return t?Bqe:Rqe;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _he{constructor(t,n,r,i=!1,s=!1,o=!1,a=null,u=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=wi(this.outputShape.length);const c=i?t[1]:t[2],f=Math.ceil(c/2),d=i?"i * 2, rc.y":"rc.y, i * 2",h=s?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",y="";a&&(u?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:l?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");const b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let v="rc.x",x="rc.x";t[0]<n[0]?v=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&(x=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${x};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class DY{constructor(t,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ut(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OY="return a * b;";function lU(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=ms(r.dtype,i.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),u=n.texData.get(i.dataId),l=new DY(IY.REAL,r.shape,i.shape),c=new DY(IY.IMAG,r.shape,i.shape),f=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],d=n.runWebGLProgram(l,f,"float32"),h=n.runWebGLProgram(c,f,"float32"),p=rh({inputs:{real:d,imag:h},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),p}if(n.shouldExecuteOnCPU([r,i])){const a=n.texData.get(r.dataId),u=n.texData.get(i.dataId),[l,c]=eqe(r.shape,i.shape,a.values,u.values,s),f=n.makeTensorInfo(c,s),d=n.texData.get(f.dataId);return d.values=l,f}let o;return Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Qy(OY,r.shape,i.shape):o=new em(OY,r.shape,i.shape),n.runWebGLProgram(o,[r,i],s)}const rXe={kernelName:dy,backendName:"webgl",kernelFunc:lU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iXe(e,t,n){const r=[Qp(e.shape),...Jp(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},s=[Qp(t),...Jp(t)],o=new vhe(s,r),a=!0,u=[r],l=n.runWebGLProgram(o,[i],e.dtype,u,a);return{dataId:l.dataId,shape:t,dtype:l.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ae(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,o=n,a=ee(i.shape),u=Qz(s,a),l=ee(u);A(a===l,()=>`The new shape (${u}) has ${l} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(i.dataId);return c.isPacked&&!Rw(i.shape,u)&&!(c.texture!==null&&Rw(c.shape,u))?iXe(i,u,o):(o.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype})}const sXe={kernelName:wS,backendName:"webgl",kernelFunc:Ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FY{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];const a=Math.floor(r/4)*4,u=r%4;let l="sumValue += dot(values, ones);";if(n!=null){const f=1/n;l=`sumValue += dot(values * ${Lp(f)?f.toPrecision(2):f}, ones);`}let c="";s%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${a};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oXe{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];let a="0.0",u="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",u="min"):n==="max"&&(a="-1.0 / 1e-20",u="max");let l=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?l="sumValue":n==="prod"?l="prodValue":n==="all"?l="allValue":n==="any"&&(l="anyValue");const c=Math.floor(r/4)*4,f=r%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aXe(e){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:e[1],r=k3(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function Gm(e,t,n,r){const i=aXe(e.shape);let s=e;for(let o=0;o<i.length;o++){const{inSize:a,windowSize:u,outSize:l}=i[o];let c,f;n==="mean"?c=o===0?new FY({windowSize:u,inSize:a,batchSize:e.shape[0],outSize:l},a):new FY({windowSize:u,inSize:a,batchSize:e.shape[0],outSize:l}):c=new oXe({windowSize:u,inSize:a,batchSize:e.shape[0],outSize:l},n),f=s,s=r.runWebGLProgram(c,[s],t),f.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(f)}return s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uXe{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[n[o]];this.outputShape=r,this.rank=r.length;const i=an(this.rank),s=lXe(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}function lXe(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cXe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let c=0;c<r.length;c++)r[c]=t[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=an(this.rank),s=bhe("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=s[c];const a=`vec2(${o.slice(-2).join()})`,u=`++${s[this.rank-1]} < ${r[this.rank-1]}`,l=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${u}) {
        result[1] = ${l};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${l};
        if(${u}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J3(e,t,n){const r=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cXe(e.shape,t):new uXe(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fXe(e,t,n,r){const i=t,s=e.shape.length,o=wt(i,e.shape);let a=o;const u=Bn(a,s),l=u!=null;let c=e;l&&(c=J3(e,u,r),a=ir(a.length,s)),ii("sum",a,s);const[f,d]=Lr(c.shape,a);let h=f;n&&(h=rr(f,o));const p=ee(d),g=ee(e.shape)/p,y=Ae({inputs:{x:c},attrs:{shape:[g,p]},backend:r}),b=LI(e.dtype),v=Gm(y,b,"sum",r),x=Ae({inputs:{x:v},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(v),l&&r.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eD(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;return fXe(i,s,o,n)}const dXe={kernelName:ES,backendName:"webgl",kernelFunc:eD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gi(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:s}=r,o=n,a=i.shape.length,u=new Array(a);for(let c=0;c<u.length;c++)u[c]=i.shape[s[c]];let l;if(o.shouldExecuteOnCPU([i])){const f=o.texData.get(i.dataId).values,d=aU(f,i.shape,i.dtype,s,u);l=o.makeTensorInfo(u,i.dtype);const h=o.texData.get(l.dataId);h.values=d}else l=J3(i,s,o);return l}const hXe={kernelName:wp,backendName:"webgl",kernelFunc:Gi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ehe=1e3;function dT({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:u=null}){const l=e.shape.length,c=t.shape.length,f=n?e.shape[l-2]:e.shape[l-1],d=r?t.shape[c-1]:t.shape[c-2],h=n?e.shape[l-1]:e.shape[l-2],p=r?t.shape[c-2]:t.shape[c-1],m=e.shape.slice(0,-2),g=t.shape.slice(0,-2),y=ee(m),b=ee(g),x=ut(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([h,p]);A(f===d,()=>`Error in matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=n?[y,f,h]:[y,h,f],S=r?[b,p,d]:[b,d,p],C=Ae({inputs:{x:e},backend:i,attrs:{shape:w}}),k=Ae({inputs:{x:t},backend:i,attrs:{shape:S}}),E=[C,k],_=Math.max(y,b),T=n?C.shape[1]:C.shape[2],D=s!=null,O=o!=null,M=u==="leakyrelu",I=u!=null?Mw(u,!0):null,P=D||O||M||I!=null;let V;if((h===1||p===1)&&T>Ehe&&P===!1){let B=C,q=k;n&&(B=Gi({inputs:{x:C},backend:i,attrs:{perm:[0,2,1]}}),E.push(B)),r&&(q=Gi({inputs:{x:k},backend:i,attrs:{perm:[0,2,1]}}),E.push(q));const J=p!==1,ne=p===1;let re=B;J&&(re=Ae({inputs:{x:B},backend:i,attrs:{shape:[_,T,1]}}),E.push(re));const ae=p===1?2:1;let le=q;ne&&(le=Ae({inputs:{x:q},backend:i,attrs:{shape:[_,1,T]}}),E.push(le));const me=lU({inputs:{a:re,b:le},backend:i});V=eD({inputs:{x:me},backend:i,attrs:{axis:ae,keepDims:!0}}),E.push(me)}else{const B=ms(e.dtype,t.dtype),q=new _he(w,S,[_,h,p],n,r,D,I,O,M),J=[C,k];if(s!=null&&J.push(s),O&&J.push(o),M){const ne=i.makeTensorInfo([],"float32",of(a,"float32"));J.push(ne),E.push(ne)}V=i.runWebGLProgram(q,J,B)}const F=Ae({inputs:{x:V},backend:i,attrs:{shape:x}});E.push(V);for(const B of E)i.disposeIntermediateTensorInfo(B);return F}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pXe(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:f}=r;return dT({a:i,b:s,transposeA:u,transposeB:l,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:f,activation:c})}const mXe={kernelName:xw,backendName:"webgl",kernelFunc:pXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RY="return abs(x);";function gXe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const s=n.texData.get(r.dataId),o=ghe(s.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let i;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new qf(r.shape,RY):i=new fl(r.shape,RY),n.runWebGLProgram(i,[r],r.dtype)}const yXe={kernelName:D2,backendName:"webgl",kernelFunc:gXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bXe=Ua+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,vXe=Pt({opSnippet:bXe}),xXe={kernelName:P1,backendName:"webgl",kernelFunc:vXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wXe=Ua+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,SXe=Pt({opSnippet:wXe}),CXe={kernelName:L1,backendName:"webgl",kernelFunc:SXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MY="return a + b;",kXe=oi({opSnippet:MY,packedOpSnippet:MY,supportsComplex:!0,cpuKernelImpl:OGe}),$Xe={kernelName:Om,backendName:"webgl",kernelFunc:kXe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Xe{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EXe{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_(e){const{inputs:t,backend:n}=e,r=t;if(r.length===1)return ro({inputs:{x:r[0]},backend:n});if(r.length>Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(r.length/2),l=V_({inputs:r.slice(0,u),backend:n}),c=V_({inputs:r.slice(u),backend:n});return V_({inputs:[l,c],backend:n})}const i=r.map(u=>u.dtype).reduce((u,l)=>ms(u,l)),s=r.map(u=>u.shape),a=Y().getBool("WEBGL_PACK")?new EXe(r[0].shape,s):new _Xe(r[0].shape,s);return n.runWebGLProgram(a,r,i)}const TXe={kernelName:O2,backendName:"webgl",kernelFunc:V_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=wt(s,i.shape);let l=u;const c=Bn(l,a);let f=i;c!=null&&(f=Gi({inputs:{x:i},backend:n,attrs:{perm:c}}),l=ir(l.length,a)),ii("all",l,a);const[d,h]=Lr(f.shape,l),p=ee(h),m=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),g=Gm(m,m.dtype,"all",n);let y;if(o){const b=rr(d,u);y=Ae({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=Ae({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),y}const NXe={kernelName:DN,backendName:"webgl",kernelFunc:AXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=wt(s,i.shape);let l=u;const c=Bn(l,a);let f=i;c!=null&&(f=Gi({inputs:{x:i},backend:n,attrs:{perm:c}}),l=ir(l.length,a)),ii("any",l,a);const[d,h]=Lr(f.shape,l),p=ee(h),m=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),g=Gm(m,m.dtype,"any",n);let y;if(o){const b=rr(d,u);y=Ae({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=Ae({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),y}const DXe={kernelName:ON,backendName:"webgl",kernelFunc:IXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OXe{constructor(t,n,r){this.variableNames=["A"];const{windowSize:i,batchSize:s,outSize:o}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,o];const a=n==="max"?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FXe{constructor(t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,A(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const s=t[t.length-1],o=Math.ceil(s/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");const a=this.outputShape,u=a.length,l=an(u),c=Mi("coords",u);let f,d;if(o===1){d=u+1;const k=an(d);f=`
        ${k} sourceLocR = ${k}(${c.join()}, 0);
        ++${c[u-1]};
        ${k} sourceLocG = ${k}(${c.join()}, 0);
        ++${c[u-2]};
        ${k} sourceLocA = ${k}(${c.join()}, 0);
        --${c[u-1]};
        ${k} sourceLocB = ${k}(${c.join()}, 0);
        --${c[u-2]};`}else d=u,f=`
        ${l} sourceLocR = coords;
        ++${c[u-1]};
        ${l} sourceLocG = coords;
        ++${c[u-2]};
        ${l} sourceLocA = coords;
        --${c[u-1]};
        ${l} sourceLocB = coords;
        --${c[u-2]};`;const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],m=h.map(k=>"int "+k),g=Mi("sourceLocR",d-1).concat("inIdx.r"),y=Mi("sourceLocG",d-1).concat("inIdx.g"),b=Mi("sourceLocB",d-1).concat("inIdx.b"),v=Mi("sourceLocA",d-1).concat("inIdx.a"),x=r==="max"?"greaterThan":"lessThan",w=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${v.join()})));`,S=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,C=i?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${c[u-1]} < ${a[u-1]-1};
        bool hasNextRow = ${c[u-2]} < ${a[u-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(e,t,n,r=null){let i=t.shape[0],s=t.shape[1];r!=null&&(i=r.shape[0],s=r.shape[1]);const o=k3(s),a={windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},u=new OXe(a,n,r==null),l=[t];r!=null&&l.push(r);const c=e.runWebGLProgram(u,l,"int32");if(c.shape[1]===1)return c;const f=The(e,t,n,c);return e.disposeIntermediateTensorInfo(c),f}function Ahe(e,t,n,r=null){const i=r!=null?r.shape:t.shape,s=i[i.length-1],o=k3(s),a=new FXe(i,o,n,r==null),u=r==null?[t]:[t,r],l=e.runWebGLProgram(a,u,"int32");if(l.shape.length===t.shape.length){const c=Ahe(e,t,n,l);return e.disposeIntermediateTensorInfo(l),c}return l}function Nhe(e,t,n,r){const i=[n];if(ii("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!Y().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const s=[],o=e.texData.get(t.dataId),a=o!==null&&o.isPacked;let u=t;a&&(u=e.unpackTensor(t),s.push(u));const[l,c]=Lr(u.shape,i),f=ee(c),d=Ae({inputs:{x:u},backend:e,attrs:{shape:[-1,f]}});s.push(d);const h=The(e,d,r);s.push(h);const p=Ae({inputs:{x:h},backend:e,attrs:{shape:l}});return s.forEach(m=>e.disposeIntermediateTensorInfo(m)),p}return Ahe(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let o=wt(s,i.shape);const a=Bn(o,i.shape.length);let u=i;const l=[];a!=null&&(u=Gi({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=ir(o.length,u.shape.length)),ii("argMax",[o[0]],u.shape.length);const c=Nhe(n,u,o[0],"max");return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const MXe={kernelName:F2,backendName:"webgl",kernelFunc:RXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let o=wt(s,i.shape);const a=Bn(o,i.shape.length);let u=i;const l=[];a!=null&&(u=Gi({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=ir(o.length,u.shape.length)),ii("argMin",[o[0]],u.shape.length);const c=Nhe(n,u,o[0],"min");return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const LXe={kernelName:R2,backendName:"webgl",kernelFunc:PXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zXe=Ua+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,BXe=Pt({opSnippet:zXe}),UXe={kernelName:z1,backendName:"webgl",kernelFunc:BXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WXe=Ua+"return log(x + sqrt(x * x + 1.0));",VXe=Pt({opSnippet:WXe}),jXe={kernelName:B1,backendName:"webgl",kernelFunc:VXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HXe=Ua+`
  return atan(x);
`,GXe=Pt({opSnippet:HXe}),qXe={kernelName:U1,backendName:"webgl",kernelFunc:GXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XXe=uU+`
  return atan(a, b);
`,KXe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Hm+`
  return result;
`,YXe=oi({opSnippet:XXe,packedOpSnippet:KXe}),ZXe={kernelName:V1,backendName:"webgl",kernelFunc:YXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QXe=Ua+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,JXe=Pt({opSnippet:QXe}),eKe={kernelName:W1,backendName:"webgl",kernelFunc:JXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pw{constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideHeight,u=t.strideWidth,l=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const m=n==="avg",g=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,y=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let b="0.0";if(m||(b="-1.0 / 1e-20"),r){const k=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${u});
        const ivec2 pads = ivec2(${h}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${k} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?s?g:y:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let x=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(x="avgValue / max(count, 1.0)");const w=Math.floor(o/4)*4,S=o%4,C=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${u});
      const ivec2 pads = ivec2(${h}, ${p});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${w};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${x});
      }
    `}}class cU{constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideDepth,u=t.strideHeight,l=t.strideWidth,c=t.dilationDepth,f=t.dilationHeight,d=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,m=t.effectiveFilterWidth,g=t.padInfo.front,y=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;const v=n==="avg";let x="0.0";if(v||(x="-1.0 / 1e-20"),r){const _=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${u}, ${l});
        const ivec3 pads = ivec3(${g}, ${y}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${_} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const C=Math.floor(o/4)*4,k=o%4,E=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${u}, ${l});
      const ivec3 pads = ivec3(${g}, ${y}, ${b});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${E}
            }

            int xC = xCCorner + ${C};
            if (${k===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${k===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${k===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${E}
            }
          }
        }
        setOutput(${S});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tKe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;qy(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;A(ri(o,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=za(i.shape,s,o,l,a,u);if(c.filterWidth===1&&c.filterHeight===1&&$t(c.inShape,c.outShape))return ro({inputs:{x:i},backend:n});const f=new Pw(c,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}const nKe={kernelName:M2,backendName:"webgl",kernelFunc:tKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rKe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:l}=r,c=[1,1,1],f=af(i.shape,s,o,c,a,u,l),d=new cU(f,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}const iKe={kernelName:P2,backendName:"webgl",kernelFunc:rKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sKe{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=u-1-t.padInfo.top,f=l-1-t.padInfo.left,d=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class oKe{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,o=t.strideHeight,a=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=f-1-t.padInfo.front,m=d-1-t.padInfo.top,g=h-1-t.padInfo.left,y=1/(n*r*i);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aKe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s,{filterSize:a,strides:u,pad:l,dimRoundingMode:c}=r,f=[1,1,1],d=af(o.shape,a,u,f,l,c),h=new oKe(d);return n.runWebGLProgram(h,[i],o.dtype)}const uKe={kernelName:RN,backendName:"webgl",kernelFunc:aKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lKe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s;qy([i,s],"avgPoolGrad");const{filterSize:a,strides:u,pad:l}=r,c=za(o.shape,a,u,1,l),f=new sKe(c);return n.runWebGLProgram(f,[i],o.dtype)}const cKe={kernelName:FN,backendName:"webgl",kernelFunc:lKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fKe(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;return dT({a:i,b:s,transposeA:o,transposeB:a,backend:n})}const dKe={kernelName:L2,backendName:"webgl",kernelFunc:fKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hKe{constructor(t,n,r,i,s,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ut(t,n),ut(t,r);let a="0.0";i!=null&&(ut(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="1.0";s!=null&&(ut(t,s),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pKe{constructor(t,n,r,i,s,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ut(t,n),ut(t,r);let a="vec4(0.0)";i!=null&&(ut(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="vec4(1.0)";s!=null&&(ut(t,s),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mKe=({inputs:e,backend:t,attrs:n})=>{const{x:r,mean:i,variance:s,offset:o,scale:a}=e;A(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=n;u==null&&(u=.001);const l=[r,i,s];let c=null;o!=null&&(c=o.shape,l.push(o));let f=null;a!=null&&(f=a.shape,l.push(a));const d=Y().getBool("WEBGL_PACK_NORMALIZATION")?new pKe(r.shape,i.shape,s.shape,c,f,u):new hKe(r.shape,i.shape,s.shape,c,f,u);return t.runWebGLProgram(d,l,l[0].dtype)},gKe={kernelName:Z2,backendName:"webgl",kernelFunc:mKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yKe{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=an(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=bKe(this.rank);let i;const s=t.map((o,a)=>`sourceLoc.${sP[a]} = start[${a}] + coords.${sP[a]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}}const sP=["x","y","z","w","u","v"];function bKe(e){if(e===1)return"sourceLoc";if(e<=6)return sP.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vKe{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=an(this.rank),r=Mi("coords",this.rank),i=Mi("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,o=`getChannel(getSource(${i.join()}), ${s})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${o};
        --${i[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${o};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((c,f)=>`start[${f}]`).join()});`:t.map((c,f)=>`${i[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${a}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xKe(e,t,n,r){const i=r.texData.get(e.dataId),s=r.makeTensorInfo(n,e.dtype),o=r.texData.get(s.dataId);Object.assign(o,i),o.refCount=1,o.shape=n,o.dtype=e.dtype;let a=P8(t,Ye(e.shape));i.slice&&(a+=i.slice.flatOffset),o.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||e.dataId};const u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),s}function eb(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:o}=r,[a,u]=C3(i,s,o);if(F8(i,a,u),ee(u)===0)return n.makeTensorInfo(u,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){const f=n.texData.get(i.dataId),d=fqe(f.values,a,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,d)}const{isPacked:l}=n.texData.get(i.dataId),c=M8(i.shape,a,u);if(l||!c){const f=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vKe(u):new yKe(u),d=[a];return n.runWebGLProgram(f,[i],i.dtype,d)}return n.uploadToGPU(i.dataId),xKe(i,a,u,n)}const wKe={kernelName:_S,backendName:"webgl",kernelFunc:eb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SKe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:o}=r;A(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce((b,v)=>b*v),u=tC(i.shape,s,a),l=nC(u.length,s.length),c=rC(i.shape,s,a),f=V8(o,s.length),d=j8(c,o,s.length),h=[],p=Ae({inputs:{x:i},backend:n,attrs:{shape:u}}),m=Gi({inputs:{x:p},backend:n,attrs:{perm:l}}),g=Ae({inputs:{x:m},backend:n,attrs:{shape:c}}),y=eb({inputs:{x:g},backend:n,attrs:{begin:f,size:d}});return h.push(p),h.push(m),h.push(g),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),y},CKe={kernelName:z2,backendName:"webgl",kernelFunc:SKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kKe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o}=r,a=n.readSync(i.dataId),u=n.readSync(s.dataId),l=mhe(a,u,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,l)}const $Ke={kernelName:MN,backendName:"webgl",kernelFunc:kKe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ke=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,EKe=`
  return float(int(a.r) & int(b.r));
`;function TKe(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=Y().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||o===1){const u=n.texData.get(r.dataId).values,l=n.texData.get(i.dataId).values,[c,f]=RGe(r.shape,i.shape,u,l,r.dtype),d=n.makeTensorInfo(f,r.dtype),h=n.texData.get(d.dataId);return h.values=c,d}let a;return s?a=new Qy(_Ke,r.shape,i.shape,!1):a=new em(EKe,r.shape,i.shape),n.runWebGLProgram(a,[r,i],r.dtype)}const AKe={kernelName:B2,backendName:"webgl",kernelFunc:TKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NKe(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.readSync(r.dataId),o=n.readSync(i.dataId),a=ut(Array.from(s),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const IKe={kernelName:PN,backendName:"webgl",kernelFunc:NKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DKe="return float(a != b);",Ihe=oi({opSnippet:DKe,cpuKernelImpl:nqe,dtype:"bool"}),OKe={kernelName:pS,backendName:"webgl",kernelFunc:Ihe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bC(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return ro({inputs:{x:i.complexTensorInfos.real},backend:n})}const FKe={kernelName:yI,backendName:"webgl",kernelFunc:bC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RKe="return float(int(x));";function MKe(e,t){const n=new fl(e.shape,RKe),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oP(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return ro({inputs:{x:i},backend:n});const o=lr(i.shape),a=oP({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),u=rh({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),u}if(i.dtype==="complex64"){const o=bC({inputs:{input:i},backend:n}),a=oP({inputs:{x:o},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(o),a}if(!Jz(i.dtype,s)){const o=ro({inputs:{x:i},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:s}}if(n.shouldExecuteOnCPU([i])){const o=n.texData.get(i.dataId).values,[a,u,l]=MGe(o,i.shape,i.dtype,s);return n.makeTensorInfo(a,u,l)}if(s==="int32")return MKe(i,n);if(s==="bool"){const o=n.makeTensorInfo([],"bool",Dr("bool",1)),u=Ihe({inputs:{a:i,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),u}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}const PKe={kernelName:j1,backendName:"webgl",kernelFunc:oP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY="return ceil(x);",LKe=Pt({opSnippet:PY,packedOpSnippet:PY,cpuKernelImpl:PGe}),zKe={kernelName:H1,backendName:"webgl",kernelFunc:LKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BKe{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UKe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WKe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:s,clipValueMax:o}=r;let a;Y().getBool("WEBGL_PACK_CLIP")?a=new UKe(i.shape):a=new BKe(i.shape);const u=[[s],[o]];return n.runWebGLProgram(a,[i],i.dtype,u)}const VKe={kernelName:G1,backendName:"webgl",kernelFunc:WKe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jKe{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LY(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function HKe(e){const{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),s=new jKe(r.shape),o=[LY(r,i.complexTensorInfos.real),LY(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(s,o,o[0].dtype)}const GKe={kernelName:U2,backendName:"webgl",kernelFunc:HKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qKe{constructor(t){this.outputShape=[],this.outputShape=bl(t,1),this.variableNames=t.map((o,a)=>`T${a}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+t[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const i=n.length,s=n[n.length-1];r.push(`else setOutput(getT${i}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XKe{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=bl(t,n);const r=this.outputShape,i=r.length,s=an(i),o=Mi("coords",i),a=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((m,g)=>`T${g}`);const u=new Array(t.length-1);u[0]=t[0][n];for(let m=1;m<u.length;m++)u[m]=u[m-1]+t[m][n];const l=a[n],c=a.slice(-2),f=a.join();let d=`if (${l} < ${u[0]}) {
        return getChannel(
            getT0(${f}), vec2(${c.join()}));
        }`;for(let m=1;m<u.length;m++){const g=u[m-1];d+=`
        if (${l} < ${u[m]}  && ${l} >= ${u[m-1]}) {
          return getChannel(
            getT${m}(${h$(a,l,g)}),
            vec2(${h$(c,l,g)}));
        }`}const h=u.length,p=u[u.length-1];d+=`
        return getChannel(
          getT${h}(${h$(a,l,p)}),
          vec2(${h$(c,l,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${d}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[i-1]} = ${o[i-1]} + 1;
        if (${o[i-1]} < ${r[i-1]}) {
          result.g = getValue(${o});
        }

        ${o[i-2]} = ${o[i-2]} + 1;
        if (${o[i-2]} < ${r[i-2]}) {
          result.a = getValue(${o});
        }

        ${o[i-1]} = ${o[i-1]} - 1;
        if (${o[i-2]} < ${r[i-2]} &&
            ${o[i-1]} < ${r[i-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function h$(e,t,n){const r=e.indexOf(t);return e.map((s,o)=>o===r?`${s} - ${n}`:s).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tD(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return ro({inputs:{x:i.complexTensorInfos.imag},backend:n})}const KKe={kernelName:rI,backendName:"webgl",kernelFunc:tD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jv(e,t,n){const r=e[0].dtype;if(r==="complex64"){const h=e.map(b=>bC({inputs:{input:b},backend:n})),p=e.map(b=>tD({inputs:{input:b},backend:n})),m=jv(h,t,n),g=jv(p,t,n),y=rh({inputs:{real:m,imag:g},backend:n});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}let i=n.shouldExecuteOnCPU(e);if(r==="string"&&(i=!0),i){const h=e.map(x=>{const S=[-1,ee(x.shape.slice(t))];return Ae({inputs:{x},backend:n,attrs:{shape:S}})}),p=h.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),m=bl(h.map(x=>x.shape),1),g=h[0].shape[0]===1,y=LGe(p,m,r,g),b=bl(e.map(x=>x.shape),t),v=n.makeTensorInfo(b,r,y);return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const s=e.filter(h=>ee(h.shape)>0),o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){const h=o?new fl(e[0].shape,Rf):new qf(e[0].shape,Rf);return n.runWebGLProgram(h,e,r)}const a=Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>a){const h=[];for(let m=0;m<s.length;m+=a){const g=s.slice(m,m+a);h.push(jv(g,t,n))}const p=jv(h,t,n);for(const m of h)n.disposeIntermediateTensorInfo(m);return p}if(o){const h=new XKe(s.map(p=>p.shape),t);return n.runWebGLProgram(h,s,r)}const{tensors2D:u,outShape:l}=YKe(s,t,n),c=new qKe(u.map(h=>h.shape)),f=n.runWebGLProgram(c,u,r);u.forEach(h=>n.disposeIntermediateTensorInfo(h));const d=Ae({inputs:{x:f},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(f),d}function YKe(e,t,n){const r=bl(e.map(s=>s.shape),t);return{tensors2D:e.map(s=>Ae({inputs:{x:s},attrs:{shape:[-1,ee(s.shape.slice(t))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dhe(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=wt(i,t[0].shape)[0],o=t.map(l=>l.shape);B8(o,s);const a=bl(t.map(l=>l.shape),s);if(ee(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const u=t.filter(l=>ee(l.shape)>0);return u.length===1?ro({inputs:{x:u[0]},backend:n}):jv(u,s,n)}const ZKe={kernelName:W2,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ohe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,a=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,p=Math.floor(t.inChannels/4)*4,m=t.inChannels%4,g=t.dataFormat==="channelsLast",y=g?1:2,b=g?2:3,v=g?3:1;let x="",w="";r&&(i?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:x=`
          float activation(float x) {
            ${r}
          }
        `,w="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${u}, ${l});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${w}
        setOutput(result);
      }
    `}}class QKe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,s=t.strideDepth,o=t.strideHeight,a=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,f=t.filterDepth,d=t.filterHeight,h=t.filterWidth,p=Math.floor(t.inChannels/4)*4,m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fhe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=wi(this.outputShape.length);const o=t.padInfo.left,a=t.strideWidth,u=t.dilationWidth,l=t.filterHeight,c=t.filterWidth,f=c;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<c;g++)d+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;d+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let g=0;g<c;g++)d+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(f+1)/2;g++){const y=g*2;if(d+=`
           xC = xCCorner + ${y*u};
           `,a===1){if(y<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,u===1&&y>0?d+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<c)){const b=o%2===0?NN(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,u>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:d+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):b===1?d+=`
                     xC${y+1} = xTexelC${y};
                     `:d+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<c&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<c&&(d+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<c&&(d+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<c&&(d+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let h="",p="";r&&(i?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:h=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JKe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=wi(this.outputShape.length);const{dataFormat:r}=n,i=Yi(),s=r==="channelsLast",o=s?1:2,a=s?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let l="";for(let c=0;c<=1;c++)for(let f=0;f<=1;f++)l+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${c};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hT(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function Rhe({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const u=e.shape,l=r.texData.get(e.dataId),c=n.inChannels,f=u[0]*u[1]*u[2],d=n.outChannels,h=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const y=[];if(s!=null){const x=hT(s.shape,h);x!=null&&(s=Ae({inputs:{x:s},backend:r,attrs:{shape:x}}),y.push(s))}if(i!=null){const x=hT(i.shape,h);x!=null&&(i=Ae({inputs:{x:i},backend:r,attrs:{shape:x}}),y.push(i))}if(!((f===1||d===1)&&c>Ehe)&&l.isPacked&&h&&l.texture!=null&&u[2]%2!==0&&$t(l.shape.slice(-3),u.slice(-3))){const x=u[0]*u[1]*(u[2]+1),w={dataId:e.dataId,shape:[1,x,n.inChannels],dtype:e.dtype},S=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,A(Rw(l.shape,w.shape),()=>`packed reshape ${l.shape} to ${w.shape} isn't free`);const C=Ae({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(C);const k=dT({a:w,b:C,backend:r,transposeA:p,transposeB:m,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o}),E=r.texData.get(k.dataId);A(E.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=S,E.shape=n.outShape,g=ro({inputs:{x:k},backend:r}),g.shape=n.outShape,y.push(k)}else{const x=n.outHeight*n.outWidth,w=Ae({inputs:{x:e},backend:r,attrs:{shape:h?[n.batchSize,x,n.inChannels]:[n.batchSize,n.inChannels,x]}}),S=Ae({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=dT({a:h?w:S,b:h?S:w,transposeA:!h,transposeB:m,backend:r,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o});g=Ae({inputs:{x:C},backend:r,attrs:{shape:n.outShape}}),y.push(w),y.push(S),y.push(C)}for(const x of y)r.disposeIntermediateTensorInfo(x);return g}function Mhe({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:u,filterHeight:l,inChannels:c,outWidth:f,outHeight:d,dataFormat:h}=n,p=h==="channelsLast",m=u*l*c,g=d*f,y=[n.batchSize,m,g],b=!0,v=!1,x=[];if(s!=null){const F=hT(s.shape,p);F!=null&&(s=Ae({inputs:{x:s},backend:r,attrs:{shape:F}}),x.push(s))}if(i!=null){const F=hT(i.shape,p);F!=null&&(i=Ae({inputs:{x:i},backend:r,attrs:{shape:F}}),x.push(i))}const w=Ae({inputs:{x:t},backend:r,attrs:{shape:[1,m,ee(t.shape)/m]}});x.push(w);const S=new JKe(y,n),C=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],k=r.runWebGLProgram(S,[e],"float32",C),E=Ae({inputs:{x:k},backend:r,attrs:{shape:y}});x.push(k),x.push(E);const _=i!=null,T=s!=null,D=a==="leakyrelu",O=a?Mw(a,!0):null,M=new _he(p?E.shape:w.shape,p?w.shape:E.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],b,v,_,O,T,D),I=p?[E,w]:[w,E];if(i&&I.push(i),T&&I.push(s),D){const F=r.makeTensorInfo([],"float32",of(o,"float32"));I.push(F),x.push(F)}const P=r.runWebGLProgram(M,I,"float32"),V=Ae({inputs:{x:P},backend:r,attrs:{shape:n.outShape}});x.push(P);for(const F of x)r.disposeIntermediateTensorInfo(F);return V}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:u,dilations:l,dimRoundingMode:c}=r,f=uf(u),d=Pr(i.shape,s.shape,o,l,a,c,!1,f);let h;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))h=Rhe({x:i,filter:s,convInfo:d,backend:n});else if(d.strideWidth<=2&&f==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const m=new Fhe(d),g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];h=n.runWebGLProgram(m,[i,s],"float32",g)}else if(Y().getBool("WEBGL_CONV_IM2COL"))h=Mhe({x:i,filter:s,convInfo:d,backend:n});else{const m=new Ohe(d);h=n.runWebGLProgram(m,[i,s],"float32")}const p=Ae({inputs:{x:h},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(h),p}const tYe={kernelName:V2,backendName:"webgl",kernelFunc:eYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nYe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,o=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class rYe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,o=t.dataFormat==="channelsLast",a=n-1-t.padInfo.top,u=r-1-t.padInfo.left,l=o?1:2,c=o?2:3,f=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class iYe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.padInfo.front,o=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${s};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${a};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class sYe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,o=t.strideHeight,a=t.strideWidth,u=n-1-t.padInfo.front,l=r-1-t.padInfo.top,c=i-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${l}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:u,dimRoundingMode:l,filterShape:c}=r,f=uf(u),d=Pr(i.shape,c,o,1,a,l,!1,f),h=new nYe(d);return n.runWebGLProgram(h,[i,s],"float32")}const aYe={kernelName:zN,backendName:"webgl",kernelFunc:oYe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uYe{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=wi(this.outputShape.length);const n=t.filterHeight,r=t.filterWidth,i=n-1-t.padInfo.top,s=r-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lYe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:u,dataFormat:l,dimRoundingMode:c}=r,f=uf(l),d=Pr(o,s.shape,a,1,u,c,!1,f);if(Y().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const h=[[d.strideHeight,d.strideWidth]],p=new uYe(d);return n.runWebGLProgram(p,[i,s],"float32",h)}else{const h=new rYe(d);return n.runWebGLProgram(h,[i,s],"float32")}}const cYe={kernelName:j2,backendName:"webgl",kernelFunc:lYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r,l=Yd(i.shape,s.shape,o,u,a),c=new QKe(l);return n.runWebGLProgram(c,[i,s],"float32")}const dYe={kernelName:H2,backendName:"webgl",kernelFunc:fYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:u}=r,l=Yd(i.shape,u,o,1,a),c=new iYe(l);return n.runWebGLProgram(c,[i,s],"float32")}const pYe={kernelName:BN,backendName:"webgl",kernelFunc:hYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mYe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:u}=r,l=Yd(u,s.shape,a,1,o),c=new sYe(l);return n.runWebGLProgram(c,[i,s],"float32")}const gYe={kernelName:UN,backendName:"webgl",kernelFunc:mYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yYe=Jy+`
  return cos(x);
`,bYe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Hm}
  return result;
`,vYe=Pt({opSnippet:yYe,packedOpSnippet:bYe}),xYe={kernelName:q1,backendName:"webgl",kernelFunc:vYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wYe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,SYe=Pt({opSnippet:wYe}),CYe={kernelName:X1,backendName:"webgl",kernelFunc:SYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kYe{constructor(t,n,r,i,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,u,l]=t,[c]=n,[f,d]=r;this.outputShape=[c,f,d,l];const h=i==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${u-1}.0`],[g,y,b]=f>1?[`${(a-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,x,w]=d>1?[`${(u-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${x};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ye=e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:u,extrapolationValue:l}=r,c=new kYe(i.shape,s.shape,a,u,l);return n.runWebGLProgram(c,[i,s,o],"float32")},_Ye={kernelName:VN,backendName:"webgl",kernelFunc:$Ye};var Lw;(function(e){e.Prod="*",e.Sum="+"})(Lw||(Lw={}));class zY{constructor(t,n,r,i){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,o=this.op===Lw.Prod?"1.0":"0.0",a=r?o:`getX(${BY(s,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let l="",c="";r?(l=i?`end != ${u-1}`:"end != 0",c=i?"end + 1":"end - 1"):(l=i?`end + pow2 < ${u}`:"end >= pow2",c=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${an(s)} coords = getOutputCoords();
        int end = ${UY(s,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${c};
          ${UY(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${BY(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function BY(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function UY(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(e,t,n,r,i,s){const o=t.shape.length,a=Bn([r],o);let u=t;a!=null&&(u=Gi({inputs:{x:t},backend:n,attrs:{perm:a}}));const l=ir(1,o)[0];if(l!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const c=u.shape[l];let f=ro({inputs:{x:u},backend:n});for(let d=0;d<=Math.ceil(Math.log2(c))-1;d++){const h=new zY(e,u.shape,!1,s),p=[[d]],m=f;f=n.runWebGLProgram(h,[f],f.dtype,p),n.disposeIntermediateTensorInfo(m)}if(i){const d=new zY(e,u.shape,i,s),h=f;f=n.runWebGLProgram(d,[f],f.dtype),n.disposeIntermediateTensorInfo(h)}if(a!=null){const d=Zd(a),h=Gi({inputs:{x:f},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(u),h}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return Phe(Lw.Prod,i,n,s,o,a)}const TYe={kernelName:WN,backendName:"webgl",kernelFunc:EYe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return Phe(Lw.Sum,i,n,s,o,a)}const NYe={kernelName:G2,backendName:"webgl",kernelFunc:AYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(i.shape.length===1){const u=n.readSync(i.dataId),l=n.readSync(s.dataId),c=mhe(u,l,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,c)}else if(i.shape.length===2){const u=n.bufferSync(i),l=n.bufferSync(s),c=FGe(u,l,o,a);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const DYe={kernelName:jN,backendName:"webgl",kernelFunc:IYe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OYe{constructor(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:o}=r,a=i.shape[0],u=o==="NHWC"?i.shape[1]:i.shape[2],l=o==="NHWC"?i.shape[2]:i.shape[3],c=o==="NHWC"?i.shape[3]:i.shape[1],f=u*s,d=l*s,h=c/(s*s),p=o==="NHWC"?[a,f,d,h]:[a,h,f,d],m=new OYe(p,s,o);return n.runWebGLProgram(m,[i],i.dtype)}const RYe={kernelName:HN,backendName:"webgl",kernelFunc:FYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lhe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=wi(this.outputShape.length);const o=t.filterHeight,a=t.filterWidth,u=t.outChannels/t.inChannels;let l="",c="";r&&(i?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:l=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zhe{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=wi(this.outputShape.length);const o=t.outChannels/t.inChannels,a=t.padInfo.left,u=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,f=t.filterWidth,d=f;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<f;y++)h+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let y=0;y<f;y++)h+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(d+1)/2;y++){const b=y*2;if(h+=`
          xC = xCCorner + ${b*l};
          `,u===1){if(b<f&&(a%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,l===1&&b>0?h+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<f)){const v=a%2===0?NN(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,l>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:h+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):v===1?h+=`
                    xC${b+1} = xTexelC${b};
                    `:h+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<f&&(a%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<f&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<f&&(h+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<f&&(h+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<f&&(h+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let p="",m="";r&&(i?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u,dimRoundingMode:l}=r;let c=u;c==null&&(c=[1,1]),A(ri(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const f=Pr(i.shape,s.shape,o,c,a,l,!0);let d;Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?d=new zhe(f):d=new Lhe(f);const h=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(d,[i,s],"float32",h)}const PYe={kernelName:q2,backendName:"webgl",kernelFunc:MYe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LYe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class zYe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,o=n-1-t.padInfo.top,a=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,filterShape:c}=r,f=Pr(i.shape,c,o,a,u,l,!0),d=new LYe(f);return n.runWebGLProgram(d,[i,s],"float32")}const UYe={kernelName:GN,backendName:"webgl",kernelFunc:BYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WYe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,inputShape:c}=r,f=Pr(c,s.shape,o,a,u,l,!0),d=new zYe(f);return n.runWebGLProgram(d,[i,s],"float32")}const VYe={kernelName:qN,backendName:"webgl",kernelFunc:WYe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jYe{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HYe(e){const{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],s=ee(r.shape),o=Ae({inputs:{x:r},backend:n,attrs:{shape:[s]}}),a=new jYe(s),u=n.runWebGLProgram(a,[o],o.dtype),l=Ae({inputs:{x:u},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}const GYe={kernelName:XN,backendName:"webgl",kernelFunc:HYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qYe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:r,padInfo:i,strideHeight:s,strideWidth:o,filterHeight:a,filterWidth:u,dilationHeight:l,dilationWidth:c}=t,{top:f,left:d}=i;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${o});
      const ivec2 pads = ivec2(${f}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r,l=PS(i.shape,s.shape,o,a,"NHWC",u);let c;const f=new qYe(l);c=n.runWebGLProgram(f,[i,s],"float32");const d=Ae({inputs:{x:c},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(c),d}const KYe={kernelName:X2,backendName:"webgl",kernelFunc:XYe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YYe(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:u}=Q8(i,s.length);e7(o.length,u,s);const{path:l,steps:c}=t7(a,u),f=c.length;let d=null,h=o.length;const p=[];for(let m=0;m<f;++m){for(const g of c[m]){const{permutationIndices:y,expandDims:b}=J8(h,u[g]);let v;n7(y)?v=s[g]:(v=Gi({inputs:{x:s[g]},backend:n,attrs:{perm:y}}),p.push(v));const x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);$t(v.shape,x)||(v=Ae({inputs:{x:v},backend:n,attrs:{shape:x}}),p.push(v)),d===null?d=v:(d=lU({inputs:{a:v,b:d},backend:n}),p.push(d))}m<f-1&&(l[m]>=0&&(d=eD({inputs:{x:d},backend:n,attrs:{axis:l[m]-(o.length-h),keepDims:!1}}),p.push(d)),h--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const ZYe={kernelName:YN,backendName:"webgl",kernelFunc:YYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QYe="return (x >= 0.0) ? x : (exp(x) - 1.0);",JYe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,eZe=Pt({opSnippet:QYe,packedOpSnippet:JYe}),tZe={kernelName:Y1,backendName:"webgl",kernelFunc:eZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZe="return (b >= 0.0) ? a : a * (b + 1.0);",rZe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,iZe=e=>{const{inputs:t,backend:n}=e,{dy:r,y:i}=t,s=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qy(rZe,r.shape,i.shape):new em(nZe,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],r.dtype)},sZe={kernelName:ZN,backendName:"webgl",kernelFunc:iZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oZe=`
  return vec4(equal(a, b));
`,aZe="return float(a == b);",uZe=oi({opSnippet:aZe,packedOpSnippet:oZe,dtype:"bool",cpuKernelImpl:zGe}),lZe={kernelName:K2,backendName:"webgl",kernelFunc:uZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cZe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${H8};
  float a1 = ${G8};
  float a2 = ${q8};
  float a3 = ${X8};
  float a4 = ${K8};
  float a5 = ${Y8};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,fZe=Pt({opSnippet:cZe}),dZe={kernelName:Z1,backendName:"webgl",kernelFunc:fZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hZe=Jy+`
  return exp(x);
`,pZe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Bhe=Pt({opSnippet:hZe,packedOpSnippet:pZe,cpuKernelImpl:BGe,dtype:"float32"}),mZe={kernelName:Q1,backendName:"webgl",kernelFunc:Bhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aP(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:s}=t,o=s.shape.length,a=s.shape.slice();let u=i;return i<0&&(A(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+i+1),a.splice(u,0,1),Ae({inputs:{x:s},backend:r,attrs:{shape:a}})}const gZe={kernelName:Y2,backendName:"webgl",kernelFunc:aP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WY="return exp(x) - 1.0;",yZe=Pt({opSnippet:WY,packedOpSnippet:WY,cpuKernelImpl:UGe}),bZe={kernelName:J1,backendName:"webgl",kernelFunc:yZe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VY{constructor(t,n,r){this.variableNames=["real","imag"];const i=n[1];this.outputShape=n;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${i}.0`:"1.0";let a;if(t==="real")a="return real * expR - imag * expI;";else if(t==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uhe(e,t,n){const r=n.texData.get(e.dataId),i=ee(e.shape),s=e.shape[e.shape.length-1],o=i/s,a=Ae({inputs:{x:e},backend:n,attrs:{shape:[o,s]}}),u=a.shape,l=new VY("real",u,t),c=new VY("imag",u,t),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],d=n.runWebGLProgram(l,f,"float32"),h=n.runWebGLProgram(c,f,"float32"),p=rh({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);const m=Ae({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZe(e){const{inputs:t,backend:n}=e,{input:r}=t;return Uhe(r,!1,n)}const xZe={kernelName:QN,backendName:"webgl",kernelFunc:vZe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wZe{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vC(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:s}=n;if(s=s||Im(i),s==="string"){const o=qn(s,ee(r));return o.fill(i),t.makeTensorInfo(r,s,o)}else{const o=new wZe(r,i),a=[[i]];return t.runWebGLProgram(o,[],s,a)}}const SZe={kernelName:JN,backendName:"webgl",kernelFunc:vC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CZe{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kZe={kernelName:eI,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,r=t,i=new CZe(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jY="return floor(x);",$Ze=Pt({opSnippet:jY,packedOpSnippet:jY,cpuKernelImpl:WGe}),_Ze={kernelName:ey,backendName:"webgl",kernelFunc:$Ze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EZe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,TZe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,AZe=oi({opSnippet:EZe,packedOpSnippet:TZe,dtype:"int32"}),NZe={kernelName:ty,backendName:"webgl",kernelFunc:AZe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IZe{constructor(t){this.variableNames=["A"];const n=Yi(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DZe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Yi(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OZe={kernelName:VE,backendName:"webgl",kernelFunc:FZe};let _g,$R=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function FZe(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:s}=r,o=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[u,l]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[l,u],f=[l,u,s];if(a||o){const m=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(_g==null||m!==$R)&&($R=m,_g=document.createElement("canvas").getContext("2d",{willReadFrequently:$R})),_g.canvas.width=u,_g.canvas.height=l,_g.drawImage(i,0,0,u,l),i=_g.canvas}const d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=To.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);const h=Y().getBool("WEBGL_PACK")?new DZe(f):new IZe(f),p=n.runWebGLProgram(h,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RZe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,m=uf(c),g=Pr(i.shape,s.shape,u,f,l,d,!1,m);let y;const b=[],v=o!=null,x=a!=null,w=h==="leakyrelu",S=()=>{const k=[i,s],E=(_,T)=>{if(T==="NCHW"&&_.shape.length===1&&_.shape[0]!==1){const D=Ae({inputs:{x:_},backend:n,attrs:{shape:[_.shape[0],1,1]}});return b.push(D),D}return _};if(v&&k.push(E(o,c)),x&&k.push(E(a,c)),w){const _=n.makeTensorInfo([],"float32",of(p,"float32"));k.push(_),b.push(_)}return k};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=Rhe({x:i,filter:s,convInfo:g,backend:n,bias:o,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const k=h?Mw(h,!0):null,E=new Fhe(g,v,k,x,w),_=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=S();y=n.runWebGLProgram(E,T,"float32",_)}else if(Y().getBool("WEBGL_CONV_IM2COL"))y=Mhe({x:i,filter:s,convInfo:g,backend:n,bias:o,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else{const k=h?Mw(h,!1):null,E=new Ohe(g,v,k,x,w),_=S();y=n.runWebGLProgram(E,_,"float32")}const C=Ae({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return b.push(y),b.forEach(k=>n.disposeIntermediateTensorInfo(k)),C}const MZe={kernelName:ww,backendName:"webgl",kernelFunc:RZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dilations:c,dimRoundingMode:f,activation:d,leakyreluAlpha:h}=r,p=[];let m=c;m==null&&(m=[1,1]),A(ri(u,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${m}'`);const g=Pr(i.shape,s.shape,u,m,l,f,!0),y=Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=d?Mw(d,y):null,v=[i,s],x=o!=null,w=a!=null,S=d==="leakyrelu";if(x&&v.push(o),w&&v.push(a),S){const _=n.makeTensorInfo([],"float32",of(h,"float32"));v.push(_),p.push(_)}let C;y?C=new zhe(g,x,b,w,S):C=new Lhe(g,x,b,w,S);const k=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],E=n.runWebGLProgram(C,v,"float32",k);return p.forEach(_=>n.disposeIntermediateTensorInfo(_)),E}const LZe={kernelName:Sw,backendName:"webgl",kernelFunc:PZe};class zZe{constructor(t,n,r,i){this.sliceDim=t,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const s=an(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BZe(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=i.shape,o=s[s.length-1],a=ee(r.shape),[u,l,c,f]=S3(r,i),d=Ae({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),h=Ae({inputs:{x:r},backend:n,attrs:{shape:[ee(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const y=n.readSync(i.dataId),b=n.bufferSync(r),v=VGe(y,b,r.dtype,l,o,c,f,r.shape,a);return n.makeTensorInfo(u,r.dtype,v.values)}const p=new zZe(o,f,[l,c],r.shape),m=n.runWebGLProgram(p,[h,d],h.dtype),g=Ae({inputs:{x:m},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}const UZe={kernelName:tI,backendName:"webgl",kernelFunc:BZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WZe{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=an(this.rank),i=VZe(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function VZe(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<e.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:o,batchDims:a}=r,u=wt(o,i.shape)[0];if(Y().get("DEBUG")){const b=n.readSync(s.dataId),v=i.shape[u];for(let x=0;x<b.length;++x){const w=b[x];A(w<=v-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${v-1}]`)}}const l=i7(i,s,u,a),c=ee(s.shape),f=[],d=Ae({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),h=Ae({inputs:{x:s},backend:n,attrs:{shape:[l.batchSize,c/l.batchSize]}});f.push(d),f.push(h);const p=[l.batchSize,l.outerSize,c/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([i,s])||i.dtype==="string"){const b=n.bufferSync(h),v=n.bufferSync(d),x=jGe(v,b,p);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(l.outputShape,x.dtype,x.values)}const m=new WZe(d.shape,p),g=n.runWebGLProgram(m,[d,h],d.dtype);f.push(g);const y=Ae({inputs:{x:g},backend:n,attrs:{shape:l.outputShape}});return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}const jZe={kernelName:Q2,backendName:"webgl",kernelFunc:Whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HZe="return float(a > b);",GZe=`
  return vec4(greaterThan(a, b));
`,qZe=oi({opSnippet:HZe,packedOpSnippet:GZe,cpuKernelImpl:HGe,dtype:"bool"}),XZe={kernelName:J2,backendName:"webgl",kernelFunc:qZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KZe="return float(a >= b);",YZe=`
  return vec4(greaterThanEqual(a, b));
`,ZZe=oi({opSnippet:KZe,packedOpSnippet:YZe,dtype:"bool",cpuKernelImpl:GGe}),QZe={kernelName:ny,backendName:"webgl",kernelFunc:ZZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JZe(e){const{inputs:t,backend:n}=e,{input:r}=t;return Uhe(r,!0,n)}const eQe={kernelName:nI,backendName:"webgl",kernelFunc:JZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tQe="return float(!isnan(x) && !isinf(x));",nQe=Pt({opSnippet:tQe,dtype:"bool"}),rQe={kernelName:iy,backendName:"webgl",kernelFunc:nQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iQe="return float(isinf(x));",sQe=Pt({opSnippet:iQe,dtype:"bool"}),oQe={kernelName:sy,backendName:"webgl",kernelFunc:sQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQe="return float(isnan(x));",uQe=Pt({opSnippet:aQe,dtype:"bool"}),lQe={kernelName:oy,backendName:"webgl",kernelFunc:uQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cQe="return float(a < b);",fQe=`
  return vec4(lessThan(a, b));
`,dQe=oi({opSnippet:cQe,packedOpSnippet:fQe,cpuKernelImpl:qGe,dtype:"bool"}),hQe={kernelName:tS,backendName:"webgl",kernelFunc:dQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQe="return float(a <= b);",mQe=`
  return vec4(lessThanEqual(a, b));
`,gQe=oi({opSnippet:pQe,packedOpSnippet:mQe,cpuKernelImpl:XGe,dtype:"bool"}),yQe={kernelName:nS,backendName:"webgl",kernelFunc:gQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bQe(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,o=KGe(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}const vQe={kernelName:iI,backendName:"webgl",kernelFunc:bQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xQe=Jy+`
  return x < 0.0 ? 0./0. : log(x);
`,wQe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,SQe=Pt({opSnippet:xQe,packedOpSnippet:wQe,cpuKernelImpl:YGe}),CQe={kernelName:ay,backendName:"webgl",kernelFunc:SQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kQe=Jy+`
  return log(1.0 + x);
`,$Qe=Pt({opSnippet:kQe}),_Qe={kernelName:uy,backendName:"webgl",kernelFunc:$Qe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EQe="return float(a >= 1.0 && b >= 1.0);",TQe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,AQe=oi({opSnippet:EQe,packedOpSnippet:TQe,dtype:"bool"}),NQe={kernelName:rS,backendName:"webgl",kernelFunc:AQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IQe="return float(!(x >= 1.0));",DQe=Pt({opSnippet:IQe}),OQe={kernelName:iS,backendName:"webgl",kernelFunc:DQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FQe="return float(a >= 1.0 || b >= 1.0);",RQe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,MQe=oi({opSnippet:FQe,packedOpSnippet:RQe,dtype:"bool"}),PQe={kernelName:sS,backendName:"webgl",kernelFunc:MQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LQe{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[];const o=n,a=t[3]-1;this.outputShape=t;let u;const l=`float(${r}) + float(${i}) * sum`;s===.5?u=`inversesqrt(${l})`:s===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zQe{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=t[3]-1;this.outputShape=t;let u;const l=`float(${r}) + float(${i}) * sum`;s===.5?u=`inversesqrt(${l})`:s===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BQe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:u}=r,l=Y().getBool("WEBGL_PACK_NORMALIZATION")?new zQe(i.shape,s,o,a,u):new LQe(i.shape,s,o,a,u);return n.runWebGLProgram(l,[i],i.dtype)},UQe={kernelName:oS,backendName:"webgl",kernelFunc:BQe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WQe{constructor(t,n,r,i,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VQe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:u,alpha:l,beta:c}=r,f=new WQe(i.shape,a,u,l,c);return n.runWebGLProgram(f,[i,s,o],i.dtype)},jQe={kernelName:sI,backendName:"webgl",kernelFunc:VQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQe(e,t,n,r){const i=ee(t),o=ee(e.shape)/i,a=Ae({inputs:{x:e},attrs:{shape:[o,i]},backend:r}),u=Gm(a,e.dtype,"max",r),l=Ae({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=i.shape.length,u=wt(s,i.shape);let l=u;const c=Bn(l,a),f=c!=null,d=n.shouldExecuteOnCPU([i]);let h=i;if(f){if(d){const v=n.texData.get(h.dataId).values,x=new Array(a);for(let C=0;C<x.length;C++)x[C]=i.shape[c[C]];const w=aU(v,i.shape,i.dtype,c,x);h=n.makeTensorInfo(x,i.dtype);const S=n.texData.get(h.dataId);S.values=w}else h=J3(i,c,n);l=ir(l.length,a)}ii("max",l,a);const[p,m]=Lr(h.shape,l);let g=p;o&&(g=rr(p,u));let y;if(d){const v=n.texData.get(h.dataId).values,x=ZGe(v,ee(m),g,i.dtype);y=n.makeTensorInfo(g,i.dtype);const w=n.texData.get(y.dataId);w.values=x}else y=HQe(h,m,g,n);return f&&n.disposeIntermediateTensorInfo(h),y}const GQe={kernelName:aS,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qQe=uU+`
  return max(a, b);
`,XQe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Hm+`
  return result;
`,KQe=oi({opSnippet:qQe,packedOpSnippet:XQe,cpuKernelImpl:QGe}),YQe={kernelName:ly,backendName:"webgl",kernelFunc:KQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;qy(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;A(ri(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=za(i.shape,s,o,l,a,u);if(c.filterWidth===1&&c.filterHeight===1&&$t(c.inShape,c.outShape))return ro({inputs:{x:i},backend:n});const f=new Pw(c,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}const QQe={kernelName:uS,backendName:"webgl",kernelFunc:ZQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dataFormat:u,dimRoundingMode:l}=r,c=[1,1,1],f=af(i.shape,s,o,c,a,l,u),d=new cU(f,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}const eJe={kernelName:lS,backendName:"webgl",kernelFunc:JQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tJe{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,r=t.strideWidth,i=t.dilationHeight,s=t.effectiveFilterHeight,o=t.effectiveFilterWidth,a=s-1-t.padInfo.top,u=o-1-t.padInfo.left,l=s*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class nJe{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,a=t.dilationWidth,u=t.effectiveFilterDepth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,f=u-1-t.padInfo.front,d=l-1-t.padInfo.top,h=c-1-t.padInfo.left,p=u*l*c-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${d}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rJe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s,{filterSize:a,strides:u,pad:l,dimRoundingMode:c}=r,f=[1,1,1],d=af(o.shape,a,u,f,l,c),h=new cU(d,"max",!0),p=n.runWebGLProgram(h,[o],o.dtype),m=new nJe(d),g=n.runWebGLProgram(m,[i,p],o.dtype);return n.disposeIntermediateTensorInfo(p),g}const iJe={kernelName:aI,backendName:"webgl",kernelFunc:rJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sJe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:o}=t,a=s;qy([s,o],"maxPoolGrad");const{filterSize:u,strides:l,pad:c,dimRoundingMode:f}=r,d=za(a.shape,u,l,1,c,f),h=!0,p=new Pw(d,"max",h),m=n.runWebGLProgram(p,[a],a.dtype),g=new tJe(d),y=n.runWebGLProgram(g,[i,m],a.dtype);return n.disposeIntermediateTensorInfo(m),y}const oJe={kernelName:oI,backendName:"webgl",kernelFunc:sJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aJe(e,t,n,r){let i=new Pw(n,"max",!1);const s=r.runWebGLProgram(i,[e],"float32");i=new Pw(n,"max",!0,!0,t);const o=r.runWebGLProgram(i,[e],"float32");return[s,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJe={kernelName:uI,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:o,includeBatchInIndex:a}=t,u=n;A(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const l=[1,1];A(ri(s,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${l}'`);const c=za(r.shape,i,s,l,o),[f,d]=aJe(r,a,c,u);return[f,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lJe(e,t,n,r){const i=ee(t),o=ee(e.shape)/i,a=Ae({inputs:{x:e},attrs:{shape:[o,i]},backend:r}),u=Gm(a,"float32","mean",r),l=Ae({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cJe={kernelName:cS,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{keepDims:i,axis:s}=t,o=n,a=r.shape.length,u=wt(s,r.shape);let l=u;const c=Bn(l,a),f=c!=null,d=o.shouldExecuteOnCPU([r]),h=[];let p=r;if(f){if(d){const x=o.texData.get(p.dataId).values,w=new Array(a);for(let k=0;k<w.length;k++)w[k]=r.shape[c[k]];const S=aU(x,r.shape,r.dtype,c,w);p=o.makeTensorInfo(w,r.dtype);const C=o.texData.get(p.dataId);C.values=S}else p=J3(r,c,o);h.push(p),l=ir(l.length,a)}ii("sum",l,a);const[m,g]=Lr(p.shape,l);let y=m;i&&(y=rr(m,u));const b=lJe(p,g,y,o);for(const v of h)o.disposeIntermediateTensorInfo(v);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=wt(s,i.shape);let l=u;const c=Bn(l,a);let f=i;c!=null&&(f=Gi({inputs:{x:i},backend:n,attrs:{perm:c}}),l=ir(l.length,i.shape.length)),ii("min",l,a);const[d,h]=Lr(f.shape,l),p=ee(h),m=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),g=Gm(m,m.dtype,"min",n);let y;if(o){const b=rr(d,u);y=Ae({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=Ae({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),y}const dJe={kernelName:fS,backendName:"webgl",kernelFunc:fJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJe=uU+`
  return min(a, b);
`,pJe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Hm+`
  return result;
`,mJe=oi({opSnippet:hJe,packedOpSnippet:pJe,cpuKernelImpl:JGe}),gJe={kernelName:cy,backendName:"webgl",kernelFunc:mJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yJe{constructor(t,n,r){this.variableNames=["x"],this.outputShape=n.map((c,f)=>c[0]+t[f]+c[1]);const i=t.length,s=an(i),o=n.map(c=>c[0]).join(","),a=n.map((c,f)=>c[0]+t[f]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),l=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${o});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bJe{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+t[m]+p[1]);const i=t.length,s=an(i),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+t[m]).join(","),u=Mi("rc",i),l=Mi("source",i),c=`${u[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${l.slice(-2).join()})`,d=r==="reflect"?0:1;let h="";if(i===1){const p=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;h=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${u[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
      `}else{const p=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;h=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${u[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
        rc = outputLoc;
        ${u[i-2]} += 1;
        if(${u[i-2]} < ${this.outputShape[i-2]}) {
          ${p}
          result[2] = getChannel(getX(${l.join()}), ${f});
          ${u[i-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${l.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${o});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vJe=({inputs:e,backend:t,attrs:n})=>{const{x:r}=e,{paddings:i,mode:s}=n,o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bJe(r.shape,i,s):new yJe(r.shape,i,s);return t.runWebGLProgram(o,[r],r.dtype)},xJe={kernelName:dS,backendName:"webgl",kernelFunc:vJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJe=`if (b == 0.0) return NAN;
  return mod(a, b);`,SJe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Hm+`
  return result;
`,CJe=oi({opSnippet:wJe,packedOpSnippet:SJe}),kJe={kernelName:fy,backendName:"webgl",kernelFunc:CJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Je{constructor(t,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Je=`
if (a == b) {
  return 1.0;
};
return a / b;`,EJe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,jhe=oi({opSnippet:_Je,packedOpSnippet:EJe,checkOutOfBounds:!0}),TJe={kernelName:K1,backendName:"webgl",kernelFunc:jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HY="return a - b;",Hhe=oi({opSnippet:HY,packedOpSnippet:HY,supportsComplex:!0,cpuKernelImpl:xqe}),AJe={kernelName:Ey,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,o=wt([s],i.shape),a=Vhe({inputs:{x:i},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=rr(a.shape,o),l=Ae({inputs:{x:a},backend:n,attrs:{shape:u}}),c=Hhe({inputs:{a:i,b:l},backend:n}),f=Bhe({inputs:{x:c},backend:n}),d=eD({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:!1}}),h=Ae({inputs:{x:d},backend:n,attrs:{shape:u}}),p=jhe({inputs:{a:f,b:h},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),p}const NJe={kernelName:NS,backendName:"webgl",kernelFunc:Ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r,u=a?i:Ghe({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),l=u.shape[0],c=u.shape[1],f=new $Je(l,c,s),d=[[o]],h=n.runWebGLProgram(f,[u],"int32",d);return a||n.disposeIntermediateTensorInfo(u),h}const DJe={kernelName:lI,backendName:"webgl",kernelFunc:IJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OJe=Ua+`
  return -x;
`,FJe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function RJe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const s=n.texData.get(r.dataId),[o,a]=tqe(s.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let i;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new qf(r.shape,FJe):i=new fl(r.shape,OJe),n.runWebGLProgram(i,[r],r.dtype)}const MJe={kernelName:hS,backendName:"webgl",kernelFunc:RJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PJe=b3;function LJe(e){So("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=r,l=n.readSync(i.dataId),c=n.readSync(s.dataId),{selectedIndices:f}=PJe(l,c,o,a,u);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const zJe={kernelName:cI,backendName:"webgl",kernelFunc:LJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BJe=v3;function UJe(e){So("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:l}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),{selectedIndices:d,validOutputs:h}=BJe(c,f,o,a,u,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const WJe={kernelName:fI,backendName:"webgl",kernelFunc:UJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VJe=x3;function jJe(e){So("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:l}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),d=o,h=a,p=u,m=l,{selectedIndices:g,selectedScores:y}=VJe(c,f,d,h,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const HJe={kernelName:dI,backendName:"webgl",kernelFunc:jJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GJe{constructor(t,n,r,i){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qJe=e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:u}=r,l=ee(i.shape),c=new GJe(l,o,a,u),f=Ae({inputs:{x:i},backend:n,attrs:{shape:[l]}}),d=n.runWebGLProgram(c,[f],s);n.disposeIntermediateTensorInfo(f);const h=[...i.shape,o],p=Ae({inputs:{x:d},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(d),p},XJe={kernelName:gS,backendName:"webgl",kernelFunc:qJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pT(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){const i=bC({inputs:{input:r},backend:n}),s=pT({inputs:{x:i},backend:n}),o=tD({inputs:{input:r},backend:n}),a=pT({inputs:{x:o},backend:n}),u=rh({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return vC({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const KJe={kernelName:FS,backendName:"webgl",kernelFunc:pT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=bC({inputs:{input:r},backend:n}),s=qhe({inputs:{x:i},backend:n}),o=tD({inputs:{input:r},backend:n}),a=pT({inputs:{x:o},backend:n}),u=rh({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return vC({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const YJe={kernelName:mS,backendName:"webgl",kernelFunc:qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJe(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return aP({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(c=>{ni(s,c.shape,"All tensors passed to stack must have matching shapes"),A(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=t.map(c=>{const f=aP({inputs:{input:c},backend:n,attrs:{dim:i}});return a.push(f),f}),l=Dhe({inputs:u,backend:n,attrs:{axis:i}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),l}const QJe={kernelName:yS,backendName:"webgl",kernelFunc:ZJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JJe{constructor(t,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((l,c)=>l[0]+t[c]+l[1]);const i=t.length,s=an(i),o=n.map(l=>l[0]).join(","),a=n.map((l,c)=>l[0]+t[c]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${o});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eet{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+t[g]+m[1]);const i=t.length,s=an(i),o=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+t[g]).join(","),u=Mi("rc",i),l=Mi("source",i),c=`${u[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${l.slice(-2).join()})`,d=[`${s} rc = outputLoc;`,`${u[i-1]} += 1;
       if(${c}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${u[i-2]} += 1;
       if(${u[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${u[i-1]} += 1;
         if(${c}) {`],h=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=i===1?2:4;m<g;m++)p+=`
        ${d[m]}
        if (${h}) {
          result[${m}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${m}] = getChannel(getX(${l.join()}), ${f});
        }
      `;p+=i===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${o});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:o}=r;if(ee(i.shape)===0){const l=s.map((c,f)=>c[0]+i.shape[f]+c[1]);return vC({backend:n,attrs:{shape:l,value:o,dtype:i.dtype}})}const a=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eet(i.shape,s,o):new JJe(i.shape,s,o),u=[[o]];return n.runWebGLProgram(a,[i],i.dtype,u)},tet={kernelName:bS,backendName:"webgl",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const net=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,ret=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Hm+`
  return result;
`,iet=oi({opSnippet:net,packedOpSnippet:ret}),set={kernelName:hy,backendName:"webgl",kernelFunc:iet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oet(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=[],l=wt(s,i.shape);let c=l;const f=Bn(c,a);let d=i;f!=null&&(d=Gi({inputs:{x:i},backend:n,attrs:{perm:f}}),c=ir(c.length,a),u.push(d)),ii("prod",c,a);let h;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:m,outShape:g,outDtype:y}=rqe(d.shape,d.dtype,p,c);h=n.makeTensorInfo(g,y,m)}else{const[p,m]=Lr(d.shape,c),g=ee(m),y=Ae({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),b=LI(i.dtype),v=Gm(y,b,"prod",n);h=Ae({inputs:{x:v},backend:n,attrs:{shape:p}}),u.push(y),u.push(v)}if(o){u.push(h);const p=rr(h.shape,l);h=Ae({inputs:{x:h},backend:n,attrs:{shape:p}})}return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const aet={kernelName:xS,backendName:"webgl",kernelFunc:oet};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uet(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,{outputRaggedRank:a}=r,u=i.map(y=>n.readSync(y.dataId)),l=i.map(y=>y.shape),c=n.readSync(s.dataId),f=n.readSync(o.dataId),[d,h,p]=iqe(u,l,c,s.shape,s.dtype,f,o.shape,a),m=d.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(p,s.dtype,h);return m.concat([g])}const cet={kernelName:hI,backendName:"webgl",kernelFunc:uet};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fet(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,o=n.readSync(r.dataId),a=n.readSync(i.dataId),u=n.readSync(s.dataId),[l,c]=sqe(o,r.shape,r.dtype,a,i.shape,u,s.shape),f=n.makeTensorInfo([l.length],"int32",l),d=n.makeTensorInfo([c.length],r.dtype,c);return[f,d]}const det={kernelName:pI,backendName:"webgl",kernelFunc:fet};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function het(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:u}=r,l=n.readSync(i.dataId),c=n.readSync(s.dataId),f=n.readSync(o.dataId),d=a.map(g=>n.readSync(g.dataId)),h=a.map(g=>g.shape),[p,m]=oqe(l,i.shape,c,s.shape,s.dtype,f,o.shape,d,h,u);return n.makeTensorInfo(p,s.dtype,m)}const pet={kernelName:mI,backendName:"webgl",kernelFunc:het};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Khe=e=>{const{backend:t,attrs:n}=e,{start:r,stop:i,step:s,dtype:o}=n,a=aqe(r,i,s,o);return t.makeTensorInfo([a.length],o,a)},met={kernelName:gI,backendName:"webgl",kernelFunc:Khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const get="return 1.0 / x;",yet=Pt({opSnippet:get}),bet={kernelName:py,backendName:"webgl",kernelFunc:yet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vet=Ua+`
  return (x < 0.0) ? 0.0 : x;
`,xet=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wet=Pt({opSnippet:vet,packedOpSnippet:xet}),Cet={kernelName:my,backendName:"webgl",kernelFunc:wet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ket=Ua+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,$et=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_et=Pt({opSnippet:ket,packedOpSnippet:$et}),Eet={kernelName:gy,backendName:"webgl",kernelFunc:_et};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tet{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let d;s?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aet{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let d;s?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Net(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[u,l]=a,c=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Aet(i.shape,u,l,s,o):new Tet(i.shape,u,l,s,o);return n.runWebGLProgram(c,[i],"float32")}const Iet={kernelName:CS,backendName:"webgl",kernelFunc:Net};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Det{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,o,a]=t,u=[r&&o>1?i-1:i,r&&a>1?s-1:s],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=u[0]/l[0],f=u[1]/l[1],d=1/c,h=1/f,p=Math.ceil(d)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oet(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r,a=new Det(s.shape,i.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}const Fet={kernelName:vI,backendName:"webgl",kernelFunc:Oet};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ret{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d=i?"0.5":"0.0";let h;s?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Met{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d=i?"0.5":"0.0";let h;s?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pet(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[u,l]=a,c=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Met(i.shape,u,l,s,o):new Ret(i.shape,u,l,s,o);return n.runWebGLProgram(c,[i],i.dtype)}const Let={kernelName:SS,backendName:"webgl",kernelFunc:Pet};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zet{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,o,a]=t,u=[r&&o>1?i-1:i,r&&a>1?s-1:s],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=u[0]/l[0],f=u[1]/l[1],d=1/c,h=1/f,p=Math.ceil(d)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bet(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r,a=new zet(s.shape,i.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}const Uet={kernelName:bI,backendName:"webgl",kernelFunc:Bet};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wet{constructor(t,n){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const i=a=>n.indexOf(a)!==-1&&t[a]!==1?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`,s=t.map((a,u)=>i(u)).join(","),o=an(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vet{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=Mi("rc",r),s=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,a=an(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(i.slice())};
          if(${s}){
            result.g = ${l(i.slice())};
          }
          if(${o}) {
            result.b = ${c(i.slice())};
            if(${s}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(p){return d(p)}function l(p){return p[r-1]="("+p[r-1]+" + 1)",d(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",d(p)}function f(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",d(p)}function d(p){const m=t.map((b,v)=>h(v,p)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function h(p,m){return n.indexOf(p)!==-1&&t[p]!==1?`${t[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jet(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r,o=i.shape.length,a=wt(s,i.shape);if(o===0)return ro({inputs:{x:i},backend:n});const u=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vet(i.shape,a):new Wet(i.shape,a);return n.runWebGLProgram(u,[i],i.dtype)}const Het={kernelName:kS,backendName:"webgl",kernelFunc:jet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Get{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=t[1],i=t[2];this.outputShape=t;let s="";typeof n=="number"?s=`float outputValue = ${n.toFixed(2)};`:s=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qet={kernelName:MI,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:o}=t,a=n,u=new Get(r.shape,s),[l,c]=W8(o,r.shape[1],r.shape[2]),f=[[l,c,Math.sin(i),Math.cos(i)]];return a.runWebGLProgram(u,[r],r.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xet=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Ket=Pt({opSnippet:Xet}),Yet={kernelName:yy,backendName:"webgl",kernelFunc:Ket};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zet="return inversesqrt(x);",Qet=Pt({opSnippet:Zet,cpuKernelImpl:uqe}),Jet={kernelName:by,backendName:"webgl",kernelFunc:Qet};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fU{constructor(t,n,r,i,s,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=an(s.length),c=an(o.length);let f="";r===1?f="i":r===2&&(f="i, j");const d=`getIndices(${f})`;let h="";i===1?h="i":i===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let m="";u&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ett{constructor(t,n,r,i,s,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const l=an(s.length),c=an(o.length);let f="";r===1?f="i":r===2&&(f="i, j");const d=`getIndices(${f})`;let h="";i===1?h="i":i===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let m="";u&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ttt(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:f}=th(s,i,o),d=[f/l,l];if(f===0)return n.makeTensorInfo(o,i.dtype);const h=Ae({inputs:{x:i},backend:n,attrs:{shape:[u,a]}}),p=Ae({inputs:{x:s},backend:n,attrs:{shape:[u,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;Y().getBool("WEBGL_PACK")?g=new ett(u,a,h.shape.length,p.shape.length,c,d):g=new fU(u,a,h.shape.length,p.shape.length,c,d);const y=n.runWebGLProgram(g,[p,h,m],p.dtype),b=Ae({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),b}const ntt={kernelName:xI,backendName:"webgl",kernelFunc:ttt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rtt{constructor(t,n,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];const s="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=Y().getNumber("WEBGL_VERSION")===2?s:o,u=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${u} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function itt(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:o}=r,a=new rtt(i.shape[0],i.shape[1],s.shape[1],o),u=[[i.shape[1]]];return n.runWebGLProgram(a,[i,s],"int32",u)}const stt={kernelName:SI,backendName:"webgl",kernelFunc:itt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ott{constructor(t,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let i,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",i="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],l=[];for(let c=0;c<n.length;c++)l.push(`${a[c]}`),c<t&&u.push(`${a[c]}`);i=u.join(),s=l.join()}const o=an(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function att(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t,o=new ott(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(o,[r,i,s],ms(i.dtype,s.dtype))}const utt={kernelName:$S,backendName:"webgl",kernelFunc:att};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ltt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${$3};
  float scale = ${_3};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,ctt=Pt({opSnippet:ltt}),ftt={kernelName:vy,backendName:"webgl",kernelFunc:ctt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dtt=Jy+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,htt=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ptt=Pt({opSnippet:dtt,packedOpSnippet:htt,cpuKernelImpl:cqe}),mtt={kernelName:Cy,backendName:"webgl",kernelFunc:ptt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gtt=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,ytt=Pt({opSnippet:gtt}),btt={kernelName:Sy,backendName:"webgl",kernelFunc:ytt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vtt=Jy+`
  return sin(x);
`,xtt=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Hm}
  return result;
`,wtt=Pt({opSnippet:vtt,packedOpSnippet:xtt}),Stt={kernelName:xy,backendName:"webgl",kernelFunc:wtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ctt=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,ktt=Pt({opSnippet:Ctt}),$tt={kernelName:wy,backendName:"webgl",kernelFunc:ktt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _tt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Ett=Pt({opSnippet:_tt}),Ttt={kernelName:ky,backendName:"webgl",kernelFunc:Ett};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Att=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:o}=r;A(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce((y,b)=>y*b),u=[[0,0]];u.push(...o);for(let y=1+s.length;y<i.shape.length;++y)u.push([0,0]);const l=[],c=Xhe({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),f=tC(c.shape,s,a,!1),d=nC(f.length,s.length,!1),h=rC(c.shape,s,a,!1),p=Ae({inputs:{x:c},backend:n,attrs:{shape:f}}),m=Gi({inputs:{x:p},backend:n,attrs:{perm:d}}),g=Ae({inputs:{x:m},backend:n,attrs:{shape:h}});return l.push(c),l.push(p),l.push(m),l.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},Ntt={kernelName:TS,backendName:"webgl",kernelFunc:Att};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Itt(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),u=n.readSync(i.dataId),l=n.readSync(s.dataId),c=n.readSync(o.dataId)[0],[f,d,h,p,m]=dqe(a,r.shape,r.dtype,u,i.dtype,l,c);return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const Dtt={kernelName:CI,backendName:"webgl",kernelFunc:Itt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ott(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(n.readSync(i.dataId)),a=n.readSync(r.dataId),u=Array.from(n.readSync(s.dataId)),[l,c,f]=hqe(a,r.shape,r.dtype,o,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const Ftt={kernelName:kI,backendName:"webgl",kernelFunc:Ott};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rtt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);const o=n.readSync(r.dataId),a=n.readSync(i.dataId),u=n.readSync(s.dataId),[l,c]=yhe(o,r.shape,r.dtype,a,u,!0);return n.makeTensorInfo(c,r.dtype,l)}const Mtt={kernelName:$I,backendName:"webgl",kernelFunc:Rtt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ptt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);const o=n.readSync(r.dataId),a=n.readSync(i.dataId),u=n.readSync(s.dataId),[l,c]=yhe(o,r.shape,r.dtype,a,u);return n.makeTensorInfo(c,r.dtype,l)}const Ltt={kernelName:_I,backendName:"webgl",kernelFunc:Ptt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ztt(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=th(s,i,a),h=!1;if(s.dtype==="string"){const y=n.bufferSync(i),b=n.bufferSync(s),v=jc(n.readSync(o.dataId)[0]),x=lqe(y,b,a,d,c,l,u,f,v,h);return n.makeTensorInfo(a,x.dtype,x.values)}const p=new fU(l,u,i.shape.length,s.shape.length,f,[d,1],h),m=n.runWebGLProgram(p,[s,i,o],s.dtype),g=Ae({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const Btt={kernelName:EI,backendName:"webgl",kernelFunc:ztt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Utt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=wt(o,i.shape)[0],u=r7(i,s,a),l=i.shape.length,c=new Array(l).fill(0),f=i.shape.slice();return u.map(d=>{const h=[...f];h[a]=d;const p=eb({inputs:{x:i},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,p})}const Wtt={kernelName:AS,backendName:"webgl",kernelFunc:Utt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GY="return sqrt(x);",Vtt=Pt({opSnippet:GY,packedOpSnippet:GY,cpuKernelImpl:pqe}),jtt={kernelName:$y,backendName:"webgl",kernelFunc:Vtt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Htt="return x * x;",Gtt=Pt({opSnippet:Htt}),qtt={kernelName:TI,backendName:"webgl",kernelFunc:Gtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qY="return (a - b) * (a - b);",Xtt=oi({opSnippet:qY,packedOpSnippet:qY}),Ktt={kernelName:_y,backendName:"webgl",kernelFunc:Xtt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ytt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");const s=n.readSync(i.dataId),o=Kc(s),a=mqe(o,"string",r);return n.makeTensorInfo(i.shape,"string",a)}const Ztt={kernelName:IS,backendName:"webgl",kernelFunc:Ytt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qtt({inputs:e,attrs:t,backend:n}){const{x:r}=e,i=Ua+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,s=new fl(r.shape,i);return n.runWebGLProgram(s,[r],r.dtype)}const Jtt={kernelName:Iy,backendName:"webgl",kernelFunc:Qtt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ent{constructor(t,n,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,s=an(r.length),o=an(r.length);let a="";if(i===1)a="coords * strides + begin";else{let u=0;a=r.map((l,c)=>(u++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${u-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${t});
      ${s} strides = ${s}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tnt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:o,strides:a,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:d}=r,{finalShapeSparse:h,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=L8(i.shape,s,o,a,u,l,c,f,d);let w;if(m)w=Ae({inputs:{x:i},backend:n,attrs:{shape:p}});else if(g||y){A(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const C=R8(b,v,x),k=eb({inputs:{x:i},backend:n,attrs:{begin:b,size:C}});w=Ae({inputs:{x:k},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(k)}else if(n.shouldExecuteOnCPU([i])){const k=n.readSync(i.dataId),E=mt(i.shape,i.dtype,k),_=gqe(h,E,x,b);w=n.makeTensorInfo(p,i.dtype,_.values)}else{const k=new ent(b,x,h);w=n.runWebGLProgram(k,[i],i.dtype)}const S=Ae({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),S}const nnt={kernelName:AI,backendName:"webgl",kernelFunc:tnt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rnt(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:f}=t,d=n.readSync(c.dataId),h=n.readSync(f.dataId),[p,m]=yqe(d,h,i,s,o,a,u,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",m)]}const int={kernelName:NI,backendName:"webgl",kernelFunc:rnt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function snt(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(s.dataId),u=n.readSync(o.dataId)[0],[l,c,f]=bqe(a,u,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const ont={kernelName:II,backendName:"webgl",kernelFunc:snt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ant(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(s.dataId),a=vqe(o,i);return n.makeTensorInfo(s.shape,"int32",a)}const unt={kernelName:DI,backendName:"webgl",kernelFunc:ant};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lnt="return tan(x);",cnt=Pt({opSnippet:lnt}),fnt={kernelName:Ty,backendName:"webgl",kernelFunc:cnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dnt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,hnt=Pt({opSnippet:dnt}),pnt={kernelName:Ay,backendName:"webgl",kernelFunc:hnt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mnt(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:s,updates:o}=t,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:f}=th(o,s,i.shape),d=[f/l,l];if(f===0)return n.makeTensorInfo(i.shape,s.dtype);const h=Ae({inputs:{x:s},backend:n,attrs:{shape:[u,a]}}),p=Ae({inputs:{x:o},backend:n,attrs:{shape:[u,l]}}),m=Ae({inputs:{x:i},backend:n,attrs:{shape:d}}),g=new fU(u,a,h.shape.length,p.shape.length,c,d,!1,!0),y=n.runWebGLProgram(g,[p,h,m],m.dtype),b=Ae({inputs:{x:y},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),b}const gnt={kernelName:wI,backendName:"webgl",kernelFunc:mnt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ynt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[o]*n[o];this.outputShape=r,this.rank=r.length;const i=an(this.rank),s=bnt(t);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}function bnt(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;if(i.dtype==="string"||i.shape.length>5){const u=n.readSync(i.dataId),l=i.dtype==="string"?u.map(d=>jc(d)):u,c=mt(i.shape,i.dtype,l),f=wqe(c,s);return n.makeTensorInfo(f.shape,f.dtype,f.values)}const o=new ynt(i.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}const vnt={kernelName:Ny,backendName:"webgl",kernelFunc:Yhe};class xnt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class wnt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $h(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function XY(e){let t=1;for(;t<e;)t*=2;return t}function Snt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:o}=r,a=Y().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=Y().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=i.shape,c=l[l.length-1];if(n.shouldExecuteOnCPU([i])||c<a||s>u){const _=n.readSync(i.dataId),[T,D]=Sqe(_,l,i.dtype,s,o);return[n.makeTensorInfo(T.shape,T.dtype,T.values),n.makeTensorInfo(D.shape,D.dtype,D.values)]}if(s===0)return l[l.length-1]=0,[n.makeTensorInfo(l,i.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(c===1)return[i,vC({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const f=n.texData.get(i.dataId),d=f!==null&&f.isPacked,h=d?n.unpackTensor(i):i,m=ee(l)/c,g=Ae({inputs:{x:h},attrs:{shape:[m,c]},backend:n});d&&$h(n,h);const y=XY(s),b=XY(c);let v=null;const x=()=>v===null?[g,g]:[g,v],w=(_,T,D)=>{const O=x(),M=new xnt(D),P=[[c],[v===null?1:0],[Number.NEGATIVE_INFINITY],[_],[T]],V=v;v=n.runWebGLProgram(M,O,"int32",P),$h(n,V)};for(let _=1;_<y;_*=2){const T=_*2;for(let D=_;D>=1;D/=2)w(T,D,[m,b])}for(let _=b;_>y;_/=2){const T=x(),D=new wnt([m,_/2]),M=[[c],[v===null?1:0],[y]],I=v;v=n.runWebGLProgram(D,T,"int32",M),$h(n,I);const P=y/2,V=P*2;for(let F=P;F>=1;F/=2)w(V,F,v.shape)}let S=v;v=eb({inputs:{x:v},backend:n,attrs:{begin:0,size:[m,s]}}),$h(n,S);let C=Whe({inputs:{x:g,indices:v},backend:n,attrs:{axis:1,batchDims:1}});$h(n,g);const k=l.slice(0,-1);k.push(s),S=v,v=Ae({inputs:{x:v},attrs:{shape:k},backend:n}),$h(n,S);const E=C;return C=Ae({inputs:{x:C},attrs:{shape:k},backend:n}),$h(n,E),[C,v]}const Cnt={kernelName:OI,backendName:"webgl",kernelFunc:Snt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class knt{constructor(t,n,r,i,s,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let u;switch(i){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $nt(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:u,outputShape:l}=r,[c,f,d,h]=i.shape,[p,m]=l??[f,d],g=[c,p,m,h],y=new knt(f,d,o,a,u,g);return n.runWebGLProgram(y,[i,s],"float32")}const _nt={kernelName:FI,backendName:"webgl",kernelFunc:$nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ent(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;qy(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(s.dataId),{outputValues:a,outputShape:u,indices:l}=Cqe(o,i,s.shape,s.dtype);return[r.makeTensorInfo(u,s.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}const Tnt={kernelName:RI,backendName:"webgl",kernelFunc:Ent};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ant(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i,a=o.shape.length,u=i.shape[s],l=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==s&&(l[c++]=o.shape[m]);const f=[],d=new Array(a).fill(0),h=o.shape.slice();h[s]=1;const p=new Array(u);for(let m=0;m<p.length;m++){d[s]=m;const g=eb({inputs:{x:o},backend:n,attrs:{begin:d,size:h}}),y=Ae({inputs:{x:g},backend:n,attrs:{shape:l}});p[m]=y,f.push(g)}return f.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Nnt={kernelName:DS,backendName:"webgl",kernelFunc:Ant};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Int{constructor(t,n){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,s=t.inSize,o=t.numSegments,a=o*Math.ceil(s/r);this.outputShape=[i,a];const u="0.0",l="sumValue",c=Math.floor(r/4)*4,f=r%4,d=`
        sumValue += dot(values, segFilter);
    `;let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dnt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:o}=r,a=i.shape.length,u=[];let l=0;const c=Bn([l],a);let f=i;c!=null&&(f=Gi({inputs:{x:i},backend:n,attrs:{perm:c}}),u.push(f),l=ir(1,a)[0]);const d=_le(f.shape,l,o),h=ee([f.shape[l]]),p=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,h]}});u.push(p);const m=LI(i.dtype),g=(x,w,S,C,k)=>{const E=x.shape[0],_=x.shape[1],T=$le(_,k),D={windowSize:T,inSize:_,batchSize:E,numSegments:k},O=new Int(D,w),M=n.compileAndRun(O,[x,S],C);if(u.push(M),M.shape[1]===k)return M;const I=Khe({backend:n,attrs:{start:0,stop:k,step:1,dtype:"float32"}}),P=Yhe({inputs:{x:I},backend:n,attrs:{reps:[_/T]}});return u.push(I),u.push(P),g(M,w,P,C,k)},y=g(p,"unsortedSegmentSum",s,m,o),b=Ae({inputs:{x:y},backend:n,attrs:{shape:d}});let v=b;if(c!=null){u.push(b);const x=Zd(c);v=Gi({inputs:{x:v},backend:n,attrs:{perm:x}})}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const Ont={kernelName:OS,backendName:"webgl",kernelFunc:Dnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fnt=[mXe,yXe,xXe,CXe,$Xe,TXe,NXe,DXe,MXe,LXe,UXe,jXe,qXe,ZXe,eKe,nKe,iKe,uKe,cKe,dKe,gKe,CKe,$Ke,AKe,IKe,PKe,zKe,VKe,Qqe,GKe,ZKe,tYe,aYe,cYe,dYe,pYe,gYe,xYe,CYe,_Ye,TYe,NYe,DYe,RYe,PYe,UYe,VYe,GYe,KYe,ZYe,tZe,sZe,lZe,dZe,mZe,gZe,bZe,xZe,SZe,kZe,_Ze,NZe,OZe,MZe,LZe,UZe,jZe,XZe,QZe,Zqe,eQe,KKe,rQe,oQe,lQe,eXe,hQe,yQe,vQe,CQe,_Qe,NQe,OQe,PQe,UQe,jQe,GQe,YQe,QQe,eJe,iJe,oJe,uJe,cJe,dJe,gJe,xJe,kJe,DJe,rXe,MJe,zJe,WJe,HJe,OKe,XJe,YJe,QJe,tet,set,nXe,aet,cet,det,pet,met,FKe,TJe,bet,Cet,Eet,sXe,Iet,Fet,Let,Uet,Het,qet,Yet,Jet,ntt,stt,utt,ftt,mtt,btt,Stt,$tt,wKe,NJe,Ttt,Ntt,Dtt,Ftt,Mtt,Ltt,Btt,Wtt,jtt,qtt,Ktt,Ztt,Jtt,nnt,int,ont,unt,AJe,dXe,fnt,pnt,gnt,vnt,Cnt,_nt,hXe,Tnt,Nnt,Ont,KJe];for(const e of Fnt)PI(e);/** @license See the LICENSE file. */const Rnt="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mnt={"tfjs-core":nle,"tfjs-backend-cpu":ode,"tfjs-backend-webgl":xhe,"tfjs-data":cfe,"tfjs-layers":z3,"tfjs-converter":Xce,tfjs:Rnt},Pnt=Object.freeze(Object.defineProperty({__proto__:null,Abs:D2,Acos:P1,Acosh:L1,AdadeltaOptimizer:$8,AdagradOptimizer:_8,AdamOptimizer:E8,AdamaxOptimizer:T8,Add:Om,AddN:O2,All:DN,Any:ON,ArgMax:F2,ArgMin:R2,Asin:z1,Asinh:B1,Atan:U1,Atan2:V1,Atanh:W1,AvgPool:M2,AvgPool3D:P2,AvgPool3DGrad:RN,AvgPoolGrad:FN,BatchMatMul:L2,BatchToSpaceND:z2,Bincount:MN,BitwiseAnd:B2,BroadcastArgs:PN,BroadcastTo:Yoe,Callback:Vce,CallbackList:Hle,Cast:j1,Ceil:H1,ClipByValue:G1,Complex:LN,ComplexAbs:U2,Concat:W2,Conv2D:V2,Conv2DBackpropFilter:zN,Conv2DBackpropInput:j2,Conv3D:H2,Conv3DBackpropFilterV2:BN,Conv3DBackpropInputV2:UN,Cos:q1,Cosh:X1,CropAndResize:VN,Cumprod:WN,Cumsum:G2,CustomCallback:qle,DataStorage:Yz,DenseBincount:jN,DepthToSpace:HN,DepthwiseConv2dNative:q2,DepthwiseConv2dNativeBackpropFilter:GN,DepthwiseConv2dNativeBackpropInput:qN,Diag:XN,Dilation2D:X2,Dilation2DBackpropFilter:WE,Dilation2DBackpropInput:UE,Draw:KN,get ENV(){return tB},EarlyStopping:jce,Einsum:YN,Elu:Y1,EluGrad:ZN,Environment:Xoe,Equal:K2,Erf:Z1,Exp:Q1,ExpandDims:Y2,Expm1:J1,FFT:QN,Fill:JN,FlipLeftRight:eI,Floor:ey,FloorDiv:ty,FromPixels:VE,FusedBatchNorm:Z2,FusedConv2D:ww,FusedDepthwiseConv2D:Sw,GPGPUContext:W_,GatherNd:tI,GatherV2:Q2,GraphModel:P9,Greater:J2,GreaterEqual:ny,History:Gle,IFFT:nI,Identity:ry,Imag:rI,InputSpec:fr,IsFinite:iy,IsInf:sy,IsNan:oy,KernelBackend:AN,LRN:oS,LRNGrad:sI,LayerVariable:Ule,LayersModel:Oc,LeakyRelu:eS,Less:tS,LessEqual:nS,LinSpace:iI,Log:ay,Log1p:uy,LogSoftmax:Zoe,LogicalAnd:rS,LogicalNot:iS,LogicalOr:sS,LogicalXor:AAe,LowerBound:NAe,MathBackendCPU:hC,MathBackendWebGL:yC,MatrixBandPart:IAe,Max:aS,MaxPool:uS,MaxPool3D:lS,MaxPool3DGrad:aI,MaxPoolGrad:oI,MaxPoolWithArgmax:uI,Maximum:ly,Mean:cS,Min:fS,Minimum:cy,MirrorPad:dS,Mod:fy,MomentumOptimizer:A8,Multinomial:lI,Multiply:dy,Neg:hS,NonMaxSuppressionV3:cI,NonMaxSuppressionV4:fI,NonMaxSuppressionV5:dI,NotEqual:pS,OP_SCOPE_SUFFIX:aB,OneHot:gS,OnesLike:mS,Optimizer:df,OptimizerConstructors:rle,Pack:yS,PadV2:bS,Pool:DAe,Pow:hy,Prelu:vS,Prod:xS,RMSPropOptimizer:N8,RNN:Mu,RaggedGather:hI,RaggedRange:pI,RaggedTensorToTensor:mI,Range:gI,get Rank(){return p5},Real:yI,RealDiv:K1,Reciprocal:py,get Reduction(){return Ri},Relu:my,Relu6:gy,Reshape:wS,ResizeBilinear:CS,ResizeBilinearGrad:vI,ResizeNearestNeighbor:SS,ResizeNearestNeighborGrad:bI,Reverse:kS,RotateWithOffset:MI,Round:yy,Rsqrt:by,SGDOptimizer:w3,ScatterNd:xI,SearchSorted:SI,Select:$S,Selu:vy,Sequential:B3,Sigmoid:Cy,Sign:Sy,Sin:xy,Sinh:wy,Slice:_S,Softmax:NS,Softplus:ky,SpaceToBatchND:TS,SparseFillEmptyRows:CI,SparseReshape:kI,SparseSegmentMean:$I,SparseSegmentSum:_I,SparseToDense:EI,SplitV:AS,Sqrt:$y,Square:TI,SquaredDifference:_y,StaticRegexReplace:IS,Step:Iy,StridedSlice:AI,StringNGrams:NI,StringSplit:II,StringToHashBucketFast:DI,Sub:Ey,Sum:ES,SymbolicTensor:Eu,Tan:Ty,Tanh:Ay,Tensor:Rt,TensorBuffer:hr,TensorScatterUpdate:wI,Tile:Ny,TopK:OI,Transform:FI,Transpose:wp,Unique:RI,Unpack:DS,UnsortedSegmentSum:OS,UpperBound:OAe,Variable:$w,ZerosLike:FS,_FusedMatMul:xw,abs:ar,acos:mB,acosh:gB,add:de,addN:Iae,all:UI,any:Ew,argMax:Wp,argMin:yB,asin:bB,asinh:vB,atan:xB,atan2:wB,atanh:SB,avgPool:LS,avgPool3d:kB,backend:lB,backend_util:Tle,basicLSTMCell:Dae,batchNorm:Dy,batchNorm2d:$B,batchNorm3d:_B,batchNorm4d:EB,batchToSpaceND:zS,bincount:TB,bitwiseAnd:Oae,booleanMaskAsync:bue,broadcastArgs:Fae,broadcastTo:Sp,broadcast_util:c3e,browser:$Me,buffer:mt,callbacks:Rze,cast:Ce,ceil:AB,clipByValue:ys,clone:gl,complex:Gc,concat:tr,concat1d:NB,concat2d:IB,concat3d:DB,concat4d:OB,constraints:EPe,conv1d:WI,conv2d:qc,conv2dTranspose:VI,conv3d:RB,conv3dTranspose:MB,copyRegisteredKernels:PAe,cos:BS,cosh:jI,cosineWindow:h3,cumprod:Nw,cumsum:HI,customGrad:Dl,data:X8e,denseBincount:qE,deprecationWarn:pNe,depthToSpace:PB,depthwiseConv2d:Oy,deregisterOp:Lze,device_util:uNe,diag:Mae,dilation2d:LB,disableDeprecationWarnings:hNe,dispose:at,disposeVariables:mNe,div:Ue,divNoNan:zB,dot:BB,dropout:x8,einsum:ep,elu:Fy,enableDebugMode:dNe,enableProdMode:fNe,enclosingPowerOfTwo:w8,engine:Ja,ensureShape:Pae,env:Y,equal:eo,erf:GI,euclideanNorm:WB,exp:bs,expandDims:jr,expm1:VB,eye:qI,fft:JS,fill:Rm,findBackend:wNe,findBackendFactory:SNe,floor:My,floorDiv:BI,forceHalfFloat:whe,fused:Eue,gather:Py,gatherND:Sue,gather_util:_Me,getBackend:yae,getGradient:f5,getKernel:kw,getKernelsForBackend:jE,gpgpu_util:IGe,grad:q3e,grads:X3e,greater:Ki,greaterEqual:lf,ifft:G0,imag:US,image:Eo,inTopKAsync:Cue,initializers:VPe,input:uce,io:O8,irfft:a3,isFinite:jB,isInf:HB,isNaN:GB,keep:xr,kernel_impls:RMe,layers:dze,leakyRelu:WS,less:W0,lessEqual:Qd,linalg:k8,linspace:Bae,loadGraphModel:l8e,loadGraphModelSync:c8e,loadLayersModel:DLe,localResponseNormalization:qB,log:to,log1p:VS,logSigmoid:XB,logSoftmax:KI,logSumExp:jS,logicalAnd:Oa,logicalNot:HS,logicalOr:YI,logicalXor:KB,losses:Fue,lowerBound:Wae,matMul:vt,math:yMe,max:Lo,maxPool:GS,maxPool3d:YB,maxPoolWithArgmax:Vae,maximum:Vl,mean:Pn,memory:x5,meshgrid:jae,metrics:Tze,min:U0,minimum:Ed,mirrorPad:ZB,mod:QB,model:RLe,models:Aze,moments:qS,movingAverage:vue,mul:U,multiRNNCell:Hae,multinomial:Gae,neg:yn,nextFrame:z8,norm:Ry,notEqual:Hp,oneHot:V0,ones:ls,onesLike:no,op:z,outerProduct:qae,pad:cf,pad1d:Xae,pad2d:Kae,pad3d:Yae,pad4d:Zae,pool:JB,pow:Il,prelu:KS,print:pB,prod:e8,profile:gNe,raggedGather:Qae,raggedRange:Jae,raggedTensorToTensor:eue,rand:tue,randomGamma:sue,randomNormal:QI,randomStandardNormal:oue,randomUniform:Jd,randomUniformInt:aue,range:Gp,ready:vNe,real:j0,reciprocal:c8,registerBackend:uB,registerCallbackConstructor:MLe,registerGradient:Qoe,registerKernel:PI,registerOp:Pze,regularizers:Oze,relu:Fu,relu6:JI,removeBackend:xNe,reshape:j,reverse:Uo,reverse1d:uue,reverse2d:lue,reverse3d:cue,reverse4d:fue,rfft:eC,round:e3,rsqrt:t3,scalar:Ze,scatterND:xue,scatter_util:YOe,searchSorted:ZI,selu:n3,separableConv2d:r3,sequential:ace,serialization:ZRe,setBackend:bNe,setPlatform:CNe,setWebGLContext:Cde,setdiff1dAsync:due,shared:sde,sigmoid:mu,sign:f8,signal:Oue,sin:i3,sinh:s3,slice:At,slice1d:YS,slice2d:o3,slice3d:ZS,slice4d:H0,slice_util:tle,softmax:QS,softplus:Mm,spaceToBatchND:XS,sparse:Rue,sparseToDense:wue,spectral:Due,split:ps,sqrt:Or,square:rn,squaredDifference:u3,squeeze:eh,stack:Hi,step:Lm,stridedSlice:d8,string:Mue,sub:Re,sum:Le,sumOutType:LI,tan:h8,tanh:_d,tensor:hs,tensor1d:qr,tensor2d:yl,tensor3d:p8,tensor4d:hue,tensor5d:pue,tensor6d:mue,tensorScatterUpdate:gue,tensor_util:rNe,test_util:lOe,tidy:K,tile:_o,time:yNe,topk:g8,train:Ff,transpose:Tt,truncatedNormal:c3,unique:y8,unregisterGradient:MAe,unregisterKernel:RAe,unsortedSegmentSum:f3,unstack:Wo,upcastType:ms,upperBound:yue,util:HAe,valueAndGrad:K3e,valueAndGrads:Y3e,variable:b8,variableGrads:Uae,version:Mnt,version_converter:Xce,version_core:nle,version_cpu:ode,version_layers:z3,version_webgl:xhe,webgl:Yqe,webgl_util:PHe,where:Ir,whereAsync:v8,zeros:lr,zerosLike:Nt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ka=784,Af=10,mT=65e3,Lnt=5/6,Lg=Math.floor(Lnt*mT),znt=mT-Lg,Bnt="https://storage.googleapis.com/learnjs-data/model-builder/mnist_images.png",Unt="https://storage.googleapis.com/learnjs-data/model-builder/mnist_labels_uint8";class Wnt{constructor(){this.shuffledTrainIndex=0,this.shuffledTestIndex=0}async load(){const t=new Image,n=document.createElement("canvas"),r=n.getContext("2d"),i=new Promise((u,l)=>{t.crossOrigin="",t.onload=()=>{t.width=t.naturalWidth,t.height=t.naturalHeight;const c=new ArrayBuffer(mT*Ka*4),f=5e3;n.width=t.width,n.height=f;for(let d=0;d<mT/f;d++){const h=new Float32Array(c,d*Ka*f*4,Ka*f);r.drawImage(t,0,d*f,t.width,f,0,0,t.width,f);const p=r.getImageData(0,0,n.width,n.height);for(let m=0;m<p.data.length/4;m++)h[m]=p.data[m*4]/255}this.datasetImages=new Float32Array(c),u()},t.src=Bnt}),s=fetch(Unt),[o,a]=await Promise.all([i,s]);this.datasetLabels=new Uint8Array(await a.arrayBuffer()),this.trainIndices=l5(Lg),this.testIndices=l5(znt),this.trainImages=this.datasetImages.slice(0,Ka*Lg),this.testImages=this.datasetImages.slice(Ka*Lg),this.trainLabels=this.datasetLabels.slice(0,Af*Lg),this.testLabels=this.datasetLabels.slice(Af*Lg)}nextTrainBatch(t){return this.nextBatch(t,[this.trainImages,this.trainLabels],()=>(this.shuffledTrainIndex=(this.shuffledTrainIndex+1)%this.trainIndices.length,this.trainIndices[this.shuffledTrainIndex]))}nextTestBatch(t){return this.nextBatch(t,[this.testImages,this.testLabels],()=>(this.shuffledTestIndex=(this.shuffledTestIndex+1)%this.testIndices.length,this.testIndices[this.shuffledTestIndex]))}nextBatch(t,n,r){const i=new Float32Array(t*Ka),s=new Uint8Array(t*Af);for(let u=0;u<t;u++){const l=r(),c=n[0].slice(l*Ka,l*Ka+Ka);i.set(c,u*Ka);const f=n[1].slice(l*Af,l*Af+Af);s.set(f,u*Af)}const o=yl(i,[t,Ka]),a=yl(s,[t,Af]);return{xs:o,labels:a}}}var wl={},dU={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Mt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Vnt(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?s(c.value):i(c.value).then(a,u)}l((r=r.apply(e,[])).next())})}var uP="http://www.w3.org/1999/xhtml";const lP={svg:"http://www.w3.org/2000/svg",xhtml:uP,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function hU(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),lP.hasOwnProperty(t)?{space:lP[t],local:e}:e}function jnt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===uP&&t.documentElement.namespaceURI===uP?t.createElement(e):t.createElementNS(n,e)}}function Hnt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function nD(e){var t=hU(e);return(t.local?Hnt:jnt)(t)}function Gnt(){}function pU(e){return e==null?Gnt:function(){return this.querySelector(e)}}function qnt(e){typeof e!="function"&&(e=pU(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=s[c])&&(l=e.call(u,u.__data__,c,s))&&("__data__"in u&&(l.__data__=u.__data__),a[c]=l);return new ws(r,this._parents)}function Xnt(){return[]}function Zhe(e){return e==null?Xnt:function(){return this.querySelectorAll(e)}}function Knt(e){typeof e!="function"&&(e=Zhe(e));for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,u,l=0;l<a;++l)(u=o[l])&&(r.push(e.call(u,u.__data__,l,o)),i.push(u));return new ws(r,i)}function Qhe(e){return function(){return this.matches(e)}}function Ynt(e){typeof e!="function"&&(e=Qhe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],u,l=0;l<o;++l)(u=s[l])&&e.call(u,u.__data__,l,s)&&a.push(u);return new ws(r,this._parents)}function Jhe(e){return new Array(e.length)}function Znt(){return new ws(this._enter||this._groups.map(Jhe),this._parents)}function gT(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}gT.prototype={constructor:gT,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Qnt(e){return function(){return e}}var KY="$";function Jnt(e,t,n,r,i,s){for(var o=0,a,u=t.length,l=s.length;o<l;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new gT(e,s[o]);for(;o<u;++o)(a=t[o])&&(i[o]=a)}function ert(e,t,n,r,i,s,o){var a,u,l={},c=t.length,f=s.length,d=new Array(c),h;for(a=0;a<c;++a)(u=t[a])&&(d[a]=h=KY+o.call(u,u.__data__,a,t),h in l?i[a]=u:l[h]=u);for(a=0;a<f;++a)h=KY+o.call(e,s[a],a,s),(u=l[h])?(r[a]=u,u.__data__=s[a],l[h]=null):n[a]=new gT(e,s[a]);for(a=0;a<c;++a)(u=t[a])&&l[d[a]]===u&&(i[a]=u)}function trt(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(S){h[++l]=S}),h;var n=t?ert:Jnt,r=this._parents,i=this._groups;typeof e!="function"&&(e=Qnt(e));for(var s=i.length,o=new Array(s),a=new Array(s),u=new Array(s),l=0;l<s;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,m=a[l]=new Array(p),g=o[l]=new Array(p),y=u[l]=new Array(d);n(c,f,m,g,y,h,t);for(var b=0,v=0,x,w;b<p;++b)if(x=m[b]){for(b>=v&&(v=b+1);!(w=g[v])&&++v<p;);x._next=w||null}}return o=new ws(o,r),o._enter=a,o._exit=u,o}function nrt(){return new ws(this._exit||this._groups.map(Jhe),this._parents)}function rrt(e,t,n){var r=this.enter(),i=this,s=this.exit();return r=typeof e=="function"?e(r):r.append(e+""),t!=null&&(i=t(i)),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function irt(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var u=t[a],l=n[a],c=u.length,f=o[a]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;a<r;++a)o[a]=t[a];return new ws(o,this._parents)}function srt(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function ort(e){e||(e=art);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,u=i[s]=new Array(a),l,c=0;c<a;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new ws(i,this._parents).order()}function art(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function urt(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function lrt(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function crt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function frt(){var e=0;return this.each(function(){++e}),e}function drt(){return!this.node()}function hrt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function prt(e){return function(){this.removeAttribute(e)}}function mrt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function grt(e,t){return function(){this.setAttribute(e,t)}}function yrt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function brt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function vrt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function xrt(e,t){var n=hU(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?mrt:prt:typeof t=="function"?n.local?vrt:brt:n.local?yrt:grt)(n,t))}function mU(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function wrt(e){return function(){this.style.removeProperty(e)}}function Srt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Crt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function krt(e,t,n){return arguments.length>1?this.each((t==null?wrt:typeof t=="function"?Crt:Srt)(e,t,n??"")):epe(this.node(),e)}function epe(e,t){return e.style.getPropertyValue(t)||mU(e).getComputedStyle(e,null).getPropertyValue(t)}function $rt(e){return function(){delete this[e]}}function _rt(e,t){return function(){this[e]=t}}function Ert(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Trt(e,t){return arguments.length>1?this.each((t==null?$rt:typeof t=="function"?Ert:_rt)(e,t)):this.node()[e]}function tpe(e){return e.trim().split(/^|\s+/)}function gU(e){return e.classList||new npe(e)}function npe(e){this._node=e,this._names=tpe(e.getAttribute("class")||"")}npe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function rpe(e,t){for(var n=gU(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function ipe(e,t){for(var n=gU(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Art(e){return function(){rpe(this,e)}}function Nrt(e){return function(){ipe(this,e)}}function Irt(e,t){return function(){(t.apply(this,arguments)?rpe:ipe)(this,e)}}function Drt(e,t){var n=tpe(e+"");if(arguments.length<2){for(var r=gU(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Irt:t?Art:Nrt)(n,t))}function Ort(){this.textContent=""}function Frt(e){return function(){this.textContent=e}}function Rrt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Mrt(e){return arguments.length?this.each(e==null?Ort:(typeof e=="function"?Rrt:Frt)(e)):this.node().textContent}function Prt(){this.innerHTML=""}function Lrt(e){return function(){this.innerHTML=e}}function zrt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Brt(e){return arguments.length?this.each(e==null?Prt:(typeof e=="function"?zrt:Lrt)(e)):this.node().innerHTML}function Urt(){this.nextSibling&&this.parentNode.appendChild(this)}function Wrt(){return this.each(Urt)}function Vrt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function jrt(){return this.each(Vrt)}function Hrt(e){var t=typeof e=="function"?e:nD(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Grt(){return null}function qrt(e,t){var n=typeof e=="function"?e:nD(e),r=t==null?Grt:typeof t=="function"?t:pU(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Xrt(){var e=this.parentNode;e&&e.removeChild(this)}function Krt(){return this.each(Xrt)}function Yrt(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Zrt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Qrt(e){return this.select(e?Zrt:Yrt)}function Jrt(e){return arguments.length?this.property("__data__",e):this.node().__data__}var spe={},No=null;if(typeof document<"u"){var eit=document.documentElement;"onmouseenter"in eit||(spe={mouseenter:"mouseover",mouseleave:"mouseout"})}function tit(e,t,n){return e=ope(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function ope(e,t,n){return function(r){var i=No;No=r;try{e.call(this,this.__data__,t,n)}finally{No=i}}}function nit(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function rit(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.capture):t[++r]=s;++r?t.length=r:delete this.__on}}}function iit(e,t,n){var r=spe.hasOwnProperty(e.type)?tit:ope;return function(i,s,o){var a=this.__on,u,l=r(t,s,o);if(a){for(var c=0,f=a.length;c<f;++c)if((u=a[c]).type===e.type&&u.name===e.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=l,u.capture=n),u.value=t;return}}this.addEventListener(e.type,l,n),u={type:e.type,name:e.name,value:t,listener:l,capture:n},a?a.push(u):this.__on=[u]}}function sit(e,t,n){var r=nit(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,l=a.length,c;u<l;++u)for(i=0,c=a[u];i<s;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(a=t?iit:rit,n==null&&(n=!1),i=0;i<s;++i)this.each(a(r[i],t,n));return this}function oit(e,t,n,r){var i=No;e.sourceEvent=No,No=e;try{return t.apply(n,r)}finally{No=i}}function ape(e,t,n){var r=mU(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ait(e,t){return function(){return ape(this,e,t)}}function uit(e,t){return function(){return ape(this,e,t.apply(this,arguments))}}function lit(e,t){return this.each((typeof t=="function"?uit:ait)(e,t))}var yU=[null];function ws(e,t){this._groups=e,this._parents=t}function upe(){return new ws([[document.documentElement]],yU)}ws.prototype=upe.prototype={constructor:ws,select:qnt,selectAll:Knt,filter:Ynt,data:trt,enter:Znt,exit:nrt,join:rrt,merge:irt,order:srt,sort:ort,call:urt,nodes:lrt,node:crt,size:frt,empty:drt,each:hrt,attr:xrt,style:krt,property:Trt,classed:Drt,text:Mrt,html:Brt,raise:Wrt,lower:jrt,append:Hrt,insert:qrt,remove:Krt,clone:Qrt,datum:Jrt,on:sit,dispatch:lit};function bU(e){return typeof e=="string"?new ws([[document.querySelector(e)]],[document.documentElement]):new ws([[e]],yU)}function cit(e){return bU(nD(e).call(document.documentElement))}var fit=0;function lpe(){return new cP}function cP(){this._="@"+(++fit).toString(36)}cP.prototype=lpe.prototype={constructor:cP,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function vU(){for(var e=No,t;t=e.sourceEvent;)e=t;return e}function rD(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function dit(e){var t=vU();return t.changedTouches&&(t=t.changedTouches[0]),rD(e,t)}function hit(e){return typeof e=="string"?new ws([document.querySelectorAll(e)],[document.documentElement]):new ws([e??[]],yU)}function pit(e,t,n){arguments.length<3&&(n=t,t=vU().changedTouches);for(var r=0,i=t?t.length:0,s;r<i;++r)if((s=t[r]).identifier===n)return rD(e,s);return null}function mit(e,t){t==null&&(t=vU().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=rD(e,t[n]);return i}const git=Object.freeze(Object.defineProperty({__proto__:null,clientPoint:rD,create:cit,creator:nD,customEvent:oit,get event(){return No},local:lpe,matcher:Qhe,mouse:dit,namespace:hU,namespaces:lP,select:bU,selectAll:hit,selection:upe,selector:pU,selectorAll:Zhe,style:epe,touch:pit,touches:mit,window:mU},Symbol.toStringTag,{value:"Module"}));var yit=/("(?:[^\\"]|\\.)*")|[:,]/g,bit=function(t,n){var r,i,s;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,s=n.replacer,function o(a,u,l){var c,f,d,h,p,m,g,y,b,v,x,w;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),x=JSON.stringify(a,s),x===void 0)return x;if(g=i-u.length-l,x.length<=g&&(b=x.replace(yit,function(S,C){return C||S+" "}),b.length<=g))return b;if(s!=null&&(a=JSON.parse(x),s=void 0),typeof a=="object"&&a!==null){if(y=u+r,d=[],f=0,Array.isArray(a))for(v="[",c="]",g=a.length;f<g;f++)d.push(o(a[f],y,f===g-1?0:1)||"null");else for(v="{",c="}",m=Object.keys(a),g=m.length;f<g;f++)h=m[f],p=JSON.stringify(h)+": ",w=o(a[h],y,p.length+(f===g-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[v,r+d.join(`,
`+y),c].join(`
`+u)}return x}(t,"",0)};const _R=O1(bit);var fP={exports:{}};(function(e,t){var n={};t=e.exports=dt;var r;typeof process=="object"&&n&&n.NODE_DEBUG&&/\bsemver\b/i.test(n.NODE_DEBUG)?r=function(){var R=Array.prototype.slice.call(arguments,0);R.unshift("SEMVER"),console.log.apply(console,R)}:r=function(){},t.SEMVER_SPEC_VERSION="2.0.0";var i=256,s=Number.MAX_SAFE_INTEGER||9007199254740991,o=16,a=i-6,u=t.re=[],l=t.safeRe=[],c=t.src=[],f=0,d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",i],[d,a]];function p(R){for(var G=0;G<h.length;G++){var Q=h[G][0],ve=h[G][1];R=R.split(Q+"*").join(Q+"{0,"+ve+"}").split(Q+"+").join(Q+"{1,"+ve+"}")}return R}var m=f++;c[m]="0|[1-9]\\d*";var g=f++;c[g]="\\d+";var y=f++;c[y]="\\d*[a-zA-Z-]"+d+"*";var b=f++;c[b]="("+c[m]+")\\.("+c[m]+")\\.("+c[m]+")";var v=f++;c[v]="("+c[g]+")\\.("+c[g]+")\\.("+c[g]+")";var x=f++;c[x]="(?:"+c[m]+"|"+c[y]+")";var w=f++;c[w]="(?:"+c[g]+"|"+c[y]+")";var S=f++;c[S]="(?:-("+c[x]+"(?:\\."+c[x]+")*))";var C=f++;c[C]="(?:-?("+c[w]+"(?:\\."+c[w]+")*))";var k=f++;c[k]=d+"+";var E=f++;c[E]="(?:\\+("+c[k]+"(?:\\."+c[k]+")*))";var _=f++,T="v?"+c[b]+c[S]+"?"+c[E]+"?";c[_]="^"+T+"$";var D="[v=\\s]*"+c[v]+c[C]+"?"+c[E]+"?",O=f++;c[O]="^"+D+"$";var M=f++;c[M]="((?:<|>)?=?)";var I=f++;c[I]=c[g]+"|x|X|\\*";var P=f++;c[P]=c[m]+"|x|X|\\*";var V=f++;c[V]="[v=\\s]*("+c[P]+")(?:\\.("+c[P]+")(?:\\.("+c[P]+")(?:"+c[S]+")?"+c[E]+"?)?)?";var F=f++;c[F]="[v=\\s]*("+c[I]+")(?:\\.("+c[I]+")(?:\\.("+c[I]+")(?:"+c[C]+")?"+c[E]+"?)?)?";var B=f++;c[B]="^"+c[M]+"\\s*"+c[V]+"$";var q=f++;c[q]="^"+c[M]+"\\s*"+c[F]+"$";var J=f++;c[J]="(?:^|[^\\d])(\\d{1,"+o+"})(?:\\.(\\d{1,"+o+"}))?(?:\\.(\\d{1,"+o+"}))?(?:$|[^\\d])";var ne=f++;c[ne]="(?:~>?)";var re=f++;c[re]="(\\s*)"+c[ne]+"\\s+",u[re]=new RegExp(c[re],"g"),l[re]=new RegExp(p(c[re]),"g");var ae="$1~",le=f++;c[le]="^"+c[ne]+c[V]+"$";var me=f++;c[me]="^"+c[ne]+c[F]+"$";var Oe=f++;c[Oe]="(?:\\^)";var Me=f++;c[Me]="(\\s*)"+c[Oe]+"\\s+",u[Me]=new RegExp(c[Me],"g"),l[Me]=new RegExp(p(c[Me]),"g");var X="$1^",oe=f++;c[oe]="^"+c[Oe]+c[V]+"$";var fe=f++;c[fe]="^"+c[Oe]+c[F]+"$";var W=f++;c[W]="^"+c[M]+"\\s*("+D+")$|^$";var Ve=f++;c[Ve]="^"+c[M]+"\\s*("+T+")$|^$";var ke=f++;c[ke]="(\\s*)"+c[M]+"\\s*("+D+"|"+c[V]+")",u[ke]=new RegExp(c[ke],"g"),l[ke]=new RegExp(p(c[ke]),"g");var Ke="$1$2$3",He=f++;c[He]="^\\s*("+c[V]+")\\s+-\\s+("+c[V]+")\\s*$";var Z=f++;c[Z]="^\\s*("+c[F]+")\\s+-\\s+("+c[F]+")\\s*$";var Ee=f++;c[Ee]="(<|>)?=?\\s*\\*";for(var it=0;it<f;it++)r(it,c[it]),u[it]||(u[it]=new RegExp(c[it]),l[it]=new RegExp(p(c[it])));t.parse=qt;function qt(R,G){if((!G||typeof G!="object")&&(G={loose:!!G,includePrerelease:!1}),R instanceof dt)return R;if(typeof R!="string"||R.length>i)return null;var Q=G.loose?l[O]:l[_];if(!Q.test(R))return null;try{return new dt(R,G)}catch{return null}}t.valid=Gu;function Gu(R,G){var Q=qt(R,G);return Q?Q.version:null}t.clean=Zi;function Zi(R,G){var Q=qt(R.trim().replace(/^[=v]+/,""),G);return Q?Q.version:null}t.SemVer=dt;function dt(R,G){if((!G||typeof G!="object")&&(G={loose:!!G,includePrerelease:!1}),R instanceof dt){if(R.loose===G.loose)return R;R=R.version}else if(typeof R!="string")throw new TypeError("Invalid Version: "+R);if(R.length>i)throw new TypeError("version is longer than "+i+" characters");if(!(this instanceof dt))return new dt(R,G);r("SemVer",R,G),this.options=G,this.loose=!!G.loose;var Q=R.trim().match(G.loose?l[O]:l[_]);if(!Q)throw new TypeError("Invalid Version: "+R);if(this.raw=R,this.major=+Q[1],this.minor=+Q[2],this.patch=+Q[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");Q[4]?this.prerelease=Q[4].split(".").map(function(ve){if(/^[0-9]+$/.test(ve)){var Te=+ve;if(Te>=0&&Te<s)return Te}return ve}):this.prerelease=[],this.build=Q[5]?Q[5].split("."):[],this.format()}dt.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},dt.prototype.toString=function(){return this.version},dt.prototype.compare=function(R){return r("SemVer.compare",this.version,this.options,R),R instanceof dt||(R=new dt(R,this.options)),this.compareMain(R)||this.comparePre(R)},dt.prototype.compareMain=function(R){return R instanceof dt||(R=new dt(R,this.options)),Qi(this.major,R.major)||Qi(this.minor,R.minor)||Qi(this.patch,R.patch)},dt.prototype.comparePre=function(R){if(R instanceof dt||(R=new dt(R,this.options)),this.prerelease.length&&!R.prerelease.length)return-1;if(!this.prerelease.length&&R.prerelease.length)return 1;if(!this.prerelease.length&&!R.prerelease.length)return 0;var G=0;do{var Q=this.prerelease[G],ve=R.prerelease[G];if(r("prerelease compare",G,Q,ve),Q===void 0&&ve===void 0)return 0;if(ve===void 0)return 1;if(Q===void 0)return-1;if(Q===ve)continue;return Qi(Q,ve)}while(++G)},dt.prototype.inc=function(R,G){switch(R){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",G);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",G);break;case"prepatch":this.prerelease.length=0,this.inc("patch",G),this.inc("pre",G);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",G),this.inc("pre",G);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var Q=this.prerelease.length;--Q>=0;)typeof this.prerelease[Q]=="number"&&(this.prerelease[Q]++,Q=-2);Q===-1&&this.prerelease.push(0)}G&&(this.prerelease[0]===G?isNaN(this.prerelease[1])&&(this.prerelease=[G,0]):this.prerelease=[G,0]);break;default:throw new Error("invalid increment argument: "+R)}return this.format(),this.raw=this.version,this},t.inc=po;function po(R,G,Q,ve){typeof Q=="string"&&(ve=Q,Q=void 0);try{return new dt(R,Q).inc(G,ve).version}catch{return null}}t.diff=ja;function ja(R,G){if(RF(R,G))return null;var Q=qt(R),ve=qt(G),Te="";if(Q.prerelease.length||ve.prerelease.length){Te="pre";var je="prerelease"}for(var Xe in Q)if((Xe==="major"||Xe==="minor"||Xe==="patch")&&Q[Xe]!==ve[Xe])return Te+Xe;return je}t.compareIdentifiers=Qi;var Ha=/^[0-9]+$/;function Qi(R,G){var Q=Ha.test(R),ve=Ha.test(G);return Q&&ve&&(R=+R,G=+G),R===G?0:Q&&!ve?-1:ve&&!Q?1:R<G?-1:1}t.rcompareIdentifiers=qu;function qu(R,G){return Qi(G,R)}t.major=Ch;function Ch(R,G){return new dt(R,G).major}t.minor=Mb;function Mb(R,G){return new dt(R,G).minor}t.patch=Pb;function Pb(R,G){return new dt(R,G).patch}t.compare=Ga;function Ga(R,G,Q){return new dt(R,Q).compare(new dt(G,Q))}t.compareLoose=Cg;function Cg(R,G){return Ga(R,G,!0)}t.rcompare=OF;function OF(R,G,Q){return Ga(G,R,Q)}t.sort=FF;function FF(R,G){return R.sort(function(Q,ve){return t.compare(Q,ve,G)})}t.rsort=v_e;function v_e(R,G){return R.sort(function(Q,ve){return t.rcompare(Q,ve,G)})}t.gt=Lb;function Lb(R,G,Q){return Ga(R,G,Q)>0}t.lt=Ok;function Ok(R,G,Q){return Ga(R,G,Q)<0}t.eq=RF;function RF(R,G,Q){return Ga(R,G,Q)===0}t.neq=tX;function tX(R,G,Q){return Ga(R,G,Q)!==0}t.gte=MF;function MF(R,G,Q){return Ga(R,G,Q)>=0}t.lte=PF;function PF(R,G,Q){return Ga(R,G,Q)<=0}t.cmp=Fk;function Fk(R,G,Q,ve){switch(G){case"===":return typeof R=="object"&&(R=R.version),typeof Q=="object"&&(Q=Q.version),R===Q;case"!==":return typeof R=="object"&&(R=R.version),typeof Q=="object"&&(Q=Q.version),R!==Q;case"":case"=":case"==":return RF(R,Q,ve);case"!=":return tX(R,Q,ve);case">":return Lb(R,Q,ve);case">=":return MF(R,Q,ve);case"<":return Ok(R,Q,ve);case"<=":return PF(R,Q,ve);default:throw new TypeError("Invalid operator: "+G)}}t.Comparator=Zo;function Zo(R,G){if((!G||typeof G!="object")&&(G={loose:!!G,includePrerelease:!1}),R instanceof Zo){if(R.loose===!!G.loose)return R;R=R.value}if(!(this instanceof Zo))return new Zo(R,G);R=R.trim().split(/\s+/).join(" "),r("comparator",R,G),this.options=G,this.loose=!!G.loose,this.parse(R),this.semver===zb?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}var zb={};Zo.prototype.parse=function(R){var G=this.options.loose?l[W]:l[Ve],Q=R.match(G);if(!Q)throw new TypeError("Invalid comparator: "+R);this.operator=Q[1],this.operator==="="&&(this.operator=""),Q[2]?this.semver=new dt(Q[2],this.options.loose):this.semver=zb},Zo.prototype.toString=function(){return this.value},Zo.prototype.test=function(R){return r("Comparator.test",R,this.options.loose),this.semver===zb?!0:(typeof R=="string"&&(R=new dt(R,this.options)),Fk(R,this.operator,this.semver,this.options))},Zo.prototype.intersects=function(R,G){if(!(R instanceof Zo))throw new TypeError("a Comparator is required");(!G||typeof G!="object")&&(G={loose:!!G,includePrerelease:!1});var Q;if(this.operator==="")return Q=new Wn(R.value,G),Rk(this.value,Q,G);if(R.operator==="")return Q=new Wn(this.value,G),Rk(R.semver,Q,G);var ve=(this.operator===">="||this.operator===">")&&(R.operator===">="||R.operator===">"),Te=(this.operator==="<="||this.operator==="<")&&(R.operator==="<="||R.operator==="<"),je=this.semver.version===R.semver.version,Xe=(this.operator===">="||this.operator==="<=")&&(R.operator===">="||R.operator==="<="),Bt=Fk(this.semver,"<",R.semver,G)&&(this.operator===">="||this.operator===">")&&(R.operator==="<="||R.operator==="<"),Lt=Fk(this.semver,">",R.semver,G)&&(this.operator==="<="||this.operator==="<")&&(R.operator===">="||R.operator===">");return ve||Te||je&&Xe||Bt||Lt},t.Range=Wn;function Wn(R,G){if((!G||typeof G!="object")&&(G={loose:!!G,includePrerelease:!1}),R instanceof Wn)return R.loose===!!G.loose&&R.includePrerelease===!!G.includePrerelease?R:new Wn(R.raw,G);if(R instanceof Zo)return new Wn(R.value,G);if(!(this instanceof Wn))return new Wn(R,G);if(this.options=G,this.loose=!!G.loose,this.includePrerelease=!!G.includePrerelease,this.raw=R.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(Q){return this.parseRange(Q.trim())},this).filter(function(Q){return Q.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Wn.prototype.format=function(){return this.range=this.set.map(function(R){return R.join(" ").trim()}).join("||").trim(),this.range},Wn.prototype.toString=function(){return this.range},Wn.prototype.parseRange=function(R){var G=this.options.loose,Q=G?l[Z]:l[He];R=R.replace(Q,A_e),r("hyphen replace",R),R=R.replace(l[ke],Ke),r("comparator trim",R,l[ke]),R=R.replace(l[re],ae),R=R.replace(l[Me],X);var ve=G?l[W]:l[Ve],Te=R.split(" ").map(function(je){return w_e(je,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(Te=Te.filter(function(je){return!!je.match(ve)})),Te=Te.map(function(je){return new Zo(je,this.options)},this),Te},Wn.prototype.intersects=function(R,G){if(!(R instanceof Wn))throw new TypeError("a Range is required");return this.set.some(function(Q){return Q.every(function(ve){return R.set.some(function(Te){return Te.every(function(je){return ve.intersects(je,G)})})})})},t.toComparators=x_e;function x_e(R,G){return new Wn(R,G).set.map(function(Q){return Q.map(function(ve){return ve.value}).join(" ").trim().split(" ")})}function w_e(R,G){return r("comp",R,G),R=k_e(R,G),r("caret",R),R=S_e(R,G),r("tildes",R),R=__e(R,G),r("xrange",R),R=T_e(R,G),r("stars",R),R}function Ji(R){return!R||R.toLowerCase()==="x"||R==="*"}function S_e(R,G){return R.trim().split(/\s+/).map(function(Q){return C_e(Q,G)}).join(" ")}function C_e(R,G){var Q=G.loose?l[me]:l[le];return R.replace(Q,function(ve,Te,je,Xe,Bt){r("tilde",R,ve,Te,je,Xe,Bt);var Lt;return Ji(Te)?Lt="":Ji(je)?Lt=">="+Te+".0.0 <"+(+Te+1)+".0.0":Ji(Xe)?Lt=">="+Te+"."+je+".0 <"+Te+"."+(+je+1)+".0":Bt?(r("replaceTilde pr",Bt),Lt=">="+Te+"."+je+"."+Xe+"-"+Bt+" <"+Te+"."+(+je+1)+".0"):Lt=">="+Te+"."+je+"."+Xe+" <"+Te+"."+(+je+1)+".0",r("tilde return",Lt),Lt})}function k_e(R,G){return R.trim().split(/\s+/).map(function(Q){return $_e(Q,G)}).join(" ")}function $_e(R,G){r("caret",R,G);var Q=G.loose?l[fe]:l[oe];return R.replace(Q,function(ve,Te,je,Xe,Bt){r("caret",R,ve,Te,je,Xe,Bt);var Lt;return Ji(Te)?Lt="":Ji(je)?Lt=">="+Te+".0.0 <"+(+Te+1)+".0.0":Ji(Xe)?Te==="0"?Lt=">="+Te+"."+je+".0 <"+Te+"."+(+je+1)+".0":Lt=">="+Te+"."+je+".0 <"+(+Te+1)+".0.0":Bt?(r("replaceCaret pr",Bt),Te==="0"?je==="0"?Lt=">="+Te+"."+je+"."+Xe+"-"+Bt+" <"+Te+"."+je+"."+(+Xe+1):Lt=">="+Te+"."+je+"."+Xe+"-"+Bt+" <"+Te+"."+(+je+1)+".0":Lt=">="+Te+"."+je+"."+Xe+"-"+Bt+" <"+(+Te+1)+".0.0"):(r("no pr"),Te==="0"?je==="0"?Lt=">="+Te+"."+je+"."+Xe+" <"+Te+"."+je+"."+(+Xe+1):Lt=">="+Te+"."+je+"."+Xe+" <"+Te+"."+(+je+1)+".0":Lt=">="+Te+"."+je+"."+Xe+" <"+(+Te+1)+".0.0"),r("caret return",Lt),Lt})}function __e(R,G){return r("replaceXRanges",R,G),R.split(/\s+/).map(function(Q){return E_e(Q,G)}).join(" ")}function E_e(R,G){R=R.trim();var Q=G.loose?l[q]:l[B];return R.replace(Q,function(ve,Te,je,Xe,Bt,Lt){r("xRange",R,ve,Te,je,Xe,Bt,Lt);var Xu=Ji(je),Ku=Xu||Ji(Xe),Qo=Ku||Ji(Bt),mo=Qo;return Te==="="&&mo&&(Te=""),Xu?Te===">"||Te==="<"?ve="<0.0.0":ve="*":Te&&mo?(Ku&&(Xe=0),Bt=0,Te===">"?(Te=">=",Ku?(je=+je+1,Xe=0,Bt=0):(Xe=+Xe+1,Bt=0)):Te==="<="&&(Te="<",Ku?je=+je+1:Xe=+Xe+1),ve=Te+je+"."+Xe+"."+Bt):Ku?ve=">="+je+".0.0 <"+(+je+1)+".0.0":Qo&&(ve=">="+je+"."+Xe+".0 <"+je+"."+(+Xe+1)+".0"),r("xRange return",ve),ve})}function T_e(R,G){return r("replaceStars",R,G),R.trim().replace(l[Ee],"")}function A_e(R,G,Q,ve,Te,je,Xe,Bt,Lt,Xu,Ku,Qo,mo){return Ji(Q)?G="":Ji(ve)?G=">="+Q+".0.0":Ji(Te)?G=">="+Q+"."+ve+".0":G=">="+G,Ji(Lt)?Bt="":Ji(Xu)?Bt="<"+(+Lt+1)+".0.0":Ji(Ku)?Bt="<"+Lt+"."+(+Xu+1)+".0":Qo?Bt="<="+Lt+"."+Xu+"."+Ku+"-"+Qo:Bt="<="+Bt,(G+" "+Bt).trim()}Wn.prototype.test=function(R){if(!R)return!1;typeof R=="string"&&(R=new dt(R,this.options));for(var G=0;G<this.set.length;G++)if(N_e(this.set[G],R,this.options))return!0;return!1};function N_e(R,G,Q){for(var ve=0;ve<R.length;ve++)if(!R[ve].test(G))return!1;if(G.prerelease.length&&!Q.includePrerelease){for(ve=0;ve<R.length;ve++)if(r(R[ve].semver),R[ve].semver!==zb&&R[ve].semver.prerelease.length>0){var Te=R[ve].semver;if(Te.major===G.major&&Te.minor===G.minor&&Te.patch===G.patch)return!0}return!1}return!0}t.satisfies=Rk;function Rk(R,G,Q){try{G=new Wn(G,Q)}catch{return!1}return G.test(R)}t.maxSatisfying=I_e;function I_e(R,G,Q){var ve=null,Te=null;try{var je=new Wn(G,Q)}catch{return null}return R.forEach(function(Xe){je.test(Xe)&&(!ve||Te.compare(Xe)===-1)&&(ve=Xe,Te=new dt(ve,Q))}),ve}t.minSatisfying=D_e;function D_e(R,G,Q){var ve=null,Te=null;try{var je=new Wn(G,Q)}catch{return null}return R.forEach(function(Xe){je.test(Xe)&&(!ve||Te.compare(Xe)===1)&&(ve=Xe,Te=new dt(ve,Q))}),ve}t.minVersion=O_e;function O_e(R,G){R=new Wn(R,G);var Q=new dt("0.0.0");if(R.test(Q)||(Q=new dt("0.0.0-0"),R.test(Q)))return Q;Q=null;for(var ve=0;ve<R.set.length;++ve){var Te=R.set[ve];Te.forEach(function(je){var Xe=new dt(je.semver.version);switch(je.operator){case">":Xe.prerelease.length===0?Xe.patch++:Xe.prerelease.push(0),Xe.raw=Xe.format();case"":case">=":(!Q||Lb(Q,Xe))&&(Q=Xe);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+je.operator)}})}return Q&&R.test(Q)?Q:null}t.validRange=F_e;function F_e(R,G){try{return new Wn(R,G).range||"*"}catch{return null}}t.ltr=R_e;function R_e(R,G,Q){return LF(R,G,"<",Q)}t.gtr=M_e;function M_e(R,G,Q){return LF(R,G,">",Q)}t.outside=LF;function LF(R,G,Q,ve){R=new dt(R,ve),G=new Wn(G,ve);var Te,je,Xe,Bt,Lt;switch(Q){case">":Te=Lb,je=PF,Xe=Ok,Bt=">",Lt=">=";break;case"<":Te=Ok,je=MF,Xe=Lb,Bt="<",Lt="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Rk(R,G,ve))return!1;for(var Xu=0;Xu<G.set.length;++Xu){var Ku=G.set[Xu],Qo=null,mo=null;if(Ku.forEach(function(Ef){Ef.semver===zb&&(Ef=new Zo(">=0.0.0")),Qo=Qo||Ef,mo=mo||Ef,Te(Ef.semver,Qo.semver,ve)?Qo=Ef:Xe(Ef.semver,mo.semver,ve)&&(mo=Ef)}),Qo.operator===Bt||Qo.operator===Lt||(!mo.operator||mo.operator===Bt)&&je(R,mo.semver))return!1;if(mo.operator===Lt&&Xe(R,mo.semver))return!1}return!0}t.prerelease=P_e;function P_e(R,G){var Q=qt(R,G);return Q&&Q.prerelease.length?Q.prerelease:null}t.intersects=L_e;function L_e(R,G,Q){return R=new Wn(R,Q),G=new Wn(G,Q),R.intersects(G)}t.coerce=z_e;function z_e(R){if(R instanceof dt)return R;if(typeof R!="string")return null;var G=R.match(l[J]);return G==null?null:qt(G[1]+"."+(G[2]||"0")+"."+(G[3]||"0"))}})(fP,fP.exports);var cpe=fP.exports;function co(e,t,n){return e.fields=t||[],e.fname=n,e}function ka(e){return e==null?null:e.fname}function Zs(e){return e==null?null:e.fields}function fpe(e){return e.length===1?vit(e[0]):xit(e)}const vit=e=>function(t){return t[e]},xit=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function he(e){throw Error(e)}function Hl(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||he("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&he("Access path missing closing bracket: "+e),r&&he("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Vo(e,t,n){const r=Hl(e);return e=r.length===1?r[0]:e,co((n&&n.get||fpe)(r),[e],t||e)}const xC=Vo("id"),Fl=co(e=>e,[],"identity"),dpe=co(()=>0,[],"zero"),iD=co(()=>1,[],"one"),ih=co(()=>!0,[],"true"),sc=co(()=>!1,[],"false");function wit(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const hpe=0,xU=1,wU=2,yT=3,SU=4;function CU(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wit,r=e||hpe;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=xU&&n(t||"error","ERROR",arguments),this},warn(){return r>=wU&&n(t||"warn","WARN",arguments),this},info(){return r>=yT&&n(t||"log","INFO",arguments),this},debug(){return r>=SU&&n(t||"log","DEBUG",arguments),this}}}var be=Array.isArray;function yt(e){return e===Object(e)}const YY=e=>e!=="__proto__";function Sit(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const s in i)if(s==="signals")r.signals=Cit(r.signals,i.signals);else{const o=s==="legend"?{layout:1}:s==="style"?!0:null;kU(r,s,i[s],o)}return r},{})}function kU(e,t,n,r){if(!YY(t))return;let i,s;if(yt(n)&&!be(n)){s=yt(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?kU(s,i,n[i]):YY(i)&&(s[i]=n[i])}else e[t]=n}function Cit(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function Vt(e){return e[e.length-1]}function Sr(e){return e==null||e===""?null:+e}const ppe=e=>t=>e*Math.exp(t),mpe=e=>t=>Math.log(e*t),gpe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),ype=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,bT=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function sD(e,t,n,r){const i=n(e[0]),s=n(Vt(e)),o=(s-i)*t;return[r(i-o),r(s-o)]}function bpe(e,t){return sD(e,t,Sr,Fl)}function vpe(e,t){var n=Math.sign(e[0]);return sD(e,t,mpe(n),ppe(n))}function xpe(e,t,n){return sD(e,t,bT(n),bT(1/n))}function kit(e,t,n){return sD(e,t,gpe(n),ype(n))}function oD(e,t,n,r,i){const s=r(e[0]),o=r(Vt(e)),a=t!=null?r(t):(s+o)/2;return[i(a+(s-a)*n),i(a+(o-a)*n)]}function $U(e,t,n){return oD(e,t,n,Sr,Fl)}function _U(e,t,n){const r=Math.sign(e[0]);return oD(e,t,n,mpe(r),ppe(r))}function vT(e,t,n,r){return oD(e,t,n,bT(r),bT(1/r))}function $it(e,t,n,r){return oD(e,t,n,gpe(r),ype(r))}function _it(e){return 1+~~(new Date(e).getMonth()/3)}function Eit(e){return 1+~~(new Date(e).getUTCMonth()/3)}function xt(e){return e!=null?be(e)?e:[e]:[]}function Tit(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function Ot(e){return typeof e=="function"}const Ait="descending";function EU(e,t,n){n=n||{},t=xt(t)||[];const r=[],i=[],s={},o=n.comparator||Nit;return xt(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===Ait?-1:1),i.push(a=Ot(a)?a:Vo(a,null,n)),(Zs(a)||[]).forEach(l=>s[l]=1))}),i.length===0?null:co(o(i,r),Object.keys(s))}const TU=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),Nit=(e,t)=>e.length===1?Iit(e[0],t[0]):Dit(e,t,e.length),Iit=(e,t)=>function(n,r){return TU(e(n),e(r))*t},Dit=(e,t,n)=>(t.push(0),function(r,i){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=TU(s(r),s(i));return o*t[a]});function Rl(e){return Ot(e)?e:()=>e}function AU(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function on(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Oit(e,t){let n=0,r,i,s,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=o=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>o&&(o=i))}return[s,o]}function wpe(e,t){const n=e.length;let r=-1,i,s,o,a,u;if(t==null){for(;++r<n;)if(s=e[r],s!=null&&s>=s){i=o=s;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)s=e[r],s!=null&&(i>s&&(i=s,a=r),o<s&&(o=s,u=r))}else{for(;++r<n;)if(s=t(e[r],r,e),s!=null&&s>=s){i=o=s;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)s=t(e[r],r,e),s!=null&&(i>s&&(i=s,a=r),o<s&&(o=s,u=r))}return[a,u]}const Fit=Object.prototype.hasOwnProperty;function os(e,t){return Fit.call(e,t)}const p$={};function tb(e){let t={},n;function r(s){return os(t,s)&&t[s]!==p$}const i={size:0,empty:0,object:t,has:r,get(s){return r(s)?t[s]:void 0},set(s,o){return r(s)||(++i.size,t[s]===p$&&--i.empty),t[s]=o,this},delete(s){return r(s)&&(--i.size,++i.empty,t[s]=p$),this},clear(){i.size=i.empty=0,i.object=t={}},test(s){return arguments.length?(n=s,i):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==p$&&(!n||!n(u))&&(s[a]=u,++o)}i.size=o,i.empty=0,i.object=t=s}};return e&&Object.keys(e).forEach(s=>{i.set(s,e[s])}),i}function Rit(e,t,n,r,i,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=Vt(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:s}function Ne(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),on(r,n)}function Mit(e,t,n,r){let i=t[0],s=t[t.length-1],o;return i>s&&(o=i,i=s,s=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function nb(e){return typeof e=="boolean"}function Qs(e){return Object.prototype.toString.call(e)==="[object Date]"}function Pit(e){return e&&Ot(e[Symbol.iterator])}function Rr(e){return typeof e=="number"}function Spe(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function ft(e){return typeof e=="string"}function NU(e,t,n){e&&(e=t?xt(e).map(a=>a.replace(/\\(.)/g,"$1")):xt(e));const r=e&&e.length,i=n&&n.get||fpe,s=a=>i(t?[a]:Hl(a));let o;if(!r)o=function(){return""};else if(r===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}return co(o,e,"key")}function Lit(e,t){const n=e[0],r=Vt(e),i=+t;return i?i===1?r:n+i*(r-n):n}const zit=1e4;function Bit(e){e=+e||zit;let t,n,r;const i=()=>{t={},n={},r=0},s=(o,a)=>(++r>e&&(n=t,t={},r=1),t[o]=a);return i(),{clear:i,has:o=>os(t,o)||os(n,o),get:o=>os(t,o)?t[o]:os(n,o)?s(o,n[o]):void 0,set:(o,a)=>os(t,o)?t[o]=a:s(o,a)}}function Cpe(e,t,n,r){const i=t.length,s=n.length;if(!s)return t;if(!i)return n;const o=r||new t.constructor(i+s);let a=0,u=0,l=0;for(;a<i&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function Hv(e,t){let n="";for(;--t>=0;)n+=e;return n}function kpe(e,t,n,r){const i=n||" ",s=e+"",o=t-s.length;return o<=0?s:r==="left"?Hv(i,o)+s:r==="center"?Hv(i,~~(o/2))+s+Hv(i,Math.ceil(o/2)):s+Hv(i,o)}function Uit(e){return e&&Vt(e)-e[0]||0}function Fe(e){return be(e)?"["+e.map(Fe)+"]":yt(e)||ft(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function IU(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Wit=e=>Rr(e)||Qs(e)?e:Date.parse(e);function DU(e,t){return t=t||Wit,e==null||e===""?null:t(e)}function OU(e){return e==null||e===""?null:e+""}function Ft(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function $pe(e,t,n,r){const i=r??"",s=e+"",o=s.length,a=Math.max(0,t-i.length);return o<=t?s:n==="left"?i+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+i+s.slice(o-~~(a/2)):s.slice(0,a)+i}function Mf(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}function aD(e){var t=e||Fl,n=[],r={};return n.add=function(i){var s=t(i);return r[s]||(r[s]=1,n.push(i)),n},n.remove=function(i){var s=t(i),o;return r[s]&&(r[s]=0,(o=n.indexOf(i))>=0&&n.splice(o,1)),n},n}var _pe=Symbol("vega_id"),Vit=1;function uD(e){return!!(e&&Je(e))}function Je(e){return e[_pe]}function Epe(e,t){return e[_pe]=t,e}function nr(e){var t=e===Object(e)?e:{data:e};return Je(t)?t:Epe(t,Vit++)}function FU(e){return RU(e,nr({}))}function RU(e,t){for(var n in e)t[n]=e[n];return t}function Tpe(e,t){return Epe(t,Je(e))}function Ape(e){return e&&e.constructor===rb}function rb(){var e=[],t=[],n=[],r=[],i=[],s=!1;return{constructor:rb,insert:function(o){for(var a=xt(o),u=0,l=a.length;u<l;++u)e.push(a[u]);return this},remove:function(o){for(var a=Ot(o)?r:t,u=xt(o),l=0,c=u.length;l<c;++l)a.push(u[l]);return this},modify:function(o,a,u){var l={field:a,value:Rl(u)};return Ot(o)?(l.filter=o,i.push(l)):(l.tuple=o,n.push(l)),this},encode:function(o,a){return Ot(o)?i.push({filter:o,field:a}):n.push({tuple:o,field:a}),this},reflow:function(){return s=!0,this},pulse:function(o,a){var u={},l={},c,f,d,h,p,m;for(c=0,f=a.length;c<f;++c)u[Je(a[c])]=1;for(c=0,f=t.length;c<f;++c)p=t[c],u[Je(p)]=-1;for(c=0,f=r.length;c<f;++c)h=r[c],a.forEach(function(y){h(y)&&(u[Je(y)]=-1)});for(c=0,f=e.length;c<f;++c)p=e[c],m=Je(p),u[m]?u[m]=1:o.add.push(nr(e[c]));for(c=0,f=a.length;c<f;++c)p=a[c],u[Je(p)]<0&&o.rem.push(p);function g(y,b,v){v?y[b]=v(y):o.encode=b,s||(l[Je(y)]=y)}for(c=0,f=n.length;c<f;++c)d=n[c],p=d.tuple,h=d.field,m=u[Je(p)],m>0&&(g(p,h,d.value),o.modifies(h));for(c=0,f=i.length;c<f;++c)d=i[c],h=d.filter,a.forEach(function(y){h(y)&&u[Je(y)]>0&&g(y,d.field,d.value)}),o.modifies(d.field);if(s)o.mod=t.length||r.length?a.filter(function(y){return u[Je(y)]>0}):a.slice();else for(m in l)o.mod.push(l[m]);return o}}}var lD="_:mod:_";function cD(){Object.defineProperty(this,lD,{writable:!0,value:{}})}var MU=cD.prototype;MU.set=function(e,t,n,r){var i=this,s=i[e],o=i[lD];return t!=null&&t>=0?(s[t]!==n||r)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||r)&&(i[e]=n,o[e]=be(n)?1+n.length:-1),i};MU.modified=function(e,t){var n=this[lD],r;if(arguments.length){if(be(e)){for(r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]};MU.clear=function(){return this[lD]={},this};var jit=0,Hit="pulse",Git=new cD,qit=1,Xit=2;function gn(e,t,n,r){this.id=++jit,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}var sh=gn.prototype;sh.targets=function(){return this._targets||(this._targets=aD(xC))};sh.set=function(e){return this.value!==e?(this.value=e,1):0};function Npe(e){return function(t){var n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}sh.skip=Npe(qit);sh.modified=Npe(Xit);sh.parameters=function(e,t,n){t=t!==!1;var r=this,i=r._argval=r._argval||new cD,s=r._argops=r._argops||[],o=[],a,u,l,c;function f(d,h,p){p instanceof gn?(p!==r&&(t&&p.targets().add(r),o.push(p)),s.push({op:p,name:d,index:h})):i.set(d,h,p)}for(a in e)if(u=e[a],a===Hit)xt(u).forEach(function(d){d instanceof gn?d!==r&&(d.targets().add(r),o.push(d)):he("Pulse parameters must be operator instances.")}),r.source=u;else if(be(u))for(i.set(a,-1,Array(l=u.length)),c=0;c<l;++c)f(a,c,u[c]);else f(a,-1,u);return this.marshall().clear(),n&&(s.initonly=!0),o};sh.marshall=function(e){var t=this._argval||Git,n=this._argops,r,i,s,o,a;if(n){for(i=0,s=n.length;i<s;++i)r=n[i],o=r.op,a=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,a);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t};sh.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}};sh.run=function(e){if(e.stamp<=this.stamp)return e.StopPropagation;var t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.stamp=e.stamp,this.pulse=t||e};function Kit(e,t,n,r){var i=1,s;return e instanceof gn?s=e:e&&e.prototype instanceof gn?s=new e:Ot(e)?s=new gn(null,e):(i=0,s=new gn(e,t)),this.rank(s),i&&(r=n,n=t),n&&this.connect(s,s.parameters(n,r)),this.touch(s),s}function Yit(e,t){var n=e.rank,r,i;for(r=0,i=t.length;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}var Zit=0;function fD(e,t,n){this.id=++Zit,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Od(e,t,n){return new fD(e,t,n)}var Pu=fD.prototype;Pu._filter=ih;Pu._apply=Fl;Pu.targets=function(){return this._targets||(this._targets=aD(xC))};Pu.consume=function(e){return arguments.length?(this._consume=!!e,this):!!this._consume};Pu.receive=function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}};Pu.filter=function(e){var t=Od(e);return this.targets().add(t),t};Pu.apply=function(e){var t=Od(null,e);return this.targets().add(t),t};Pu.merge=function(){var e=Od();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e};Pu.throttle=function(e){var t=-1;return this.filter(function(){var n=Date.now();return n-t>e?(t=n,1):0})};Pu.debounce=function(e){var t=Od();return this.targets().add(Od(null,null,AU(e,function(n){var r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t};Pu.between=function(e,t){var n=!1;return e.targets().add(Od(null,null,function(){n=!0})),t.targets().add(Od(null,null,function(){n=!1})),this.filter(function(){return n})};function Qit(e,t,n,r){var i=this,s=Od(n,r),o=function(c){c.dataflow=i;try{s.receive(c)}catch(f){i.error(f)}finally{i.run()}},a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=xt(e);for(var u=0,l=a.length;u<l;++u)a[u].addEventListener(t,o);return s}var Jit=/^([A-Za-z]+:)?\/\//,ZY="file://";function dD(e){return{options:e||{},sanitize:tst,load:est,file:rst,http:nst}}function est(e,t){var n=this;return n.sanitize(e,t).then(function(r){var i=r.href;return r.localFile?n.file(i):n.http(i,t)})}function tst(e,t){return t=on({},this.options,t),new Promise(function(n,r){var i={href:null},s,o,a,u;if(e==null||typeof e!="string"){r("Sanitize failure, invalid URI: "+Fe(e));return}o=Jit.test(e),(u=t.baseURL)&&!o&&(!ER(e,"/")&&u[u.length-1]!=="/"&&(e="/"+e),e=u+e),a=(s=ER(e,ZY))||t.mode==="file"||t.mode!=="http"&&!o&&Ipe(),s?e=e.slice(ZY.length):ER(e,"//")&&(t.defaultProtocol==="file"?(e=e.slice(2),a=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!a}),i.href=e,t.target&&(i.target=t.target+""),n(i)})}function nst(e,t){return ist(e,on({},this.options.http,t)).then(function(n){if(!n.ok)throw n.status+""+n.statusText;return n.text()})}function rst(e){return new Promise(function(t,n){var r=Ipe();r?r.readFile(e,function(i,s){i?n(i):t(s)}):n("No file system access for "+e)})}function ist(e,t){var n=typeof fetch=="function"?fetch:require("node-fetch");return n?n(e,t):Promise.reject("No fetch method available.")}function Ipe(){var e=typeof require=="function"&&require("fs");return e&&Ot(e.readFile)?e:null}function ER(e,t){return e==null?!1:e.lastIndexOf(t,0)===0}var dP={boolean:IU,integer:Sr,number:Sr,date:DU,string:OU,unknown:Fl},m$=[ast,lst,Fpe,ust],sst=["boolean","integer","number","date"];function Dpe(e,t){if(!e||!e.length)return"unknown";var n,r,i,s=0,o=e.length,a=m$.length,u=m$.map(function(l,c){return c+1});for(r=0,o=e.length;r<o;++r)for(n=t?e[r][t]:e[r],i=0;i<a;++i)if(u[i]&&ost(n)&&!m$[i](n)&&(u[i]=0,++s,s===m$.length))return"string";return s=u.reduce(function(l,c){return l===0?c:l},0)-1,sst[s]}function Ope(e,t){return t.reduce(function(n,r){return n[r]=Dpe(e,r),n},{})}function ost(e){return e!=null&&e===e}function ast(e){return e==="true"||e==="false"||e===!0||e===!1}function ust(e){return!isNaN(Date.parse(e))}function Fpe(e){return!isNaN(+e)&&!(e instanceof Date)}function lst(e){return Fpe(e)&&(e=+e)===~~e}var QY={},TR={},AR=34,Jb=10,NR=13;function Rpe(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function cst(e,t){var n=Rpe(e);return function(r,i){return t(n(r),i,e)}}function JY(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Os(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function fst(e){return e<0?"-"+Os(-e,6):e>9999?"+"+Os(e,6):Os(e,4)}function dst(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":fst(e.getUTCFullYear())+"-"+Os(e.getUTCMonth()+1,2)+"-"+Os(e.getUTCDate(),2)+(i?"T"+Os(t,2)+":"+Os(n,2)+":"+Os(r,2)+"."+Os(i,3)+"Z":r?"T"+Os(t,2)+":"+Os(n,2)+":"+Os(r,2)+"Z":n||t?"T"+Os(t,2)+":"+Os(n,2)+"Z":"")}function hst(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,m=i(f,function(g,y){if(h)return h(g,y-1);p=g,h=d?cst(g,d):Rpe(g)});return m.columns=p||[],m}function i(f,d){var h=[],p=f.length,m=0,g=0,y,b=p<=0,v=!1;f.charCodeAt(p-1)===Jb&&--p,f.charCodeAt(p-1)===NR&&--p;function x(){if(b)return TR;if(v)return v=!1,QY;var S,C=m,k;if(f.charCodeAt(C)===AR){for(;m++<p&&f.charCodeAt(m)!==AR||f.charCodeAt(++m)===AR;);return(S=m)>=p?b=!0:(k=f.charCodeAt(m++))===Jb?v=!0:k===NR&&(v=!0,f.charCodeAt(m)===Jb&&++m),f.slice(C+1,S-1).replace(/""/g,'"')}for(;m<p;){if((k=f.charCodeAt(S=m++))===Jb)v=!0;else if(k===NR)v=!0,f.charCodeAt(m)===Jb&&++m;else if(k!==n)continue;return f.slice(C,S)}return b=!0,f.slice(C,p)}for(;(y=x())!==TR;){for(var w=[];y!==QY&&y!==TR;)w.push(y),y=x();d&&(w=d(w,g++))==null||h.push(w)}return h}function s(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=JY(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function a(f,d){return d==null&&(d=JY(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?dst(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function eZ(e){return function(t,n){var r={delimiter:e};return Mpe(t,n?on(n,r):r)}}function Mpe(e,t){return t.header&&(e=t.header.map(Fe).join(t.delimiter)+`
`+e),hst(t.delimiter).parse(e+"")}function pst(e){return typeof Buffer=="function"&&Ot(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Ppe(e,t){var n=t&&t.property?Vo(t.property):Fl;return yt(e)&&!pst(e)?mst(n(e)):n(JSON.parse(e))}function mst(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}function gst(e){return e}function yst(e){if(e==null)return gst;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+s,f[1]=(n+=a[1])*i+o;l<c;)f[l]=a[l],++l;return f}}function bst(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function vst(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return tZ(e,n)})}:tZ(e,t)}function tZ(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=Lpe(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function Lpe(e,t){var n=yst(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&bst(f,p)}function s(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function xst(e,t){var n={},r={},i={},s=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var m=p===h?h:h.concat(p);r[m.start=h.start]=i[m.end=p.end]=m}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var g=p===h?h:p.concat(h);r[g.start=p.start]=i[g.end=h.end]=g}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function wst(e){return Lpe(e,Sst.apply(this,arguments))}function Sst(e,t,n){var r,i,s;if(arguments.length>1)r=Cst(e,t,n);else for(i=0,r=new Array(s=e.arcs.length);i<s;++i)r[i]=i;return{type:"MultiLineString",arcs:xst(e,r)}}function Cst(e,t,n){var r=[],i=[],s;function o(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}function kst(e,t){var n,r,i;return e=Ppe(e,t),n=t&&(i=t.feature)?vst:t&&(i=t.mesh)?wst:he("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r):he("Invalid TopoJSON object: "+i),r&&r.features||[r]}var j_={dsv:Mpe,csv:eZ(","),tsv:eZ("	"),json:Ppe,topojson:kst};function zpe(e,t){return arguments.length>1?(j_[e]=t,this):j_.hasOwnProperty(e)?j_[e]:null}var IR=new Date,DR=new Date;function ai(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return e(s=new Date(+s)),s},i.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},i.round=function(s){var o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=function(s,o){return t(s=new Date(+s),o==null?1:Math.floor(o)),s},i.range=function(s,o,a){var u=[],l;if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},i.filter=function(s){return ai(function(o){if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););})},n&&(i.count=function(s,o){return IR.setTime(+s),DR.setTime(+o),e(IR),e(DR),Math.floor(n(IR,DR))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?function(o){return r(o)%s===0}:function(o){return i.count(0,o)%s===0}):i}),i}var tm=ai(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});tm.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ai(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):tm};tm.range;var xT=1e3,nm=6e4,wT=36e5,Bpe=864e5,Upe=6048e5,wC=ai(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*xT)},function(e,t){return(t-e)/xT},function(e){return e.getUTCSeconds()});wC.range;var PU=ai(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*xT)},function(e,t){e.setTime(+e+t*nm)},function(e,t){return(t-e)/nm},function(e){return e.getMinutes()});PU.range;var LU=ai(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*xT-e.getMinutes()*nm)},function(e,t){e.setTime(+e+t*wT)},function(e,t){return(t-e)/wT},function(e){return e.getHours()});LU.range;var SC=ai(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*nm)/Bpe},function(e){return e.getDate()-1});SC.range;function qm(e){return ai(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*nm)/Upe})}var hD=qm(0),ST=qm(1),$st=qm(2),_st=qm(3),J0=qm(4),Est=qm(5),Tst=qm(6);hD.range;ST.range;$st.range;_st.range;J0.range;Est.range;Tst.range;var zU=ai(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});zU.range;var Yc=ai(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Yc.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ai(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};Yc.range;var BU=ai(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*nm)},function(e,t){return(t-e)/nm},function(e){return e.getUTCMinutes()});BU.range;var UU=ai(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*wT)},function(e,t){return(t-e)/wT},function(e){return e.getUTCHours()});UU.range;var CC=ai(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Bpe},function(e){return e.getUTCDate()-1});CC.range;function Xm(e){return ai(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/Upe})}var pD=Xm(0),CT=Xm(1),Ast=Xm(2),Nst=Xm(3),e1=Xm(4),Ist=Xm(5),Dst=Xm(6);pD.range;CT.range;Ast.range;Nst.range;e1.range;Ist.range;Dst.range;var WU=ai(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()});WU.range;var Zc=ai(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Zc.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ai(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};Zc.range;function OR(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function FR(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ev(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Ost(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=tv(i),c=nv(i),f=tv(s),d=nv(s),h=tv(o),p=nv(o),m=tv(a),g=nv(a),y=tv(u),b=nv(u),v={a:V,A:F,b:B,B:q,c:null,d:aZ,e:aZ,f:not,g:dot,G:pot,H:Jst,I:eot,j:tot,L:Wpe,m:rot,M:iot,p:J,q:ne,Q:cZ,s:fZ,S:sot,u:oot,U:aot,V:uot,w:lot,W:cot,x:null,X:null,y:fot,Y:hot,Z:mot,"%":lZ},x={a:re,A:ae,b:le,B:me,c:null,d:uZ,e:uZ,f:vot,g:Aot,G:Iot,H:got,I:yot,j:bot,L:jpe,m:xot,M:wot,p:Oe,q:Me,Q:cZ,s:fZ,S:Sot,u:Cot,U:kot,V:$ot,w:_ot,W:Eot,x:null,X:null,y:Tot,Y:Not,Z:Dot,"%":lZ},w={a:_,A:T,b:D,B:O,c:M,d:sZ,e:sZ,f:Kst,g:iZ,G:rZ,H:oZ,I:oZ,j:Hst,L:Xst,m:jst,M:Gst,p:E,q:Vst,Q:Zst,s:Qst,S:qst,u:Lst,U:zst,V:Bst,w:Pst,W:Ust,x:I,X:P,y:iZ,Y:rZ,Z:Wst,"%":Yst};v.x=S(n,v),v.X=S(r,v),v.c=S(t,v),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(X,oe){return function(fe){var W=[],Ve=-1,ke=0,Ke=X.length,He,Z,Ee;for(fe instanceof Date||(fe=new Date(+fe));++Ve<Ke;)X.charCodeAt(Ve)===37&&(W.push(X.slice(ke,Ve)),(Z=nZ[He=X.charAt(++Ve)])!=null?He=X.charAt(++Ve):Z=He==="e"?" ":"0",(Ee=oe[He])&&(He=Ee(fe,Z)),W.push(He),ke=Ve+1);return W.push(X.slice(ke,Ve)),W.join("")}}function C(X,oe){return function(fe){var W=ev(1900,void 0,1),Ve=k(W,X,fe+="",0),ke,Ke;if(Ve!=fe.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(oe&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(ke=FR(ev(W.y,0,1)),Ke=ke.getUTCDay(),ke=Ke>4||Ke===0?CT.ceil(ke):CT(ke),ke=CC.offset(ke,(W.V-1)*7),W.y=ke.getUTCFullYear(),W.m=ke.getUTCMonth(),W.d=ke.getUTCDate()+(W.w+6)%7):(ke=OR(ev(W.y,0,1)),Ke=ke.getDay(),ke=Ke>4||Ke===0?ST.ceil(ke):ST(ke),ke=SC.offset(ke,(W.V-1)*7),W.y=ke.getFullYear(),W.m=ke.getMonth(),W.d=ke.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),Ke="Z"in W?FR(ev(W.y,0,1)).getUTCDay():OR(ev(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(Ke+5)%7:W.w+W.U*7-(Ke+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,FR(W)):OR(W)}}function k(X,oe,fe,W){for(var Ve=0,ke=oe.length,Ke=fe.length,He,Z;Ve<ke;){if(W>=Ke)return-1;if(He=oe.charCodeAt(Ve++),He===37){if(He=oe.charAt(Ve++),Z=w[He in nZ?oe.charAt(Ve++):He],!Z||(W=Z(X,fe,W))<0)return-1}else if(He!=fe.charCodeAt(W++))return-1}return W}function E(X,oe,fe){var W=l.exec(oe.slice(fe));return W?(X.p=c[W[0].toLowerCase()],fe+W[0].length):-1}function _(X,oe,fe){var W=h.exec(oe.slice(fe));return W?(X.w=p[W[0].toLowerCase()],fe+W[0].length):-1}function T(X,oe,fe){var W=f.exec(oe.slice(fe));return W?(X.w=d[W[0].toLowerCase()],fe+W[0].length):-1}function D(X,oe,fe){var W=y.exec(oe.slice(fe));return W?(X.m=b[W[0].toLowerCase()],fe+W[0].length):-1}function O(X,oe,fe){var W=m.exec(oe.slice(fe));return W?(X.m=g[W[0].toLowerCase()],fe+W[0].length):-1}function M(X,oe,fe){return k(X,t,oe,fe)}function I(X,oe,fe){return k(X,n,oe,fe)}function P(X,oe,fe){return k(X,r,oe,fe)}function V(X){return o[X.getDay()]}function F(X){return s[X.getDay()]}function B(X){return u[X.getMonth()]}function q(X){return a[X.getMonth()]}function J(X){return i[+(X.getHours()>=12)]}function ne(X){return 1+~~(X.getMonth()/3)}function re(X){return o[X.getUTCDay()]}function ae(X){return s[X.getUTCDay()]}function le(X){return u[X.getUTCMonth()]}function me(X){return a[X.getUTCMonth()]}function Oe(X){return i[+(X.getUTCHours()>=12)]}function Me(X){return 1+~~(X.getUTCMonth()/3)}return{format:function(X){var oe=S(X+="",v);return oe.toString=function(){return X},oe},parse:function(X){var oe=C(X+="",!1);return oe.toString=function(){return X},oe},utcFormat:function(X){var oe=S(X+="",x);return oe.toString=function(){return X},oe},utcParse:function(X){var oe=C(X+="",!0);return oe.toString=function(){return X},oe}}}var nZ={"-":"",_:" ",0:"0"},ui=/^\s*\d+/,Fst=/^%/,Rst=/[\\^$*+?|[\]().{}]/g;function Ht(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function Mst(e){return e.replace(Rst,"\\$&")}function tv(e){return new RegExp("^(?:"+e.map(Mst).join("|")+")","i")}function nv(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function Pst(e,t,n){var r=ui.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Lst(e,t,n){var r=ui.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function zst(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Bst(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Ust(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function rZ(e,t,n){var r=ui.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function iZ(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Wst(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Vst(e,t,n){var r=ui.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function jst(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function sZ(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Hst(e,t,n){var r=ui.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function oZ(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Gst(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function qst(e,t,n){var r=ui.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Xst(e,t,n){var r=ui.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Kst(e,t,n){var r=ui.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Yst(e,t,n){var r=Fst.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Zst(e,t,n){var r=ui.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Qst(e,t,n){var r=ui.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function aZ(e,t){return Ht(e.getDate(),t,2)}function Jst(e,t){return Ht(e.getHours(),t,2)}function eot(e,t){return Ht(e.getHours()%12||12,t,2)}function tot(e,t){return Ht(1+SC.count(Yc(e),e),t,3)}function Wpe(e,t){return Ht(e.getMilliseconds(),t,3)}function not(e,t){return Wpe(e,t)+"000"}function rot(e,t){return Ht(e.getMonth()+1,t,2)}function iot(e,t){return Ht(e.getMinutes(),t,2)}function sot(e,t){return Ht(e.getSeconds(),t,2)}function oot(e){var t=e.getDay();return t===0?7:t}function aot(e,t){return Ht(hD.count(Yc(e)-1,e),t,2)}function Vpe(e){var t=e.getDay();return t>=4||t===0?J0(e):J0.ceil(e)}function uot(e,t){return e=Vpe(e),Ht(J0.count(Yc(e),e)+(Yc(e).getDay()===4),t,2)}function lot(e){return e.getDay()}function cot(e,t){return Ht(ST.count(Yc(e)-1,e),t,2)}function fot(e,t){return Ht(e.getFullYear()%100,t,2)}function dot(e,t){return e=Vpe(e),Ht(e.getFullYear()%100,t,2)}function hot(e,t){return Ht(e.getFullYear()%1e4,t,4)}function pot(e,t){var n=e.getDay();return e=n>=4||n===0?J0(e):J0.ceil(e),Ht(e.getFullYear()%1e4,t,4)}function mot(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ht(t/60|0,"0",2)+Ht(t%60,"0",2)}function uZ(e,t){return Ht(e.getUTCDate(),t,2)}function got(e,t){return Ht(e.getUTCHours(),t,2)}function yot(e,t){return Ht(e.getUTCHours()%12||12,t,2)}function bot(e,t){return Ht(1+CC.count(Zc(e),e),t,3)}function jpe(e,t){return Ht(e.getUTCMilliseconds(),t,3)}function vot(e,t){return jpe(e,t)+"000"}function xot(e,t){return Ht(e.getUTCMonth()+1,t,2)}function wot(e,t){return Ht(e.getUTCMinutes(),t,2)}function Sot(e,t){return Ht(e.getUTCSeconds(),t,2)}function Cot(e){var t=e.getUTCDay();return t===0?7:t}function kot(e,t){return Ht(pD.count(Zc(e)-1,e),t,2)}function Hpe(e){var t=e.getUTCDay();return t>=4||t===0?e1(e):e1.ceil(e)}function $ot(e,t){return e=Hpe(e),Ht(e1.count(Zc(e),e)+(Zc(e).getUTCDay()===4),t,2)}function _ot(e){return e.getUTCDay()}function Eot(e,t){return Ht(CT.count(Zc(e)-1,e),t,2)}function Tot(e,t){return Ht(e.getUTCFullYear()%100,t,2)}function Aot(e,t){return e=Hpe(e),Ht(e.getUTCFullYear()%100,t,2)}function Not(e,t){return Ht(e.getUTCFullYear()%1e4,t,4)}function Iot(e,t){var n=e.getUTCDay();return e=n>=4||n===0?e1(e):e1.ceil(e),Ht(e.getUTCFullYear()%1e4,t,4)}function Dot(){return"+0000"}function lZ(){return"%"}function cZ(e){return+e}function fZ(e){return Math.floor(+e/1e3)}var Eg,VU,jU,HU,GU;Gpe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Gpe(e){return Eg=Ost(e),VU=Eg.format,jU=Eg.parse,HU=Eg.utcFormat,GU=Eg.utcParse,Eg}function qU(e,t,n){t=t||{};var r=zpe(t.type||"json");return r||he("Unknown data format type: "+t.type),e=r(e,t),t.parse&&Oot(e,t.parse,n),e.hasOwnProperty("columns")&&delete e.columns,e}function Oot(e,t,n){if(e.length){n=n||jU;var r=e.columns||Object.keys(e[0]),i,s,o,a,u,l,c;for(t==="auto"&&(t=Ope(e,r)),r=Object.keys(t),i=r.map(function(f){var d=t[f],h,p;if(d&&(d.indexOf("date:")===0||d.indexOf("utc:")===0))return h=d.split(/:(.+)?/,2),p=h[1],(p[0]==="'"&&p[p.length-1]==="'"||p[0]==='"'&&p[p.length-1]==='"')&&(p=p.slice(1,-1)),h[0]==="utc"?GU(p):n(p);if(!dP[d])throw Error("Illegal format pattern: "+f+":"+d);return dP[d]}),a=0,l=e.length,c=r.length;a<l;++a)for(s=e[a],u=0;u<c;++u)o=r[u],s[o]=i[u](s[o])}}function Fot(e,t,n){return this.pulse(e,this.changeset().insert(qU(t,n)))}function Rot(e){var t,n,r=new Promise(function(i,s){t=function(){i(e)},n=s});return r.requests=0,r.done=function(){--r.requests===0&&e.runAfter(function(){e._pending=null;try{e.run(),e._pending?e._pending.then(t):t()}catch(i){n(i)}})},e._pending=r}function Mot(e,t,n){var r=this,i=0,s=r._pending||Rot(r);return s.requests+=1,r.loader().load(t,{context:"dataflow"}).then(function(o){return qU(o,n)},function(o){i=-1,r.error("Loading failed",t,o)}).catch(function(o){i=-2,r.error("Data ingestion failed",t,o)}).then(function(o){return r.pulse(e,r.changeset().remove(ih).insert(o||[])),s.done(),i})}var Pot={skip:!0};function Lot(e,t,n,r,i){var s=e instanceof gn?Bot:zot;return s(this,e,t,n,r,i),this}function zot(e,t,n,r,i,s){var o=on({},s,Pot),a,u;Ot(n)||(n=Rl(n)),r===void 0?a=function(l){e.touch(n(l))}:Ot(r)?(u=new gn(null,r,i,!1),a=function(l){var c,f=n(l);u.evaluate(l),Ape(c=u.value)?e.pulse(f,c,s):e.update(f,c,o)}):a=function(l){e.update(n(l),r,o)},t.apply(a)}function Bot(e,t,n,r,i,s){var o,a;r===void 0?a=n:(o=Ot(r)?r:Rl(r),r=n?function(u,l){var c=o(u,l);return n.skip()||(n.skip(c!==this.value).value=c),c}:o,a=new gn(null,r,i,!1),a.modified(s&&s.force),a.rank=0,n&&(a.skip(!0),a.value=n.value,a.targets().add(n))),t.targets().add(a)}function Uot(e){e.rank=++this._rank}function Wot(e){for(var t=[e],n,r,i;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&he("Cycle detected in dataflow graph.")}var kT={},Gl=1,oh=2,pf=4,Vot=Gl|oh,qpe=Gl|pf,t1=Gl|oh|pf,Xpe=8,kC=16,Kpe=32,Ype=64;function ah(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}var Yn=ah.prototype;Yn.StopPropagation=kT;Yn.ADD=Gl;Yn.REM=oh;Yn.MOD=pf;Yn.ADD_REM=Vot;Yn.ADD_MOD=qpe;Yn.ALL=t1;Yn.REFLOW=Xpe;Yn.SOURCE=kC;Yn.NO_SOURCE=Kpe;Yn.NO_FIELDS=Ype;Yn.fork=function(e){return new ah(this.dataflow).init(this,e)};Yn.clone=function(){var e=this.fork(t1);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(t1|kC)};Yn.addAll=function(){var e=this;return!this.source||this.source.length===this.add.length||(e=new ah(this.dataflow).init(this),e.add=e.source),e};Yn.init=function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&Ype)&&(n.fields=e.fields),t&Gl?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&oh?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&pf?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Kpe?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source),n};Yn.runAfter=function(e){this.dataflow.runAfter(e)};Yn.changed=function(e){var t=e||t1;return t&Gl&&this.add.length||t&oh&&this.rem.length||t&pf&&this.mod.length};Yn.reflow=function(e){if(e)return this.fork(t1).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(pf,Zpe(this,Gl))),this};Yn.modifies=function(e){var t=xt(e),n=this.fields||(this.fields={});return t.forEach(function(r){n[r]=!0}),this};Yn.modified=function(e){var t=this.fields;return this.mod.length&&t?arguments.length?be(e)?e.some(function(n){return t[n]}):t[e]:!!t:!1};Yn.filter=function(e,t){var n=this;return e&Gl&&(n.addF=g$(n.addF,t)),e&oh&&(n.remF=g$(n.remF,t)),e&pf&&(n.modF=g$(n.modF,t)),e&kC&&(n.srcF=g$(n.srcF,t)),n};function g$(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}Yn.materialize=function(e){e=e||t1;var t=this;return e&Gl&&t.addF&&(t.add=RR(t.add,t.addF),t.addF=null),e&oh&&t.remF&&(t.rem=RR(t.rem,t.remF),t.remF=null),e&pf&&t.modF&&(t.mod=RR(t.mod,t.modF),t.modF=null),e&kC&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t};function RR(e,t){var n=[];return Mf(e,t,function(r){n.push(r)}),n}function Zpe(e,t){var n={};return e.visit(t,function(r){n[Je(r)]=1}),function(r){return n[Je(r)]?null:r}}Yn.visit=function(e,t){var n=this,r=t,i,s;return e&kC?(Mf(n.source,n.srcF,r),n):(e&Gl&&Mf(n.add,n.addF,r),e&oh&&Mf(n.rem,n.remF,r),e&pf&&Mf(n.mod,n.modF,r),e&Xpe&&(i=n.source)&&(s=n.add.length+n.mod.length,s===i.length||(s?Mf(i,Zpe(n,qpe),r):Mf(i,n.srcF,r))),n)};function XU(e,t,n,r){var i=this,s=0,o,a,u,l,c;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n,u=0,l=n.length;u<l;++u)if(o=n[u],o.stamp===t){if(o.fields){a=i.fields||(i.fields={});for(c in o.fields)a[c]=1}o.changed(i.ADD)&&(s|=i.ADD),o.changed(i.REM)&&(s|=i.REM),o.changed(i.MOD)&&(s|=i.MOD)}this.changes=s}var ib=Ne(XU,ah);ib.fork=function(e){var t=new ah(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,function(n){return t.add.push(n)}),e&t.REM&&this.visit(t.REM,function(n){return t.rem.push(n)}),e&t.MOD&&this.visit(t.MOD,function(n){return t.mod.push(n)})),t};ib.changed=function(e){return this.changes&e};ib.modified=function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?be(e)?e.some(function(r){return n[r]}):n[e]:0};ib.filter=function(){he("MultiPulse does not support filtering.")};ib.materialize=function(){he("MultiPulse does not support materialization.")};ib.visit=function(e,t){var n=this,r=n.pulses,i=r.length,s=0;if(e&n.SOURCE)for(;s<i;++s)r[s].visit(e,t);else for(;s<i;++s)r[s].stamp===n.stamp&&r[s].visit(e,t);return n};function jot(e){var t=this,n=0,r=t.logLevel(),i,s,o,a;if(t._pending)return t.info("Awaiting requests, delaying dataflow run."),0;if(t._pulse)return t.error("Dataflow invoked recursively. Use the runAfter method to queue invocation."),0;if(!t._touched.length)return t.info("Dataflow invoked, but nothing to do."),0;t._pulse=new ah(t,++t._clock,e),r>=yT&&(o=Date.now(),t.debug("-- START PROPAGATION ("+t._clock+") -----")),t._touched.forEach(function(l){t._enqueue(l,!0)}),t._touched=aD(xC);try{for(;t._heap.size()>0;){if(i=t._heap.pop(),i.rank!==i.qrank){t._enqueue(i,!0);continue}s=i.run(t._getPulse(i,e)),r>=SU&&t.debug(i.id,s===kT?"STOP":s,i),s!==kT&&(t._pulse=s,i._targets&&i._targets.forEach(function(l){t._enqueue(l)})),++n}}catch(l){a=l}if(t._pulses={},t._pulse=null,r>=yT&&(o=Date.now()-o,t.info("> Pulse "+t._clock+": "+n+" operators; "+o+"ms")),a&&(t._postrun=[],t.error(a)),t._onrun)try{t._onrun(t,n,a)}catch(l){t.error(l)}if(t._postrun.length){var u=t._postrun;t._postrun=[],u.sort(function(l,c){return c.priority-l.priority}).forEach(function(l){Qpe(t,l.callback)})}return this}function Qpe(e,t){try{t(e)}catch(n){e.error(n)}}function Hot(){return this._pending||this.run()&&this._pending||Promise.resolve(this)}function Got(e,t,n){this._pulse||t?this._postrun.push({priority:n||0,callback:e}):Qpe(this,e)}function qot(e,t){var n=!this._pulses[e.id];n&&(this._pulses[e.id]=this._pulse),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function Xot(e,t){var n=e.source,r=this._clock,i;return n&&be(n)?(i=n.map(function(s){return s.pulse}),new XU(this,r,i,t)):(i=this._pulses[e.id],n&&(n=n.pulse,!n||n===kT?i.source=[]:n.stamp===r&&i.target!==e?i=n:i.source=n.source),i)}var KU={skip:!1,force:!1};function Kot(e,t){var n=t||KU;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function Yot(e,t,n){var r=n||KU;return(e.set(t)||r.force)&&this.touch(e,r),this}function Zot(e,t,n){this.touch(e,n||KU);var r=new ah(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._pulses[e.id]=t.pulse(r,i),this}function Jpe(e){this.cmp=e,this.nodes=[]}var Km=Jpe.prototype;Km.size=function(){return this.nodes.length};Km.clear=function(){return this.nodes=[],this};Km.peek=function(){return this.nodes[0]};Km.push=function(e){var t=this.nodes;return t.push(e),eme(t,0,t.length-1,this.cmp)};Km.pop=function(){var e=this.nodes,t=e.pop(),n;return e.length?(n=e[0],e[0]=t,YU(e,0,this.cmp)):n=t,n};Km.replace=function(e){var t=this.nodes,n=t[0];return t[0]=e,YU(t,0,this.cmp),n};Km.pushpop=function(e){var t=this.nodes,n=t[0];return t.length&&this.cmp(n,e)<0&&(t[0]=e,e=n,YU(t,0,this.cmp)),e};function eme(e,t,n,r){var i,s,o;for(i=e[n];n>t;){if(o=n-1>>1,s=e[o],r(i,s)<0){e[n]=s,n=o;continue}break}return e[n]=i}function YU(e,t,n){for(var r=t,i=e.length,s=e[t],o=2*t+1,a;o<i;)a=o+1,a<i&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=2*t+1;return e[t]=s,eme(e,r,t,n)}function sb(){this._log=CU(),this.logLevel(xU),this._clock=0,this._rank=0;try{this._loader=dD()}catch{}this._touched=aD(xC),this._pulses={},this._pulse=null,this._heap=new Jpe(function(e,t){return e.qrank-t.qrank}),this._postrun=[]}var Fn=sb.prototype;Fn.stamp=function(){return this._clock};Fn.loader=function(e){return arguments.length?(this._loader=e,this):this._loader};Fn.cleanThreshold=1e4;Fn.add=Kit;Fn.connect=Yit;Fn.rank=Uot;Fn.rerank=Wot;Fn.pulse=Zot;Fn.touch=Kot;Fn.update=Yot;Fn.changeset=rb;Fn.ingest=Fot;Fn.request=Mot;Fn.events=Qit;Fn.on=Lot;Fn.run=jot;Fn.runAsync=Hot;Fn.runAfter=Got;Fn._enqueue=qot;Fn._getPulse=Xot;function $C(e){return function(){return this._log[e].apply(this,arguments)}}Fn.error=$C("error");Fn.warn=$C("warn");Fn.info=$C("info");Fn.debug=$C("debug");Fn.logLevel=$C("level");function ue(e,t){gn.call(this,e,null,t)}var ZU=Ne(ue,gn);ZU.run=function(e){if(e.stamp<=this.stamp)return e.StopPropagation;var t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t!==e.StopPropagation&&(this.pulse=t),this.stamp=e.stamp,t};ZU.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n};ZU.transform=function(){};var n1={};function tme(e){var t=nme(e);return t&&t.Definition||null}function nme(e){return e=e&&e.toLowerCase(),n1.hasOwnProperty(e)?n1[e]:null}function Qot(e){return function(t){for(var n=e.length,r=1,i=String(e[0](t));r<n;++r)i+="|"+e[r](t);return i}}function QU(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:Qot(e)}function rme(e,t,n){return n||e+(t?"_"+t:"")}var JU={values:Vn({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:Vn({name:"count",set:"cell.num"}),__count__:Vn({name:"count",set:"this.missing + this.valid"}),missing:Vn({name:"missing",set:"this.missing"}),valid:Vn({name:"valid",set:"this.valid"}),sum:Vn({name:"sum",init:"this.sum = 0;",add:"this.sum += +v;",rem:"this.sum -= v;",set:"this.sum"}),mean:Vn({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.valid ? this.mean : undefined"}),average:Vn({name:"average",set:"this.valid ? this.mean : undefined",req:["mean"],idx:1}),variance:Vn({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : undefined",req:["mean"],idx:1}),variancep:Vn({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : undefined",req:["variance"],idx:2}),stdev:Vn({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined",req:["variance"],idx:2}),stdevp:Vn({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined",req:["variance"],idx:2}),stderr:Vn({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined",req:["variance"],idx:2}),distinct:Vn({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:Vn({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:Vn({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:Vn({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:Vn({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:Vn({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:Vn({name:"argmin",init:"this.argmin = undefined;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = undefined;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:Vn({name:"argmax",init:"this.argmax = undefined;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = undefined;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:Vn({name:"min",init:"this.min = undefined;",add:"if (v < this.min || this.min === undefined) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:Vn({name:"max",init:"this.max = undefined;",add:"if (v > this.max || this.max === undefined) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})},mD=Object.keys(JU);function ime(e,t){return JU[e](t)}function Vn(e){return function(t){var n=on({init:"",add:"",rem:"",idx:0},e);return n.out=t||e.name,n}}function sme(e,t){return e.idx-t.idx}function Jot(e,t){function n(o,a){function u(l){o[l]||n(o,o[l]=JU[l]())}return a.req&&a.req.forEach(u),a.str&&a.str.forEach(u),o}var r=e.reduce(n,e.reduce(function(o,a){return o[a.name]=a,o},{})),i=[],s;for(s in r)i.push(r[s]);return i.sort(sme)}function ome(e,t){var n=t||Fl,r=Jot(e),i="var cell = this.cell; this.valid = 0; this.missing = 0;",s="this.cell = cell; this.init();",o="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",a="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",u="var cell = this.cell;";return r.forEach(function(l){i+=l.init,o+=l.add,a+=l.rem}),e.slice().sort(sme).forEach(function(l){u+="t['"+l.out+"']="+l.set+";"}),u+="return t;",s=Function("cell",s),s.prototype.init=Function(i),s.prototype.add=Function("v","t",o),s.prototype.rem=Function("v","t",a),s.prototype.set=Function("t",u),s.prototype.get=n,s.fields=e.map(function(l){return l.out}),s}function Fc(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function eat(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function eW(e){let t,n,r;e.length!==2?(t=Fc,n=(a,u)=>Fc(e(a),u),r=(a,u)=>e(a)-u):(t=e===Fc||e===eat?e:tat,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:o,right:s}}function tat(){return 0}function ame(e){return e===null?NaN:+e}function*nat(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const rat=eW(Fc),rm=rat.right;eW(ame).center;function iat(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i))}if(n>1)return s/(n-1)}function sat(e,t){const n=iat(e,t);return n&&Math.sqrt(n)}let im=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[r++]=a),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}};class dZ extends Map{constructor(t,n=uat){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(hZ(this,t))}has(t){return super.has(hZ(this,t))}set(t,n){return super.set(oat(this,t),n)}delete(t){return super.delete(aat(this,t))}}function hZ({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function oat({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function aat({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function uat(e){return e!==null&&typeof e=="object"?e.valueOf():e}function lat(e=Fc){if(e===Fc)return ume;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function ume(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const cat=Math.sqrt(50),fat=Math.sqrt(10),dat=Math.sqrt(2);function $T(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=cat?10:s>=fat?5:s>=dat?2:1;let a,u,l;return i<0?(l=Math.pow(10,-i)/o,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*o,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?$T(e,t,n*2):[a,u,l]}function hP(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,o]=r?$T(t,e,n):$T(e,t,n);if(!(s>=i))return[];const a=s-i+1,u=new Array(a);if(r)if(o<0)for(let l=0;l<a;++l)u[l]=(s-l)/-o;else for(let l=0;l<a;++l)u[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)u[l]=(i+l)/-o;else for(let l=0;l<a;++l)u[l]=(i+l)*o;return u}function pP(e,t,n){return t=+t,e=+e,n=+n,$T(e,t,n)[2]}function mP(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?pP(t,e,n):pP(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function pZ(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function mZ(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function lme(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?ume:lat(i);r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));lme(e,t,h,p,i)}const s=e[t];let o=n,a=r;for(rv(e,n,t),i(e[r],s)>0&&rv(e,n,r);o<a;){for(rv(e,o,a),++o,--a;i(e[o],s)<0;)++o;for(;i(e[a],s)>0;)--a}i(e[n],s)===0?rv(e,n,a):(++a,rv(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function rv(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function gP(e,t,n){if(e=Float64Array.from(nat(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return mZ(e);if(t>=1)return pZ(e);var r,i=(r-1)*t,s=Math.floor(i),o=pZ(lme(e,s).subarray(0,s+1)),a=mZ(e.subarray(s+1));return o+(a-o)*(i-s)}}function cme(e,t,n=ame){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(i-s)}}function hat(e,t){return gP(e,.5)}function*pat(e){for(const t of e)yield*t}function fme(e){return Array.from(pat(e))}function mat(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function*dme(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function hme(e,t,n){const r=Float64Array.from(dme(e,n));return r.sort(Fc),t.map(i=>cme(r,i))}function tW(e,t){return hme(e,[.25,.5,.75],t)}function pme(e,t){const n=e.length,r=sat(e,t),i=tW(e,t),s=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function mme(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,u,l,c,f,d;const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/r)+1,m=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+m)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Fa=Math.random;function gat(e){Fa=e}function gme(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(dme(e,r)),s=i.length,o=t;let a,u,l,c;for(l=0,c=Array(o);l<o;++l){for(a=0,u=0;u<s;++u)a+=i[~~(Fa()*s)];c[l]=a/s}return c.sort(Fc),[gP(c,n/2),gP(c,1-n/2)]}function yat(e,t,n,r){r=r||(d=>d);const i=e.length,s=new Float64Array(i);let o=0,a=1,u=r(e[0]),l=u,c=u+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(l=(u+l)/2;o<a;++o)s[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<a;++o)s[o]=l;return n?bat(s,t+t/4):s}function bat(e,t){const n=e.length;let r=0,i=1,s,o;for(;e[r]===e[i];)++i;for(;i<n;){for(s=i+1;e[i]===e[s];)++s;if(e[i]-e[i-1]<t){for(o=i+(r+s-i-i>>1);o<i;)e[o++]=e[i];for(;o>i;)e[o--]=e[r]}r=i,i=s}return e}function vat(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function xat(e,t){t==null&&(t=e,e=0);let n,r,i;const s={min(o){return arguments.length?(n=o||0,i=r-n,s):n},max(o){return arguments.length?(r=o||0,i=r-n,s):r},sample(){return n+Math.floor(i*Fa())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=r?1:(a-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return s.min(e).max(t)}const yme=Math.sqrt(2*Math.PI),wat=Math.SQRT2;let iv=NaN;function nW(e,t){e=e||0,t=t??1;let n=0,r=0,i,s;if(iv===iv)n=iv,iv=NaN;else{do n=Fa()*2-1,r=Fa()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,iv=r*s}return e+n*t}function bme(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*yme)}function rW(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const o=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,s=o*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,s=s/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,s=o/a/2.506628274631)}return r>0?1-s:s}function iW(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*wat*Sat(2*e-1)}function Sat(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function sW(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s??1,i):r},sample:()=>nW(n,r),pdf:s=>bme(s,n,r),cdf:s=>rW(s,n,r),icdf:s=>iW(s,n,r)};return i.mean(e).stdev(t)}function vme(e,t){const n=sW();let r=0;const i={data(s){return arguments.length?(e=s,r=s?s.length:0,i.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=pme(e)),i):t},sample(){return e[~~(Fa()*r)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<r;++a)o+=n.pdf((s-e[a])/t);return o/t/r},cdf(s){let o=0,a=0;for(;a<r;++a)o+=n.cdf((s-e[a])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function xme(e,t){return e=e||0,t=t??1,Math.exp(e+nW()*t)}function wme(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*yme*e)}function Sme(e,t,n){return rW(Math.log(e),t,n)}function Cme(e,t,n){return Math.exp(iW(e,t,n))}function Cat(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s??1,i):r},sample:()=>xme(n,r),pdf:s=>wme(s,n,r),cdf:s=>Sme(s,n,r),icdf:s=>Cme(s,n,r)};return i.mean(e).stdev(t)}function kme(e,t){let n=0,r;function i(o){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)a[l]/=u;return a}const s={weights(o){return arguments.length?(r=i(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Fa();let a=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(o<u){a=e[l];break}return a.sample()},pdf(o){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(o);return a},cdf(o){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function $me(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Fa()}function _me(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function Eme(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Tme(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Ame(e,t){let n,r;const i={min(s){return arguments.length?(n=s||0,i):n},max(s){return arguments.length?(r=s??1,i):r},sample:()=>$me(n,r),pdf:s=>_me(s,n,r),cdf:s=>Eme(s,n,r),icdf:s=>Tme(s,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function Nme(e,t,n){let r=0,i=0;for(const s of e){const o=n(s);t(s)==null||o==null||isNaN(o)||(r+=(o-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function _C(e,t,n,r){const i=r-e*e,s=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-s*e,s]}function gD(e,t,n,r){e=e.filter(h=>{let p=t(h),m=n(h);return p!=null&&(p=+p)>=p&&m!=null&&(m=+m)>=m}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,s=new Float64Array(i),o=new Float64Array(i);let a=0,u=0,l=0,c,f,d;for(d of e)s[a]=c=+t(d),o[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<i;++a)s[a]-=u,o[a]-=l;return[s,o,u,l]}function EC(e,t,n,r){let i=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&r(s,o,++i)}function ob(e,t,n,r,i){let s=0,o=0;return EC(e,t,n,(a,u)=>{const l=u-i(a),c=u-r;s+=l*l,o+=c*c}),1-s/o}function Ime(e,t,n){let r=0,i=0,s=0,o=0,a=0;EC(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=_C(r,i,s,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:ob(e,t,n,i,l)}}function kat(e,t,n){let r=0,i=0,s=0,o=0,a=0;EC(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=_C(r,i,s,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:ob(e,t,n,i,l)}}function $at(e,t,n){const[r,i,s,o]=gD(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;EC(e,t,n,(b,v)=>{d=r[f++],h=Math.log(v),p=d*v,a+=(v*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[m,g]=_C(u/o,a/o,l/o,c/o),y=b=>Math.exp(m+g*(b-s));return{coef:[Math.exp(m-g*s),g],predict:y,rSquared:ob(e,t,n,o,y)}}function _at(e,t,n){let r=0,i=0,s=0,o=0,a=0,u=0;EC(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,s+=(h*p-s)/u,o+=(h*h-o)/u,a+=(d-a)/u});const l=_C(r,i,s,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:ob(e,t,n,a,c)}}function Dme(e,t,n){const[r,i,s,o]=gD(e,t,n),a=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,m,g;for(h=0;h<a;)p=r[h],m=i[h++],g=p*p,u+=(g-u)/h,l+=(g*p-l)/h,c+=(g*g-c)/h,f+=(p*m-f)/h,d+=(g*m-d)/h;const y=c-u*u,b=u*y-l*l,v=(d*u-f*l)/b,x=(f*y-d*l)/b,w=-v*u,S=C=>(C=C-s,v*C*C+x*C+w+o);return{coef:[w-x*s+v*s*s+o,x-2*v*s,v],predict:S,rSquared:ob(e,t,n,o,S)}}function Eat(e,t,n,r){if(r===0)return Nme(e,t,n);if(r===1)return Ime(e,t,n);if(r===2)return Dme(e,t,n);const[i,s,o,a]=gD(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,m,g;for(d=0;d<f;++d){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d)*s[p];for(l.push(m),g=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d+h);g[h]=m}c.push(g)}c.push(l);const y=Aat(c),b=v=>{v-=o;let x=a+y[0]+y[1]*v+y[2]*v*v;for(d=3;d<f;++d)x+=y[d]*Math.pow(v,d);return x};return{coef:Tat(f,y,-o,a),predict:b,rSquared:ob(e,t,n,a,b)}}function Tat(e,t,n,r){const i=Array(e);let s,o,a,u;for(s=0;s<e;++s)i[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],u=1,i[s]+=a,o=1;o<=s;++o)u*=(s+1-o)/o,i[s-o]+=a*Math.pow(n,o)*u;return i[0]+=r,i}function Aat(e){const t=e.length-1,n=[];let r,i,s,o,a;for(r=0;r<t;++r){for(o=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][o])&&(o=i);for(s=r;s<t+1;++s)a=e[s][r],e[s][r]=e[s][o],e[s][o]=a;for(i=r+1;i<t;++i)for(s=t;s>=r;s--)e[s][i]-=e[s][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,s=i+1;s<t;++s)a+=e[s][i]*n[s];n[i]=(e[t][i]-a)/e[i][i]}return n}const gZ=2,yZ=1e-12;function Nat(e,t,n,r){const[i,s,o,a]=gD(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=gZ;){const p=[0,l-1];for(let g=0;g<u;++g){const y=i[g],b=p[0],v=p[1],x=y-i[b]>i[v]-y?b:v;let w=0,S=0,C=0,k=0,E=0;const _=1/Math.abs(i[x]-y||1);for(let O=b;O<=v;++O){const M=i[O],I=s[O],P=Iat(Math.abs(y-M)*_)*d[O],V=M*P;w+=P,S+=V,C+=I*P,k+=I*V,E+=M*V}const[T,D]=_C(S/w,C/w,k/w,E/w);c[g]=T+D*y,f[g]=Math.abs(s[g]-c[g]),Dat(i,g+1,p)}if(h===gZ)break;const m=hat(f);if(Math.abs(m)<yZ)break;for(let g=0,y,b;g<u;++g)y=f[g]/(6*m),d[g]=y>=1?yZ:(b=1-y*y)*b}return Oat(i,c,o,a)}function Iat(e){return(e=1-e*e*e)*e*e}function Dat(e,t,n){const r=e[t];let i=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>i&&e[s]-r<=r-e[i];)n[0]=++i,n[1]=s,++s}function Oat(e,t,n,r){const i=e.length,s=[];let o=0,a=0,u=[],l;for(;o<i;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++a:(a=0,u[1]+=r,u=[l,t[o]],s.push(u));return u[1]+=r,s}const Fat=.5*Math.PI/180;function Rat(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=m=>[m,e(m)],s=t[0],o=t[1],a=o-s,u=a/r,l=[i(s)],c=[];if(n===r){for(let m=1;m<r;++m)l.push(i(s+m/n*a));return l.push(i(o)),l}else{c.push(i(o));for(let m=n;--m>0;)c.push(i(s+m/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,p=Mat(f[1],c);for(;d;){const m=i((f[0]+d[0])/2);m[0]-f[0]>=u&&Pat(f,m,d,h,p)>Fat?c.push(m):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function Mat(e,t){let n=e,r=e;const i=t.length;for(let s=0;s<i;++s){const o=t[s][1];o<n&&(n=o),o>r&&(r=o)}return 1/(r-n)}function Pat(e,t,n,r,i){const s=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),o=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(s-o)}function oW(e){this._key=e?Vo(e):Je,this.reset()}var Si=oW.prototype;Si.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Si.add=function(e){this._add.push(e)};Si.rem=function(e){this._rem.push(e)};Si.values=function(){if(this._get=null,this._rem.length===0)return this._add;var e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,s=Array(r-i),o={},a,u,l;for(a=0;a<i;++a)o[n(t[a])]=1;for(a=0,u=0;a<r;++a)o[n(l=e[a])]?o[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};Si.distinct=function(e){for(var t=this.values(),n=t.length,r={},i=0,s;--n>=0;)s=e(t[n])+"",r.hasOwnProperty(s)||(r[s]=1,++i);return i};Si.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=wpe(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Si.argmin=function(e){return this.extent(e)[0]||{}};Si.argmax=function(e){return this.extent(e)[1]||{}};Si.min=function(e){var t=this.extent(e)[0];return t!=null?e(t):void 0};Si.max=function(e){var t=this.extent(e)[1];return t!=null?e(t):void 0};Si.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=tW(this.values(),e),this._get=e),this._q};Si.q1=function(e){return this.quartile(e)[0]};Si.q2=function(e){return this.quartile(e)[1]};Si.q3=function(e){return this.quartile(e)[2]};Si.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=gme(this.values(),1e3,.05,e),this._get=e),this._ci};Si.ci0=function(e){return this.ci(e)[0]};Si.ci1=function(e){return this.ci(e)[1]};function Ym(e){ue.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Ym.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:mD},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var Lu=Ne(Ym,ue);Lu.transform=function(e,t){var n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i;return this.stamp=r.stamp,this.value&&((i=e.modified())||t.modified(this._inputs))?(this._prev=this.value,this.value=i?this.init(e):{},t.visit(t.SOURCE,function(s){n.add(s)})):(this.value=this.value||this.init(e),t.visit(t.REM,function(s){n.rem(s)}),t.visit(t.ADD,function(s){n.add(s)})),r.modifies(this._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,this.cross()),n.changes(r)};Lu.cross=function(){var e=this,t=e.value,n=e._dnames,r=n.map(function(){return{}}),i=n.length;function s(a){var u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}s(e._prev),s(t);function o(a,u,l){var c=n[l],f=r[l++],d,h;for(d in f)u[c]=f[d],h=a?a+"|"+d:d,l<i?o(h,u,l):t[h]||e.cell(h,u)}o("",{},0)};Lu.init=function(e){var t=this._inputs=[],n=this._outputs=[],r={};function i(g){for(var y=xt(Zs(g)),b=0,v=y.length,x;b<v;++b)r[x=y[b]]||(r[x]=1,t.push(x))}this._dims=xt(e.groupby),this._dnames=this._dims.map(function(g){var y=ka(g);return i(g),n.push(y),y}),this.cellkey=e.key?e.key:QU(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var s=e.fields||[null],o=e.ops||["count"],a=e.as||[],u=s.length,l={},c,f,d,h,p,m;for(u!==o.length&&he("Unmatched number of fields and aggregate ops."),m=0;m<u;++m){if(c=s[m],f=o[m],c==null&&f!=="count"&&he("Null aggregate field specified."),h=ka(c),p=rme(f,h,a[m]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(ime(f,p))}return this._measures=this._measures.map(function(g){return ome(g,g.field)}),{}};Lu.cellkey=QU();Lu.cell=function(e,t){var n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n};Lu.newcell=function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var r=this._measures,i=r.length,s;for(n.agg=Array(i),s=0;s<i;++s)n.agg[s]=new r[s](n)}return n.store&&(n.data=new oW),n};Lu.newtuple=function(e,t){var n=this._dnames,r=this._dims,i={},s,o;for(s=0,o=r.length;s<o;++s)i[n[s]]=r[s](e);return t?Tpe(t.tuple,i):nr(i)};Lu.add=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,s;if(n.num+=1,!this._countOnly)for(n.store&&n.data.add(e),r=n.agg,i=0,s=r.length;i<s;++i)r[i].add(r[i].get(e),e)};Lu.rem=function(e){var t=this.cellkey(e),n=this.cell(t,e),r,i,s;if(n.num-=1,!this._countOnly)for(n.store&&n.data.rem(e),r=n.agg,i=0,s=r.length;i<s;++i)r[i].rem(r[i].get(e),e)};Lu.celltuple=function(e){var t=e.tuple,n=this._counts,r,i,s;for(e.store&&e.data.values(),i=0,s=n.length;i<s;++i)t[n[i]]=e.num;if(!this._countOnly)for(r=e.agg,i=0,s=r.length;i<s;++i)r[i].set(t);return t};Lu.changes=function(e){var t=this._adds,n=this._mods,r=this._prev,i=this._drop,s=e.add,o=e.rem,a=e.mod,u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?o:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e};function aW(e){ue.call(this,null,e)}aW.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var Ome=Ne(aW,ue);Ome.transform=function(e,t){var n=this._bins(e),r=n.start,i=n.step,s=e.as||["bin0","bin1"],o=s[0],a=s[1],u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(Zs(e.field))?t.ADD_MOD:t.ADD,t.visit(u,function(l){var c=n(l);l[o]=c,l[a]=c==null?null:r+i*(1+(c-r)/i)}),t.modifies(s)};Ome._bins=function(e){if(this.value&&!e.modified())return this.value;var t=e.field,n=mme(e),r=n.start,i=n.stop,s=n.step,o,a;(o=e.anchor)!=null&&(a=o-(r+s*Math.floor((o-r)/s)),r+=a,i+=a);var u=function(l){var c=t(l);return c==null?null:(c=Math.max(r,Math.min(+c,i-s)),r+s*Math.floor((c-r)/s))};return u.start=r,u.stop=i,u.step=s,this.value=co(u,Zs(t),e.name||"bin_"+ka(t))};function Fme(e,t,n){var r=e,i=t||[],s=n||[],o={},a=0;return{add:function(u){s.push(u)},remove:function(u){o[r(u)]=++a},size:function(){return i.length},data:function(u,l){return a&&(i=i.filter(function(c){return!o[r(c)]}),o={},a=0),l&&u&&i.sort(u),s.length&&(i=u?Cpe(u,i,s.sort(u)):i.concat(s),s=[]),i}}}function uW(e){ue.call(this,[],e)}uW.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};var Lat=Ne(uW,ue);Lat.transform=function(e,t){var n=t.fork(t.ALL),r=Fme(Je,this.value,n.materialize(n.ADD).add),i=e.sort,s=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(s),this.value=n.source=r.data(i,s),t.source&&t.source.root&&(this.value.root=t.source.root),n};function Rme(e){gn.call(this,null,zat,e)}Ne(Rme,gn);function zat(e){return this.value&&!e.modified()?this.value:EU(e.fields,e.orders)}function lW(e){ue.call(this,null,e)}lW.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function Bat(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}var cW=Ne(lW,ue);cW.transform=function(e,t){function n(f){return function(d){for(var h=Bat(a(d),e.case,s)||[],p,m=0,g=h.length;m<g;++m)o.test(p=h[m])||f(p)}}var r=this._parameterCheck(e,t),i=this._counts,s=this._match,o=this._stop,a=e.field,u=e.as||["text","count"],l=n(function(f){i[f]=1+(i[f]||0)}),c=n(function(f){i[f]-=1});return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)};cW._parameterCheck=function(e,t){var n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n};cW._finish=function(e,t){var n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS),a,u,l;for(a in n)u=r[a],l=n[a]||0,!u&&l?(r[a]=u=nr({}),u[i]=a,u[s]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[a]=null,r[a]=null):u[s]!==l&&(u[s]=l,o.mod.push(u));return o.modifies(t)};function fW(e){ue.call(this,null,e)}fW.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};var Uat=Ne(fW,ue);Uat.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=this.value,i=e.as||["a","b"],s=i[0],o=i[1],a=!r||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");return a?(r&&(n.rem=r),r=t.materialize(t.SOURCE).source,n.add=this.value=Wat(r,s,o,e.filter||ih)):n.mod=r,n.source=this.value,n.modifies(i)};function Wat(e,t,n,r){for(var i=[],s={},o=e.length,a=0,u,l;a<o;++a)for(s[t]=l=e[a],u=0;u<o;++u)s[n]=e[u],r(s)&&(i.push(nr(s)),s={},s[t]=l);return i}var bZ={kde:vme,mixture:kme,normal:sW,uniform:Ame},Vat="distributions",vZ="function",jat="field";function Mme(e,t){var n=e[vZ];bZ.hasOwnProperty(n)||he("Unknown distribution function: "+n);var r=bZ[n]();for(var i in e)i===jat?r.data((e.from||t()).map(e[i])):i===Vat?r[i](e[i].map(function(s){return Mme(s,t)})):typeof r[i]===vZ&&r[i](e[i]);return r}function dW(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function hW(e){let t=e,n=e;e.length===1&&(t=(o,a)=>e(o)-a,n=Hat(e));function r(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)<0?u=c+1:l=c}return u}function i(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)>0?l=c:u=c+1}return u}function s(o,a,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,a,u,l-1);return c>u&&t(o[c-1],a)>-t(o[c],a)?c-1:c}return{left:r,center:s,right:i}}function Hat(e){return(t,n)=>dW(e(t),n)}function Gat(e){return e===null?NaN:+e}function*qat(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const Pme=hW(dW),_T=Pme.right,Xat=Pme.left;hW(Gat).center;function Lme(e,t){let n,r;for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));return[n,r]}function Kat(e,t){return Array.from(t,n=>e[n])}var Yat=Math.sqrt(50),Zat=Math.sqrt(10),Qat=Math.sqrt(2);function Jat(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=Yat?i*=10:s>=Zat?i*=5:s>=Qat&&(i*=2),t<e?-i:i}function yP(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function bP(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function zme(e,t,n=0,r=e.length-1,i=dW){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));zme(e,t,h,p,i)}const s=e[t];let o=n,a=r;for(sv(e,n,t),i(e[r],s)>0&&sv(e,n,r);o<a;){for(sv(e,o,a),++o,--a;i(e[o],s)<0;)++o;for(;i(e[a],s)>0;)--a}i(e[n],s)===0?sv(e,n,a):(++a,sv(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function sv(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function eut(e,t,n){if(e=Float64Array.from(qat(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return bP(e);if(t>=1)return yP(e);var r,i=(r-1)*t,s=Math.floor(i),o=yP(zme(e,s).subarray(0,s+1)),a=bP(e.subarray(s+1));return o+(a-o)*(i-s)}}function tut(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function nut(e,t){return eut(e,.5,t)}function TC(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function rut(e,t){let n=0;for(let r of e)(r=+r)&&(n+=r);return n}function pW(e){ue.call(this,null,e)}var Bme=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],iut={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Bme},{name:"weights",type:"number",array:!0}]};pW.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number",default:100},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Bme.concat(iut)},{name:"as",type:"string",array:!0,default:["value","density"]}]};var sut=Ne(pW,ue);sut.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=Mme(e.distribution,out(t)),i=e.method||"pdf";i!=="pdf"&&i!=="cdf"&&he("Invalid density method: "+i),!e.extent&&!r.data&&he("Missing density extent parameter."),i=r[i];var s=e.as||["value","density"],o=e.extent||Lme(r.data()),a=(o[1]-o[0])/(e.steps||100),u=TC(o[0],o[1]+a/2,a).map(function(l){var c={};return c[s[0]]=l,c[s[1]]=i(l),nr(c)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n};function out(e){return function(){return e.materialize(e.SOURCE).source}}function Ume(e){gn.call(this,null,aut,e),this.modified(!0)}Ne(Ume,gn);function aut(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:co(function(n){return t(n,e)},Zs(t),ka(t))}function mW(e){ue.call(this,[void 0,void 0],e)}mW.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};var uut=Ne(mW,ue);uut.transform=function(e,t){var n=this.value,r=e.field,i=n[0],s=n[1],o;o=t.changed()||t.modified(r.fields)||e.modified("field"),(o||i==null)&&(i=1/0,s=-1/0),t.visit(o?t.SOURCE:t.ADD,function(a){var u=r(a);u!=null&&(u=+u,u<i&&(i=u),u>s&&(s=u))}),(!isFinite(i)||!isFinite(s))&&(i=s=void 0),this.value=[i,s]};function gW(e,t){gn.call(this,e),this.parent=t}var ab=Ne(gW,gn);ab.connect=function(e){return this.targets().add(e),e.source=this};ab.add=function(e){this.value.add.push(e)};ab.rem=function(e){this.value.rem.push(e)};ab.mod=function(e){this.value.mod.push(e)};ab.init=function(e){this.value.init(e,e.NO_SOURCE)};ab.evaluate=function(){return this.value};function yD(e){ue.call(this,{},e),this._keys=tb();var t=this._targets=[];t.active=0,t.forEach=function(n){for(var r=0,i=t.active;r<i;++r)n(t[r],r,t)}}var yW=Ne(yD,ue);yW.activate=function(e){this._targets[this._targets.active++]=e};yW.subflow=function(e,t,n,r){var i=this.value,s=i.hasOwnProperty(e)&&i[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[e])&&a.tuple,o=n.dataflow,s=o.add(new gW(n.fork(n.NO_SOURCE),this)).connect(t(o,e,a)),i[e]=s,this.activate(s)),s};yW.transform=function(e,t){var n=t.dataflow,r=this,i=e.key,s=e.subflow,o=this._keys,a=e.modified("key");function u(l){return r.subflow(l,s,t)}return this._group=e.group||{},this._targets.active=0,t.visit(t.REM,function(l){var c=Je(l),f=o.get(c);f!==void 0&&(o.delete(c),u(f).rem(l))}),t.visit(t.ADD,function(l){var c=i(l);o.set(Je(l),c),u(c).add(l)}),a||t.modified(i.fields)?t.visit(t.MOD,function(l){var c=Je(l),f=o.get(c),d=i(l);f===d?u(d).mod(l):(o.set(c,d),u(f).rem(l),u(d).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,function(l){u(o.get(Je(l))).mod(l)}),a&&t.visit(t.REFLOW,function(l){var c=Je(l),f=o.get(c),d=i(l);f!==d&&(o.set(c,d),u(f).rem(l),u(d).add(l))}),o.empty>n.cleanThreshold&&n.runAfter(o.clean),t};function Wme(e){gn.call(this,null,lut,e)}Ne(Wme,gn);function lut(e){return this.value&&!e.modified()?this.value:be(e.name)?xt(e.name).map(function(t){return Vo(t)}):Vo(e.name,e.as)}function bW(e){ue.call(this,tb(),e)}bW.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};var cut=Ne(bW,ue);cut.transform=function(e,t){var n=t.dataflow,r=this.value,i=t.fork(),s=i.add,o=i.rem,a=i.mod,u=e.expr,l=!0;t.visit(t.REM,function(f){var d=Je(f);r.has(d)?r.delete(d):o.push(f)}),t.visit(t.ADD,function(f){u(f,e)?s.push(f):r.set(Je(f),1)});function c(f){var d=Je(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),s.push(f)):!h&&!p?(r.set(d,1),o.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i};function Vme(e,t){return e?e.map(function(n,r){return t[r]||ka(n)}):null}function vW(e){ue.call(this,[],e)}vW.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0}]};var fut=Ne(vW,ue);fut.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=Vme(r,e.as||[]),s=i.length;return n.rem=this.value,t.visit(t.SOURCE,function(o){for(var a=r.map(function(h){return h(o)}),u=a.reduce(function(h,p){return Math.max(h,p.length)},0),l=0,c,f,d;l<u;++l){for(f=FU(o),c=0;c<s;++c)f[i[c]]=(d=a[c][l])==null?null:d;n.add.push(f)}}),this.value=n.source=n.add,n.modifies(i)};function xW(e){ue.call(this,[],e)}xW.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};var dut=Ne(xW,ue);dut.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ka),s=e.as||["key","value"],o=s[0],a=s[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,function(l){for(var c=0,f;c<u;++c)f=FU(l),f[o]=i[c],f[a]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)};function wW(e){ue.call(this,null,e)}wW.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};var hut=Ne(wW,ue);hut.transform=function(e,t){var n=e.expr,r=e.as,i=e.modified(),s=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)?t.ADD_MOD:t.ADD;function o(a){a[r]=n(a,e)}return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(s,o)};function jme(e){ue.call(this,[],e)}var put=Ne(jme,ue);put.transform=function(e,t){var n=this.value,r=t.fork(t.ALL),i=e.size-n.length,s=e.generator,o,a,u;if(i>0){for(o=[];--i>=0;)o.push(u=nr(s(e))),n.push(u);r.add=r.add.length?r.materialize(r.ADD).add.concat(o):o}else a=n.slice(0,-i),r.rem=r.rem.length?r.materialize(r.REM).rem.concat(a):a,n=n.slice(-i);return r.source=this.value=n,r};var y$={value:"value",median:nut,mean:tut,min:bP,max:yP},mut=[];function SW(e){ue.call(this,[],e)}SW.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};var gut=Ne(SW,ue);function yut(e){var t=e.method||y$.value,n;if(y$[t]==null)he("Unrecognized imputation method: "+t);else return t===y$.value?(n=e.value!==void 0?e.value:0,function(){return n}):y$[t]}function but(e){var t=e.field;return function(n){return n?t(n):NaN}}gut.transform=function(e,t){var n=t.fork(t.ALL),r=yut(e),i=but(e),s=ka(e.field),o=ka(e.key),a=(e.groupby||[]).map(ka),u=vut(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,m,g,y,b,v,x,w;for(g=0,v=u.length;g<v;++g)for(d=u[g],p=d.values,h=NaN,b=0;b<f;++b)if(d[b]==null){for(m=u.domain[b],w={_impute:!0},y=0,x=p.length;y<x;++y)w[a[y]]=p[y];w[o]=m,w[s]=isNaN(h)?h=r(d,i):h,l.push(nr(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n};function vut(e,t,n,r){var i=function(y){return y(g)},s=[],o=r?r.slice():[],a={},u={},l,c,f,d,h,p,m,g;for(o.forEach(function(y,b){a[y]=b+1}),d=0,m=e.length;d<m;++d)g=e[d],p=n(g),h=a[p]||(a[p]=o.push(p)),c=(l=t?t.map(i):mut)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[h-1]=g;return s.domain=o,s}function CW(e){Ym.call(this,e)}CW.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:mD},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var Hme=Ne(CW,Ym);Hme.transform=function(e,t){var n=this,r=e.modified(),i;return n.value&&(r||t.modified(n._inputs))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,function(s){n.add(s)})):(i=n.value=n.value||this.init(e),t.visit(t.REM,function(s){n.rem(s)}),t.visit(t.ADD,function(s){n.add(s)})),n.changes(),t.visit(t.SOURCE,function(s){on(s,i[n.cellkey(s)].tuple)}),t.reflow(r).modifies(this._outputs)};Hme.changes=function(){var e=this._adds,t=this._mods,n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0};function Gme(e){gn.call(this,null,xut,e)}Ne(Gme,gn);function xut(e){return this.value&&!e.modified()?this.value:NU(e.fields,e.flat)}function qme(e){ue.call(this,null,e)}var wut=Ne(qme,ue);wut.transform=function(e,t){t.dataflow.request(this.target,e.url,e.format)};function kW(e){ue.call(this,{},e)}kW.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};var Sut=Ne(kW,ue);Sut.transform=function(e,t){var n=t,r=e.as,i=e.fields,s=e.index,o=e.values,a=e.default==null?null:e.default,u=e.modified(),l=u?t.SOURCE:t.ADD,c=i.length,f,d,h;return o?(d=o.length,c>1&&!r&&he('Multi-field lookup requires explicit "as" parameter.'),r&&r.length!==c*d&&he('The "as" parameter has too few output field names.'),r=r||o.map(ka),f=function(p){for(var m=0,g=0,y,b;m<c;++m)if(b=s.get(i[m](p)),b==null)for(y=0;y<d;++y,++g)p[r[g]]=a;else for(y=0;y<d;++y,++g)p[r[g]]=o[y](b)}):(r||he("Missing output field names."),f=function(p){for(var m=0,g;m<c;++m)g=s.get(i[m](p)),p[r[m]]=g??a}),u?n=t.reflow(!0):(h=i.some(function(p){return t.modified(p.fields)}),l|=h?t.MOD:0),t.visit(l,f),n.modifies(r)};function Xme(e){gn.call(this,null,Cut,e)}Ne(Xme,gn);function Cut(e){if(this.value&&!e.modified())return this.value;var t=1/0,n=-1/0,r=e.extents,i,s,o;for(i=0,s=r.length;i<s;++i)o=r[i],o[0]<t&&(t=o[0]),o[1]>n&&(n=o[1]);return[t,n]}function Kme(e){gn.call(this,null,kut,e)}Ne(Kme,gn);function kut(e){return this.value&&!e.modified()?this.value:e.values.reduce(function(t,n){return t.concat(n)},[])}function $W(e){ue.call(this,null,e)}Ne($W,ue);$W.prototype.transform=function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)};function _W(e){Ym.call(this,e)}_W.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:mD,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var vP=Ne(_W,Ym);vP._transform=vP.transform;vP.transform=function(e,t){return this._transform($ut(e,t),t)};function $ut(e,t){var n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",s=Zs(n).concat(Zs(r)),o=Eut(n,e.limit||0,t);return{key:e.key,groupby:e.groupby,ops:o.map(function(){return i}),fields:o.map(function(a){return _ut(a,n,r,s)}),as:o.map(function(a){return a+""}),modified:e.modified.bind(e)}}function _ut(e,t,n,r){return co(function(i){return t(i)===e?n(i):NaN},r,e+"")}function Eut(e,t,n){var r={},i=[];return n.visit(n.SOURCE,function(s){var o=e(s);r[o]||(r[o]=1,i.push(o))}),i.sort(function(s,o){return(s<o||s==null)&&o!=null?-1:(s>o||o==null)&&s!=null?1:(o=o instanceof Date?+o:o,(s=s instanceof Date?+s:s)!==s&&o===o?-1:o!==o&&s===s?1:0)}),t?i.slice(0,t):i}function Yme(e){yD.call(this,e)}var Tut=Ne(Yme,yD);Tut.transform=function(e,t){var n=this,r=e.subflow,i=e.field;return(e.modified("field")||i&&t.modified(Zs(i)))&&he("PreFacet does not support field modification."),this._targets.active=0,t.visit(t.MOD,function(s){var o=n.subflow(Je(s),r,t,s);i?i(s).forEach(function(a){o.mod(a)}):o.mod(s)}),t.visit(t.ADD,function(s){var o=n.subflow(Je(s),r,t,s);i?i(s).forEach(function(a){o.add(nr(a))}):o.add(s)}),t.visit(t.REM,function(s){var o=n.subflow(Je(s),r,t,s);i?i(s).forEach(function(a){o.rem(a)}):o.rem(s)}),t};function EW(e){ue.call(this,null,e)}EW.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};var Aut=Ne(EW,ue);Aut.transform=function(e,t){var n=e.fields,r=Vme(e.fields,e.as||[]),i=n?function(a,u){return Nut(a,u,n,r)}:RU,s,o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),s=t.fork(t.NO_SOURCE),t.visit(t.REM,function(a){var u=Je(a);s.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,function(a){var u=i(a,nr({}));o[Je(a)]=u,s.add.push(u)}),t.visit(t.MOD,function(a){s.mod.push(i(a,o[Je(a)]))}),s};function Nut(e,t,n,r){for(var i=0,s=n.length;i<s;++i)t[r[i]]=n[i](e);return t}function Zme(e){ue.call(this,null,e)}var Iut=Ne(Zme,ue);Iut.transform=function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};function Qme(e){ue.call(this,null,e)}var Dut=Ne(Qme,ue);Dut.transform=function(e,t){var n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,function(i){var s=Je(i);n.rem.push(r[s]),r[s]=null}),t.visit(t.ADD,function(i){var s=FU(i);r[Je(i)]=s,n.add.push(s)}),t.visit(t.MOD,function(i){n.mod.push(RU(i,r[Je(i)]))})),n};function TW(e){ue.call(this,[],e),this.count=0}TW.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};var Out=Ne(TW,ue);Out.transform=function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,s=this.value,o=this.count,a=0,u=s.reduce(function(d,h){return d[Je(h)]=1,d},{});function l(d){var h,p;s.length<i?s.push(d):(p=~~((o+1)*Fa()),p<s.length&&p>=a&&(h=s[p],u[Je(h)]&&n.rem.push(h),s[p]=d)),++o}if(t.rem.length&&(t.visit(t.REM,function(d){var h=Je(d);u[h]&&(u[h]=-1,n.rem.push(d)),--o}),s=s.filter(function(d){return u[Je(d)]!==-1})),(t.rem.length||r)&&s.length<i&&t.source&&(a=o=s.length,t.visit(t.SOURCE,function(d){u[Je(d)]||l(d)}),a=-1),r&&s.length>i){for(var c=0,f=s.length-i;c<f;++c)u[Je(s[c])]=-1,n.rem.push(s[c]);s=s.slice(f)}return t.mod.length&&t.visit(t.MOD,function(d){u[Je(d)]&&n.mod.push(d)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||a<0)&&(n.add=s.filter(function(d){return!u[Je(d)]})),this.count=o,this.value=n.source=s,n};function AW(e){ue.call(this,null,e)}AW.Definition={type:"Sequence",metadata:{changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};var Fut=Ne(AW,ue);Fut.transform=function(e,t){if(!(this.value&&!e.modified())){var n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=TC(e.start,e.stop,e.step||1).map(function(i){var s={};return s[r]=i,nr(s)}),n.add=t.add.concat(this.value),n}};function Jme(e){ue.call(this,null,e),this.modified(!0)}var Rut=Ne(Jme,ue);Rut.transform=function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};function ege(e){ue.call(this,tb(),e)}var Mut=Ne(ege,ue);Mut.transform=function(e,t){var n=t.dataflow,r=e.field,i=this.value,s=!0;function o(a){i.set(r(a),a)}return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,function(a){i.delete(r(a))}),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()};function tge(e){ue.call(this,null,e)}var Put=Ne(tge,ue);Put.transform=function(e,t){var n=!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields);n&&(this.value=(e.sort?t.source.slice().sort(e.sort):t.source).map(e.field))};function Lut(e,t,n,r){var i=zw[e](t,n);return{init:i.init||dpe,update:function(s,o){o[r]=i.next(s)}}}var zw={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=zw.rank(),t=e.next;return{init:e.init,next:function(n){return(t(n)-1)/(n.data.length-1)}}},cume_dist:function(){var e;return{init:function(){e=0},next:function(t){var n=t.index,r=t.data,i=t.compare;if(e<n){for(;n+1<r.length&&!i(r[n],r[n+1]);)++n;e=n}return(1+e)/r.length}}},ntile:function(e,t){t=+t,t>0||he("ntile num must be greater than zero.");var n=zw.cume_dist(),r=n.next;return{init:n.init,next:function(i){return Math.ceil(t*r(i))}}},lag:function(e,t){return t=+t||1,{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return t=+t,t>0||he("nth_value nth must be greater than zero."),{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}}},zut=Object.keys(zw);function nge(e){var t=this,n=xt(e.ops),r=xt(e.fields),i=xt(e.params),s=xt(e.as),o=t.outputs=[],a=t.windows=[],u={},l={},c=!0,f=[],d=[];function h(p){xt(Zs(p)).forEach(function(m){u[m]=1})}h(e.sort),n.forEach(function(p,m){var g=r[m],y=ka(g),b=rme(p,y,s[m]);if(h(g),o.push(b),zw.hasOwnProperty(p))a.push(Lut(p,r[m],i[m],b));else{if(g==null&&p!=="count"&&he("Null aggregate field specified."),p==="count"){f.push(b);return}c=!1;var v=l[y];v||(v=l[y]=[],v.field=g,d.push(v)),v.push(ime(p,b))}}),(f.length||d.length)&&(t.cell=But(d,f,c)),t.inputs=Object.keys(u)}var rge=nge.prototype;rge.init=function(){this.windows.forEach(function(e){e.init()}),this.cell&&this.cell.init()};rge.update=function(e,t){var n=this,r=n.cell,i=n.windows,s=e.data,o=i&&i.length,a;if(r){for(a=e.p0;a<e.i0;++a)r.rem(s[a]);for(a=e.p1;a<e.i1;++a)r.add(s[a]);r.set(t)}for(a=0;a<o;++a)i[a].update(e,t)};function But(e,t,n){e=e.map(function(u){return ome(u,u.field)});var r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,s=r.agg=Array(i),o=0;o<i;++o)s[o]=new e[o](r);if(r.store)var a=r.data=new oW;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(var l=0;l<i;++l)s[l].add(s[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(var l=0;l<i;++l)s[l].rem(s[l].get(u),u)}},r.set=function(u){var l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},r.init=function(){r.num=0,a&&a.reset();for(var u=0;u<i;++u)s[u].init()},r}function NW(e){ue.call(this,{},e),this._mlen=0,this._mods=[]}NW.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:zut.concat(mD)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var ige=Ne(NW,ue);ige.transform=function(e,t){var n=this,r=n.state,i=e.modified(),s,o;this.stamp=t.stamp,(!r||i)&&(r=n.state=new nge(e));var a=QU(e.groupby);function u(l){return n.group(a(l))}for(i||t.modified(r.inputs)?(n.value={},t.visit(t.SOURCE,function(l){u(l).add(l)})):(t.visit(t.REM,function(l){u(l).remove(l)}),t.visit(t.ADD,function(l){u(l).add(l)})),s=0,o=n._mlen;s<o;++s)Uut(n._mods[s],r,e);return n._mlen=0,n._mods=[],t.reflow(i).modifies(r.outputs)};ige.group=function(e){var t=this,n=t.value[e];return n||(n=t.value[e]=Fme(Je),n.stamp=-1),n.stamp<t.stamp&&(n.stamp=t.stamp,t._mods[t._mlen++]=n),n};function Uut(e,t,n){var r=n.sort,i=r&&!n.ignorePeers,s=n.frame||[null,0],o=e.data(r),a=o.length,u=0,l=i?hW(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:o,compare:r||Rl(-1)};for(t.init();u<a;++u)Wut(c,s,u,a),i&&Vut(c,l),t.update(c,o[u])}function Wut(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function Vut(e,t){var n=e.i0,r=e.i1-1,i=e.compare,s=e.data,o=s.length-1;n>0&&!i(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),r<o&&!i(s[r],s[r+1])&&(e.i1=t.right(s,s[r]))}const jut=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Ym,bin:aW,collect:uW,compare:Rme,countpattern:lW,cross:fW,density:pW,expression:Ume,extent:mW,facet:yD,field:Wme,filter:bW,flatten:vW,fold:xW,formula:wW,generate:jme,impute:SW,joinaggregate:CW,key:Gme,load:qme,lookup:kW,multiextent:Xme,multivalues:Kme,params:$W,pivot:_W,prefacet:Yme,project:EW,proxy:Zme,relay:Qme,sample:TW,sequence:AW,sieve:Jme,subflow:gW,tupleindex:ege,values:tge,window:NW},Symbol.toStringTag,{value:"Module"}));var r1="top",dl="left",pd="right",i1="bottom",Hut="top-left",Gut="top-right",qut="bottom-left",Xut="bottom-right",Kut="start",Yut="end",bD="group",sge="axis",Zut="title",Qut="frame",Jut="scope",IW="legend",oge="row-header",age="row-footer",uge="row-title",lge="column-header",cge="column-footer",fge="column-title",elt="padding",tlt="symbol",dge="fit",nlt="fit-x",rlt="fit-y",ilt="pad",slt="none",b$="all",xZ="each",olt="flush",Tg="column",Ag="row";function Es(e){this.clear(),e&&this.union(e)}var Ci=Es.prototype;Ci.clone=function(){return new Es(this)};Ci.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this};Ci.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE};Ci.set=function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this};Ci.add=function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this};Ci.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this};Ci.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this};Ci.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this};Ci.rotate=function(e,t,n){var r=Math.cos(e),i=Math.sin(e),s=t-t*r+n*i,o=n-t*i-n*r,a=this.x1,u=this.x2,l=this.y1,c=this.y2;return this.clear().add(r*a-i*l+s,i*a+r*l+o).add(r*a-i*c+s,i*a+r*c+o).add(r*u-i*l+s,i*u+r*l+o).add(r*u-i*c+s,i*u+r*c+o)};Ci.union=function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this};Ci.intersect=function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this};Ci.encloses=function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2};Ci.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)};Ci.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)};Ci.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)};Ci.width=function(){return this.x2-this.x1};Ci.height=function(){return this.y2-this.y1};var alt=0;function hge(e,t){var n=[],r;return r={id:"gradient_"+alt++,x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}function vD(e){this.mark=e,this.bounds=this.bounds||new Es}function xD(e){vD.call(this,e),this.items=this.items||[]}Ne(xD,vD);function DW(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const ult=()=>typeof Image<"u"?Image:null;function OW(e){this._pending=0,this._loader=e||dD()}var wD=OW.prototype;wD.pending=function(){return this._pending};function pge(e){e._pending+=1}function Ax(e){e._pending-=1}wD.sanitizeURL=function(e){var t=this;return pge(t),t._loader.sanitize(e,{context:"href"}).then(function(n){return Ax(t),n}).catch(function(){return Ax(t),null})};wD.loadImage=function(e){var t=this,n=ult();return pge(t),t._loader.sanitize(e,{context:"image"}).then(function(r){var i=r.href;if(!i||!n)throw{url:i};var s=new n;return s.onload=function(){Ax(t),s.loaded=!0},s.onerror=function(){Ax(t),s.loaded=!1},s.src=i,s}).catch(function(r){return Ax(t),{loaded:!1,width:0,height:0,src:r&&r.url||""}})};wD.ready=function(){var e=this;return new Promise(function(t){function n(r){e.pending()?setTimeout(function(){n(!0)},10):t(r)}n(!1)})};var xP=Math.PI,wP=2*xP,Xh=1e-6,llt=wP-Xh;function SP(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Zm(){return new SP}SP.prototype=Zm.prototype={constructor:SP,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var s=this._x1,o=this._y1,a=n-e,u=r-t,l=s-e,c=o-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Xh)if(!(Math.abs(c*a-u*l)>Xh)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-s,h=r-o,p=a*a+u*u,m=d*d+h*h,g=Math.sqrt(p),y=Math.sqrt(f),b=i*Math.tan((xP-Math.acos((p+f-m)/(2*g*y)))/2),v=b/y,x=b/g;Math.abs(v-1)>Xh&&(this._+="L"+(e+v*l)+","+(t+v*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*a)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,s){e=+e,t=+t,n=+n,s=!!s;var o=n*Math.cos(r),a=n*Math.sin(r),u=e+o,l=t+a,c=1^s,f=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>Xh||Math.abs(this._y1-l)>Xh)&&(this._+="L"+u+","+l),n&&(f<0&&(f=f%wP+wP),f>llt?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>Xh&&(this._+="A"+n+","+n+",0,"+ +(f>=xP)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function En(e){return function(){return e}}var wZ=Math.abs,Ei=Math.atan2,_h=Math.cos,clt=Math.max,MR=Math.min,Zu=Math.sin,t0=Math.sqrt,Ti=1e-12,s1=Math.PI,ET=s1/2,mge=2*s1;function flt(e){return e>1?0:e<-1?s1:Math.acos(e)}function SZ(e){return e>=1?ET:e<=-1?-ET:Math.asin(e)}function dlt(e){return e.innerRadius}function hlt(e){return e.outerRadius}function plt(e){return e.startAngle}function mlt(e){return e.endAngle}function glt(e){return e&&e.padAngle}function ylt(e,t,n,r,i,s,o,a){var u=n-e,l=r-t,c=o-i,f=a-s,d=f*u-c*l;if(!(d*d<Ti))return d=(c*(t-s)-f*(e-i))/d,[e+d*u,t+d*l]}function v$(e,t,n,r,i,s,o){var a=e-n,u=t-r,l=(o?s:-s)/t0(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,m=r+f,g=(d+p)/2,y=(h+m)/2,b=p-d,v=m-h,x=b*b+v*v,w=i-s,S=d*m-p*h,C=(v<0?-1:1)*t0(clt(0,w*w*x-S*S)),k=(S*v-b*C)/x,E=(-S*b-v*C)/x,_=(S*v+b*C)/x,T=(-S*b+v*C)/x,D=k-g,O=E-y,M=_-g,I=T-y;return D*D+O*O>M*M+I*I&&(k=_,E=T),{cx:k,cy:E,x01:-c,y01:-f,x11:k*(i/w-1),y11:E*(i/w-1)}}function blt(){var e=dlt,t=hlt,n=En(0),r=null,i=plt,s=mlt,o=glt,a=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-ET,p=s.apply(this,arguments)-ET,m=wZ(p-h),g=p>h;if(a||(a=l=Zm()),d<f&&(c=d,d=f,f=c),!(d>Ti))a.moveTo(0,0);else if(m>mge-Ti)a.moveTo(d*_h(h),d*Zu(h)),a.arc(0,0,d,h,p,!g),f>Ti&&(a.moveTo(f*_h(p),f*Zu(p)),a.arc(0,0,f,p,h,g));else{var y=h,b=p,v=h,x=p,w=m,S=m,C=o.apply(this,arguments)/2,k=C>Ti&&(r?+r.apply(this,arguments):t0(f*f+d*d)),E=MR(wZ(d-f)/2,+n.apply(this,arguments)),_=E,T=E,D,O;if(k>Ti){var M=SZ(k/f*Zu(C)),I=SZ(k/d*Zu(C));(w-=M*2)>Ti?(M*=g?1:-1,v+=M,x-=M):(w=0,v=x=(h+p)/2),(S-=I*2)>Ti?(I*=g?1:-1,y+=I,b-=I):(S=0,y=b=(h+p)/2)}var P=d*_h(y),V=d*Zu(y),F=f*_h(x),B=f*Zu(x);if(E>Ti){var q=d*_h(b),J=d*Zu(b),ne=f*_h(v),re=f*Zu(v),ae;if(m<s1&&(ae=ylt(P,V,ne,re,q,J,F,B))){var le=P-ae[0],me=V-ae[1],Oe=q-ae[0],Me=J-ae[1],X=1/Zu(flt((le*Oe+me*Me)/(t0(le*le+me*me)*t0(Oe*Oe+Me*Me)))/2),oe=t0(ae[0]*ae[0]+ae[1]*ae[1]);_=MR(E,(f-oe)/(X-1)),T=MR(E,(d-oe)/(X+1))}}S>Ti?T>Ti?(D=v$(ne,re,P,V,d,T,g),O=v$(q,J,F,B,d,T,g),a.moveTo(D.cx+D.x01,D.cy+D.y01),T<E?a.arc(D.cx,D.cy,T,Ei(D.y01,D.x01),Ei(O.y01,O.x01),!g):(a.arc(D.cx,D.cy,T,Ei(D.y01,D.x01),Ei(D.y11,D.x11),!g),a.arc(0,0,d,Ei(D.cy+D.y11,D.cx+D.x11),Ei(O.cy+O.y11,O.cx+O.x11),!g),a.arc(O.cx,O.cy,T,Ei(O.y11,O.x11),Ei(O.y01,O.x01),!g))):(a.moveTo(P,V),a.arc(0,0,d,y,b,!g)):a.moveTo(P,V),!(f>Ti)||!(w>Ti)?a.lineTo(F,B):_>Ti?(D=v$(F,B,q,J,f,-_,g),O=v$(P,V,ne,re,f,-_,g),a.lineTo(D.cx+D.x01,D.cy+D.y01),_<E?a.arc(D.cx,D.cy,_,Ei(D.y01,D.x01),Ei(O.y01,O.x01),!g):(a.arc(D.cx,D.cy,_,Ei(D.y01,D.x01),Ei(D.y11,D.x11),!g),a.arc(0,0,f,Ei(D.cy+D.y11,D.cx+D.x11),Ei(O.cy+O.y11,O.cx+O.x11),g),a.arc(O.cx,O.cy,_,Ei(O.y11,O.x11),Ei(O.y01,O.x01),!g))):a.arc(0,0,f,x,v,g)}if(a.closePath(),l)return a=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-s1/2;return[_h(c)*l,Zu(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:En(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:En(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:En(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:En(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:En(+l),u):i},u.endAngle=function(l){return arguments.length?(s=typeof l=="function"?l:En(+l),u):s},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:En(+l),u):o},u.context=function(l){return arguments.length?(a=l??null,u):a},u}function gge(e){this._context=e}gge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function FW(e){return new gge(e)}function yge(e){return e[0]}function bge(e){return e[1]}function vge(){var e=yge,t=bge,n=En(!0),r=null,i=FW,s=null;function o(a){var u,l=a.length,c,f=!1,d;for(r==null&&(s=i(d=Zm())),u=0;u<=l;++u)!(u<l&&n(c=a[u],u,a))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(c,u,a),+t(c,u,a));if(d)return s=null,d+""||null}return o.x=function(a){return arguments.length?(e=typeof a=="function"?a:En(+a),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:En(+a),o):t},o.defined=function(a){return arguments.length?(n=typeof a=="function"?a:En(!!a),o):n},o.curve=function(a){return arguments.length?(i=a,r!=null&&(s=i(r)),o):i},o.context=function(a){return arguments.length?(a==null?r=s=null:s=i(r=a),o):r},o}function xge(){var e=yge,t=null,n=En(0),r=bge,i=En(!0),s=null,o=FW,a=null;function u(c){var f,d,h,p=c.length,m,g=!1,y,b=new Array(p),v=new Array(p);for(s==null&&(a=o(y=Zm())),f=0;f<=p;++f){if(!(f<p&&i(m=c[f],f,c))===g)if(g=!g)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=f-1;h>=d;--h)a.point(b[h],v[h]);a.lineEnd(),a.areaEnd()}g&&(b[f]=+e(m,f,c),v[f]=+n(m,f,c),a.point(t?+t(m,f,c):b[f],r?+r(m,f,c):v[f]))}if(y)return a=null,y+""||null}function l(){return vge().defined(i).curve(o).context(s)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:En(+c),t=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:En(+c),u):e},u.x1=function(c){return arguments.length?(t=c==null?null:typeof c=="function"?c:En(+c),u):t},u.y=function(c){return arguments.length?(n=typeof c=="function"?c:En(+c),r=null,u):n},u.y0=function(c){return arguments.length?(n=typeof c=="function"?c:En(+c),u):n},u.y1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:En(+c),u):r},u.lineX0=u.lineY0=function(){return l().x(e).y(n)},u.lineY1=function(){return l().x(e).y(r)},u.lineX1=function(){return l().x(t).y(n)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:En(!!c),u):i},u.curve=function(c){return arguments.length?(o=c,s!=null&&(a=o(s)),u):o},u.context=function(c){return arguments.length?(c==null?s=a=null:a=o(s=c),u):s},u}const vlt={draw:function(e,t){var n=Math.sqrt(t/s1);e.moveTo(n,0),e.arc(0,0,n,0,mge)}};function xlt(){var e=En(vlt),t=En(64),n=null;function r(){var i;if(n||(n=i=Zm()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:En(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:En(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function Fd(){}function TT(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function SD(e){this._context=e}SD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:TT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:TT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wlt(e){return new SD(e)}function wge(e){this._context=e}wge.prototype={areaStart:Fd,areaEnd:Fd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:TT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Slt(e){return new wge(e)}function Sge(e){this._context=e}Sge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:TT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Clt(e){return new Sge(e)}function Cge(e,t){this._basis=new SD(e),this._beta=t}Cge.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,o=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*s),this._beta*t[a]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const klt=function e(t){function n(r){return t===1?new SD(r):new Cge(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function AT(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function RW(e,t){this._context=e,this._k=(1-t)/6}RW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:AT(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:AT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const $lt=function e(t){function n(r){return new RW(r,t)}return n.tension=function(r){return e(+r)},n}(0);function MW(e,t){this._context=e,this._k=(1-t)/6}MW.prototype={areaStart:Fd,areaEnd:Fd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:AT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const _lt=function e(t){function n(r){return new MW(r,t)}return n.tension=function(r){return e(+r)},n}(0);function PW(e,t){this._context=e,this._k=(1-t)/6}PW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:AT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Elt=function e(t){function n(r){return new PW(r,t)}return n.tension=function(r){return e(+r)},n}(0);function LW(e,t,n){var r=e._x1,i=e._y1,s=e._x2,o=e._y2;if(e._l01_a>Ti){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>Ti){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,o,e._x2,e._y2)}function kge(e,t){this._context=e,this._alpha=t}kge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:LW(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Tlt=function e(t){function n(r){return t?new kge(r,t):new RW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function $ge(e,t){this._context=e,this._alpha=t}$ge.prototype={areaStart:Fd,areaEnd:Fd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:LW(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Alt=function e(t){function n(r){return t?new $ge(r,t):new MW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function _ge(e,t){this._context=e,this._alpha=t}_ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:LW(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Nlt=function e(t){function n(r){return t?new _ge(r,t):new PW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Ege(e){this._context=e}Ege.prototype={areaStart:Fd,areaEnd:Fd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Ilt(e){return new Ege(e)}function CZ(e){return e<0?-1:1}function kZ(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),a=(s*i+o*r)/(r+i);return(CZ(s)+CZ(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function $Z(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function PR(e,t,n){var r=e._x0,i=e._y0,s=e._x1,o=e._y1,a=(s-r)/3;e._context.bezierCurveTo(r+a,i+a*t,s-a,o-a*n,s,o)}function NT(e){this._context=e}NT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:PR(this,this._t0,$Z(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,PR(this,$Z(this,n=kZ(this,e,t)),n);break;default:PR(this,this._t0,n=kZ(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Tge(e){this._context=new Age(e)}(Tge.prototype=Object.create(NT.prototype)).point=function(e,t){NT.prototype.point.call(this,t,e)};function Age(e){this._context=e}Age.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function Dlt(e){return new NT(e)}function Olt(e){return new Tge(e)}function Nge(e){this._context=e}Nge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=_Z(e),i=_Z(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function _Z(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),o=new Array(n);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function Flt(e){return new Nge(e)}function CD(e,t){this._context=e,this._t=t}CD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Rlt(e){return new CD(e,.5)}function Mlt(e){return new CD(e,0)}function Plt(e){return new CD(e,1)}var EZ={basis:{curve:wlt},"basis-closed":{curve:Slt},"basis-open":{curve:Clt},bundle:{curve:klt,tension:"beta",value:.85},cardinal:{curve:$lt,tension:"tension",value:0},"cardinal-open":{curve:Elt,tension:"tension",value:0},"cardinal-closed":{curve:_lt,tension:"tension",value:0},"catmull-rom":{curve:Tlt,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Alt,tension:"alpha",value:.5},"catmull-rom-open":{curve:Nlt,tension:"alpha",value:.5},linear:{curve:FW},"linear-closed":{curve:Ilt},monotone:{horizontal:Olt,vertical:Dlt},natural:{curve:Flt},step:{curve:Rlt},"step-after":{curve:Plt},"step-before":{curve:Mlt}};function zW(e,t,n){var r=EZ.hasOwnProperty(e)&&EZ[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}var Llt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},x$=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function o1(e){var t=[],n,r,i,s,o,a,u,l,c,f,d;for(n=e.slice().replace(x$[0],"###$1").split(x$[1]).slice(1),l=0,f=n.length;l<f;++l){for(r=n[l],i=r.slice(1).trim().replace(x$[2],"$1###$2").split(x$[3]),a=r.charAt(0),s=[a],c=0,d=i.length;c<d;++c)(o=+i[c])===o&&s.push(o);if(u=Llt[a.toLowerCase()],s.length-1>u)for(c=1,d=s.length;c<d;c+=u)t.push([a].concat(s.slice(c,c+u)));else t.push(s)}return t}var LR={},zR={},Ige=[].join;function zlt(e,t,n,r,i,s,o,a,u){var l=Ige.call(arguments);if(LR[l])return LR[l];var c=o*(Math.PI/180),f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);var h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5,m=h*h/(n*n)+p*p/(r*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);var g=d/n,y=f/n,b=-f/r,v=d/r,x=g*a+y*u,w=b*a+v*u,S=g*e+y*t,C=b*e+v*t,k=(S-x)*(S-x)+(C-w)*(C-w),E=1/k-.25;E<0&&(E=0);var _=Math.sqrt(E);s==i&&(_=-_);var T=.5*(x+S)-_*(C-w),D=.5*(w+C)+_*(S-x),O=Math.atan2(w-D,x-T),M=Math.atan2(C-D,S-T),I=M-O;I<0&&s===1?I+=2*Math.PI:I>0&&s===0&&(I-=2*Math.PI);for(var P=Math.ceil(Math.abs(I/(Math.PI*.5+.001))),V=[],F=0;F<P;++F){var B=O+F*I/P,q=O+(F+1)*I/P;V[F]=[T,D,B,q,n,r,f,d]}return LR[l]=V}function Blt(e){var t=Ige.call(e);if(zR[t])return zR[t];var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7],c=l*o,f=-u*a,d=u*o,h=l*a,p=Math.cos(i),m=Math.sin(i),g=Math.cos(s),y=Math.sin(s),b=.5*(s-i),v=Math.sin(b*.5),x=8/3*v*v/Math.sin(b),w=n+p-x*m,S=r+m+x*p,C=n+g,k=r+y,E=C+x*y,_=k-x*g;return zR[t]=[c*w+f*S,d*w+h*S,c*E+f*_,d*E+h*_,c*C+f*k,d*C+h*k]}var Qu=["l",0,0,0,0,0,0,0];function Ult(e,t){var n=Qu[0]=e[0];if(n==="a"||n==="A")Qu[1]=t*e[1],Qu[2]=t*e[2],Qu[3]=e[3],Qu[4]=e[4],Qu[5]=e[5],Qu[6]=t*e[6],Qu[7]=t*e[7];else for(var r=1,i=e.length;r<i;++r)Qu[r]=t*e[r];return Qu}function kD(e,t,n,r,i){var s,o=null,a=0,u=0,l=0,c=0,f,d,h,p;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),e.beginPath&&e.beginPath();for(var m=0,g=t.length;m<g;++m){switch(s=t[m],i!==1&&(s=Ult(s,i)),s[0]){case"l":a+=s[1],u+=s[2],e.lineTo(a+n,u+r);break;case"L":a=s[1],u=s[2],e.lineTo(a+n,u+r);break;case"h":a+=s[1],e.lineTo(a+n,u+r);break;case"H":a=s[1],e.lineTo(a+n,u+r);break;case"v":u+=s[1],e.lineTo(a+n,u+r);break;case"V":u=s[1],e.lineTo(a+n,u+r);break;case"m":a+=s[1],u+=s[2],e.moveTo(a+n,u+r);break;case"M":a=s[1],u=s[2],e.moveTo(a+n,u+r);break;case"c":f=a+s[5],d=u+s[6],l=a+s[3],c=u+s[4],e.bezierCurveTo(a+s[1]+n,u+s[2]+r,l+n,c+r,f+n,d+r),a=f,u=d;break;case"C":a=s[5],u=s[6],l=s[3],c=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,l+n,c+r,a+n,u+r);break;case"s":f=a+s[3],d=u+s[4],l=2*a-l,c=2*u-c,e.bezierCurveTo(l+n,c+r,a+s[1]+n,u+s[2]+r,f+n,d+r),l=a+s[1],c=u+s[2],a=f,u=d;break;case"S":f=s[3],d=s[4],l=2*a-l,c=2*u-c,e.bezierCurveTo(l+n,c+r,s[1]+n,s[2]+r,f+n,d+r),a=f,u=d,l=s[1],c=s[2];break;case"q":f=a+s[3],d=u+s[4],l=a+s[1],c=u+s[2],e.quadraticCurveTo(l+n,c+r,f+n,d+r),a=f,u=d;break;case"Q":f=s[3],d=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,f+n,d+r),a=f,u=d,l=s[1],c=s[2];break;case"t":f=a+s[1],d=u+s[2],o[0].match(/[QqTt]/)===null?(l=a,c=u):o[0]==="t"?(l=2*a-h,c=2*u-p):o[0]==="q"&&(l=2*a-l,c=2*u-c),h=l,p=c,e.quadraticCurveTo(l+n,c+r,f+n,d+r),a=f,u=d,l=a+s[1],c=u+s[2];break;case"T":f=s[1],d=s[2],l=2*a-l,c=2*u-c,e.quadraticCurveTo(l+n,c+r,f+n,d+r),a=f,u=d;break;case"a":TZ(e,a+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+a+n,s[7]+u+r]),a+=s[6],u+=s[7];break;case"A":TZ(e,a+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),a=s[6],u=s[7];break;case"z":case"Z":e.closePath();break}o=s}}function TZ(e,t,n,r){for(var i=zlt(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),s=0;s<i.length;++s){var o=Blt(i[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var Wlt=2*Math.PI,w$=Math.sqrt(3)/2,AZ={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Wlt)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=w$*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=w$*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=w$*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=w$*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}}};function Dge(e){return AZ.hasOwnProperty(e)?AZ[e]:Vlt(e)}var BR={};function Vlt(e){if(!BR.hasOwnProperty(e)){var t=o1(e);BR[e]={draw:function(n,r){kD(n,t,0,0,Math.sqrt(r)/2)}}}return BR[e]}function jlt(e){return e.x}function Hlt(e){return e.y}function Glt(e){return e.width}function qlt(e){return e.height}function Ng(e){return function(){return e}}function Oge(){var e=jlt,t=Hlt,n=Glt,r=qlt,i=Ng(0),s=null;function o(a,u,l){var c,f=u??+e.call(this,a),d=l??+t.call(this,a),h=+n.call(this,a),p=+r.call(this,a),m=+i.call(this,a);if(s||(s=c=Zm()),m<=0)s.rect(f,d,h,p);else{var g=f+h,y=d+p;s.moveTo(f+m,d),s.lineTo(g-m,d),s.quadraticCurveTo(g,d,g,d+m),s.lineTo(g,y-m),s.quadraticCurveTo(g,y,g-m,y),s.lineTo(f+m,y),s.quadraticCurveTo(f,y,f,y-m),s.lineTo(f,d+m),s.quadraticCurveTo(f,d,f+m,d),s.closePath()}if(c)return s=null,c+""||null}return o.x=function(a){return arguments.length?(e=typeof a=="function"?a:Ng(+a),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:Ng(+a),o):t},o.width=function(a){return arguments.length?(n=typeof a=="function"?a:Ng(+a),o):n},o.height=function(a){return arguments.length?(r=typeof a=="function"?a:Ng(+a),o):r},o.cornerRadius=function(a){return arguments.length?(i=typeof a=="function"?a:Ng(+a),o):i},o.context=function(a){return arguments.length?(s=a??null,o):s},o}var UR=Math.PI;function Fge(){var e,t,n,r,i=null,s,o,a,u;function l(f,d,h){var p=h/2;if(s){var m=a-d,g=f-o;if(m||g){var y=Math.sqrt(m*m+g*g),b=(m/=y)*u,v=(g/=y)*u,x=Math.atan2(g,m);i.moveTo(o-b,a-v),i.lineTo(f-m*p,d-g*p),i.arc(f,d,p,x-UR,x),i.lineTo(o+b,a+v),i.arc(o,a,u,x,x+UR)}else i.arc(f,d,p,0,2*UR);i.closePath()}else s=1;o=f,a=d,u=p}function c(f){var d,h=f.length,p,m=!1,g;for(i==null&&(i=g=Zm()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===m&&(m=!m)&&(s=0),m&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(g)return i=null,g+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function AC(e){return e.x||0}function NC(e){return e.y||0}function Xlt(e){return e.width||0}function Klt(e){return e.size||1}function Ylt(e){return e.height||0}function Zlt(e){return(e.x||0)+(e.width||0)}function Qlt(e){return(e.y||0)+(e.height||0)}function Jlt(e){return e.startAngle||0}function ect(e){return e.endAngle||0}function tct(e){return e.padAngle||0}function nct(e){return e.innerRadius||0}function rct(e){return e.outerRadius||0}function Rge(e){return e.cornerRadius||0}function $D(e){return e.defined!==!1}function ict(e){return e.size==null?64:e.size}function sct(e){return Dge(e.shape||"circle")}var oct=blt().startAngle(Jlt).endAngle(ect).padAngle(tct).innerRadius(nct).outerRadius(rct).cornerRadius(Rge),act=xge().x(AC).y1(NC).y0(Qlt).defined($D),uct=xge().y(NC).x1(AC).x0(Zlt).defined($D),lct=vge().x(AC).y(NC).defined($D),cct=Oge().x(AC).y(NC).width(Xlt).height(Ylt).cornerRadius(Rge),fct=xlt().type(sct).size(ict),dct=Fge().x(AC).y(NC).defined($D).size(Klt);function hct(e,t){return oct.context(e)(t)}function pct(e,t){var n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?uct:act).curve(zW(r,n.orient,n.tension)).context(e)(t)}function mct(e,t){var n=t[0],r=n.interpolate||"linear";return lct.curve(zW(r,n.orient,n.tension)).context(e)(t)}function _D(e,t,n,r){return cct.context(e)(t,n,r)}function gct(e,t){return(t.mark.shape||t.shape).context(e)(t)}function yct(e,t){return fct.context(e)(t)}function bct(e,t){return dct.context(e)(t)}function mf(e,t){return t.stroke&&t.opacity!==0&&t.strokeOpacity!==0&&e.expand(t.strokeWidth!=null?+t.strokeWidth:1),e}var Mge,ip=Math.PI*2,ov=ip/4,vct=ip-1e-8;function fo(e){return Mge=e,fo}function Pge(){}function Io(e,t){Mge.add(e,t)}fo.beginPath=Pge;fo.closePath=Pge;fo.moveTo=Io;fo.lineTo=Io;fo.rect=function(e,t,n,r){Io(e,t),Io(e+n,t+r)};fo.quadraticCurveTo=function(e,t,n,r){Io(e,t),Io(n,r)};fo.bezierCurveTo=function(e,t,n,r,i,s){Io(e,t),Io(n,r),Io(i,s)};fo.arc=function(e,t,n,r,i,s){if(Math.abs(i-r)>vct){Io(e-n,t-n),Io(e+n,t+n);return}var o=1/0,a=-1/0,u=1/0,l=-1/0,c,f,d,h;function p(m){d=n*Math.cos(m),h=n*Math.sin(m),d<o&&(o=d),d>a&&(a=d),h<u&&(u=h),h>l&&(l=h)}if(p(r),p(i),i!==r)if(r=r%ip,r<0&&(r+=ip),i=i%ip,i<0&&(i+=ip),i<r&&(s=!s,c=r,r=i,i=c),s)for(i-=ip,c=r-r%ov,f=0;f<4&&c>i;++f,c-=ov)p(c);else for(c=r-r%ov+ov,f=0;f<4&&c<i;++f,c=c+ov)p(c);Io(e+o,t+u),Io(e+a,t+l)};function xct(e,t,n){for(var r=n.width(),i=n.height(),s=n.x1+t.x1*r,o=n.y1+t.y1*i,a=n.x1+t.x2*r,u=n.y1+t.y2*i,l=t.stops,c=0,f=l.length,d=e.createLinearGradient(s,o,a,u);c<f;++c)d.addColorStop(l[c].offset,l[c].color);return d}function Lge(e,t,n){return n.id?xct(e,n,t.bounds):n}function BW(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Lge(e,t,t.fill),!0):!1}var wct=[];function ED(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Lge(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||wct),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Sct(e,t){return e.zindex-t.zindex||e.index-t.index}function UW(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Sct)}function Au(e,t){var n=e.items,r,i;if(!(!n||!n.length)){var s=UW(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}}function IT(e,t){var n=e.items,r,i;if(!n||!n.length)return null;var s=UW(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function WW(e){return function(t,n,r){Au(n,function(i){(!r||r.intersects(i.bounds))&&zge(e,t,i,i)})}}function Cct(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&zge(e,t,n.items[0],n.items)}}function zge(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(n.fill&&BW(t,n,i)&&t.fill(),n.stroke&&ED(t,n,i)&&t.stroke()))}var kct=function(){return!0};function TD(e){return e||(e=kct),function(t,n,r,i,s,o){return r*=t.pixelRatio,i*=t.pixelRatio,IT(n,function(a){var u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,r,i,s,o))return a})}}function VW(e,t){return function(n,r,i,s){var o=Array.isArray(r)?r[0]:r,a=o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,s)||u&&n.isPointInStroke(i,s)}}function jW(e){return TD(VW(e))}function Nx(e,t){return"translate("+e+","+t+")"}function AD(e){return Nx(e.x||0,e.y||0)}function HW(e,t){function n(s,o){s("transform",AD(o)),s("d",t(null,o))}function r(s,o){return t(fo(s),o),mf(s,o).translate(o.x||0,o.y||0)}function i(s,o){var a=o.x||0,u=o.y||0;s.translate(a,u),s.beginPath(),t(s,o),s.translate(-a,-u)}return{type:e,tag:"path",nested:!1,attr:n,bound:r,draw:WW(i),pick:jW(i)}}const $ct=HW("arc",hct);function _ct(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,o,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<s&&(s=a,o=e[i]));return o}function Ect(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],o=i*i+s*s,o<n))return e[r];return null}function Tct(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function GW(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(fo(u),c),mf(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}var o=VW(s);function a(u,l,c,f,d,h){var p=l.items,m=l.bounds;return!p||!p.length||m&&!m.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Cct(s),pick:a,tip:n}}const Act=GW("area",pct,_ct);var Bge=1;function Nct(){Bge=1}function qW(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+Bge++),o=i.clipping[s]||(i.clipping[s]={id:s});return Ot(r)?o.path=r(null):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}var Uge=.5;function Ict(e,t){e("transform",AD(t))}function Dct(e,t){var n=t.stroke?Uge:0;e("class","background"),e("d",_D(null,t,n,n))}function Oct(e,t,n){var r=t.clip?qW(n,t,t):null;e("clip-path",r)}function Fct(e,t){if(!t.clip&&t.items)for(var n=t.items,r=0,i=n.length;r<i;++r)e.union(n[r].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),mf(e,t),e.translate(t.x||0,t.y||0)}function Wge(e,t){var n=t.stroke?Uge:0;e.beginPath(),_D(e,t,n,n)}var Rct=VW(Wge);function Mct(e,t,n){var r=this;Au(t,function(i){var s=i.x||0,o=i.y||0,a=i.width||0,u=i.height||0,l;e.save(),e.translate(s,o),(i.stroke||i.fill)&&(l=i.opacity==null?1:i.opacity,l>0&&(Wge(e,i),i.fill&&BW(e,i,l)&&e.fill(),i.stroke&&ED(e,i,l)&&e.stroke())),i.clip&&(e.beginPath(),e.rect(0,0,a,u),e.clip()),n&&n.translate(-s,-o),Au(i,function(c){r.draw(e,c,n)}),n&&n.translate(s,o),e.restore()})}function Pct(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;var o=this,a=n*e.pixelRatio,u=r*e.pixelRatio;return IT(t,function(l){var c,f,d,h;if(h=l.bounds,!(h&&!h.contains(i,s)))return f=l.x||0,d=l.y||0,e.save(),e.translate(f,d),f=i-f,d=s-d,c=IT(l,function(p){return Lct(p,f,d)?o.pick(p,n,r,f,d):null}),!c&&t.interactive!==!1&&(l.fill||l.stroke)&&Rct(e,l,a,u)&&(c=l),e.restore(),c||null})}function Lct(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}const zct={type:"group",tag:"g",nested:!1,attr:Ict,bound:Fct,draw:Mct,pick:Pct,background:Dct,foreground:Oct};function XW(e,t){var n=e.image;return(!n||n.url!==e.url)&&(n={loaded:!1,width:0,height:0},t.loadImage(e.url).then(function(r){e.image=r,e.image.url=e.url})),n}function ND(e,t){return e==="center"?t/2:e==="right"?t:0}function ID(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Bct(e,t,n){var r=XW(t,n),i=t.x||0,s=t.y||0,o=(t.width!=null?t.width:r.width)||0,a=(t.height!=null?t.height:r.height)||0,u=t.aspect===!1?"none":"xMidYMid";i-=ND(t.align,o),s-=ID(t.baseline,a),e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href"),e("transform",Nx(i,s)),e("width",o),e("height",a),e("preserveAspectRatio",u)}function Uct(e,t){var n=t.image,r=t.x||0,i=t.y||0,s=(t.width!=null?t.width:n&&n.width)||0,o=(t.height!=null?t.height:n&&n.height)||0;return r-=ND(t.align,s),i-=ID(t.baseline,o),e.set(r,i,r+s,i+o)}function Wct(e,t,n){var r=this;Au(t,function(i){if(!(n&&!n.intersects(i.bounds))){var s=XW(i,r),o=i.x||0,a=i.y||0,u=(i.width!=null?i.width:s.width)||0,l=(i.height!=null?i.height:s.height)||0,c,f,d,h;o-=ND(i.align,u),a-=ID(i.baseline,l),i.aspect!==!1&&(f=s.width/s.height,d=i.width/i.height,f===f&&d===d&&f!==d&&(d<f?(h=u/f,a+=(l-h)/2,l=h):(h=l*f,o+=(u-h)/2,u=h))),s.loaded&&(e.globalAlpha=(c=i.opacity)!=null?c:1,e.drawImage(s,o,a,u,l))}})}const Vct={type:"image",tag:"image",nested:!1,attr:Bct,bound:Uct,draw:Wct,pick:TD(),get:XW,xOffset:ND,yOffset:ID},jct=GW("line",mct,Ect);function Hct(e,t){e("transform",AD(t)),e("d",t.path)}function CP(e,t){var n=t.path;if(n==null)return!0;var r=t.pathCache;(!r||r.path!==n)&&((t.pathCache=r=o1(n)).path=n),kD(e,r,t.x,t.y)}function Gct(e,t){return CP(fo(e),t)?e.set(0,0,0,0):mf(e,t)}const qct={type:"path",tag:"path",nested:!1,attr:Hct,bound:Gct,draw:WW(CP),pick:jW(CP)};function Xct(e,t){e("d",_D(null,t))}function Kct(e,t){var n,r;return mf(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function NZ(e,t){e.beginPath(),_D(e,t)}const Yct={type:"rect",tag:"path",nested:!1,attr:Xct,bound:Kct,draw:WW(NZ),pick:jW(NZ)};function Zct(e,t){e("transform",AD(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Qct(e,t){var n,r;return mf(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function Vge(e,t,n){var r,i,s,o;return t.stroke&&ED(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,o),!0):!1}function Jct(e,t,n){Au(t,function(r){if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&Vge(e,r,i)&&e.stroke()}})}function eft(e,t,n,r){return e.isPointInStroke?Vge(e,t,1)&&e.isPointInStroke(n,r):!1}const tft={type:"rule",tag:"line",nested:!1,attr:Zct,bound:Qct,draw:Jct,pick:TD(eft)},nft=HW("shape",gct),rft=HW("symbol",yct);var Xf,KW,DT={height:uh,measureWidth:Hge,estimateWidth:kP,width:kP,canvas:qge};qge(!0);function kP(e){return KW=uh(e),jge(IC(e))}function jge(e){return~~(.8*e.length*KW)}function Hge(e){return Xf.font=DD(e),Gge(IC(e))}function Gge(e){return Xf.measureText(e).width}function uh(e){return e.fontSize!=null?e.fontSize:11}function qge(e){Xf=e&&(Xf=DW(1,1))?Xf.getContext("2d"):null,DT.width=Xf?Hge:kP}function IC(e){var t=e.text;return t==null?"":e.limit>0?ift(e):t+""}function ift(e){var t=+e.limit,n=e.text+"",r;if(Xf?(Xf.font=DD(e),r=Gge):(KW=uh(e),r=jge),r(n)<t)return n;var i=e.ellipsis||"",s=e.dir==="rtl",o=0,a=n.length,u;if(t-=r(i),s){for(;o<a;)u=o+a>>>1,r(n.slice(u))>t?o=u+1:a=u;return i+n.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),r(n.slice(0,u))<t?o=u:a=u-1;return n.slice(0,o)+i}}function DC(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function DD(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+uh(e)+"px "+DC(e,t)}function YW(e){var t=e.baseline,n=uh(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:0)}var sft={left:"start",center:"middle",right:"end"},oft=new Es;function aft(e,t){var n=t.dx||0,r=(t.dy||0)+YW(t),i=t.x||0,s=t.y||0,o=t.angle||0,a=t.radius||0,u;a&&(u=(t.theta||0)-Math.PI/2,i+=a*Math.cos(u),s+=a*Math.sin(u)),e("text-anchor",sft[t.align]||"start"),o?(u=Nx(i,s)+" rotate("+o+")",(n||r)&&(u+=" "+Nx(n,r))):u=Nx(i+n,s+r),e("transform",u)}function Xge(e,t,n){var r=DT.height(t),i=t.align,s=t.radius||0,o=t.x||0,a=t.y||0,u=t.dx||0,l=(t.dy||0)+YW(t)-Math.round(.8*r),c,f;return s&&(f=(t.theta||0)-Math.PI/2,o+=s*Math.cos(f),a+=s*Math.sin(f)),c=DT.width(t),i==="center"?u-=c/2:i==="right"&&(u-=c),e.set(u+=o,l+=a,u+c,l+r),t.angle&&!n&&e.rotate(t.angle*Math.PI/180,o,a),e.expand(n||!c?0:1)}function uft(e,t,n){Au(t,function(r){var i,s,o,a,u,l;n&&!n.intersects(r.bounds)||(l=IC(r))&&(i=r.opacity==null?1:r.opacity,i!==0&&(e.font=DD(r),e.textAlign=r.align||"left",s=r.x||0,o=r.y||0,(a=r.radius)&&(u=(r.theta||0)-Math.PI/2,s+=a*Math.cos(u),o+=a*Math.sin(u)),r.angle&&(e.save(),e.translate(s,o),e.rotate(r.angle*Math.PI/180),s=o=0),s+=r.dx||0,o+=(r.dy||0)+YW(r),r.fill&&BW(e,r,i)&&e.fillText(l,s,o),r.stroke&&ED(e,r,i)&&e.strokeText(l,s,o),r.angle&&e.restore()))})}function lft(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=Xge(oft,t,!0),a=-t.angle*Math.PI/180,u=Math.cos(a),l=Math.sin(a),c=t.x,f=t.y,d=u*i-l*s+(c-c*u+f*l),h=l*i+u*s+(f-c*l-f*u);return o.contains(d,h)}const cft={type:"text",tag:"text",nested:!1,attr:aft,bound:Xge,draw:uft,pick:TD(lft)},fft=GW("trail",bct,Tct),ql={arc:$ct,area:Act,group:zct,image:Vct,line:jct,path:qct,rect:Yct,rule:tft,shape:nft,symbol:rft,text:cft,trail:fft};function $P(e,t,n){var r=ql[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Es),e,n)}var IZ={mark:null};function Kge(e,t,n){var r=ql[e.marktype],i=r.bound,s=e.items,o=s&&s.length,a,u,l,c;if(r.nested)return o?l=s[0]:(IZ.mark=e,l=IZ),c=$P(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Es,o)for(a=0,u=s.length;a<u;++a)t.union($P(s[a],i,n));return e.bounds=t}var dft=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","interpolate","tension","orient","defined","url","path","x2","y2","size","shape","text","angle","theta","radius","dx","dy","font","fontSize","fontWeight","fontStyle","fontVariant"];function Yge(e,t){return JSON.stringify(e,dft,t)}function Zge(e){var t=typeof e=="string"?JSON.parse(e):e;return Qge(t)}function Qge(e){var t=e.marktype,n=e.items,r,i,s;if(n)for(i=0,s=n.length;i<s;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&Qge(n[i]);return t&&Kge(e),e}function ZW(e){arguments.length?this.root=Zge(e):(this.root=e0e({marktype:"group",name:"root",role:"frame"}),this.root.items=[new xD(this.root)])}var Jge=ZW.prototype;Jge.toJSON=function(e){return Yge(this.root,e||0)};Jge.mark=function(e,t,n){t=t||this.root.items[0];var r=e0e(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};function e0e(e,t){return{bounds:new Es,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0}}function y0(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function QW(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Sl(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=y0(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Qc(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function t0e(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function OD(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function hft(e,t,n,r){var i=e&&e.mark,s,o;if(i&&(s=ql[i.marktype]).tip){for(o=OD(t,n),o[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(i.items,o)}return e}function lh(e,t){this._active=null,this._handlers={},this._loader=e||dD(),this._tooltip=t||pft}function pft(e,t,n,r){e.element().setAttribute("title",r||"")}var Xo=lh.prototype;Xo.initialize=function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)};Xo.element=function(){return this._el};Xo.canvas=function(){return this._el&&this._el.firstChild};Xo.origin=function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()};Xo.scene=function(e){return arguments.length?(this._scene=e,this):this._scene};Xo.on=function(){};Xo.off=function(){};Xo._handlerIndex=function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1};Xo.handlers=function(e){var t=this._handlers,n=[],r;if(e)n.push.apply(n,t[this.eventName(e)]);else for(r in t)n.push.apply(n,t[r]);return n};Xo.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)};Xo.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then(function(r){var i=new MouseEvent(e.type,e),s=y0(null,"a");for(var o in r)s.setAttribute(o,r[o]);s.dispatchEvent(i)}).catch(function(){})};Xo.handleTooltip=function(e,t,n){if(t&&t.tooltip!=null){t=hft(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}};Xo.getItemBoundingClientRect=function(e){if(t=this.canvas()){for(var t,n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,a=i.width(),u=i.height();e.mark&&(e=e.mark.group);)s+=e.x||0,o+=e.y||0;return{x:s,y:o,width:a,height:u,left:s,top:o,right:s+a,bottom:o+u}}};function zu(e){this._el=null,this._bgcolor=null,this._loader=new OW(e)}var Wa=zu.prototype;Wa.initialize=function(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)};Wa.element=function(){return this._el};Wa.canvas=function(){return this._el&&this._el.firstChild};Wa.background=function(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)};Wa.resize=function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this};Wa.dirty=function(){};Wa.render=function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t};Wa._render=function(){};Wa.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then(function(){return t}):Promise.resolve(t)};Wa._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(s){s&&i(),n._ready=null})}return r};Wa.sanitizeURL=function(e){return this._load("sanitizeURL",e)};Wa.loadImage=function(e){return this._load("loadImage",e)};var mft=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],_P="mousemove",Bw="mouseout",EP="click";function OC(e,t){lh.call(this,e,t),this._down=null,this._touch=null,this._first=!0}var pr=Ne(OC,lh);pr.initialize=function(e,t,n){var r=this._canvas=e&&QW(e,"canvas");if(r){var i=this;this.events.forEach(function(s){r.addEventListener(s,function(o){pr[s]?pr[s].call(i,o):i.fire(s,o)})})}return lh.prototype.initialize.call(this,e,t,n)};pr.canvas=function(){return this._canvas};pr.context=function(){return this._canvas.getContext("2d")};pr.events=mft;pr.DOMMouseScroll=function(e){this.fire("mousewheel",e)};function n0e(e,t,n){return function(r){var i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function r0e(e){return function(t){this.fire(e,t),this._active=null}}pr.mousemove=n0e("mousemove","mouseover","mouseout");pr.dragover=n0e("dragover","dragenter","dragleave");pr.mouseout=r0e("mouseout");pr.dragleave=r0e("dragleave");pr.mousedown=function(e){this._down=this._active,this.fire("mousedown",e)};pr.click=function(e){this._down===this._active&&(this.fire("click",e),this._down=null)};pr.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",e,!0)};pr.touchmove=function(e){this.fire("touchmove",e,!0)};pr.touchend=function(e){this.fire("touchend",e,!0),this._touch=null};pr.fire=function(e,t,n){var r=n?this._touch:this._active,i=this._handlers[e],s,o;if(t.vegaType=e,e===EP&&r&&r.href?this.handleHref(t,r,r.href):(e===_P||e===Bw)&&this.handleTooltip(t,r,e!==Bw),i)for(s=0,o=i.length;s<o;++s)i[s].handler.call(this._obj,t,r)};pr.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);return i<0&&(r[n]||(r[n]=[])).push({type:e,handler:t}),this};pr.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this};pr.pickEvent=function(e){var t=OD(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])};pr.pick=function(e,t,n,r,i){var s=this.context(),o=ql[e.marktype];return o.pick.call(this,s,e,t,n,r,i)};function gft(e,t){var n=t.clip;if(e.save(),e.beginPath(),Ot(n))n(e);else{var r=t.group;e.rect(0,0,r.width||0,r.height||0)}e.clip()}function yft(){return typeof window<"u"&&window.devicePixelRatio||1}var bft=yft();function vft(e,t,n,r,i){var s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),a=s?bft:i;return e.width=t*a,e.height=n*a,s&&a!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=a,o.setTransform(a,0,0,a,a*r[0],a*r[1]),e}function OT(e){zu.call(this,e),this._redraw=!1,this._dirty=new Es}var ch=Ne(OT,zu),i0e=zu.prototype,xft=new Es;ch.initialize=function(e,t,n,r,i){return this._canvas=DW(1,1),e&&(Qc(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),i0e.initialize.call(this,e,t,n,r,i)};ch.resize=function(e,t,n,r){return i0e.resize.call(this,e,t,n,r),vft(this._canvas,this._width,this._height,this._origin,this._scale),this._redraw=!0,this};ch.canvas=function(){return this._canvas};ch.context=function(){return this._canvas?this._canvas.getContext("2d"):null};ch.dirty=function(e){var t=Sft(e.bounds,e.mark.group);this._dirty.union(t)};function wft(e,t,n){return t.expand(1).round(),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}function Sft(e,t){if(t==null)return e;for(var n=xft.clear().union(e);t!=null;t=t.mark.group)n.translate(t.x||0,t.y||0);return n}ch._render=function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty;return t.save(),this._redraw||s.empty()?(this._redraw=!1,s=null):s=wft(t,s,n),this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),this._dirty.clear(),this};ch.draw=function(e,t,n){var r=ql[t.marktype];t.clip&&gft(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()};ch.clear=function(e,t,n,r){var i=this.context();i.clearRect(e,t,n,r),this._bgcolor!=null&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))};function JW(e,t){lh.call(this,e,t);var n=this;n._hrefHandler=TP(n,function(r,i){i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=TP(n,function(r,i){n.handleTooltip(r,i,r.type!==Bw)})}var FD=Ne(JW,lh);FD.initialize=function(e,t,n){var r=this._svg;return r&&(r.removeEventListener(EP,this._hrefHandler),r.removeEventListener(_P,this._tooltipHandler),r.removeEventListener(Bw,this._tooltipHandler)),this._svg=r=e&&QW(e,"svg"),r&&(r.addEventListener(EP,this._hrefHandler),r.addEventListener(_P,this._tooltipHandler),r.addEventListener(Bw,this._tooltipHandler)),lh.prototype.initialize.call(this,e,t,n)};FD.canvas=function(){return this._svg};function TP(e,t){return function(n){var r=n.target,i=r.__data__;n.vegaType=n.type,i=Array.isArray(i)?i[0]:i,t.call(e._obj,n,i)}}FD.on=function(e,t){var n=this.eventName(e),r=this._handlers,i=this._handlerIndex(r[n],e,t);if(i<0){var s={type:e,handler:t,listener:TP(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this};FD.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};function di(e,t,n){var r="<"+e,i,s;if(t)for(i in t)s=t[i],s!=null&&(r+=" "+i+'="'+s+'"');return n&&(r+=" "+n),r+">"}function hi(e){return"</"+e+">"}const Uw={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};var eV={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},FT=Object.keys(eV),$a=Uw.xmlns;function tV(e){zu.call(this,e),this._dirtyID=1,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var ho=Ne(tV,zu),nV=zu.prototype;ho.initialize=function(e,t,n,r){return e&&(this._svg=Sl(e,0,"svg",$a),this._svg.setAttribute("class","marks"),Qc(e,1),this._root=Sl(this._svg,0,"g",$a),Qc(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),nV.initialize.call(this,e,t,n,r)};ho.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),nV.background.apply(this,arguments)};ho.resize=function(e,t,n,r){return nV.resize.call(this,e,t,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this};ho.canvas=function(){return this._svg};ho.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in Uw)e[t]=Uw[t];var n=this._bgcolor?di("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+hi("rect"):"";return di("svg",e)+n+this._svg.innerHTML+hi("svg")};ho._render=function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e),Qc(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this};ho.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,r=0,i;for(i in t.gradient)n||(t.el=n=Sl(e,0,"defs",$a)),Cft(n,t.gradient[i],r++);for(i in t.clipping)n||(t.el=n=Sl(e,0,"defs",$a)),kft(n,t.clipping[i],r++);n&&(r===0?(e.removeChild(n),t.el=null):Qc(n,r))};function Cft(e,t,n){var r,i,s;for(e=Sl(e,n,"linearGradient",$a),e.setAttribute("id",t.id),e.setAttribute("x1",t.x1),e.setAttribute("x2",t.x2),e.setAttribute("y1",t.y1),e.setAttribute("y2",t.y2),r=0,i=t.stops.length;r<i;++r)s=Sl(e,r,"stop",$a),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);Qc(e,r)}function kft(e,t,n){var r;e=Sl(e,n,"clipPath",$a),e.setAttribute("id",t.id),t.path?(r=Sl(e,0,"path",$a),r.setAttribute("d",t.path)):(r=Sl(e,0,"rect",$a),r.setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",t.width),r.setAttribute("height",t.height))}ho._resetDefs=function(){var e=this._defs;e.gradient={},e.clipping={}};ho.dirty=function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))};ho.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID};ho._dirtyCheck=function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length)return!0;var t=++this._dirtyID,n,r,i,s,o,a,u;for(o=0,a=e.length;o<a;++o)if(n=e[o],r=n.mark,r.marktype!==i&&(i=r.marktype,s=ql[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,DZ(n,t),r.items.forEach(function(l){l.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(s,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,DZ(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll};function DZ(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}ho.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r=this,i=this._svg,s=ql[t.marktype],o=t.interactive===!1?"none":null,a=s.tag==="g",u=null,l=0,c;c=OZ(t,e,n,"g",i),c.setAttribute("class",t0e(t)),a||c.style.setProperty("pointer-events",o),t.clip?c.setAttribute("clip-path",qW(r,t,t.group)):c.removeAttribute("clip-path");function f(d){var h=r.isDirty(d),p=OZ(d,c,u,s.tag,i);h&&(r._update(s,p,d),a&&$ft(r,p,d)),u=p,++l}return s.nested?t.items.length&&f(t.items[0]):Au(t,f),Qc(c,l),c};function $ft(e,t,n){t=t.lastChild;var r,i=0;Au(n,function(s){r=e.draw(t,s,r),++i}),Qc(t,1+i)}function OZ(e,t,n,r,i){var s=e._svg,o;if(!s&&(o=t.ownerDocument,s=y0(o,r,$a),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){var a=y0(o,"path",$a);a.setAttribute("class","background"),s.appendChild(a),a.__data__=e;var u=y0(o,"g",$a);s.appendChild(u),u.__data__=e}return(s.ownerSVGElement!==i||_ft(e)&&s.previousSibling!==n)&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function _ft(e){var t=e.mark||e.group;return t&&t.items.length>1}var Cc=null,la=null,Eft={group:function(e,t,n){la=t.__values__,Cc=t.childNodes[1],e.foreground(AP,n,this),Cc=t.childNodes[0],e.background(AP,n,this);var r=n.mark.interactive===!1?"none":null;r!==la.events&&(Cc.style.setProperty("pointer-events",r),la.events=r)},text:function(e,t,n){var r;r=IC(n),r!==la.text&&(t.textContent=r,la.text=r),av(t,"font-family",DC(n)),av(t,"font-size",uh(n)+"px"),av(t,"font-style",n.fontStyle),av(t,"font-variant",n.fontVariant),av(t,"font-weight",n.fontWeight)}};function av(e,t,n){n!==la[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),la[t]=n)}ho._update=function(e,t,n){Cc=t,la=t.__values__,e.attr(AP,n,this);var r=Eft[e.type];r&&r.call(this,e,t,n),this.style(Cc,n)};function AP(e,t,n){t!==la[e]&&(t!=null?n?Cc.setAttributeNS(n,e,t):Cc.setAttribute(e,t):n?Cc.removeAttributeNS(n,e):Cc.removeAttribute(e),la[e]=t)}ho.style=function(e,t){if(t!=null){var n,r,i,s,o;for(n=0,r=FT.length;n<r;++n)i=FT[n],o=t[i],i==="font"&&(o=DC(t)),o!==la[i]&&(s=eV[i],o==null?s==="fill"?e.style.setProperty(s,"none"):e.style.removeProperty(s):(o.id&&(this._defs.gradient[o.id]=o,o="url("+Tft()+"#"+o.id+")"),e.style.setProperty(s,o+"")),la[i]=o)}};function Tft(){var e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function rV(e){zu.call(this,e),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}var gf=Ne(rV,zu),s0e=zu.prototype;gf.resize=function(e,t,n,r){s0e.resize.call(this,e,t,n,r);var i=this._origin,s=this._text,o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var a in Uw)o[a]=Uw[a];s.head=di("svg",o);var u=this._bgcolor;return(u==="transparent"||u==="none")&&(u=null),u?s.bg=di("rect",{width:this._width,height:this._height,style:"fill: "+u+";"})+hi("rect"):s.bg="",s.root=di("g",{transform:"translate("+i+")"}),s.foot=hi("g")+hi("svg"),this};gf.background=function(){var e=s0e.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),e};gf.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot};gf._render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this};gf.buildDefs=function(){var e=this._defs,t="",n,r,i,s;for(r in e.gradient){for(i=e.gradient[r],s=i.stops,t+=di("linearGradient",{id:r,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2}),n=0;n<s.length;++n)t+=di("stop",{offset:s[n].offset,"stop-color":s[n].color})+hi("stop");t+=hi("linearGradient")}for(r in e.clipping)i=e.clipping[r],t+=di("clipPath",{id:r}),i.path?t+=di("path",{d:i.path})+hi("path"):t+=di("rect",{x:0,y:0,width:i.width,height:i.height})+hi("rect"),t+=hi("clipPath");return t.length>0?di("defs")+t+hi("defs"):""};var NP;function Aft(e,t,n,r){NP[r||e]=t}gf.attributes=function(e,t){return NP={},e(Aft,t,this),NP};gf.href=function(e){var t=this,n=e.href,r;if(n){if(r=t._hrefs&&t._hrefs[n])return r;t.sanitizeURL(n).then(function(i){i["xlink:href"]=i.href,i.href=null,(t._hrefs||(t._hrefs={}))[n]=i})}return null};gf.mark=function(e){var t=this,n=ql[e.marktype],r=n.tag,i=this._defs,s="",o;r!=="g"&&e.interactive===!1&&(o='style="pointer-events: none;"'),s+=di("g",{class:t0e(e),"clip-path":e.clip?qW(t,e,e.group):null},o);function a(u){var l=t.href(u);l&&(s+=di("a",l)),o=r!=="g"?FZ(u,e,r,i):null,s+=di(r,t.attributes(n.attr,u),o),r==="text"?s+=Nft(IC(u)):r==="g"&&(s+=di("path",t.attributes(n.background,u),FZ(u,e,"bgrect",i))+hi("path"),s+=di("g",t.attributes(n.foreground,u))+t.markGroup(u)+hi("g")),s+=hi(r),l&&(s+=hi("a"))}return n.nested?e.items&&e.items.length&&a(e.items[0]):Au(e,a),s+hi("g")};gf.markGroup=function(e){var t=this,n="";return Au(e,function(r){n+=t.mark(r)}),n};function FZ(e,t,n,r){if(e==null)return"";var i,s,o,a,u,l="";for(n==="bgrect"&&t.interactive===!1&&(l+="pointer-events: none; "),n==="text"&&(l+="font-family: "+DC(e)+"; ",l+="font-size: "+uh(e)+"px; ",e.fontStyle&&(l+="font-style: "+e.fontStyle+"; "),e.fontVariant&&(l+="font-variant: "+e.fontVariant+"; "),e.fontWeight&&(l+="font-weight: "+e.fontWeight+"; ")),i=0,s=FT.length;i<s;++i)o=FT[i],a=eV[o],u=e[o],u==null?a==="fill"&&(l+="fill: none; "):u==="transparent"&&(a==="fill"||a==="stroke")?l+=a+": none; ":(u.id&&(r.gradient[u.id]=u,u="url(#"+u.id+")"),l+=a+": "+u+"; ");return l?'style="'+l.trim()+'"':null}function Nft(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var o0e="canvas",a0e="png",u0e="svg",l0e="none",Kf={Canvas:o0e,PNG:a0e,SVG:u0e,None:l0e},a1={};a1[o0e]=a1[a0e]={renderer:OT,headless:OT,handler:OC};a1[u0e]={renderer:tV,headless:rV,handler:JW};a1[l0e]={};function RD(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(a1[e]=t,this):a1[e]}var WR=new Es;function c0e(e){var t=e.clip;if(Ot(t))t(fo(WR.clear()));else if(t)WR.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(WR)}var Ift=1e-9;function iV(e,t,n){return e===t?!0:n==="path"?f0e(e,t):e instanceof Date&&t instanceof Date?+e==+t:Rr(e)&&Rr(t)?Math.abs(e-t)<=Ift:!e||!t||!yt(e)&&!yt(t)?e==t:e==null||t==null?!1:Dft(e,t)}function f0e(e,t){return iV(o1(e),o1(t))}function Dft(e,t){var n=Object.keys(e),r=Object.keys(t),i,s;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),s=n.length-1;s>=0;s--)if(n[s]!=r[s])return!1;for(s=n.length-1;s>=0;s--)if(i=n[s],!iV(e[i],t[i],i))return!1;return typeof e==typeof t}function d0e(e){ue.call(this,null,e)}var Oft=Ne(d0e,ue);Oft.transform=function(e,t){var n=t.dataflow,r=e.mark,i=r.marktype,s=ql[i],o=s.bound,a=r.bounds,u;return s.nested?(r.items.length&&n.dirty(r.items[0]),a=S$(r,o),r.items.forEach(function(l){l.bounds.clear().union(a)})):i===bD||e.modified()?(t.visit(t.MOD,function(l){n.dirty(l)}),a.clear(),r.items.forEach(function(l){a.union(S$(l,o))}),r.role===IW&&t.reflow()):(u=t.changed(t.REM),t.visit(t.ADD,function(l){a.union(S$(l,o))}),t.visit(t.MOD,function(l){u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(S$(l,o))}),u&&(a.clear(),r.items.forEach(function(l){a.union(l.bounds)}))),c0e(r),t.modifies("bounds")};function S$(e,t,n){return t(e.bounds.clear(),e,n)}var RZ=":vega_identifier:";function sV(e){ue.call(this,0,e)}sV.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};var Fft=Ne(sV,ue);Fft.transform=function(e,t){var n=Rft(t.dataflow),r=n.value,i=e.as;return t.visit(t.ADD,function(s){s[i]||(s[i]=++r)}),n.set(this.value=r),t};function Rft(e){var t=e._signals[RZ];return t||(e._signals[RZ]=t=e.add(0)),t}function h0e(e){ue.call(this,null,e)}var Mft=Ne(h0e,ue);Mft.transform=function(e,t){var n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Pft(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this,n.clip=e.clip,n.interactive=e.interactive,this.value=n);var r=n.marktype===bD?xD:vD;return t.visit(t.ADD,function(i){r.call(i,n)}),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t};function Pft(e){var t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function p0e(e){ue.call(this,null,e)}var Lft=Ne(p0e,ue),MZ={parity:function(e){return e.filter(function(t,n){return n%2?t.opacity=0:1})},greedy:function(e){var t;return e.filter(function(n,r){return!r||!m0e(t.bounds,n.bounds)?(t=n,1):n.opacity=0})}};function m0e(e,t){return!(e.x2-1<t.x1||e.x1+1>t.x2||e.y2-1<t.y1||e.y1+1>t.y2)}function PZ(e){for(var t=1,n=e.length,r=e[0].bounds,i;t<n;r=i,++t)if(m0e(r,i=e[t].bounds))return!0}function zft(e){var t=e.bounds;return t.width()>1&&t.height()>1}function Bft(e,t,n){var r=e.range(),i=new Es;return t===r1||t===i1?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),function(s){return i.encloses(s.bounds)}}function LZ(e){return e.forEach(function(t){t.opacity=1}),e}function zZ(e,t){return e.reflow(t.modified()).modifies("opacity")}Lft.transform=function(e,t){var n=MZ[e.method]||MZ.parity,r=t.materialize(t.SOURCE).source,i,s;if(r){if(!e.method)return e.modified("method")&&(LZ(r),t=zZ(t,e)),t;if(e.sort&&(r=r.slice().sort(e.sort)),e.method==="greedy"&&(r=r.filter(zft)),i=LZ(r),t=zZ(t,e),i.length>=3&&PZ(i)){do i=n(i);while(i.length>=3&&PZ(i));i.length<3&&!Vt(r).opacity&&(i.length>1&&(Vt(i).opacity=0),Vt(r).opacity=1)}return e.boundScale&&e.boundTolerance>=0&&(s=Bft(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(function(o){s(o)||(o.opacity=0)})),t}};function g0e(e){ue.call(this,null,e)}var Uft=Ne(g0e,ue);Uft.transform=function(e,t){var n=t.dataflow;if(t.visit(t.ALL,function(i){n.dirty(i)}),t.fields&&t.fields.zindex){var r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}};function Wft(e){for(var t=e.items,n=t.length,r=0,i,s,o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};r<n;++r)if(i=t[r],s=i.items,i.marktype===bD)switch(i.role){case sge:case IW:break;case oge:uv(s,o.rowheaders);break;case age:uv(s,o.rowfooters);break;case lge:uv(s,o.colheaders);break;case cge:uv(s,o.colfooters);break;case uge:o.rowtitle=s[0];break;case fge:o.coltitle=s[0];break;default:uv(s,o.marks)}return o}function uv(e,t){for(var n=0,r=e.length;n<r;++n)t.push(e[n])}function Vft(e){return{x1:0,y1:0,x2:e.width||0,y2:e.height||0}}function jft(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Hft(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Gft(e,t){return e.bounds[t]}function Ur(e,t,n){var r=yt(e)?e[t]:e;return r??(n!==void 0?n:0)}function BZ(e){return e<0?Math.ceil(-e):0}function qft(e,t,n){var r=Wft(t),i=r.marks,s=n.bounds===olt,o=s?Vft:jft,a=new Es(0),u=Ur(n.align,Tg),l=Ur(n.align,Ag),c=Ur(n.padding,Tg),f=Ur(n.padding,Ag),d=n.offset,h=t.columns||n.columns||i.length,p=h<0?1:Math.ceil(i.length/h),m=p*h,g=[],y=[],b=0,v=0,x=[],w=[],S=0,C=0,k=i.length,E,_,T,D,O,M,I,P,V,F,B,q;for(_=0;_<h;++_)y[_]=0;for(_=0;_<p;++_)w[_]=0;for(_=0;_<k;++_)O=o(i[_]),T=_%h,D=~~(_/h),I=Math.ceil(o(i[_]).x2),P=Math.ceil(o(i[_]).y2),b=Math.max(b,I),S=Math.max(S,P),y[T]=Math.max(y[T],I),w[D]=Math.max(w[D],P),g.push(c+BZ(O.x1)),x.push(f+BZ(O.y1)),e.dirty(i[_]);for(_=0;_<k;++_)_%h===0&&(g[_]=v),_<h&&(x[_]=C);if(u===xZ)for(T=1;T<h;++T){for(q=0,_=T;_<k;_+=h)q<g[_]&&(q=g[_]);for(_=T;_<k;_+=h)g[_]=q+y[T-1]}else if(u===b$){for(q=0,_=0;_<k;++_)_%h&&q<g[_]&&(q=g[_]);for(_=0;_<k;++_)_%h&&(g[_]=q+b)}else for(u=!1,T=1;T<h;++T)for(_=T;_<k;_+=h)g[_]+=y[T-1];if(l===xZ)for(D=1;D<p;++D){for(q=0,_=D*h,E=_+h;_<E;++_)q<x[_]&&(q=x[_]);for(_=D*h;_<E;++_)x[_]=q+w[D-1]}else if(l===b$){for(q=0,_=h;_<k;++_)q<x[_]&&(q=x[_]);for(_=h;_<k;++_)x[_]=q+S}else for(l=!1,D=1;D<p;++D)for(_=D*h,E=_+h;_<E;++_)x[_]+=w[D-1];for(V=0,_=0;_<k;++_)M=i[_],I=M.x||0,M.x=V=g[_]+(_%h?V:0),M.bounds.translate(V-I,0);for(T=0;T<h;++T)for(F=0,_=T;_<k;_+=h)M=i[_],P=M.y||0,M.y=F+=x[_],M.bounds.translate(0,F-P);if(Ur(n.center,Tg)&&p>1&&u)for(_=0;_<k;++_)M=i[_],O=u===b$?b:y[_%h],V=O-o(M).x2,V>0&&(M.x+=I=V/2,M.bounds.translate(I,0));if(Ur(n.center,Ag)&&h!==1&&l)for(_=0;_<k;++_)M=i[_],O=l===b$?S:w[~~(_/h)],F=O-o(M).y2,F>0&&(M.y+=P=F/2,M.bounds.translate(0,P));for(_=0;_<k;++_)i[_].mark.bounds.clear();for(_=0;_<k;++_)M=i[_],e.dirty(M),a.union(M.mark.bounds.union(M.bounds));function J(re,ae){return Math.floor(Math.min(re,ae))}function ne(re,ae){return Math.ceil(Math.max(re,ae))}o=s?Hft:Gft,B=Ur(n.headerBand,Ag,null),V=C$(e,r.rowheaders,i,h,p,-Ur(d,"rowHeader"),J,0,o,"x1",0,h,1,B),B=Ur(n.headerBand,Tg,null),F=C$(e,r.colheaders,i,h,h,-Ur(d,"columnHeader"),J,1,o,"y1",0,1,h,B),B=Ur(n.footerBand,Ag,null),C$(e,r.rowfooters,i,h,p,Ur(d,"rowFooter"),ne,0,o,"x2",h-1,h,1,B),B=Ur(n.footerBand,Tg,null),C$(e,r.colfooters,i,h,h,Ur(d,"columnFooter"),ne,1,o,"y2",m-h,1,h,B),r.rowtitle&&(q=V-Ur(d,"rowTitle"),B=Ur(n.titleBand,Ag,.5),UZ(e,r.rowtitle,q,0,a,B)),r.coltitle&&(q=F-Ur(d,"columnTitle"),B=Ur(n.titleBand,Tg,.5),UZ(e,r.coltitle,q,1,a,B))}function C$(e,t,n,r,i,s,o,a,u,l,c,f,d,h){var p=n.length,m=0,g=0,y,b,v,x,w,S,C,k,E;if(!p)return m;for(y=c;y<p;y+=f)n[y]&&(m=o(m,u(n[y],l)));if(!t.length)return m;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),m+=s,b=0,x=t.length;b<x;++b)e.dirty(t[b]),t[b].mark.bounds.clear();for(y=c,b=0,x=t.length;b<x;++b,y+=f){for(S=t[b],w=S.mark.bounds,v=y;v>=0&&(C=n[v])==null;v-=d);a?(k=h==null?C.x:Math.round(C.bounds.x1+h*C.bounds.width()),E=m):(k=m,E=h==null?C.y:Math.round(C.bounds.y1+h*C.bounds.height())),w.union(S.bounds.translate(k-(S.x||0),E-(S.y||0))),S.x=k,S.y=E,e.dirty(S),g=o(g,w[l])}return g}function UZ(e,t,n,r,i,s){if(t){e.dirty(t);var o=n,a=n;r?o=Math.round(i.x1+s*i.width()):a=Math.round(i.y1+s*i.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}var WZ=.5,sm=new Es;function y0e(e){ue.call(this,null,e)}var Xft=Ne(y0e,ue);Xft.transform=function(e,t){var n=t.dataflow;return e.mark.items.forEach(function(r){e.layout&&qft(n,r,e.layout),Kft(n,r,e)}),e.modified()&&t.reflow(),t};function Kft(e,t,n){var r=t.items,i=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new Es().set(0,0,i,s),a=o.clone(),u=o.clone(),l=[],c,f,d,h,p,m;for(p=0,m=r.length;p<m;++p)switch(f=r[p],f.role){case sge:h=Yft(f)?a:u,h.union(Qft(e,f,i,s));break;case Zut:c=f;break;case IW:l.push(f);break;case Qut:case Jut:case oge:case age:case uge:case lge:case cge:case fge:a.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length)for(d={leftWidth:edt(e,l),margin:n.legendMargin||8,left:0,right:0,top:0,bottom:0},p=0,m=l.length;p<m;++p)if(h=ndt(e,l[p],d,a,u,i,s),n.autosize&&n.autosize.type===dge){var g=l[p].items[0].datum.orient;g===dl||g===pd?o.add(h.x1,0).add(h.x2,0):(g===r1||g===i1)&&o.add(0,h.y1).add(0,h.y2)}else o.union(h);o.union(a).union(u),c&&o.union(Jft(e,c,i,s,o)),idt(e,t,o,n)}function Yf(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Yft(e){var t=e.items[0].datum.orient;return t===dl||t===pd}function Zft(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Qft(e,t,n,r){var i=t.items[0],s=i.datum,o=s.orient,a=Zft(s),u=i.range,l=i.offset,c=i.position,f=i.minExtent,d=i.maxExtent,h=s.title&&i.items[a[2]].items[0],p=i.titlePadding,m=i.bounds,g=0,y=0,b,v;switch(sm.clear().union(m),m.clear(),(b=a[0])>-1&&m.union(i.items[b].bounds),(b=a[1])>-1&&m.union(i.items[b].bounds),o){case r1:g=c||0,y=-l,v=Math.max(f,Math.min(d,-m.y1)),h&&(v=k$(h,v,p,0,-1,m)),m.add(0,-v).add(u,0);break;case dl:g=-l,y=c||0,v=Math.max(f,Math.min(d,-m.x1)),h&&(v=k$(h,v,p,1,-1,m)),m.add(-v,0).add(0,u);break;case pd:g=n+l,y=c||0,v=Math.max(f,Math.min(d,m.x2)),h&&(v=k$(h,v,p,1,1,m)),m.add(0,0).add(v,u);break;case i1:g=c||0,y=r+l,v=Math.max(f,Math.min(d,m.y2)),h&&(v=k$(h,v,p,0,1,m)),m.add(0,0).add(u,v);break;default:g=i.x,y=i.y}return mf(m.translate(g,y),i),Yf(i,"x",g+WZ)|Yf(i,"y",y+WZ)&&(i.bounds=sm,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function k$(e,t,n,r,i,s){var o=e.bounds,a=0,u=0;return e.auto?(t+=n,r?a=(e.x||0)-(e.x=i*t):u=(e.y||0)-(e.y=i*t),o.translate(-a,-u),e.mark.bounds.set(o.x1,o.y1,o.x2,o.y2),r?(s.add(0,o.y1).add(0,o.y2),t+=o.width()):(s.add(o.x1,0).add(o.x2,0),t+=o.height())):s.union(o),t}function Jft(e,t,n,r,i){var s=t.items[0],o=s.orient,a=s.frame,u=s.anchor,l=s.offset,c=s.bounds,f=o===dl||o===pd,d=0,h=f?r:n,p=0,m=0,g;switch(a!==bD?o===dl?(d=i.y2,h=i.y1):o===pd?(d=i.y1,h=i.y2):(d=i.x1,h=i.x2):o===dl&&(d=r,h=0),g=u===Kut?d:u===Yut?h:(d+h)/2,sm.clear().union(c),o){case r1:p=g,m=i.y1-l;break;case dl:p=i.x1-l,m=g;break;case pd:p=i.x2+l,m=g;break;case i1:p=g,m=i.y2+l;break;default:p=s.x,m=s.y}return c.translate(p-s.x,m-s.y),Yf(s,"x",p)|Yf(s,"y",m)&&(s.bounds=sm,e.dirty(s),s.bounds=c,e.dirty(s)),t.bounds.clear().union(c)}function edt(e,t){return t.reduce(function(n,r){var i=r.items[0];if(tdt(e,i,i.items[0].items[0]),i.datum.orient===dl){var s=sm.clear();i.items.forEach(function(o){s.union(o.bounds)}),n=Math.max(n,Math.ceil(s.width()+2*i.padding-1))}return n},0)}function tdt(e,t,n){var r=t.padding-n.x,i=t.padding-n.y;if(t.datum.title){var s=t.items[1].items[0];i+=t.titlePadding+s.fontSize}(r||i)&&(n.x+=r,n.y+=i,n.bounds.translate(r,i),n.mark.bounds.translate(r,i),e.dirty(n))}function ndt(e,t,n,r,i,s,o){var a=t.items[0],u=a.datum,l=u.orient,c=a.offset,f=a.bounds,d=0,h=0,p,m,g;switch(l===r1||l===i1?(g=i,d=n[l]):(l===dl||l===pd)&&(g=r,h=n[l]),sm.clear().union(f),f.clear(),a.items.forEach(function(y){f.union(y.bounds)}),p=2*a.padding-1,m=2*a.padding-1,f.empty()||(p=Math.ceil(f.width()+p),m=Math.ceil(f.height()+m)),u.type===tlt&&rdt(a.items[0].items[0].items[0].items),l){case dl:d-=n.leftWidth+c-Math.floor(g.x1),n.left+=m+n.margin;break;case pd:d+=c+Math.ceil(g.x2),n.right+=m+n.margin;break;case r1:h-=m+c-Math.floor(g.y1),n.top+=p+n.margin;break;case i1:h+=c+Math.ceil(g.y2),n.bottom+=p+n.margin;break;case Hut:d+=c,h+=c;break;case Gut:d+=s-p-c,h+=c;break;case qut:d+=c,h+=o-m-c;break;case Xut:d+=s-p-c,h+=o-m-c;break;default:d=a.x,h=a.y}return mf(f.set(d,h,d+p,h+m),a),Yf(a,"x",d)|Yf(a,"width",p)|Yf(a,"y",h)|Yf(a,"height",m)&&(a.bounds=sm,e.dirty(a),a.bounds=f,e.dirty(a)),a.mark.bounds.clear().union(f)}function rdt(e){var t=e.reduce(function(n,r){return n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n},{});e.forEach(function(n){n.width=t[n.column],n.height=n.bounds.y2-n.y})}function idt(e,t,n,r){var i=r.autosize||{},s=i.type,o=e._width,a=e._height,u=e.padding();if(!(e._autosize<1||!s)){var l=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,Math.ceil(n.x2-l)),d=Math.max(0,t.height||0),h=Math.max(0,Math.ceil(-n.y1)),p=Math.max(0,Math.ceil(n.y2-d));i.contains===elt&&(o-=u.left+u.right,a-=u.top+u.bottom),s===slt?(c=0,h=0,l=o,d=a):s===dge?(l=Math.max(0,o-c-f),d=Math.max(0,a-h-p)):s===nlt?(l=Math.max(0,o-c-f),a=d+h+p):s===rlt?(o=l+c+f,d=Math.max(0,a-h-p)):s===ilt&&(o=l+c+f,a=d+h+p),e._resizeView(o,a,l,d,[c,h],i.resize)}}const sdt=Object.freeze(Object.defineProperty({__proto__:null,bound:d0e,identifier:sV,mark:h0e,overlap:p0e,render:g0e,viewlayout:y0e},Symbol.toStringTag,{value:"Module"}));var MD="log",oV="pow",odt="utc",aV="sqrt",adt="band",udt="time",VZ="point",uV="linear",b0e="ordinal",v0e="quantile",x0e="quantize",lV="threshold",ldt="bin-linear",w0e="bin-ordinal",S0e="sequential";function cV(e,t,n){var r=e-t+n*2;return e?r>0?r:1:0}function cdt(e){return function(t){var n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function fdt(e){return function(t){var n=e.range(),r=t[0],i=t[1],s=-1,o,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(s<0&&(s=u),o=u);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function fV(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function C0e(e){return e.length===1&&(e=ddt(e)),{left:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var s=r+i>>>1;e(t[s],n)<0?r=s+1:i=s}return r},right:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var s=r+i>>>1;e(t[s],n)>0?i=s:r=s+1}return r}}}function ddt(e){return function(t,n){return fV(e(t),n)}}var hdt=C0e(fV),PD=hdt.right;function pdt(e){return e===null?NaN:+e}var IP=Math.sqrt(50),DP=Math.sqrt(10),OP=Math.sqrt(2);function k0e(e,t,n){var r,i=-1,s,o,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(s=e,e=t,t=s),(a=H_(e,t,n))===0||!isFinite(a))return[];if(a>0)for(e=Math.ceil(e/a),t=Math.floor(t/a),o=new Array(s=Math.ceil(t-e+1));++i<s;)o[i]=(e+i)*a;else for(e=Math.floor(e*a),t=Math.ceil(t*a),o=new Array(s=Math.ceil(e-t+1));++i<s;)o[i]=(e-i)/a;return r&&o.reverse(),o}function H_(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=IP?10:s>=DP?5:s>=OP?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=IP?10:s>=DP?5:s>=OP?2:1)}function FP(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=IP?i*=10:s>=DP?i*=5:s>=OP&&(i*=2),t<e?-i:i}function mdt(e,t,n){if(n==null&&(n=pdt),!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(i-s)}}function yf(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}var ra="$";function RT(){}RT.prototype=Rd.prototype={constructor:RT,has:function(e){return ra+e in this},get:function(e){return this[ra+e]},set:function(e,t){return this[ra+e]=t,this},remove:function(e){var t=ra+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===ra&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===ra&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===ra&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===ra&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===ra&&++e;return e},empty:function(){for(var e in this)if(e[0]===ra)return!1;return!0},each:function(e){for(var t in this)t[0]===ra&&e(this[t],t.slice(1),this)}};function Rd(e,t){var n=new RT;if(e instanceof RT)e.each(function(a,u){n.set(u,a)});else if(Array.isArray(e)){var r=-1,i=e.length,s;if(t==null)for(;++r<i;)n.set(r,e[r]);else for(;++r<i;)n.set(t(s=e[r],r,e),s)}else if(e)for(var o in e)n.set(o,e[o]);return n}function gdt(){var e=[],t=[],n,r,i;function s(a,u,l,c){if(u>=e.length)return n!=null&&a.sort(n),r!=null?r(a):a;for(var f=-1,d=a.length,h=e[u++],p,m,g=Rd(),y,b=l();++f<d;)(y=g.get(p=h(m=a[f])+""))?y.push(m):g.set(p,[m]);return g.each(function(v,x){c(b,x,s(v,u,l,c))}),b}function o(a,u){if(++u>e.length)return a;var l,c=t[u-1];return r!=null&&u>=e.length?l=a.entries():(l=[],a.each(function(f,d){l.push({key:d,values:o(f,u)})})),c!=null?l.sort(function(f,d){return c(f.key,d.key)}):l}return i={object:function(a){return s(a,0,ydt,bdt)},map:function(a){return s(a,0,jZ,HZ)},entries:function(a){return o(s(a,0,jZ,HZ),0)},key:function(a){return e.push(a),i},sortKeys:function(a){return t[e.length-1]=a,i},sortValues:function(a){return n=a,i},rollup:function(a){return r=a,i}}}function ydt(){return{}}function bdt(e,t,n){e[t]=n}function jZ(){return Rd()}function HZ(e,t,n){e.set(t,n)}function GZ(){}var Eh=Rd.prototype;GZ.prototype={constructor:GZ,has:Eh.has,add:function(e){return e+="",this[ra+e]=e,this},remove:Eh.remove,clear:Eh.clear,values:Eh.keys,size:Eh.size,empty:Eh.empty,each:Eh.each};var $0e=Array.prototype,MT=$0e.map,om=$0e.slice,RP={name:"implicit"};function dV(){var e=Rd(),t=[],n=[],r=RP;function i(s){var o=s+"",a=e.get(o);if(!a){if(r!==RP)return r;e.set(o,a=t.push(s))}return n[(a-1)%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=Rd();for(var o=-1,a=s.length,u,l;++o<a;)e.has(l=(u=s[o])+"")||e.set(l,t.push(u));return i},i.range=function(s){return arguments.length?(n=om.call(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return dV(t,n).unknown(r)},yf.apply(i,arguments),i}function ub(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function FC(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function fh(){}var am=.7,u1=1/am,b0="\\s*([+-]?\\d+)\\s*",Ww="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vdt=/^#([0-9a-f]{3,8})$/,xdt=new RegExp("^rgb\\("+[b0,b0,b0]+"\\)$"),wdt=new RegExp("^rgb\\("+[Cl,Cl,Cl]+"\\)$"),Sdt=new RegExp("^rgba\\("+[b0,b0,b0,Ww]+"\\)$"),Cdt=new RegExp("^rgba\\("+[Cl,Cl,Cl,Ww]+"\\)$"),kdt=new RegExp("^hsl\\("+[Ww,Cl,Cl]+"\\)$"),$dt=new RegExp("^hsla\\("+[Ww,Cl,Cl,Ww]+"\\)$"),qZ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ub(fh,Vw,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:XZ,formatHex:XZ,formatHsl:_dt,formatRgb:KZ,toString:KZ});function XZ(){return this.rgb().formatHex()}function _dt(){return _0e(this).formatHsl()}function KZ(){return this.rgb().formatRgb()}function Vw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=vdt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?YZ(t):n===3?new pi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$$(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$$(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xdt.exec(e))?new pi(t[1],t[2],t[3],1):(t=wdt.exec(e))?new pi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Sdt.exec(e))?$$(t[1],t[2],t[3],t[4]):(t=Cdt.exec(e))?$$(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=kdt.exec(e))?JZ(t[1],t[2]/100,t[3]/100,1):(t=$dt.exec(e))?JZ(t[1],t[2]/100,t[3]/100,t[4]):qZ.hasOwnProperty(e)?YZ(qZ[e]):e==="transparent"?new pi(NaN,NaN,NaN,0):null}function YZ(e){return new pi(e>>16&255,e>>8&255,e&255,1)}function $$(e,t,n,r){return r<=0&&(e=t=n=NaN),new pi(e,t,n,r)}function hV(e){return e instanceof fh||(e=Vw(e)),e?(e=e.rgb(),new pi(e.r,e.g,e.b,e.opacity)):new pi}function l1(e,t,n,r){return arguments.length===1?hV(e):new pi(e,t,n,r??1)}function pi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ub(pi,l1,FC(fh,{brighter:function(e){return e=e==null?u1:Math.pow(u1,e),new pi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?am:Math.pow(am,e),new pi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ZZ,formatHex:ZZ,formatRgb:QZ,toString:QZ}));function ZZ(){return"#"+VR(this.r)+VR(this.g)+VR(this.b)}function QZ(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function VR(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function JZ(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new al(e,t,n,r)}function _0e(e){if(e instanceof al)return new al(e.h,e.s,e.l,e.opacity);if(e instanceof fh||(e=Vw(e)),!e)return new al;if(e instanceof al)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new al(o,a,u,e.opacity)}function PT(e,t,n,r){return arguments.length===1?_0e(e):new al(e,t,n,r??1)}function al(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ub(al,PT,FC(fh,{brighter:function(e){return e=e==null?u1:Math.pow(u1,e),new al(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?am:Math.pow(am,e),new al(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new pi(jR(e>=240?e-240:e+120,i,r),jR(e,i,r),jR(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function jR(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var E0e=Math.PI/180,T0e=180/Math.PI,LT=18,A0e=.96422,N0e=1,I0e=.82521,D0e=4/29,v0=6/29,O0e=3*v0*v0,Edt=v0*v0*v0;function F0e(e){if(e instanceof kl)return new kl(e.l,e.a,e.b,e.opacity);if(e instanceof kc)return R0e(e);e instanceof pi||(e=hV(e));var t=XR(e.r),n=XR(e.g),r=XR(e.b),i=HR((.2225045*t+.7168786*n+.0606169*r)/N0e),s,o;return t===n&&n===r?s=o=i:(s=HR((.4360747*t+.3850649*n+.1430804*r)/A0e),o=HR((.0139322*t+.0971045*n+.7141733*r)/I0e)),new kl(116*i-16,500*(s-i),200*(i-o),e.opacity)}function zT(e,t,n,r){return arguments.length===1?F0e(e):new kl(e,t,n,r??1)}function kl(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}ub(kl,zT,FC(fh,{brighter:function(e){return new kl(this.l+LT*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new kl(this.l-LT*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=A0e*GR(t),e=N0e*GR(e),n=I0e*GR(n),new pi(qR(3.1338561*t-1.6168667*e-.4906146*n),qR(-.9787684*t+1.9161415*e+.033454*n),qR(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function HR(e){return e>Edt?Math.pow(e,1/3):e/O0e+D0e}function GR(e){return e>v0?e*e*e:O0e*(e-D0e)}function qR(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function XR(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Tdt(e){if(e instanceof kc)return new kc(e.h,e.c,e.l,e.opacity);if(e instanceof kl||(e=F0e(e)),e.a===0&&e.b===0)return new kc(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*T0e;return new kc(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function BT(e,t,n,r){return arguments.length===1?Tdt(e):new kc(e,t,n,r??1)}function kc(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function R0e(e){if(isNaN(e.h))return new kl(e.l,0,0,e.opacity);var t=e.h*E0e;return new kl(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ub(kc,BT,FC(fh,{brighter:function(e){return new kc(this.h,this.c,this.l+LT*(e??1),this.opacity)},darker:function(e){return new kc(this.h,this.c,this.l-LT*(e??1),this.opacity)},rgb:function(){return R0e(this).rgb()}}));var M0e=-.14861,pV=1.78277,mV=-.29227,LD=-.90649,jw=1.97294,eQ=jw*LD,tQ=jw*pV,nQ=pV*mV-LD*M0e;function Adt(e){if(e instanceof $p)return new $p(e.h,e.s,e.l,e.opacity);e instanceof pi||(e=hV(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(nQ*r+eQ*t-tQ*n)/(nQ+eQ-tQ),s=r-i,o=(jw*(n-i)-mV*s)/LD,a=Math.sqrt(o*o+s*s)/(jw*i*(1-i)),u=a?Math.atan2(o,s)*T0e-120:NaN;return new $p(u<0?u+360:u,a,i,e.opacity)}function Ml(e,t,n,r){return arguments.length===1?Adt(e):new $p(e,t,n,r??1)}function $p(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ub($p,Ml,FC(fh,{brighter:function(e){return e=e==null?u1:Math.pow(u1,e),new $p(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?am:Math.pow(am,e),new $p(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*E0e,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new pi(255*(t+n*(M0e*r+pV*i)),255*(t+n*(mV*r+LD*i)),255*(t+n*(jw*r)),this.opacity)}}));function P0e(e,t,n,r,i){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*i)/6}function L0e(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],o=r>0?e[r-1]:2*i-s,a=r<t-1?e[r+2]:2*s-i;return P0e((n-r/t)*t,o,i,s,a)}}function z0e(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],o=e[(r+1)%t],a=e[(r+2)%t];return P0e((n-r/t)*t,i,s,o,a)}}function zD(e){return function(){return e}}function B0e(e,t){return function(n){return e+n*t}}function Ndt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function BD(e,t){var n=t-e;return n?B0e(e,n>180||n<-180?n-360*Math.round(n/360):n):zD(isNaN(e)?t:e)}function Idt(e){return(e=+e)==1?Xr:function(t,n){return n-t?Ndt(t,n,e):zD(isNaN(t)?n:t)}}function Xr(e,t){var n=t-e;return n?B0e(e,n):zD(isNaN(e)?t:e)}const MP=function e(t){var n=Idt(t);function r(i,s){var o=n((i=l1(i)).r,(s=l1(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),l=Xr(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function U0e(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=l1(t[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=e(r),i=e(i),s=e(s),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=s(u),a+""}}}var RC=U0e(L0e),Ddt=U0e(z0e);function gV(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function W0e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Odt(e,t){return(W0e(t)?gV:V0e)(e,t)}function V0e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=MC(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function j0e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ou(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function H0e(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=MC(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var PP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,KR=new RegExp(PP.source,"g");function Fdt(e){return function(){return e}}function Rdt(e){return function(t){return e(t)+""}}function G0e(e,t){var n=PP.lastIndex=KR.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(r=PP.exec(e))&&(i=KR.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:ou(r,i)})),n=KR.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?Rdt(u[0].x):Fdt(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function MC(e,t){var n=typeof t,r;return t==null||n==="boolean"?zD(t):(n==="number"?ou:n==="string"?(r=Vw(t))?(t=r,MP):G0e:t instanceof Vw?MP:t instanceof Date?j0e:W0e(t)?gV:Array.isArray(t)?V0e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?H0e:ou)(e,t)}function Mdt(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Pdt(e,t){var n=BD(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function yV(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var rQ=180/Math.PI,LP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function q0e(e,t,n,r,i,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*rQ,skewX:Math.atan(u)*rQ,scaleX:o,scaleY:a}}var lv,YR,iQ,_$;function Ldt(e){return e==="none"?LP:(lv||(lv=document.createElement("DIV"),YR=document.documentElement,iQ=document.defaultView),lv.style.transform=e,e=iQ.getComputedStyle(YR.appendChild(lv),null).getPropertyValue("transform"),YR.removeChild(lv),e=e.slice(7,-1).split(","),q0e(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function zdt(e){return e==null||(_$||(_$=document.createElementNS("http://www.w3.org/2000/svg","g")),_$.setAttribute("transform",e),!(e=_$.transform.baseVal.consolidate()))?LP:(e=e.matrix,q0e(e.a,e.b,e.c,e.d,e.e,e.f))}function X0e(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:ou(l,f)},{i:m-2,x:ou(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:ou(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:ou(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:ou(l,f)},{i:m-2,x:ou(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,m=d.length,g;++p<m;)f[(g=d[p]).i]=g.x(h);return f.join("")}}}var Bdt=X0e(Ldt,"px, ","px)","deg)"),Udt=X0e(zdt,", ",")",")"),cv=Math.SQRT2,ZR=2,sQ=4,Wdt=1e-12;function oQ(e){return((e=Math.exp(e))+1/e)/2}function Vdt(e){return((e=Math.exp(e))-1/e)/2}function jdt(e){return((e=Math.exp(2*e))-1)/(e+1)}function Hdt(e,t){var n=e[0],r=e[1],i=e[2],s=t[0],o=t[1],a=t[2],u=s-n,l=o-r,c=u*u+l*l,f,d;if(c<Wdt)d=Math.log(a/i)/cv,f=function(b){return[n+b*u,r+b*l,i*Math.exp(cv*b*d)]};else{var h=Math.sqrt(c),p=(a*a-i*i+sQ*c)/(2*i*ZR*h),m=(a*a-i*i-sQ*c)/(2*a*ZR*h),g=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(m*m+1)-m);d=(y-g)/cv,f=function(b){var v=b*d,x=oQ(g),w=i/(ZR*h)*(x*jdt(cv*v+g)-Vdt(g));return[n+w*u,r+w*l,i*x/oQ(cv*v+g)]}}return f.duration=d*1e3,f}function K0e(e){return function(t,n){var r=e((t=PT(t)).h,(n=PT(n)).h),i=Xr(t.s,n.s),s=Xr(t.l,n.l),o=Xr(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const Gdt=K0e(BD);var qdt=K0e(Xr);function Xdt(e,t){var n=Xr((e=zT(e)).l,(t=zT(t)).l),r=Xr(e.a,t.a),i=Xr(e.b,t.b),s=Xr(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=s(o),e+""}}function Y0e(e){return function(t,n){var r=e((t=BT(t)).h,(n=BT(n)).h),i=Xr(t.c,n.c),s=Xr(t.l,n.l),o=Xr(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const Kdt=Y0e(BD);var Ydt=Y0e(Xr);function Z0e(e){return function t(n){n=+n;function r(i,s){var o=e((i=Ml(i)).h,(s=Ml(s)).h),a=Xr(i.s,s.s),u=Xr(i.l,s.l),l=Xr(i.opacity,s.opacity);return function(c){return i.h=o(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const Zdt=Z0e(BD);var UD=Z0e(Xr);function Qdt(e,t){for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[a](o-a)}}function Jdt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const eht=Object.freeze(Object.defineProperty({__proto__:null,interpolate:MC,interpolateArray:Odt,interpolateBasis:L0e,interpolateBasisClosed:z0e,interpolateCubehelix:Zdt,interpolateCubehelixLong:UD,interpolateDate:j0e,interpolateDiscrete:Mdt,interpolateHcl:Kdt,interpolateHclLong:Ydt,interpolateHsl:Gdt,interpolateHslLong:qdt,interpolateHue:Pdt,interpolateLab:Xdt,interpolateNumber:ou,interpolateNumberArray:gV,interpolateObject:H0e,interpolateRgb:MP,interpolateRgbBasis:RC,interpolateRgbBasisClosed:Ddt,interpolateRound:yV,interpolateString:G0e,interpolateTransformCss:Bdt,interpolateTransformSvg:Udt,interpolateZoom:Hdt,piecewise:Qdt,quantize:Jdt},Symbol.toStringTag,{value:"Module"}));function tht(e){return function(){return e}}function zP(e){return+e}var aQ=[0,1];function ya(e){return e}function BP(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:tht(isNaN(t)?NaN:.5)}function uQ(e){var t=e[0],n=e[e.length-1],r;return t>n&&(r=t,t=n,n=r),function(i){return Math.max(t,Math.min(n,i))}}function nht(e,t,n){var r=e[0],i=e[1],s=t[0],o=t[1];return i<r?(r=BP(i,r),s=n(o,s)):(r=BP(r,i),s=n(s,o)),function(a){return s(r(a))}}function rht(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=BP(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=PD(e,a,1,r)-1;return s[u](i[u](a))}}function WD(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bV(){var e=aQ,t=aQ,n=MC,r,i,s,o=ya,a,u,l;function c(){return a=Math.min(e.length,t.length)>2?rht:nht,u=l=null,f}function f(d){return isNaN(d=+d)?s:(u||(u=a(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=a(t,e.map(r),ou)))(d)))},f.domain=function(d){return arguments.length?(e=MT.call(d,zP),o===ya||(o=uQ(e)),c()):e.slice()},f.range=function(d){return arguments.length?(t=om.call(d),c()):t.slice()},f.rangeRound=function(d){return t=om.call(d),n=yV,c()},f.clamp=function(d){return arguments.length?(o=d?uQ(e):ya,f):o!==ya},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return r=d,i=h,c()}}function Q0e(e,t){return bV()(e,t)}function iht(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function UT(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function c1(e){return e=UT(Math.abs(e)),e?e[1]:NaN}function sht(e,t){return function(n,r){for(var i=n.length,s=[],o=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),s.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function oht(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var aht=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Md(e){if(!(t=aht.exec(e)))throw new Error("invalid format: "+e);var t;return new VD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Md.prototype=VD.prototype;function VD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}VD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uht(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var J0e;function lht(e,t){var n=UT(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(J0e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+UT(e,Math.max(0,t+s-1))[0]}function lQ(e,t){var n=UT(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const cQ={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:iht,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return lQ(e*100,t)},r:lQ,s:lht,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function fQ(e){return e}var dQ=Array.prototype.map,hQ=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function e1e(e){var t=e.grouping===void 0||e.thousands===void 0?fQ:sht(dQ.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?fQ:oht(dQ.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"-":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Md(f);var d=f.fill,h=f.align,p=f.sign,m=f.symbol,g=f.zero,y=f.width,b=f.comma,v=f.precision,x=f.trim,w=f.type;w==="n"?(b=!0,w="g"):cQ[w]||(v===void 0&&(v=12),x=!0,w="g"),(g||d==="0"&&h==="=")&&(g=!0,d="0",h="=");var S=m==="$"?n:m==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",C=m==="$"?r:/[%p]/.test(w)?o:"",k=cQ[w],E=/[defgprs%]/.test(w);v=v===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function _(T){var D=S,O=C,M,I,P;if(w==="c")O=k(T)+O,T="";else{T=+T;var V=T<0||1/T<0;if(T=isNaN(T)?u:k(Math.abs(T),v),x&&(T=uht(T)),V&&+T==0&&p!=="+"&&(V=!1),D=(V?p==="("?p:a:p==="-"||p==="("?"":p)+D,O=(w==="s"?hQ[8+J0e/3]:"")+O+(V&&p==="("?")":""),E){for(M=-1,I=T.length;++M<I;)if(P=T.charCodeAt(M),48>P||P>57){O=(P===46?i+T.slice(M+1):T.slice(M))+O,T=T.slice(0,M);break}}}b&&!g&&(T=t(T,1/0));var F=D.length+T.length+O.length,B=F<y?new Array(y-F+1).join(d):"";switch(b&&g&&(T=t(B+T,B.length?y-O.length:1/0),B=""),h){case"<":T=D+T+O+B;break;case"=":T=D+B+T+O;break;case"^":T=B.slice(0,F=B.length>>1)+D+T+O+B.slice(F);break;default:T=B+D+T+O;break}return s(T)}return _.toString=function(){return f+""},_}function c(f,d){var h=l((f=Md(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(c1(d)/3)))*3,m=Math.pow(10,-p),g=hQ[8+p/3];return function(y){return h(m*y)+g}}return{format:l,formatPrefix:c}}var E$,bu,jD;vV({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function vV(e){return E$=e1e(e),bu=E$.format,jD=E$.formatPrefix,E$}function xV(e){return Math.max(0,-c1(Math.abs(e)))}function wV(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(c1(t)/3)))*3-c1(Math.abs(e)))}function SV(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,c1(t)-c1(e))+1}const cht=Object.freeze(Object.defineProperty({__proto__:null,FormatSpecifier:VD,get format(){return bu},formatDefaultLocale:vV,formatLocale:e1e,get formatPrefix(){return jD},formatSpecifier:Md,precisionFixed:xV,precisionPrefix:wV,precisionRound:SV},Symbol.toStringTag,{value:"Module"}));function fht(e,t,n,r){var i=FP(e,t,n),s;switch(r=Md(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=wV(i,o))&&(r.precision=s),jD(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=SV(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=xV(i))&&(r.precision=s-(r.type==="%")*2);break}}return bu(r)}function HD(e){var t=e.domain;return e.ticks=function(n){var r=t();return k0e(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return fht(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,o=r[i],a=r[s],u;return a<o&&(u=o,o=a,a=u,u=i,i=s,s=u),u=H_(o,a,n),u>0?(o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u,u=H_(o,a,n)):u<0&&(o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u,u=H_(o,a,n)),u>0?(r[i]=Math.floor(o/u)*u,r[s]=Math.ceil(a/u)*u,t(r)):u<0&&(r[i]=Math.ceil(o*u)/u,r[s]=Math.floor(a*u)/u,t(r)),e},e}function PC(){var e=Q0e(ya,ya);return e.copy=function(){return WD(e,PC())},yf.apply(e,arguments),HD(e)}function t1e(e){var t;function n(r){return isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=MT.call(r,zP),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return t1e(e).unknown(t)},e=arguments.length?MT.call(e,zP):[0,1],HD(n)}function n1e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],o;return s<i&&(o=n,n=r,r=o,o=i,i=s,s=o),e[n]=t.floor(i),e[r]=t.ceil(s),e}function pQ(e){return Math.log(e)}function mQ(e){return Math.exp(e)}function dht(e){return-Math.log(-e)}function hht(e){return-Math.exp(-e)}function pht(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mht(e){return e===10?pht:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function ght(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function gQ(e){return function(t){return-e(-t)}}function yht(e){var t=e(pQ,mQ),n=t.domain,r=10,i,s;function o(){return i=ght(r),s=mht(r),n()[0]<0?(i=gQ(i),s=gQ(s),e(dht,hht)):e(pQ,mQ),t}return t.base=function(a){return arguments.length?(r=+a,o()):r},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=function(a){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),p,m,g,y=a==null?10:+a,b=[];if(!(r%1)&&h-d<y){if(d=Math.round(d)-1,h=Math.round(h)+1,l>0){for(;d<h;++d)for(m=1,p=s(d);m<r;++m)if(g=p*m,!(g<l)){if(g>c)break;b.push(g)}}else for(;d<h;++d)for(m=r-1,p=s(d);m>=1;--m)if(g=p*m,!(g<l)){if(g>c)break;b.push(g)}}else b=k0e(d,h,Math.min(h-d,y)).map(s);return f?b.reverse():b},t.tickFormat=function(a,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=bu(u)),a===1/0)return u;a==null&&(a=10);var l=Math.max(1,r*a/t.ticks().length);return function(c){var f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(n1e(n(),{floor:function(a){return s(Math.floor(i(a)))},ceil:function(a){return s(Math.ceil(i(a)))}}))},t}function r1e(){var e=yht(bV()).domain([1,10]);return e.copy=function(){return WD(e,r1e()).base(e.base())},yf.apply(e,arguments),e}function yQ(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function bht(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function vht(e){return e<0?-e*e:e*e}function xht(e){var t=e(ya,ya),n=1;function r(){return n===1?e(ya,ya):n===.5?e(bht,vht):e(yQ(n),yQ(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},HD(t)}function CV(){var e=xht(bV());return e.copy=function(){return WD(e,CV()).exponent(e.exponent())},yf.apply(e,arguments),e}function wht(){return CV.apply(null,arguments).exponent(.5)}function i1e(){var e=[],t=[],n=[],r;function i(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=mdt(e,o/a);return s}function s(o){return isNaN(o=+o)?r:t[PD(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(var a=0,u=o.length,l;a<u;++a)l=o[a],l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(fV),i()},s.range=function(o){return arguments.length?(t=om.call(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return i1e().domain(e).range(t).unknown(r)},yf.apply(s,arguments)}function s1e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function o(u){return u<=u?i[PD(r,u,0,n)]:s}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?(e=+u[0],t=+u[1],a()):[e,t]},o.range=function(u){return arguments.length?(n=(i=om.call(u)).length-1,a()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return s1e().domain([e,t]).range(i).unknown(s)},yf.apply(HD(o),arguments)}function o1e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s<=s?t[PD(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=om.call(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=om.call(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return o1e().domain(e).range(t).unknown(n)},yf.apply(i,arguments)}var Gv=1e3,qv=Gv*60,Xv=qv*60,Hw=Xv*24,Sht=Hw*7,bQ=Hw*30,QR=Hw*365;function Cht(e){return new Date(e)}function kht(e){return e instanceof Date?+e:+new Date(+e)}function kV(e,t,n,r,i,s,o,a,u){var l=Q0e(ya,ya),c=l.invert,f=l.domain,d=u(".%L"),h=u(":%S"),p=u("%I:%M"),m=u("%I %p"),g=u("%a %d"),y=u("%b %d"),b=u("%B"),v=u("%Y"),x=[[o,1,Gv],[o,5,5*Gv],[o,15,15*Gv],[o,30,30*Gv],[s,1,qv],[s,5,5*qv],[s,15,15*qv],[s,30,30*qv],[i,1,Xv],[i,3,3*Xv],[i,6,6*Xv],[i,12,12*Xv],[r,1,Hw],[r,2,2*Hw],[n,1,Sht],[t,1,bQ],[t,3,3*bQ],[e,1,QR]];function w(C){return(o(C)<C?d:s(C)<C?h:i(C)<C?p:r(C)<C?m:t(C)<C?n(C)<C?g:y:e(C)<C?b:v)(C)}function S(C,k,E,_){if(C==null&&(C=10),typeof C=="number"){var T=Math.abs(E-k)/C,D=C0e(function(O){return O[2]}).right(x,T);D===x.length?(_=FP(k/QR,E/QR,C),C=e):D?(D=x[T/x[D-1][2]<x[D][2]/T?D-1:D],_=D[1],C=D[0]):(_=Math.max(FP(k,E,C),1),C=a)}return _==null?C:C.every(_)}return l.invert=function(C){return new Date(c(C))},l.domain=function(C){return arguments.length?f(MT.call(C,kht)):f().map(Cht)},l.ticks=function(C,k){var E=f(),_=E[0],T=E[E.length-1],D=T<_,O;return D&&(O=_,_=T,T=O),O=S(C,_,T,k),O=O?O.range(_,T+1):[],D?O.reverse():O},l.tickFormat=function(C,k){return k==null?w:u(k)},l.nice=function(C,k){var E=f();return(C=S(C,E[0],E[E.length-1],k))?f(n1e(E,C)):l},l.copy=function(){return WD(l,kV(e,t,n,r,i,s,o,a,u))},l}function $ht(){return yf.apply(kV(Yc,zU,hD,SC,LU,PU,wC,tm,VU).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function _ht(){return yf.apply(kV(Zc,WU,pD,CC,UU,BU,wC,tm,HU).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function $V(){var e=dV().unknown(void 0),t=e.domain,n=e.range,r=[0,1],i,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){var f=t().length,d=r[1]<r[0],h=r[d-0],p=r[1-d],m=cV(f,a,u);i=(p-h)/(m||1),o&&(i=Math.floor(i)),h+=(p-h-i*(f-a))*l,s=i*(1-a),o&&(h=Math.round(h),s=Math.round(s));var g=TC(f).map(function(y){return h+i*y});return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(!(f[0]==null||f[1]==null)){var d=+f[0],h=+f[1],p=r[1]<r[0],m=p?n().reverse():n(),g=m.length-1,y,b,v;if(!(d!==d||h!==h)&&(h<d&&(v=d,d=h,h=v),!(h<m[0]||d>r[1-p])))return y=Math.max(0,_T(m,d)-1),b=d===h?y:_T(m,h)-1,d-m[y]>s+1e-10&&++y,p&&(v=y,y=g-b,b=g-v),y>b?void 0:t().slice(y,b+1)}},e.invert=function(f){var d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return $V().domain(t()).range(r).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function a1e(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return a1e(t())},e}function Eht(){return a1e($V().paddingInner(1))}var Tht=Array.prototype.map,Aht=Array.prototype.slice;function u1e(e){return Tht.call(e,function(t){return+t})}function l1e(){var e=PC(),t=[];function n(i){return e(i)}function r(i){t=u1e(i),e.domain([t[0],Vt(t)])}return n.domain=function(i){return arguments.length?(r(i),n):t.slice()},n.range=function(i){return arguments.length?(e.range(i),n):e.range()},n.rangeRound=function(i){return arguments.length?(e.rangeRound(i),n):e.rangeRound()},n.interpolate=function(i){return arguments.length?(e.interpolate(i),n):e.interpolate()},n.invert=function(i){return e.invert(i)},n.ticks=function(i){var s=t.length,o=~~(s/(i||s));return o<2?n.domain():t.filter(function(a,u){return!(u%o)})},n.tickFormat=function(){return e.tickFormat.apply(e,arguments)},n.copy=function(){return l1e().domain(n.domain()).range(n.range())},n}function c1e(){var e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(_T(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=u1e(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Aht.call(r),n):t.slice()},n.tickFormat=function(){var r=PC().domain([e[0],Vt(e)]);return r.tickFormat.apply(r,arguments)},n.copy=function(){return c1e().domain(n.domain()).range(n.range())},n}function f1e(e){var t=PC(),n=0,r=1,i=!1;function s(){var a=t.domain();n=a[0],r=Vt(a)-n}function o(a){var u=(a-n)/r;return e(i?Math.max(0,Math.min(1,u)):u)}return o.clamp=function(a){return arguments.length?(i=!!a,o):i},o.domain=function(a){return arguments.length?(t.domain(a),s(),o):t.domain()},o.interpolator=function(a){return arguments.length?(e=a,o):e},o.copy=function(){return f1e().domain(t.domain()).clamp(i).interpolator(e)},o.ticks=function(a){return t.ticks(a)},o.tickFormat=function(a,u){return t.tickFormat(a,u)},o.nice=function(a){return t.nice(a),s(),o},o}function Nht(e,t){return function(){var r=t();return r.invertRange||(r.invertRange=r.invert?cdt(r):r.invertExtent?fdt(r):void 0),r.type=e,r}}function GD(e,t){return arguments.length>1?(Ix[e]=Nht(e,t),this):Ix.hasOwnProperty(e)?Ix[e]:void 0}var Ix={identity:t1e,linear:PC,log:r1e,ordinal:dV,pow:CV,sqrt:wht,quantile:i1e,quantize:s1e,threshold:o1e,time:$ht,utc:_ht,band:$V,point:Eht,sequential:f1e,"bin-linear":l1e,"bin-ordinal":c1e};for(var vQ in Ix)GD(vQ,Ix[vQ]);function d1e(e,t){var n=t[0],r=Vt(t)-n;return function(i){return e(n+i*r)}}function h1e(e,t,n){var r=n-t;return!r||!isFinite(r)?Rl(0):e.type==="linear"||e.type==="sequential"?function(i){return(i-t)/r}:e.copy().domain([t,n]).range([0,1]).interpolate(Iht)}function Iht(e,t){var n=t-e;return function(r){return e+r*n}}function p1e(e,t){var n=eht[Dht(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Dht(e){return"interpolate"+e.toLowerCase().split("-").map(function(t){return t[0].toUpperCase()+t.slice(1)}).join("")}function lb(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}var Oht=lb("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Fht=lb("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Rht=lb("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Mht=lb("4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac"),Pht=lb("4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"),m1e=new Array(3).concat("67a9cff7f7f7f1a340","0571b092c5defdb863e66101","0571b092c5def7f7f7fdb863e66101","2166ac67a9cfd1e5f0fee0b6f1a340b35806","2166ac67a9cfd1e5f0f7f7f7fee0b6f1a340b35806","2166ac4393c392c5ded1e5f0fee0b6fdb863e08214b35806","2166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b35806","0530612166ac4393c392c5ded1e5f0fee0b6fdb863e08214b358067f3b08","0530612166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b358067f3b08").map(lb);function Ct(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const g1e=Ct("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),y1e=Ct("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),b1e=Ct("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),v1e=Ct("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),x1e=Ct("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),w1e=Ct("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),S1e=Ct("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),C1e=Ct("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),k1e=Ct("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Lht=Ct("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function vn(e){return RC(e[e.length-1])}var $1e=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ct);const zht=vn($1e);var _1e=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ct);const Bht=vn(_1e);var E1e=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ct);const Uht=vn(E1e);var T1e=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ct);const Wht=vn(T1e);var A1e=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ct);const Vht=vn(A1e);var N1e=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ct);const jht=vn(N1e);var I1e=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ct);const Hht=vn(I1e);var D1e=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ct);const Ght=vn(D1e);var O1e=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ct);const qht=vn(O1e);var F1e=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ct);const Xht=vn(F1e);var R1e=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ct);const Kht=vn(R1e);var M1e=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ct);const Yht=vn(M1e);var P1e=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ct);const Zht=vn(P1e);var L1e=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ct);const Qht=vn(L1e);var z1e=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ct);const Jht=vn(z1e);var B1e=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ct);const ept=vn(B1e);var U1e=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ct);const tpt=vn(U1e);var W1e=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ct);const npt=vn(W1e);var V1e=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ct);const rpt=vn(V1e);var j1e=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ct);const ipt=vn(j1e);var H1e=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ct);const spt=vn(H1e);var G1e=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ct);const opt=vn(G1e);var q1e=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ct);const apt=vn(q1e);var X1e=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ct);const upt=vn(X1e);var K1e=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ct);const lpt=vn(K1e);var Y1e=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ct);const cpt=vn(Y1e);var Z1e=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ct);const fpt=vn(Z1e);function dpt(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const hpt=UD(Ml(300,.5,0),Ml(-240,.5,1));var ppt=UD(Ml(-100,.75,.35),Ml(80,1.5,.8)),mpt=UD(Ml(260,.75,.35),Ml(80,1.5,.8)),T$=Ml();function Q1e(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return T$.h=360*e-100,T$.s=1.5-1.5*t,T$.l=.8-.9*t,T$+""}var A$=l1(),gpt=Math.PI/3,ypt=Math.PI*2/3;function J1e(e){var t;return e=(.5-e)*Math.PI,A$.r=255*(t=Math.sin(e))*t,A$.g=255*(t=Math.sin(e+gpt))*t,A$.b=255*(t=Math.sin(e+ypt))*t,A$+""}function bpt(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function qD(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const eye=qD(Ct("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var tye=qD(Ct("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),nye=qD(Ct("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),rye=qD(Ct("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));const xQ=Object.freeze(Object.defineProperty({__proto__:null,interpolateBlues:opt,interpolateBrBG:zht,interpolateBuGn:Xht,interpolateBuPu:Kht,interpolateCividis:dpt,interpolateCool:mpt,interpolateCubehelixDefault:hpt,interpolateGnBu:Yht,interpolateGreens:apt,interpolateGreys:upt,interpolateInferno:nye,interpolateMagma:tye,interpolateOrRd:Zht,interpolateOranges:fpt,interpolatePRGn:Bht,interpolatePiYG:Uht,interpolatePlasma:rye,interpolatePuBu:Jht,interpolatePuBuGn:Qht,interpolatePuOr:Wht,interpolatePuRd:ept,interpolatePurples:lpt,interpolateRainbow:Q1e,interpolateRdBu:Vht,interpolateRdGy:jht,interpolateRdPu:tpt,interpolateRdYlBu:Hht,interpolateRdYlGn:Ght,interpolateReds:cpt,interpolateSinebow:J1e,interpolateSpectral:qht,interpolateTurbo:bpt,interpolateViridis:eye,interpolateWarm:ppt,interpolateYlGn:rpt,interpolateYlGnBu:npt,interpolateYlOrBr:ipt,interpolateYlOrRd:spt,schemeAccent:y1e,schemeBlues:G1e,schemeBrBG:$1e,schemeBuGn:F1e,schemeBuPu:R1e,schemeCategory10:g1e,schemeDark2:b1e,schemeGnBu:M1e,schemeGreens:q1e,schemeGreys:X1e,schemeOrRd:P1e,schemeOranges:Z1e,schemePRGn:_1e,schemePaired:v1e,schemePastel1:x1e,schemePastel2:w1e,schemePiYG:E1e,schemePuBu:z1e,schemePuBuGn:L1e,schemePuOr:T1e,schemePuRd:B1e,schemePurples:K1e,schemeRdBu:A1e,schemeRdGy:N1e,schemeRdPu:U1e,schemeRdYlBu:I1e,schemeRdYlGn:D1e,schemeReds:Y1e,schemeSet1:S1e,schemeSet2:C1e,schemeSet3:k1e,schemeSpectral:O1e,schemeTableau10:Lht,schemeYlGn:V1e,schemeYlGnBu:W1e,schemeYlOrBr:j1e,schemeYlOrRd:H1e},Symbol.toStringTag,{value:"Module"}));var x0={blueorange:m1e},Dx={category10:g1e,accent:y1e,dark2:b1e,paired:v1e,pastel1:x1e,pastel2:w1e,set1:S1e,set2:C1e,set3:k1e,category20:Oht,category20b:Fht,category20c:Rht,tableau10:Mht,tableau20:Pht,viridis:eye,magma:tye,inferno:nye,plasma:rye,rainbow:Q1e,sinebow:J1e,blueorange:RC(Vt(m1e))};function xn(e,t){Dx[e]=xQ["interpolate"+t],x0[e]=xQ["scheme"+t]}xn("blues","Blues");xn("greens","Greens");xn("greys","Greys");xn("purples","Purples");xn("reds","Reds");xn("oranges","Oranges");xn("brownbluegreen","BrBG");xn("purplegreen","PRGn");xn("pinkyellowgreen","PiYG");xn("purpleorange","PuOr");xn("redblue","RdBu");xn("redgrey","RdGy");xn("redyellowblue","RdYlBu");xn("redyellowgreen","RdYlGn");xn("spectral","Spectral");xn("bluegreen","BuGn");xn("bluepurple","BuPu");xn("greenblue","GnBu");xn("orangered","OrRd");xn("purplebluegreen","PuBuGn");xn("purpleblue","PuBu");xn("purplered","PuRd");xn("redpurple","RdPu");xn("yellowgreenblue","YlGnBu");xn("yellowgreen","YlGn");xn("yelloworangebrown","YlOrBr");xn("yelloworangered","YlOrRd");function UP(e,t){if(arguments.length>1)return Dx[e]=t,this;var n=e.split("-");return e=n[0],n=+n[1]+1,n&&x0.hasOwnProperty(e)?x0[e][n-1]:!n&&Dx.hasOwnProperty(e)?Dx[e]:void 0}function vpt(e,t,n){return arguments.length>1?(x0[e]=t,Dx[e]=n||RC(Vt(t)),this):x0.hasOwnProperty(e)?x0[e]:void 0}var wQ={millisecond:tm,second:wC,minute:PU,hour:LU,day:SC,week:hD,month:zU,year:Yc},SQ={millisecond:tm,second:wC,minute:BU,hour:UU,day:CC,week:pD,month:WU,year:Zc};function iye(e){return wQ.hasOwnProperty(e)&&wQ[e]}function sye(e){return SQ.hasOwnProperty(e)&&SQ[e]}function _V(e,t){var n;return yt(t)&&(n=t.step,t=t.interval),ft(t)&&(t=e.type==="time"?iye(t):e.type==="utc"?sye(t):he("Only time and utc scales accept interval strings."),n&&(t=t.every(n))),t}function oye(e,t,n){var r=e.range(),i=r[0],s=Vt(r);if(i>s&&(r=s,s=i,i=r),t=t.filter(function(a){return a=e(a),!(a<i||a>s)}),n>0&&t.length>1){for(var o=[t[0],Vt(t)];t.length>n&&t.length>=3;)t=t.filter(function(a,u){return!(u%2)});t.length<3&&(t=o)}return t}function aye(e,t){return e.ticks?e.ticks(t):e.domain()}function uye(e,t,n){var r=e.tickFormat?e.tickFormat(t,n):n?bu(n):String;return e.type===MD?xpt(r,wpt(n)):r}function xpt(e,t){return function(n){return e(n)?t(n):""}}function wpt(e){var t=Md(e||",");if(t.precision==null){switch(t.precision=12,t.type){case"%":t.precision-=2;break;case"e":t.precision-=1;break}return Spt(bu(t),bu(".1f")(1)[1])}else return bu(t)}function Spt(e,t){return function(n){var r=e(n),i=r.indexOf(t),s,o;if(i<0)return r;for(s=Cpt(r,i),o=s<r.length?r.slice(s):"";--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+o}}function Cpt(e,t){var n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function lye(e){ue.call(this,null,e)}var kpt=Ne(lye,ue);kpt.transform=function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.scale,s=e.count==null?e.values?e.values.length:10:_V(i,e.count),o=e.format||uye(i,s,e.formatSpecifier),a=e.values?oye(i,e.values,s):aye(i,s);return r&&(n.rem=r),r=a.map(function(u,l){return nr({index:l/(a.length-1),value:u,label:o(u)})}),e.extra&&r.length&&r.push(nr({index:-1,extra:{value:r[0].value},label:""})),n.source=r,n.add=r,this.value=r,n};function cye(e){ue.call(this,null,e)}var $pt=Ne(cye,ue);function _pt(){return nr({})}function Ept(e){return e.exit}$pt.transform=function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||_pt,s=e.key||Je,o=this.value;return be(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(s))&&he("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=tb().test(Ept),o.lookup=function(a){return o.get(s(a))}),t.visit(t.ADD,function(a){var u=s(a),l=o.get(u);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(o.set(u,l=i(a)),r.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,function(a){var u=s(a),l=o.get(u);l&&(l.datum=a,r.mod.push(l))}),t.visit(t.REM,function(a){var u=s(a),l=o.get(u);a===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),e.clean&&o.empty>n.cleanThreshold&&n.runAfter(o.clean),r};function fye(e){ue.call(this,null,e)}var Tpt=Ne(fye,ue);Tpt.transform=function(e,t){var n=t.fork(t.ADD_REM),r=e.encoders,i=t.encode;if(be(i))if(n.changed()||i.every(function(f){return r[f]}))i=i[0],n.encode=null;else return t.StopPropagation;var s=i==="enter",o=r.update||sc,a=r.enter||sc,u=r.exit||sc,l=(i&&!s?r[i]:o)||sc;if(t.changed(t.ADD)&&(t.visit(t.ADD,function(f){a(f,e),o(f,e),l!==sc&&l!==o&&l(f,e)}),n.modifies(a.output),n.modifies(o.output),l!==sc&&l!==o&&n.modifies(l.output)),t.changed(t.REM)&&u!==sc&&(t.visit(t.REM,function(f){u(f,e)}),n.modifies(u.output)),s||l!==sc){var c=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(c,function(f){var d=a(f,e);(l(f,e)||d)&&n.mod.push(f)}),n.mod.length&&n.modifies(a.output)):t.visit(c,function(f){l(f,e)&&n.mod.push(f)}),n.mod.length&&n.modifies(l.output)}return n.changed()?n:t.StopPropagation};var WP="symbol",Apt="discrete",Npt="gradient",um={};um[v0e]=Opt;um[x0e]=Dpt;um[lV]=Fpt;um[ldt]=um[w0e]=Rpt;function Ipt(e,t){var n=um[e.type];return n?n(e):aye(e,t)}function Dpt(e){var t=e.domain(),n=t[0],r=Vt(t),i=e.range().length,s=new Array(i),o=0;for(s[0]=-1/0;++o<i;)s[o]=(o*r-(o-i)*n)/i;return s.max=1/0,s}function Opt(e){var t=[-1/0].concat(e.quantiles());return t.max=1/0,t}function Fpt(e){var t=[-1/0].concat(e.domain());return t.max=1/0,t}function Rpt(e){var t=e.domain();return t.max=t.pop(),t}function Mpt(e,t,n){return n===WP&&um[e.type]?Ppt(t):n===Apt?Lpt(t):zpt(t)}function Ppt(e){return function(t,n,r){var i=r[n+1]||r.max||1/0,s=CQ(t,e),o=CQ(i,e);return s&&o?s+""+o:o?"< "+o:" "+s}}function Lpt(e){return function(t,n){return n?e(t):null}}function zpt(e){return function(t){return e(t)}}function CQ(e,t){return isFinite(e)?t(e):null}function Bpt(e){var t=e.domain(),n=t.length-1,r=+t[0],i=+Vt(t),s=i-r;if(e.type===lV){var o=n?s/n:.1;r-=o,i+=o,s=i-r}return function(a){return(a-r)/s}}function dye(e){ue.call(this,[],e)}var Upt=Ne(dye,ue);Upt.transform=function(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.type||WP,s=e.scale,o=e.count==null?5:_V(s,e.count),a=e.format||uye(s,o,e.formatSpecifier),u=e.values||Ipt(s,o),l,c,f,d;return a=Mpt(s,a,i),r&&(n.rem=r),i===WP?(Ot(f=e.size)?(!e.values&&s(u[0])===0&&(u=u.slice(1)),d=u.reduce(function(h,p){return Math.max(h,f(p,e))},0)):f=Rl(d=f||8),r=u.map(function(h,p){return nr({index:p,label:a(h,p,u),value:h,offset:d,size:f(h,e)})})):i===Npt?(l=s.domain(),c=h1e(s,l[0],Vt(l)),u.length<3&&!e.values&&l[0]!==Vt(l)&&(u=[l[0],Vt(l)]),r=u.map(function(h,p){return nr({index:p,label:a(h,p,u),value:h,perc:c(h)})})):(f=u.length-1,c=Bpt(s),r=u.map(function(h,p){return nr({index:p,label:a(h,p,u),value:h,perc:p?c(h):0,perc2:p===f?1:c(u[p+1])})})),n.source=r,n.add=r,this.value=r,n};var kQ=tb({line:hye,"line-radial":qpt,arc:pye,"arc-radial":Xpt,curve:mye,"curve-radial":Kpt,"orthogonal-horizontal":Ypt,"orthogonal-vertical":Zpt,"orthogonal-radial":Qpt,"diagonal-horizontal":Jpt,"diagonal-vertical":emt,"diagonal-radial":tmt});function Wpt(e){return e.source.x}function Vpt(e){return e.source.y}function jpt(e){return e.target.x}function Hpt(e){return e.target.y}function EV(e){ue.call(this,{},e)}EV.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};var Gpt=Ne(EV,ue);Gpt.transform=function(e,t){var n=e.sourceX||Wpt,r=e.sourceY||Vpt,i=e.targetX||jpt,s=e.targetY||Hpt,o=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=kQ.get(u+"-"+a)||kQ.get(u);return l||he("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,function(c){c[o]=l(n(c),r(c),i(c),s(c))}),t.reflow(e.modified()).modifies(o)};function hye(e,t,n,r){return"M"+e+","+t+"L"+n+","+r}function qpt(e,t,n,r){return hye(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function pye(e,t,n,r){var i=n-e,s=r-t,o=Math.sqrt(i*i+s*s)/2,a=180*Math.atan2(s,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+r}function Xpt(e,t,n,r){return pye(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function mye(e,t,n,r){var i=n-e,s=r-t,o=.2*(i+s),a=.2*(s-i);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(r-o)+" "+n+","+r}function Kpt(e,t,n,r){return mye(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))}function Ypt(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n}function Zpt(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r}function Qpt(e,t,n,r){var i=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*a+"L"+r*o+","+r*a}function Jpt(e,t,n,r){var i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r}function emt(e,t,n,r){var i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r}function tmt(e,t,n,r){var i=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*s+"C"+u*i+","+u*s+" "+u*o+","+u*a+" "+r*o+","+r*a}function TV(e){ue.call(this,null,e)}TV.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};var nmt=Ne(TV,ue);nmt.transform=function(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],s=e.field||iD,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=o,d=(a-o)/rut(l),h=TC(c),p,m,g;for(e.sort&&h.sort(function(y,b){return l[y]-l[b]}),p=0;p<c;++p)g=l[h[p]],m=u[h[p]],m[r]=f,m[i]=f+=g*d;return this.value=l,t.reflow(e.modified()).modifies(n)};var rmt=5,imt=Ft([uV,oV,aV]),gye=Ft([uV,MD,oV,aV,udt,odt]),smt=Ft(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function yye(e){ue.call(this,null,e),this.modified(!0)}var omt=Ne(yye,ue);omt.transform=function(e,t){var n=t.dataflow,r=this.value,i;(!r||e.modified("type"))&&(this.value=r=GD((e.type||uV).toLowerCase())());for(i in e)if(!smt[i]){if(i==="padding"&&gye[r.type])continue;Ot(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return cmt(r,e,amt(r,e,n)),t.fork(t.NO_SOURCE|t.NO_FIELDS)};function amt(e,t,n){var r=umt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,s=e.type,o=t.zero||t.zero===void 0&&imt[s],a,u;return i?(gye[s]&&t.padding&&i[0]!==Vt(i)&&(i=lmt(s,i,t.range,t.padding,t.exponent)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null&&(u=t.domainMid,(u<i[0]||u>i[a])&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(a,0,u))),e.domain(bye(s,i,n)),s===b0e&&e.unknown(t.domainImplicit?RP:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&_V(e,t.nice)||null),i.length):0}function umt(e,t,n){return t?(e.domain(bye(e.type,t,n)),t.length):-1}function lmt(e,t,n,r,i){var s=Math.abs(Vt(n)-n[0]),o=s/(s-2*r),a=e===MD?_U(t,null,o):e===aV?vT(t,null,o,.5):e===oV?vT(t,null,o,i):$U(t,null,o);return t=t.slice(),t[0]=a[0],t[t.length-1]=a[1],t}function bye(e,t,n){if(e===MD){var r=Math.abs(t.reduce(function(i,s){return i+(s<0?-1:s>0?1:0)},0));r!==t.length&&n.warn("Log scale domain includes zero: "+Fe(t))}return t}function cmt(e,t,n){var r=t.round||!1,i=t.range;if(t.rangeStep!=null)i=fmt(e.type,t,n);else if(t.scheme){if(i=dmt(e.type,t,n),Ot(i))return e.interpolator(i)}else if(i&&e.type===S0e)return e.interpolator(RC(VP(i,t.reverse)));i&&t.interpolate&&e.interpolate?e.interpolate(p1e(t.interpolate,t.interpolateGamma)):Ot(e.round)?e.round(r):Ot(e.rangeRound)&&e.interpolate(r?yV:MC),i&&e.range(VP(i,t.reverse))}function fmt(e,t,n){e!==adt&&e!==VZ&&he("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===VZ?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*cV(n,i,r)]}function dmt(e,t,n){var r=t.scheme.toLowerCase(),i=UP(r),s=t.schemeExtent,o;return i||he("Unrecognized scheme name: "+t.scheme),n=e===lV?n+1:e===w0e?n-1:e===v0e||e===x0e?+t.schemeCount||rmt:n,e===S0e?$Q(i,s,t.reverse):!s&&(o=UP(r+"-"+n))?o:Ot(i)?hmt($Q(i,s),n):e===b0e?i:i.slice(0,n)}function $Q(e,t,n){return Ot(e)&&(t||n)?d1e(e,VP(t||[0,1],n)):e}function VP(e,t){return t?e.slice().reverse():e}function hmt(e,t){for(var n=new Array(t),r=t+1,i=0;i<t;)n[i]=e(++i/r);return n}function vye(e){ue.call(this,null,e)}var pmt=Ne(vye,ue);pmt.transform=function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(e.sort),this.modified(n),t};var _Q="zero",xye="center",wye="normalize",Sye=["y0","y1"];function AV(e){ue.call(this,null,e)}AV.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:_Q,values:[_Q,xye,wye]},{name:"as",type:"string",array:!0,length:2,default:Sye}]};var mmt=Ne(AV,ue);mmt.transform=function(e,t){var n=e.as||Sye,r=n[0],i=n[1],s=e.field||iD,o=e.offset===xye?gmt:e.offset===wye?ymt:bmt,a,u,l,c;for(a=vmt(t.source,e.groupby,e.sort,s),u=0,l=a.length,c=a.max;u<l;++u)o(a[u],c,s,r,i);return t.reflow(e.modified()).modifies(n)};function gmt(e,t,n,r,i){for(var s=(t-e.sum)/2,o=e.length,a=0,u;a<o;++a)u=e[a],u[r]=s,u[i]=s+=Math.abs(n(u))}function ymt(e,t,n,r,i){for(var s=1/e.sum,o=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[r]=o,c[i]=o=s*(l+=Math.abs(n(c)))}function bmt(e,t,n,r,i){for(var s=0,o=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=n(c),l<0?(c[r]=o,c[i]=o+=l):(c[r]=s,c[i]=s+=l)}function vmt(e,t,n,r){var i=[],s=function(m){return m(c)},o,a,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(o={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(s),d=o[f],d||(o[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(r(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}const xmt=Object.freeze(Object.defineProperty({__proto__:null,axisticks:lye,datajoin:cye,encode:fye,legendentries:dye,linkpath:EV,pie:TV,scale:yye,sortitems:vye,stack:AV,validTicks:oye},Symbol.toStringTag,{value:"Module"}));function Cye(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function wmt(e){return e.length===1&&(e=Smt(e)),{left:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var s=r+i>>>1;e(t[s],n)<0?r=s+1:i=s}return r},right:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var s=r+i>>>1;e(t[s],n)>0?i=s:r=s+1}return r}}}function Smt(e){return function(t,n){return Cye(e(t),n)}}wmt(Cye);function Cmt(e,t){for(var n=e.length,r=-1,i,s,o;++r<n;)if((i=e[r])!=null&&i>=i)for(s=o=i;++r<n;)(i=e[r])!=null&&(s>i&&(s=i),o<i&&(o=i));return[s,o]}function kye(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}var kmt=Math.sqrt(50),$mt=Math.sqrt(10),_mt=Math.sqrt(2);function $ye(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=kmt?i*=10:s>=$mt?i*=5:s>=_mt&&(i*=2),t<e?-i:i}function Emt(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}function Tmt(e,t){for(var n=e.length,r=-1,i,s;++r<n;)if((i=e[r])!=null&&i>=i)for(s=i;++r<n;)(i=e[r])!=null&&i>s&&(s=i);return s}var Amt=Array.prototype,_ye=Amt.slice;function Nmt(e,t){return e-t}function Imt(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Pf(e){return function(){return e}}function Dmt(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=Omt(e,t[n]))return i;return 0}function Omt(e,t){for(var n=t[0],r=t[1],i=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var u=e[s],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(Fmt(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function Fmt(e,t,n){var r;return Rmt(e,t,n)&&Mmt(e[r=+(e[0]===t[0])],n[r],t[r])}function Rmt(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function Mmt(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Pmt(){}var rc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Eye(){var e=1,t=1,n=Emt,r=u;function i(l){var c=n(l);if(Array.isArray(c))c=c.slice().sort(Nmt);else{var f=Cmt(l),d=f[0],h=f[1];c=$ye(d,h,c),c=kye(Math.floor(d/c)*c,Math.floor(h/c)*c,c)}return c.map(function(p){return s(l,p)})}function s(l,c){var f=[],d=[];return o(l,c,function(h){r(h,l,c),Imt(h)>0?f.push([h]):d.push(h)}),d.forEach(function(h){for(var p=0,m=f.length,g;p<m;++p)if(Dmt((g=f[p])[0],h)!==-1){g.push(h);return}}),{type:"MultiPolygon",value:c,coordinates:f}}function o(l,c,f){var d=new Array,h=new Array,p,m,g,y,b,v;for(p=m=-1,y=l[0]>=c,rc[y<<1].forEach(x);++p<e-1;)g=y,y=l[p+1]>=c,rc[g|y<<1].forEach(x);for(rc[y<<0].forEach(x);++m<t-1;){for(p=-1,y=l[m*e+e]>=c,b=l[m*e]>=c,rc[y<<1|b<<2].forEach(x);++p<e-1;)g=y,y=l[m*e+e+p+1]>=c,v=b,b=l[m*e+p+1]>=c,rc[g|y<<1|b<<2|v<<3].forEach(x);rc[y|b<<3].forEach(x)}for(p=-1,b=l[m*e]>=c,rc[b<<2].forEach(x);++p<e-1;)v=b,b=l[m*e+p+1]>=c,rc[b<<2|v<<3].forEach(x);rc[b<<3].forEach(x);function x(w){var S=[w[0][0]+p,w[0][1]+m],C=[w[1][0]+p,w[1][1]+m],k=a(S),E=a(C),_,T;(_=h[k])?(T=d[E])?(delete h[_.end],delete d[T.start],_===T?(_.ring.push(C),f(_.ring)):d[_.start]=h[T.end]={start:_.start,end:T.end,ring:_.ring.concat(T.ring)}):(delete h[_.end],_.ring.push(C),h[_.end=E]=_):(_=d[E])?(T=h[k])?(delete d[_.start],delete h[T.end],_===T?(_.ring.push(C),f(_.ring)):d[T.start]=h[_.end]={start:T.start,end:_.end,ring:T.ring.concat(_.ring)}):(delete d[_.start],_.ring.unshift(S),d[_.start=k]=_):d[k]=h[E]={start:k,end:E,ring:[S,C]}}}function a(l){return l[0]*2+l[1]*(e+1)*4}function u(l,c,f){l.forEach(function(d){var h=d[0],p=d[1],m=h|0,g=p|0,y,b=c[g*e+m];h>0&&h<e&&m===h&&(y=c[g*e+m-1],d[0]=h+(f-y)/(b-y)-.5),p>0&&p<t&&g===p&&(y=c[(g-1)*e+m],d[1]=p+(f-y)/(b-y)-.5)})}return i.contour=s,i.size=function(l){if(!arguments.length)return[e,t];var c=Math.ceil(l[0]),f=Math.ceil(l[1]);if(!(c>0)||!(f>0))throw new Error("invalid size");return e=c,t=f,i},i.thresholds=function(l){return arguments.length?(n=typeof l=="function"?l:Array.isArray(l)?Pf(_ye.call(l)):Pf(l),i):n},i.smooth=function(l){return arguments.length?(r=l?u:Pmt,i):r===u},i}function JR(e,t,n){for(var r=e.width,i=e.height,s=(n<<1)+1,o=0;o<i;++o)for(var a=0,u=0;a<r+n;++a)a<r&&(u+=e.data[a+o*r]),a>=n&&(a>=s&&(u-=e.data[a-s+o*r]),t.data[a-n+o*r]=u/Math.min(a+1,r-1+s-a,s))}function eM(e,t,n){for(var r=e.width,i=e.height,s=(n<<1)+1,o=0;o<r;++o)for(var a=0,u=0;a<i+n;++a)a<i&&(u+=e.data[o+a*r]),a>=n&&(a>=s&&(u-=e.data[o+(a-s)*r]),t.data[o+(a-n)*r]=u/Math.min(a+1,i-1+s-a,s))}function Lmt(e){return e[0]}function zmt(e){return e[1]}function Bmt(){return 1}function Umt(){var e=Lmt,t=zmt,n=Bmt,r=960,i=500,s=20,o=2,a=s*3,u=r+a*2>>o,l=i+a*2>>o,c=Pf(20);function f(y){var b=new Float32Array(u*l),v=new Float32Array(u*l);y.forEach(function(S,C,k){var E=+e(S,C,k)+a>>o,_=+t(S,C,k)+a>>o,T=+n(S,C,k);E>=0&&E<u&&_>=0&&_<l&&(b[E+_*u]+=T)}),JR({width:u,height:l,data:b},{width:u,height:l,data:v},s>>o),eM({width:u,height:l,data:v},{width:u,height:l,data:b},s>>o),JR({width:u,height:l,data:b},{width:u,height:l,data:v},s>>o),eM({width:u,height:l,data:v},{width:u,height:l,data:b},s>>o),JR({width:u,height:l,data:b},{width:u,height:l,data:v},s>>o),eM({width:u,height:l,data:v},{width:u,height:l,data:b},s>>o);var x=c(b);if(!Array.isArray(x)){var w=Tmt(b);x=$ye(0,w,x),x=kye(0,Math.floor(w/x)*x,x),x.shift()}return Eye().thresholds(x).size([u,l])(b).map(d)}function d(y){return y.value*=Math.pow(2,-2*o),y.coordinates.forEach(h),y}function h(y){y.forEach(p)}function p(y){y.forEach(m)}function m(y){y[0]=y[0]*Math.pow(2,o)-a,y[1]=y[1]*Math.pow(2,o)-a}function g(){return a=s*3,u=r+a*2>>o,l=i+a*2>>o,f}return f.x=function(y){return arguments.length?(e=typeof y=="function"?y:Pf(+y),f):e},f.y=function(y){return arguments.length?(t=typeof y=="function"?y:Pf(+y),f):t},f.weight=function(y){return arguments.length?(n=typeof y=="function"?y:Pf(+y),f):n},f.size=function(y){if(!arguments.length)return[r,i];var b=Math.ceil(y[0]),v=Math.ceil(y[1]);if(!(b>=0)&&!(b>=0))throw new Error("invalid size");return r=b,i=v,g()},f.cellSize=function(y){if(!arguments.length)return 1<<o;if(!((y=+y)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(y)/Math.LN2),g()},f.thresholds=function(y){return arguments.length?(c=typeof y=="function"?y:Array.isArray(y)?Pf(_ye.call(y)):Pf(y),f):c},f.bandwidth=function(y){if(!arguments.length)return Math.sqrt(s*(s+1));if(!((y=+y)>=0))throw new Error("invalid bandwidth");return s=Math.round((Math.sqrt(4*y*y+1)-1)/2),g()},f}var Wmt=["size","smooth"],Vmt=["x","y","weight","size","cellSize","bandwidth"];function NV(e){ue.call(this,null,e)}NV.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"smooth",type:"boolean"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0}]};var jmt=Ne(NV,ue);jmt.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.count||10,i,s,o;return e.values?(i=Eye(),s=Wmt,o=e.values):(i=Umt(),s=Vmt,o=t.materialize(t.SOURCE).source),i.thresholds(e.thresholds||(e.nice?r:Hmt(r))),s.forEach(function(a){e[a]!=null&&i[a](e[a])}),this.value&&(n.rem=this.value),o=o&&o.length?i(o).map(nr):[],this.value=n.source=n.add=o,n};function Hmt(e){return function(t){for(var n=Lme(t),r=n[0],i=n[1]-r,s=[],o=1;o<=e;++o)s.push(r+i*o/(e+1));return s}}var Gmt="Feature",jP="FeatureCollection",qmt="MultiPoint";function IV(e){ue.call(this,null,e)}IV.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};var Xmt=Ne(IV,ue);Xmt.transform=function(e,t){var n=this._features,r=this._points,i=e.fields,s=i&&i[0],o=i&&i[1],a=e.geojson,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Zs(a))||s&&t.modified(Zs(s))||o&&t.modified(Zs(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,function(c){n.push(a(c))}),s&&o&&(t.visit(u,function(c){var f=s(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:Gmt,geometry:{type:qmt,coordinates:r}})),this.value={type:jP,features:n}};var gt=1e-6,Tye=1e-12,Et=Math.PI,er=Et/2,EQ=Et/4,jo=Et*2,Ai=180/Et,Hn=Et/180,Qt=Math.abs,cb=Math.atan,Jc=Math.atan2,kt=Math.cos,Aye=Math.exp,WT=Math.log,tM=Math.pow,pt=Math.sin,ba=Math.sign||function(e){return e>0?1:e<0?-1:0},io=Math.sqrt,DV=Math.tan;function Nye(e){return e>1?0:e<-1?Et:Math.acos(e)}function Ra(e){return e>1?er:e<-1?-er:Math.asin(e)}function va(){}function VT(e,t){e&&AQ.hasOwnProperty(e.type)&&AQ[e.type](e,t)}var TQ={Feature:function(e,t){VT(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)VT(n[r].geometry,t)}},AQ={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){HP(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)HP(n[r],t,0)},Polygon:function(e,t){NQ(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)NQ(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)VT(n[r],t)}};function HP(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function NQ(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)HP(e[n],t,1);t.polygonEnd()}function zg(e,t){e&&TQ.hasOwnProperty(e.type)?TQ[e.type](e,t):VT(e,t)}function GP(e){return[Jc(e[1],e[0]),Ra(e[2])]}function f1(e){var t=e[0],n=e[1],r=kt(n);return[r*kt(t),r*pt(t),pt(n)]}function N$(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function jT(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function nM(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function I$(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function qP(e){var t=io(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function XP(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function KP(e,t){return Qt(e)>Et&&(e-=Math.round(e/jo)*jo),[e,t]}KP.invert=KP;function Iye(e,t,n){return(e%=jo)?t||n?XP(DQ(e),OQ(t,n)):DQ(e):t||n?OQ(t,n):KP}function IQ(e){return function(t,n){return t+=e,Qt(t)>Et&&(t-=Math.round(t/jo)*jo),[t,n]}}function DQ(e){var t=IQ(e);return t.invert=IQ(-e),t}function OQ(e,t){var n=kt(e),r=pt(e),i=kt(t),s=pt(t);function o(a,u){var l=kt(u),c=kt(a)*l,f=pt(a)*l,d=pt(u),h=d*n+c*r;return[Jc(f*i-h*s,c*n-d*r),Ra(h*i+f*s)]}return o.invert=function(a,u){var l=kt(u),c=kt(a)*l,f=pt(a)*l,d=pt(u),h=d*i-f*s;return[Jc(f*i+d*s,c*n+h*r),Ra(h*n-c*r)]},o}function Kmt(e){e=Iye(e[0]*Hn,e[1]*Hn,e.length>2?e[2]*Hn:0);function t(n){return n=e(n[0]*Hn,n[1]*Hn),n[0]*=Ai,n[1]*=Ai,n}return t.invert=function(n){return n=e.invert(n[0]*Hn,n[1]*Hn),n[0]*=Ai,n[1]*=Ai,n},t}function Ymt(e,t,n,r,i,s){if(n){var o=kt(t),a=pt(t),u=r*n;i==null?(i=t+r*jo,s=t-u/2):(i=FQ(o,i),s=FQ(o,s),(r>0?i<s:i>s)&&(i+=r*jo));for(var l,c=i;r>0?c>s:c<s;c-=u)l=GP([o,-a*kt(c),-a*pt(c)]),e.point(l[0],l[1])}}function FQ(e,t){t=f1(t),t[0]-=e,qP(t);var n=Nye(-t[1]);return((-t[2]<0?-n:n)+jo-gt)%jo}function Dye(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:va,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function G_(e,t){return Qt(e[0]-t[0])<gt&&Qt(e[1]-t[1])<gt}function D$(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Oye(e,t,n,r,i){var s=[],o=[],a,u;if(e.forEach(function(p){if(!((m=p.length-1)<=0)){var m,g=p[0],y=p[m],b;if(G_(g,y)){if(!g[2]&&!y[2]){for(i.lineStart(),a=0;a<m;++a)i.point((g=p[a])[0],g[1]);i.lineEnd();return}y[0]+=2*gt}s.push(b=new D$(g,p,null,!0)),o.push(b.o=new D$(g,null,b,!1)),s.push(b=new D$(y,p,null,!1)),o.push(b.o=new D$(y,null,b,!0))}}),!!s.length){for(o.sort(t),RQ(s),RQ(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var l=s[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function RQ(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function rM(e){return Qt(e[0])<=Et?e[0]:ba(e[0])*((Qt(e[0])+Et)%jo-Et)}function Zmt(e,t){var n=rM(t),r=t[1],i=pt(r),s=[pt(n),-kt(n),0],o=0,a=0,u=new im;i===1?r=er+gt:i===-1&&(r=-er-gt);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=rM(h),m=h[1]/2+EQ,g=pt(m),y=kt(m),b=0;b<d;++b,p=x,g=S,y=C,h=v){var v=f[b],x=rM(v),w=v[1]/2+EQ,S=pt(w),C=kt(w),k=x-p,E=k>=0?1:-1,_=E*k,T=_>Et,D=g*S;if(u.add(Jc(D*E*pt(_),y*C+D*kt(_))),o+=T?k+E*jo:k,T^p>=n^x>=n){var O=jT(f1(h),f1(v));qP(O);var M=jT(s,O);qP(M);var I=(T^k>=0?-1:1)*Ra(M[2]);(r>I||r===I&&(O[0]||O[1]))&&(a+=T^k>=0?1:-1)}}return(o<-gt||o<gt&&u<-Tye)^a&1}function Fye(e,t,n,r){return function(i){var s=t(i),o=Dye(),a=t(o),u=!1,l,c,f,d={point:h,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=v,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=g,c=fme(c);var x=Zmt(l,r);c.length?(u||(i.polygonStart(),u=!0),Oye(c,Jmt,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function p(x,w){s.point(x,w)}function m(){d.point=p,s.lineStart()}function g(){d.point=h,s.lineEnd()}function y(x,w){f.push([x,w]),a.point(x,w)}function b(){a.lineStart(),f=[]}function v(){y(f[0][0],f[0][1]),a.lineEnd();var x=a.clean(),w=o.result(),S,C=w.length,k,E,_;if(f.pop(),l.push(f),f=null,!!C){if(x&1){if(E=w[0],(k=E.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<k;++S)i.point((_=E[S])[0],_[1]);i.lineEnd()}return}C>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Qmt))}}return d}}function Qmt(e){return e.length>1}function Jmt(e,t){return((e=e.x)[0]<0?e[1]-er-gt:er-e[1])-((t=t.x)[0]<0?t[1]-er-gt:er-t[1])}const MQ=Fye(function(){return!0},egt,ngt,[-Et,-er]);function egt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var a=s>0?Et:-Et,u=Qt(s-t);Qt(u-Et)<gt?(e.point(t,n=(n+o)/2>0?er:-er),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),i=0):r!==a&&u>=Et&&(Qt(t-r)<gt&&(t-=r*gt),Qt(s-a)<gt&&(s-=a*gt),n=tgt(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=s,n=o),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function tgt(e,t,n,r){var i,s,o=pt(e-n);return Qt(o)>gt?cb((pt(t)*(s=kt(r))*pt(n)-pt(r)*(i=kt(t))*pt(e))/(i*s*o)):(t+r)/2}function ngt(e,t,n,r){var i;if(e==null)i=n*er,r.point(-Et,i),r.point(0,i),r.point(Et,i),r.point(Et,0),r.point(Et,-i),r.point(0,-i),r.point(-Et,-i),r.point(-Et,0),r.point(-Et,i);else if(Qt(e[0]-t[0])>gt){var s=e[0]<t[0]?Et:-Et;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function rgt(e){var t=kt(e),n=2*Hn,r=t>0,i=Qt(t)>gt;function s(c,f,d,h){Ymt(h,e,n,d,c,f)}function o(c,f){return kt(c)*kt(f)>t}function a(c){var f,d,h,p,m;return{lineStart:function(){p=h=!1,m=1},point:function(g,y){var b=[g,y],v,x=o(g,y),w=r?x?0:l(g,y):x?l(g+(g<0?Et:-Et),y):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(v=u(f,b),(!v||G_(f,v)||G_(b,v))&&(b[2]=1)),x!==h)m=0,x?(c.lineStart(),v=u(b,f),c.point(v[0],v[1])):(v=u(f,b),c.point(v[0],v[1],2),c.lineEnd()),f=v;else if(i&&f&&r^x){var S;!(w&d)&&(S=u(b,f,!0))&&(m=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}x&&(!f||!G_(f,b))&&c.point(b[0],b[1]),f=b,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return m|(p&&h)<<1}}}function u(c,f,d){var h=f1(c),p=f1(f),m=[1,0,0],g=jT(h,p),y=N$(g,g),b=g[0],v=y-b*b;if(!v)return!d&&c;var x=t*y/v,w=-t*b/v,S=jT(m,g),C=I$(m,x),k=I$(g,w);nM(C,k);var E=S,_=N$(C,E),T=N$(E,E),D=_*_-T*(N$(C,C)-1);if(!(D<0)){var O=io(D),M=I$(E,(-_-O)/T);if(nM(M,C),M=GP(M),!d)return M;var I=c[0],P=f[0],V=c[1],F=f[1],B;P<I&&(B=I,I=P,P=B);var q=P-I,J=Qt(q-Et)<gt,ne=J||q<gt;if(!J&&F<V&&(B=V,V=F,F=B),ne?J?V+F>0^M[1]<(Qt(M[0]-I)<gt?V:F):V<=M[1]&&M[1]<=F:q>Et^(I<=M[0]&&M[0]<=P)){var re=I$(E,(-_+O)/T);return nM(re,C),[M,GP(re)]}}}function l(c,f){var d=r?e:Et-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return Fye(o,a,s,r?[0,-e]:[-Et,e-Et])}function igt(e,t,n,r,i,s){var o=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-a,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=s-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=a+c*h),f<1&&(t[0]=o+f*d,t[1]=a+f*h),!0}}}}}var Kv=1e9,O$=-Kv;function Rye(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function s(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return Qt(l[0]-e)<gt?c>0?0:3:Qt(l[0]-n)<gt?c>0?2:1:Qt(l[1]-t)<gt?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=Dye(),d,h,p,m,g,y,b,v,x,w,S,C={point:k,lineStart:D,lineEnd:O,polygonStart:_,polygonEnd:T};function k(I,P){i(I,P)&&c.point(I,P)}function E(){for(var I=0,P=0,V=h.length;P<V;++P)for(var F=h[P],B=1,q=F.length,J=F[0],ne,re,ae=J[0],le=J[1];B<q;++B)ne=ae,re=le,J=F[B],ae=J[0],le=J[1],re<=r?le>r&&(ae-ne)*(r-re)>(le-re)*(e-ne)&&++I:le<=r&&(ae-ne)*(r-re)<(le-re)*(e-ne)&&--I;return I}function _(){c=f,d=[],h=[],S=!0}function T(){var I=E(),P=S&&I,V=(d=fme(d)).length;(P||V)&&(l.polygonStart(),P&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),V&&Oye(d,a,I,s,l),l.polygonEnd()),c=l,d=h=p=null}function D(){C.point=M,h&&h.push(p=[]),w=!0,x=!1,b=v=NaN}function O(){d&&(M(m,g),y&&x&&f.rejoin(),d.push(f.result())),C.point=k,x&&c.lineEnd()}function M(I,P){var V=i(I,P);if(h&&p.push([I,P]),w)m=I,g=P,y=V,w=!1,V&&(c.lineStart(),c.point(I,P));else if(V&&x)c.point(I,P);else{var F=[b=Math.max(O$,Math.min(Kv,b)),v=Math.max(O$,Math.min(Kv,v))],B=[I=Math.max(O$,Math.min(Kv,I)),P=Math.max(O$,Math.min(Kv,P))];igt(F,B,e,t,n,r)?(x||(c.lineStart(),c.point(F[0],F[1])),c.point(B[0],B[1]),V||c.lineEnd(),S=!1):V&&(c.lineStart(),c.point(I,P),S=!1)}b=I,v=P,x=V}return C}}const Gw=e=>e;var iM=new im,YP=new im,Mye,Pye,ZP,QP,xc={point:va,lineStart:va,lineEnd:va,polygonStart:function(){xc.lineStart=sgt,xc.lineEnd=agt},polygonEnd:function(){xc.lineStart=xc.lineEnd=xc.point=va,iM.add(Qt(YP)),YP=new im},result:function(){var e=iM/2;return iM=new im,e}};function sgt(){xc.point=ogt}function ogt(e,t){xc.point=Lye,Mye=ZP=e,Pye=QP=t}function Lye(e,t){YP.add(QP*e-ZP*t),ZP=e,QP=t}function agt(){Lye(Mye,Pye)}var d1=1/0,HT=d1,qw=-d1,GT=qw,qT={point:ugt,lineStart:va,lineEnd:va,polygonStart:va,polygonEnd:va,result:function(){var e=[[d1,HT],[qw,GT]];return qw=GT=-(HT=d1=1/0),e}};function ugt(e,t){e<d1&&(d1=e),e>qw&&(qw=e),t<HT&&(HT=t),t>GT&&(GT=t)}var JP=0,eL=0,Yv=0,XT=0,KT=0,n0=0,tL=0,nL=0,Zv=0,zye,Bye,ul,ll,ca={point:lm,lineStart:PQ,lineEnd:LQ,polygonStart:function(){ca.lineStart=fgt,ca.lineEnd=dgt},polygonEnd:function(){ca.point=lm,ca.lineStart=PQ,ca.lineEnd=LQ},result:function(){var e=Zv?[tL/Zv,nL/Zv]:n0?[XT/n0,KT/n0]:Yv?[JP/Yv,eL/Yv]:[NaN,NaN];return JP=eL=Yv=XT=KT=n0=tL=nL=Zv=0,e}};function lm(e,t){JP+=e,eL+=t,++Yv}function PQ(){ca.point=lgt}function lgt(e,t){ca.point=cgt,lm(ul=e,ll=t)}function cgt(e,t){var n=e-ul,r=t-ll,i=io(n*n+r*r);XT+=i*(ul+e)/2,KT+=i*(ll+t)/2,n0+=i,lm(ul=e,ll=t)}function LQ(){ca.point=lm}function fgt(){ca.point=hgt}function dgt(){Uye(zye,Bye)}function hgt(e,t){ca.point=Uye,lm(zye=ul=e,Bye=ll=t)}function Uye(e,t){var n=e-ul,r=t-ll,i=io(n*n+r*r);XT+=i*(ul+e)/2,KT+=i*(ll+t)/2,n0+=i,i=ll*e-ul*t,tL+=i*(ul+e),nL+=i*(ll+t),Zv+=i*3,lm(ul=e,ll=t)}function Wye(e){this._context=e}Wye.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,jo);break}}},result:va};var rL=new im,sM,Vye,jye,Qv,Jv,Xw={point:va,lineStart:function(){Xw.point=pgt},lineEnd:function(){sM&&Hye(Vye,jye),Xw.point=va},polygonStart:function(){sM=!0},polygonEnd:function(){sM=null},result:function(){var e=+rL;return rL=new im,e}};function pgt(e,t){Xw.point=Hye,Vye=Qv=e,jye=Jv=t}function Hye(e,t){Qv-=e,Jv-=t,rL.add(io(Qv*Qv+Jv*Jv)),Qv=e,Jv=t}let zQ,YT,BQ,UQ;class WQ{constructor(t){this._append=t==null?Gye:mgt(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==BQ||this._append!==YT){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,BQ=r,YT=this._append,UQ=this._,this._=i}this._+=UQ;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Gye(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function mgt(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Gye;if(t!==zQ){const n=10**t;zQ=t,YT=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return YT}function qye(e,t){let n=3,r=4.5,i,s;function o(a){return a&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),zg(a,i(s))),s.result()}return o.area=function(a){return zg(a,i(xc)),xc.result()},o.measure=function(a){return zg(a,i(Xw)),Xw.result()},o.bounds=function(a){return zg(a,i(qT)),qT.result()},o.centroid=function(a){return zg(a,i(ca)),ca.result()},o.projection=function(a){return arguments.length?(i=a==null?(e=null,Gw):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new WQ(n)):new Wye(t=a),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(s.pointRadius(+a),+a),o):r},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(s=new WQ(n)),o},o.projection(e).digits(n).context(t)}function XD(e){return function(t){var n=new iL;for(var r in e)n[r]=e[r];return n.stream=t,n}}function iL(){}iL.prototype={constructor:iL,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function OV(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),zg(n,e.stream(qT)),t(qT.result()),r!=null&&e.clipExtent(r),e}function KD(e,t,n){return OV(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),a=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function FV(e,t,n){return KD(e,[[0,0],t],n)}function RV(e,t,n){return OV(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,a=-s*r[0][1];e.scale(150*s).translate([o,a])},n)}function MV(e,t,n){return OV(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],a=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var VQ=16,ggt=kt(30*Hn);function jQ(e,t){return+t?bgt(e,t):ygt(e)}function ygt(e){return XD({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function bgt(e,t){function n(r,i,s,o,a,u,l,c,f,d,h,p,m,g){var y=l-r,b=c-i,v=y*y+b*b;if(v>4*t&&m--){var x=o+d,w=a+h,S=u+p,C=io(x*x+w*w+S*S),k=Ra(S/=C),E=Qt(Qt(S)-1)<gt||Qt(s-f)<gt?(s+f)/2:Jc(w,x),_=e(E,k),T=_[0],D=_[1],O=T-r,M=D-i,I=b*O-y*M;(I*I/v>t||Qt((y*O+b*M)/v-.5)>.3||o*d+a*h+u*p<ggt)&&(n(r,i,s,o,a,u,T,D,E,x/=C,w/=C,S,m,g),g.point(T,D),n(T,D,E,x,w,S,l,c,f,d,h,p,m,g))}}return function(r){var i,s,o,a,u,l,c,f,d,h,p,m,g={point:y,lineStart:b,lineEnd:x,polygonStart:function(){r.polygonStart(),g.lineStart=w},polygonEnd:function(){r.polygonEnd(),g.lineStart=b}};function y(k,E){k=e(k,E),r.point(k[0],k[1])}function b(){f=NaN,g.point=v,r.lineStart()}function v(k,E){var _=f1([k,E]),T=e(k,E);n(f,d,c,h,p,m,f=T[0],d=T[1],c=k,h=_[0],p=_[1],m=_[2],VQ,r),r.point(f,d)}function x(){g.point=y,r.lineEnd()}function w(){b(),g.point=S,g.lineEnd=C}function S(k,E){v(i=k,E),s=f,o=d,a=h,u=p,l=m,g.point=v}function C(){n(f,d,c,h,p,m,s,o,i,a,u,l,VQ,r),g.lineEnd=x,x()}return g}}var vgt=XD({point:function(e,t){this.stream.point(e*Hn,t*Hn)}});function xgt(e){return XD({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function wgt(e,t,n,r,i){function s(o,a){return o*=r,a*=i,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},s}function HQ(e,t,n,r,i,s){if(!s)return wgt(e,t,n,r,i);var o=kt(s),a=pt(s),u=o*e,l=a*e,c=o/e,f=a/e,d=(a*n-o*t)/e,h=(a*t+o*n)/e;function p(m,g){return m*=r,g*=i,[u*m-l*g+t,n-l*m-u*g]}return p.invert=function(m,g){return[r*(c*m-f*g+d),i*(h-f*m-c*g)]},p}function Xl(e){return Xye(function(){return e})()}function Xye(e){var t,n=150,r=480,i=250,s=0,o=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,m=MQ,g=null,y,b,v,x=Gw,w=.5,S,C,k,E,_;function T(I){return k(I[0]*Hn,I[1]*Hn)}function D(I){return I=k.invert(I[0],I[1]),I&&[I[0]*Ai,I[1]*Ai]}T.stream=function(I){return E&&_===I?E:E=vgt(xgt(c)(m(S(x(_=I)))))},T.preclip=function(I){return arguments.length?(m=I,p=void 0,M()):m},T.postclip=function(I){return arguments.length?(x=I,g=y=b=v=null,M()):x},T.clipAngle=function(I){return arguments.length?(m=+I?rgt(p=I*Hn):(p=null,MQ),M()):p*Ai},T.clipExtent=function(I){return arguments.length?(x=I==null?(g=y=b=v=null,Gw):Rye(g=+I[0][0],y=+I[0][1],b=+I[1][0],v=+I[1][1]),M()):g==null?null:[[g,y],[b,v]]},T.scale=function(I){return arguments.length?(n=+I,O()):n},T.translate=function(I){return arguments.length?(r=+I[0],i=+I[1],O()):[r,i]},T.center=function(I){return arguments.length?(s=I[0]%360*Hn,o=I[1]%360*Hn,O()):[s*Ai,o*Ai]},T.rotate=function(I){return arguments.length?(a=I[0]%360*Hn,u=I[1]%360*Hn,l=I.length>2?I[2]%360*Hn:0,O()):[a*Ai,u*Ai,l*Ai]},T.angle=function(I){return arguments.length?(f=I%360*Hn,O()):f*Ai},T.reflectX=function(I){return arguments.length?(d=I?-1:1,O()):d<0},T.reflectY=function(I){return arguments.length?(h=I?-1:1,O()):h<0},T.precision=function(I){return arguments.length?(S=jQ(C,w=I*I),M()):io(w)},T.fitExtent=function(I,P){return KD(T,I,P)},T.fitSize=function(I,P){return FV(T,I,P)},T.fitWidth=function(I,P){return RV(T,I,P)},T.fitHeight=function(I,P){return MV(T,I,P)};function O(){var I=HQ(n,0,0,d,h,f).apply(null,t(s,o)),P=HQ(n,r-I[0],i-I[1],d,h,f);return c=Iye(a,u,l),C=XP(t,P),k=XP(c,C),S=jQ(C,w),M()}function M(){return E=_=null,T}return function(){return t=e.apply(this,arguments),T.invert=t.invert&&D,O()}}function PV(e){var t=0,n=Et/3,r=Xye(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Hn,n=s[1]*Hn):[t*Ai,n*Ai]},i}function Sgt(e){var t=kt(e);function n(r,i){return[r*t,pt(i)/t]}return n.invert=function(r,i){return[r/t,Ra(i*t)]},n}function Cgt(e,t){var n=pt(e),r=(n+pt(t))/2;if(Qt(r)<gt)return Sgt(e);var i=1+n*(2*r-n),s=io(i)/r;function o(a,u){var l=io(i-2*r*pt(u))/r;return[l*pt(a*=r),s-l*kt(a)]}return o.invert=function(a,u){var l=s-u,c=Jc(a,Qt(l))*ba(l);return l*r<0&&(c-=Et*ba(a)*ba(l)),[c/r,Ra((i-(a*a+l*l)*r*r)/(2*r))]},o}function ZT(){return PV(Cgt).scale(155.424).center([0,33.6442])}function Kye(){return ZT().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function kgt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function $gt(){var e,t,n=Kye(),r,i=ZT().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=ZT().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(s.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),m=(d[0]-p[0])/h,g=(d[1]-p[1])/h;return(g>=.12&&g<.234&&m>=-.425&&m<-.214?i:g>=.166&&g<.234&&m>=-.214&&m<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=kgt([n.stream(t=d),i.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],m=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,m-.238*h],[p+.455*h,m+.238*h]]).stream(l),s=i.translate([p-.307*h,m+.201*h]).clipExtent([[p-.425*h+gt,m+.12*h+gt],[p-.214*h-gt,m+.234*h-gt]]).stream(l),a=o.translate([p-.205*h,m+.212*h]).clipExtent([[p-.214*h+gt,m+.166*h+gt],[p-.115*h-gt,m+.234*h-gt]]).stream(l),f()},c.fitExtent=function(d,h){return KD(c,d,h)},c.fitSize=function(d,h){return FV(c,d,h)},c.fitWidth=function(d,h){return RV(c,d,h)},c.fitHeight=function(d,h){return MV(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function Yye(e){return function(t,n){var r=kt(t),i=kt(n),s=e(r*i);return s===1/0?[2,0]:[s*i*pt(t),s*pt(n)]}}function LC(e){return function(t,n){var r=io(t*t+n*n),i=e(r),s=pt(i),o=kt(i);return[Jc(t*s,r*o),Ra(r&&n*s/r)]}}var Zye=Yye(function(e){return io(2/(1+e))});Zye.invert=LC(function(e){return 2*Ra(e/2)});function _gt(){return Xl(Zye).scale(124.75).clipAngle(180-.001)}var Qye=Yye(function(e){return(e=Nye(e))&&e/pt(e)});Qye.invert=LC(function(e){return e});function Egt(){return Xl(Qye).scale(79.4188).clipAngle(180-.001)}function YD(e,t){return[e,WT(DV((er+t)/2))]}YD.invert=function(e,t){return[e,2*cb(Aye(t))-er]};function Tgt(){return Jye(YD).scale(961/jo)}function Jye(e){var t=Xl(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,o=null,a,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=a=u=l=null:(o=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,a],[u,l]]};function c(){var f=Et*r(),d=t(Kmt(t.rotate()).invert([0,0]));return s(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===YD?[[Math.max(d[0]-f,o),a],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function F$(e){return DV((er+e)/2)}function Agt(e,t){var n=kt(e),r=e===t?pt(e):WT(n/kt(t))/WT(F$(t)/F$(e)),i=n*tM(F$(e),r)/r;if(!r)return YD;function s(o,a){i>0?a<-er+gt&&(a=-er+gt):a>er-gt&&(a=er-gt);var u=i/tM(F$(a),r);return[u*pt(r*o),i-u*kt(r*o)]}return s.invert=function(o,a){var u=i-a,l=ba(r)*io(o*o+u*u),c=Jc(o,Qt(u))*ba(u);return u*r<0&&(c-=Et*ba(o)*ba(u)),[c/r,2*cb(tM(i/l,1/r))-er]},s}function Ngt(){return PV(Agt).scale(109.5).parallels([30,30])}function QT(e,t){return[e,t]}QT.invert=QT;function Igt(){return Xl(QT).scale(152.63)}function Dgt(e,t){var n=kt(e),r=e===t?pt(e):(n-kt(t))/(t-e),i=n/r+e;if(Qt(r)<gt)return QT;function s(o,a){var u=i-a,l=r*o;return[u*pt(l),i-u*kt(l)]}return s.invert=function(o,a){var u=i-a,l=Jc(o,Qt(u))*ba(u);return u*r<0&&(l-=Et*ba(o)*ba(u)),[l/r,i-ba(r)*io(o*o+u*u)]},s}function Ogt(){return PV(Dgt).scale(131.154).center([0,13.9389])}var Ox=1.340264,Fx=-.081106,Rx=893e-6,Mx=.003796,JT=io(3)/2,Fgt=12;function ebe(e,t){var n=Ra(JT*pt(t)),r=n*n,i=r*r*r;return[e*kt(n)/(JT*(Ox+3*Fx*r+i*(7*Rx+9*Mx*r))),n*(Ox+Fx*r+i*(Rx+Mx*r))]}ebe.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,o,a,u;s<Fgt&&(a=n*(Ox+Fx*r+i*(Rx+Mx*r))-t,u=Ox+3*Fx*r+i*(7*Rx+9*Mx*r),n-=o=a/u,r=n*n,i=r*r*r,!(Qt(o)<Tye));++s);return[JT*e*(Ox+3*Fx*r+i*(7*Rx+9*Mx*r))/kt(n),Ra(pt(n)/JT)]};function Rgt(){return Xl(ebe).scale(177.158)}function tbe(e,t){var n=kt(t),r=kt(e)*n;return[n*pt(e)/r,pt(t)/r]}tbe.invert=LC(cb);function Mgt(){return Xl(tbe).scale(144.049).clipAngle(60)}function Pgt(){var e=1,t=0,n=0,r=1,i=1,s=0,o,a,u=null,l,c,f,d=1,h=1,p=XD({point:function(x,w){var S=v([x,w]);this.stream.point(S[0],S[1])}}),m=Gw,g,y;function b(){return d=e*r,h=e*i,g=y=null,v}function v(x){var w=x[0]*d,S=x[1]*h;if(s){var C=S*o-w*a;w=w*o+S*a,S=C}return[w+t,S+n]}return v.invert=function(x){var w=x[0]-t,S=x[1]-n;if(s){var C=S*o+w*a;w=w*o-S*a,S=C}return[w/d,S/h]},v.stream=function(x){return g&&y===x?g:g=p(m(y=x))},v.postclip=function(x){return arguments.length?(m=x,u=l=c=f=null,b()):m},v.clipExtent=function(x){return arguments.length?(m=x==null?(u=l=c=f=null,Gw):Rye(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),b()):u==null?null:[[u,l],[c,f]]},v.scale=function(x){return arguments.length?(e=+x,b()):e},v.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],b()):[t,n]},v.angle=function(x){return arguments.length?(s=x%360*Hn,a=pt(s),o=kt(s),b()):s*Ai},v.reflectX=function(x){return arguments.length?(r=x?-1:1,b()):r<0},v.reflectY=function(x){return arguments.length?(i=x?-1:1,b()):i<0},v.fitExtent=function(x,w){return KD(v,x,w)},v.fitSize=function(x,w){return FV(v,x,w)},v.fitWidth=function(x,w){return RV(v,x,w)},v.fitHeight=function(x,w){return MV(v,x,w)},v}function nbe(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}nbe.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(Qt(i)>gt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function Lgt(){return Xl(nbe).scale(175.295)}function rbe(e,t){return[kt(t)*pt(e),pt(t)]}rbe.invert=LC(Ra);function zgt(){return Xl(rbe).scale(249.5).clipAngle(90+gt)}function ibe(e,t){var n=kt(t),r=1+kt(e)*n;return[n*pt(e)/r,pt(t)/r]}ibe.invert=LC(function(e){return 2*cb(e)});function Bgt(){return Xl(ibe).scale(250).clipAngle(142)}function sbe(e,t){return[WT(DV((er+t)/2)),-e]}sbe.invert=function(e,t){return[-t,2*cb(Aye(e))-er]};function Ugt(){var e=Jye(sbe),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var Wgt=Math.abs,sL=Math.cos,eA=Math.sin,Vgt=1e-6,obe=Math.PI,oL=obe/2,GQ=jgt(2);function qQ(e){return e>1?oL:e<-1?-oL:Math.asin(e)}function jgt(e){return e>0?Math.sqrt(e):0}function Hgt(e,t){var n=e*eA(t),r=30,i;do t-=i=(t+eA(t)-n)/(1+sL(t));while(Wgt(i)>Vgt&&--r>0);return t/2}function Ggt(e,t,n){function r(i,s){return[e*i*sL(s=Hgt(n,s)),t*eA(s)]}return r.invert=function(i,s){return s=qQ(s/t),[i/(e*sL(s)),qQ((2*s+eA(2*s))/n)]},r}var qgt=Ggt(GQ/oL,GQ,obe);function Xgt(){return Xl(qgt).scale(169.529)}function Kl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function dh(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const XQ=Symbol("implicit");function LV(){var e=new dZ,t=[],n=[],r=XQ;function i(s){let o=e.get(s);if(o===void 0){if(r!==XQ)return r;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new dZ;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return LV(t,n).unknown(r)},Kl.apply(i,arguments),i}function fb(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function zC(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function hh(){}var cm=.7,h1=1/cm,w0="\\s*([+-]?\\d+)\\s*",Kw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kgt=/^#([0-9a-f]{3,8})$/,Ygt=new RegExp(`^rgb\\(${w0},${w0},${w0}\\)$`),Zgt=new RegExp(`^rgb\\(${$l},${$l},${$l}\\)$`),Qgt=new RegExp(`^rgba\\(${w0},${w0},${w0},${Kw}\\)$`),Jgt=new RegExp(`^rgba\\(${$l},${$l},${$l},${Kw}\\)$`),e0t=new RegExp(`^hsl\\(${Kw},${$l},${$l}\\)$`),t0t=new RegExp(`^hsla\\(${Kw},${$l},${$l},${Kw}\\)$`),KQ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fb(hh,Yw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:YQ,formatHex:YQ,formatHex8:n0t,formatHsl:r0t,formatRgb:ZQ,toString:ZQ});function YQ(){return this.rgb().formatHex()}function n0t(){return this.rgb().formatHex8()}function r0t(){return abe(this).formatHsl()}function ZQ(){return this.rgb().formatRgb()}function Yw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Kgt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?QQ(t):n===3?new Kr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?R$(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?R$(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Ygt.exec(e))?new Kr(t[1],t[2],t[3],1):(t=Zgt.exec(e))?new Kr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Qgt.exec(e))?R$(t[1],t[2],t[3],t[4]):(t=Jgt.exec(e))?R$(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=e0t.exec(e))?tJ(t[1],t[2]/100,t[3]/100,1):(t=t0t.exec(e))?tJ(t[1],t[2]/100,t[3]/100,t[4]):KQ.hasOwnProperty(e)?QQ(KQ[e]):e==="transparent"?new Kr(NaN,NaN,NaN,0):null}function QQ(e){return new Kr(e>>16&255,e>>8&255,e&255,1)}function R$(e,t,n,r){return r<=0&&(e=t=n=NaN),new Kr(e,t,n,r)}function zV(e){return e instanceof hh||(e=Yw(e)),e?(e=e.rgb(),new Kr(e.r,e.g,e.b,e.opacity)):new Kr}function tA(e,t,n,r){return arguments.length===1?zV(e):new Kr(e,t,n,r??1)}function Kr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}fb(Kr,tA,zC(hh,{brighter(e){return e=e==null?h1:Math.pow(h1,e),new Kr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?cm:Math.pow(cm,e),new Kr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Kr(_p(this.r),_p(this.g),_p(this.b),nA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:JQ,formatHex:JQ,formatHex8:i0t,formatRgb:eJ,toString:eJ}));function JQ(){return`#${pp(this.r)}${pp(this.g)}${pp(this.b)}`}function i0t(){return`#${pp(this.r)}${pp(this.g)}${pp(this.b)}${pp((isNaN(this.opacity)?1:this.opacity)*255)}`}function eJ(){const e=nA(this.opacity);return`${e===1?"rgb(":"rgba("}${_p(this.r)}, ${_p(this.g)}, ${_p(this.b)}${e===1?")":`, ${e})`}`}function nA(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function _p(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pp(e){return e=_p(e),(e<16?"0":"")+e.toString(16)}function tJ(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new uu(e,t,n,r)}function abe(e){if(e instanceof uu)return new uu(e.h,e.s,e.l,e.opacity);if(e instanceof hh||(e=Yw(e)),!e)return new uu;if(e instanceof uu)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new uu(o,a,u,e.opacity)}function aL(e,t,n,r){return arguments.length===1?abe(e):new uu(e,t,n,r??1)}function uu(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}fb(uu,aL,zC(hh,{brighter(e){return e=e==null?h1:Math.pow(h1,e),new uu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?cm:Math.pow(cm,e),new uu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Kr(oM(e>=240?e-240:e+120,i,r),oM(e,i,r),oM(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new uu(nJ(this.h),M$(this.s),M$(this.l),nA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=nA(this.opacity);return`${e===1?"hsl(":"hsla("}${nJ(this.h)}, ${M$(this.s)*100}%, ${M$(this.l)*100}%${e===1?")":`, ${e})`}`}}));function nJ(e){return e=(e||0)%360,e<0?e+360:e}function M$(e){return Math.max(0,Math.min(1,e||0))}function oM(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ube=Math.PI/180,lbe=180/Math.PI,rA=18,cbe=.96422,fbe=1,dbe=.82521,hbe=4/29,S0=6/29,pbe=3*S0*S0,s0t=S0*S0*S0;function mbe(e){if(e instanceof _l)return new _l(e.l,e.a,e.b,e.opacity);if(e instanceof $c)return gbe(e);e instanceof Kr||(e=zV(e));var t=cM(e.r),n=cM(e.g),r=cM(e.b),i=aM((.2225045*t+.7168786*n+.0606169*r)/fbe),s,o;return t===n&&n===r?s=o=i:(s=aM((.4360747*t+.3850649*n+.1430804*r)/cbe),o=aM((.0139322*t+.0971045*n+.7141733*r)/dbe)),new _l(116*i-16,500*(s-i),200*(i-o),e.opacity)}function uL(e,t,n,r){return arguments.length===1?mbe(e):new _l(e,t,n,r??1)}function _l(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}fb(_l,uL,zC(hh,{brighter(e){return new _l(this.l+rA*(e??1),this.a,this.b,this.opacity)},darker(e){return new _l(this.l-rA*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=cbe*uM(t),e=fbe*uM(e),n=dbe*uM(n),new Kr(lM(3.1338561*t-1.6168667*e-.4906146*n),lM(-.9787684*t+1.9161415*e+.033454*n),lM(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function aM(e){return e>s0t?Math.pow(e,1/3):e/pbe+hbe}function uM(e){return e>S0?e*e*e:pbe*(e-hbe)}function lM(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function cM(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function o0t(e){if(e instanceof $c)return new $c(e.h,e.c,e.l,e.opacity);if(e instanceof _l||(e=mbe(e)),e.a===0&&e.b===0)return new $c(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*lbe;return new $c(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function lL(e,t,n,r){return arguments.length===1?o0t(e):new $c(e,t,n,r??1)}function $c(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function gbe(e){if(isNaN(e.h))return new _l(e.l,0,0,e.opacity);var t=e.h*ube;return new _l(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}fb($c,lL,zC(hh,{brighter(e){return new $c(this.h,this.c,this.l+rA*(e??1),this.opacity)},darker(e){return new $c(this.h,this.c,this.l-rA*(e??1),this.opacity)},rgb(){return gbe(this).rgb()}}));var ybe=-.14861,BV=1.78277,UV=-.29227,ZD=-.90649,Zw=1.97294,rJ=Zw*ZD,iJ=Zw*BV,sJ=BV*UV-ZD*ybe;function a0t(e){if(e instanceof Ep)return new Ep(e.h,e.s,e.l,e.opacity);e instanceof Kr||(e=zV(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(sJ*r+rJ*t-iJ*n)/(sJ+rJ-iJ),s=r-i,o=(Zw*(n-i)-UV*s)/ZD,a=Math.sqrt(o*o+s*s)/(Zw*i*(1-i)),u=a?Math.atan2(o,s)*lbe-120:NaN;return new Ep(u<0?u+360:u,a,i,e.opacity)}function cL(e,t,n,r){return arguments.length===1?a0t(e):new Ep(e,t,n,r??1)}function Ep(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}fb(Ep,cL,zC(hh,{brighter(e){return e=e==null?h1:Math.pow(h1,e),new Ep(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?cm:Math.pow(cm,e),new Ep(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*ube,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Kr(255*(t+n*(ybe*r+BV*i)),255*(t+n*(UV*r+ZD*i)),255*(t+n*(Zw*r)),this.opacity)}}));function bbe(e,t,n,r,i){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*i)/6}function vbe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],o=r>0?e[r-1]:2*i-s,a=r<t-1?e[r+2]:2*s-i;return bbe((n-r/t)*t,o,i,s,a)}}function xbe(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],o=e[(r+1)%t],a=e[(r+2)%t];return bbe((n-r/t)*t,i,s,o,a)}}const QD=e=>()=>e;function wbe(e,t){return function(n){return e+n*t}}function u0t(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function JD(e,t){var n=t-e;return n?wbe(e,n>180||n<-180?n-360*Math.round(n/360):n):QD(isNaN(e)?t:e)}function l0t(e){return(e=+e)==1?Yr:function(t,n){return n-t?u0t(t,n,e):QD(isNaN(t)?n:t)}}function Yr(e,t){var n=t-e;return n?wbe(e,n):QD(isNaN(e)?t:e)}const fL=function e(t){var n=l0t(t);function r(i,s){var o=n((i=tA(i)).r,(s=tA(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),l=Yr(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function Sbe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=tA(t[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=e(r),i=e(i),s=e(s),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=s(u),a+""}}}var c0t=Sbe(vbe),f0t=Sbe(xbe);function WV(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function Cbe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function d0t(e,t){return(Cbe(t)?WV:kbe)(e,t)}function kbe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=Qm(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function $be(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function au(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function _be(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Qm(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var dL=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fM=new RegExp(dL.source,"g");function h0t(e){return function(){return e}}function p0t(e){return function(t){return e(t)+""}}function Ebe(e,t){var n=dL.lastIndex=fM.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(r=dL.exec(e))&&(i=fM.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:au(r,i)})),n=fM.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?p0t(u[0].x):h0t(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function Qm(e,t){var n=typeof t,r;return t==null||n==="boolean"?QD(t):(n==="number"?au:n==="string"?(r=Yw(t))?(t=r,fL):Ebe:t instanceof Yw?fL:t instanceof Date?$be:Cbe(t)?WV:Array.isArray(t)?kbe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?_be:au)(e,t)}function m0t(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function g0t(e,t){var n=JD(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function eO(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var oJ=180/Math.PI,hL={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Tbe(e,t,n,r,i,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*oJ,skewX:Math.atan(u)*oJ,scaleX:o,scaleY:a}}var P$;function y0t(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?hL:Tbe(t.a,t.b,t.c,t.d,t.e,t.f)}function b0t(e){return e==null||(P$||(P$=document.createElementNS("http://www.w3.org/2000/svg","g")),P$.setAttribute("transform",e),!(e=P$.transform.baseVal.consolidate()))?hL:(e=e.matrix,Tbe(e.a,e.b,e.c,e.d,e.e,e.f))}function Abe(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:au(l,f)},{i:m-2,x:au(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:au(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:au(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:au(l,f)},{i:m-2,x:au(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,m=d.length,g;++p<m;)f[(g=d[p]).i]=g.x(h);return f.join("")}}}var v0t=Abe(y0t,"px, ","px)","deg)"),x0t=Abe(b0t,", ",")",")"),w0t=1e-12;function aJ(e){return((e=Math.exp(e))+1/e)/2}function S0t(e){return((e=Math.exp(e))-1/e)/2}function C0t(e){return((e=Math.exp(2*e))-1)/(e+1)}const k0t=function e(t,n,r){function i(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,p=f-u,m=h*h+p*p,g,y;if(m<w0t)y=Math.log(d/l)/t,g=function(C){return[a+C*h,u+C*p,l*Math.exp(t*C*y)]};else{var b=Math.sqrt(m),v=(d*d-l*l+r*m)/(2*l*n*b),x=(d*d-l*l-r*m)/(2*d*n*b),w=Math.log(Math.sqrt(v*v+1)-v),S=Math.log(Math.sqrt(x*x+1)-x);y=(S-w)/t,g=function(C){var k=C*y,E=aJ(w),_=l/(n*b)*(E*C0t(t*k+w)-S0t(w));return[a+_*h,u+_*p,l*E/aJ(t*k+w)]}}return g.duration=y*1e3*t/Math.SQRT2,g}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},i}(Math.SQRT2,2,4);function Nbe(e){return function(t,n){var r=e((t=aL(t)).h,(n=aL(n)).h),i=Yr(t.s,n.s),s=Yr(t.l,n.l),o=Yr(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const $0t=Nbe(JD);var _0t=Nbe(Yr);function E0t(e,t){var n=Yr((e=uL(e)).l,(t=uL(t)).l),r=Yr(e.a,t.a),i=Yr(e.b,t.b),s=Yr(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=s(o),e+""}}function Ibe(e){return function(t,n){var r=e((t=lL(t)).h,(n=lL(n)).h),i=Yr(t.c,n.c),s=Yr(t.l,n.l),o=Yr(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const T0t=Ibe(JD);var A0t=Ibe(Yr);function Dbe(e){return function t(n){n=+n;function r(i,s){var o=e((i=cL(i)).h,(s=cL(s)).h),a=Yr(i.s,s.s),u=Yr(i.l,s.l),l=Yr(i.opacity,s.opacity);return function(c){return i.h=o(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const N0t=Dbe(JD);var I0t=Dbe(Yr);function VV(e,t){t===void 0&&(t=e,e=Qm);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[a](o-a)}}function D0t(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const O0t=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Qm,interpolateArray:d0t,interpolateBasis:vbe,interpolateBasisClosed:xbe,interpolateCubehelix:N0t,interpolateCubehelixLong:I0t,interpolateDate:$be,interpolateDiscrete:m0t,interpolateHcl:T0t,interpolateHclLong:A0t,interpolateHsl:$0t,interpolateHslLong:_0t,interpolateHue:g0t,interpolateLab:E0t,interpolateNumber:au,interpolateNumberArray:WV,interpolateObject:_be,interpolateRgb:fL,interpolateRgbBasis:c0t,interpolateRgbBasisClosed:f0t,interpolateRound:eO,interpolateString:Ebe,interpolateTransformCss:v0t,interpolateTransformSvg:x0t,interpolateZoom:k0t,piecewise:VV,quantize:D0t},Symbol.toStringTag,{value:"Module"}));function F0t(e){return function(){return e}}function pL(e){return+e}var uJ=[0,1];function Gs(e){return e}function mL(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:F0t(isNaN(t)?NaN:.5)}function R0t(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function M0t(e,t,n){var r=e[0],i=e[1],s=t[0],o=t[1];return i<r?(r=mL(i,r),s=n(o,s)):(r=mL(r,i),s=n(s,o)),function(a){return s(r(a))}}function P0t(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=mL(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=rm(e,a,1,r)-1;return s[u](i[u](a))}}function BC(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function tO(){var e=uJ,t=uJ,n=Qm,r,i,s,o=Gs,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==Gs&&(o=R0t(e[0],e[d-1])),a=d>2?P0t:M0t,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=a(t,e.map(r),au)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,pL),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=eO,c()},f.clamp=function(d){return arguments.length?(o=d?!0:Gs,c()):o!==Gs},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return r=d,i=h,c()}}function Obe(){return tO()(Gs,Gs)}function Fbe(e,t,n,r){var i=mP(e,t,n),s;switch(r=Md(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=wV(i,o))&&(r.precision=s),jD(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=SV(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=xV(i))&&(r.precision=s-(r.type==="%")*2);break}}return bu(r)}function Jm(e){var t=e.domain;return e.ticks=function(n){var r=t();return hP(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Fbe(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,o=r[i],a=r[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=i,i=s,s=l);c-- >0;){if(l=pP(o,a,n),l===u)return r[i]=o,r[s]=a,t(r);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function Rbe(){var e=Obe();return e.copy=function(){return BC(e,Rbe())},Kl.apply(e,arguments),Jm(e)}function Mbe(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,pL),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Mbe(e).unknown(t)},e=arguments.length?Array.from(e,pL):[0,1],Jm(n)}function Pbe(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],o;return s<i&&(o=n,n=r,r=o,o=i,i=s,s=o),e[n]=t.floor(i),e[r]=t.ceil(s),e}function lJ(e){return Math.log(e)}function cJ(e){return Math.exp(e)}function L0t(e){return-Math.log(-e)}function z0t(e){return-Math.exp(-e)}function B0t(e){return isFinite(e)?+("1e"+e):e<0?0:e}function U0t(e){return e===10?B0t:e===Math.E?Math.exp:t=>Math.pow(e,t)}function W0t(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function fJ(e){return(t,n)=>-e(-t,n)}function jV(e){const t=e(lJ,cJ),n=t.domain;let r=10,i,s;function o(){return i=W0t(r),s=U0t(r),n()[0]<0?(i=fJ(i),s=fJ(s),e(L0t,z0t)):e(lJ,cJ),t}return t.base=function(a){return arguments.length?(r=+a,o()):r},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=i(l),h=i(c),p,m;const g=a==null?10:+a;let y=[];if(!(r%1)&&h-d<g){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<r;++p)if(m=d<0?p/s(-d):p*s(d),!(m<l)){if(m>c)break;y.push(m)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(m=d>0?p/s(-d):p*s(d),!(m<l)){if(m>c)break;y.push(m)}y.length*2<g&&(y=hP(l,c,g))}else y=hP(d,h,Math.min(h-d,g)).map(s);return f?y.reverse():y},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=Md(u)).precision==null&&(u.trim=!0),u=bu(u)),a===1/0)return u;const l=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=()=>n(Pbe(n(),{floor:a=>s(Math.floor(i(a))),ceil:a=>s(Math.ceil(i(a)))})),t}function Lbe(){const e=jV(tO()).domain([1,10]);return e.copy=()=>BC(e,Lbe()).base(e.base()),Kl.apply(e,arguments),e}function dJ(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function hJ(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function HV(e){var t=1,n=e(dJ(t),hJ(t));return n.constant=function(r){return arguments.length?e(dJ(t=+r),hJ(t)):t},Jm(n)}function zbe(){var e=HV(tO());return e.copy=function(){return BC(e,zbe()).constant(e.constant())},Kl.apply(e,arguments)}function pJ(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function V0t(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function j0t(e){return e<0?-e*e:e*e}function GV(e){var t=e(Gs,Gs),n=1;function r(){return n===1?e(Gs,Gs):n===.5?e(V0t,j0t):e(pJ(n),pJ(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Jm(t)}function qV(){var e=GV(tO());return e.copy=function(){return BC(e,qV()).exponent(e.exponent())},Kl.apply(e,arguments),e}function H0t(){return qV.apply(null,arguments).exponent(.5)}function Bbe(){var e=[],t=[],n=[],r;function i(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=cme(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?r:t[rm(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Fc),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return Bbe().domain(e).range(t).unknown(r)},Kl.apply(s,arguments)}function Ube(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function o(u){return u!=null&&u<=u?i[rm(r,u,0,n)]:s}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return Ube().domain([e,t]).range(i).unknown(s)},Kl.apply(Jm(o),arguments)}function Wbe(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[rm(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return Wbe().domain(e).range(t).unknown(n)},Kl.apply(i,arguments)}const dM=new Date,hM=new Date;function zr(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const u=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;let l;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},i.filter=s=>zr(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(i.count=(s,o)=>(dM.setTime(+s),hM.setTime(+o),e(dM),e(hM),Math.floor(n(dM,hM))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?o=>r(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const p1=zr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);p1.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?zr(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):p1);p1.range;const _c=1e3,xa=_c*60,Ec=xa*60,ef=Ec*24,XV=ef*7,mJ=ef*30,pM=ef*365,Tc=zr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*_c)},(e,t)=>(t-e)/_c,e=>e.getUTCSeconds());Tc.range;const nO=zr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*_c)},(e,t)=>{e.setTime(+e+t*xa)},(e,t)=>(t-e)/xa,e=>e.getMinutes());nO.range;const rO=zr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*xa)},(e,t)=>(t-e)/xa,e=>e.getUTCMinutes());rO.range;const iO=zr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*_c-e.getMinutes()*xa)},(e,t)=>{e.setTime(+e+t*Ec)},(e,t)=>(t-e)/Ec,e=>e.getHours());iO.range;const sO=zr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ec)},(e,t)=>(t-e)/Ec,e=>e.getUTCHours());sO.range;const md=zr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xa)/ef,e=>e.getDate()-1);md.range;const Tp=zr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ef,e=>e.getUTCDate()-1);Tp.range;const Vbe=zr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ef,e=>Math.floor(e/ef));Vbe.range;function eg(e){return zr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*xa)/XV)}const UC=eg(0),iA=eg(1),G0t=eg(2),q0t=eg(3),m1=eg(4),X0t=eg(5),K0t=eg(6);UC.range;iA.range;G0t.range;q0t.range;m1.range;X0t.range;K0t.range;function tg(e){return zr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/XV)}const WC=tg(0),sA=tg(1),Y0t=tg(2),Z0t=tg(3),g1=tg(4),Q0t=tg(5),J0t=tg(6);WC.range;sA.range;Y0t.range;Z0t.range;g1.range;Q0t.range;J0t.range;const Qw=zr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Qw.range;const Jw=zr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Jw.range;const Pl=zr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Pl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:zr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Pl.range;const Ll=zr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ll.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:zr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Ll.range;function jbe(e,t,n,r,i,s){const o=[[Tc,1,_c],[Tc,5,5*_c],[Tc,15,15*_c],[Tc,30,30*_c],[s,1,xa],[s,5,5*xa],[s,15,15*xa],[s,30,30*xa],[i,1,Ec],[i,3,3*Ec],[i,6,6*Ec],[i,12,12*Ec],[r,1,ef],[r,2,2*ef],[n,1,XV],[t,1,mJ],[t,3,3*mJ],[e,1,pM]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=eW(([,,g])=>g).right(o,d);if(h===o.length)return e.every(mP(l/pM,c/pM,f));if(h===0)return p1.every(Math.max(mP(l,c,f),1));const[p,m]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(m)}return[a,u]}const[e1t,t1t]=jbe(Ll,Jw,WC,Vbe,sO,rO),[n1t,r1t]=jbe(Pl,Qw,UC,md,iO,nO);function mM(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function gM(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function fv(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function i1t(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=dv(i),c=hv(i),f=dv(s),d=hv(s),h=dv(o),p=hv(o),m=dv(a),g=hv(a),y=dv(u),b=hv(u),v={a:V,A:F,b:B,B:q,c:null,d:wJ,e:wJ,f:E1t,g:P1t,G:z1t,H:k1t,I:$1t,j:_1t,L:Hbe,m:T1t,M:A1t,p:J,q:ne,Q:kJ,s:$J,S:N1t,u:I1t,U:D1t,V:O1t,w:F1t,W:R1t,x:null,X:null,y:M1t,Y:L1t,Z:B1t,"%":CJ},x={a:re,A:ae,b:le,B:me,c:null,d:SJ,e:SJ,f:j1t,g:eyt,G:nyt,H:U1t,I:W1t,j:V1t,L:qbe,m:H1t,M:G1t,p:Oe,q:Me,Q:kJ,s:$J,S:q1t,u:X1t,U:K1t,V:Y1t,w:Z1t,W:Q1t,x:null,X:null,y:J1t,Y:tyt,Z:ryt,"%":CJ},w={a:_,A:T,b:D,B:O,c:M,d:vJ,e:vJ,f:x1t,g:bJ,G:yJ,H:xJ,I:xJ,j:g1t,L:v1t,m:m1t,M:y1t,p:E,q:p1t,Q:S1t,s:C1t,S:b1t,u:l1t,U:c1t,V:f1t,w:u1t,W:d1t,x:I,X:P,y:bJ,Y:yJ,Z:h1t,"%":w1t};v.x=S(n,v),v.X=S(r,v),v.c=S(t,v),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(X,oe){return function(fe){var W=[],Ve=-1,ke=0,Ke=X.length,He,Z,Ee;for(fe instanceof Date||(fe=new Date(+fe));++Ve<Ke;)X.charCodeAt(Ve)===37&&(W.push(X.slice(ke,Ve)),(Z=gJ[He=X.charAt(++Ve)])!=null?He=X.charAt(++Ve):Z=He==="e"?" ":"0",(Ee=oe[He])&&(He=Ee(fe,Z)),W.push(He),ke=Ve+1);return W.push(X.slice(ke,Ve)),W.join("")}}function C(X,oe){return function(fe){var W=fv(1900,void 0,1),Ve=k(W,X,fe+="",0),ke,Ke;if(Ve!=fe.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(oe&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(ke=gM(fv(W.y,0,1)),Ke=ke.getUTCDay(),ke=Ke>4||Ke===0?sA.ceil(ke):sA(ke),ke=Tp.offset(ke,(W.V-1)*7),W.y=ke.getUTCFullYear(),W.m=ke.getUTCMonth(),W.d=ke.getUTCDate()+(W.w+6)%7):(ke=mM(fv(W.y,0,1)),Ke=ke.getDay(),ke=Ke>4||Ke===0?iA.ceil(ke):iA(ke),ke=md.offset(ke,(W.V-1)*7),W.y=ke.getFullYear(),W.m=ke.getMonth(),W.d=ke.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),Ke="Z"in W?gM(fv(W.y,0,1)).getUTCDay():mM(fv(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(Ke+5)%7:W.w+W.U*7-(Ke+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,gM(W)):mM(W)}}function k(X,oe,fe,W){for(var Ve=0,ke=oe.length,Ke=fe.length,He,Z;Ve<ke;){if(W>=Ke)return-1;if(He=oe.charCodeAt(Ve++),He===37){if(He=oe.charAt(Ve++),Z=w[He in gJ?oe.charAt(Ve++):He],!Z||(W=Z(X,fe,W))<0)return-1}else if(He!=fe.charCodeAt(W++))return-1}return W}function E(X,oe,fe){var W=l.exec(oe.slice(fe));return W?(X.p=c.get(W[0].toLowerCase()),fe+W[0].length):-1}function _(X,oe,fe){var W=h.exec(oe.slice(fe));return W?(X.w=p.get(W[0].toLowerCase()),fe+W[0].length):-1}function T(X,oe,fe){var W=f.exec(oe.slice(fe));return W?(X.w=d.get(W[0].toLowerCase()),fe+W[0].length):-1}function D(X,oe,fe){var W=y.exec(oe.slice(fe));return W?(X.m=b.get(W[0].toLowerCase()),fe+W[0].length):-1}function O(X,oe,fe){var W=m.exec(oe.slice(fe));return W?(X.m=g.get(W[0].toLowerCase()),fe+W[0].length):-1}function M(X,oe,fe){return k(X,t,oe,fe)}function I(X,oe,fe){return k(X,n,oe,fe)}function P(X,oe,fe){return k(X,r,oe,fe)}function V(X){return o[X.getDay()]}function F(X){return s[X.getDay()]}function B(X){return u[X.getMonth()]}function q(X){return a[X.getMonth()]}function J(X){return i[+(X.getHours()>=12)]}function ne(X){return 1+~~(X.getMonth()/3)}function re(X){return o[X.getUTCDay()]}function ae(X){return s[X.getUTCDay()]}function le(X){return u[X.getUTCMonth()]}function me(X){return a[X.getUTCMonth()]}function Oe(X){return i[+(X.getUTCHours()>=12)]}function Me(X){return 1+~~(X.getUTCMonth()/3)}return{format:function(X){var oe=S(X+="",v);return oe.toString=function(){return X},oe},parse:function(X){var oe=C(X+="",!1);return oe.toString=function(){return X},oe},utcFormat:function(X){var oe=S(X+="",x);return oe.toString=function(){return X},oe},utcParse:function(X){var oe=C(X+="",!0);return oe.toString=function(){return X},oe}}}var gJ={"-":"",_:" ",0:"0"},li=/^\s*\d+/,s1t=/^%/,o1t=/[\\^$*+?|[\]().{}]/g;function Gt(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function a1t(e){return e.replace(o1t,"\\$&")}function dv(e){return new RegExp("^(?:"+e.map(a1t).join("|")+")","i")}function hv(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function u1t(e,t,n){var r=li.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function l1t(e,t,n){var r=li.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function c1t(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function f1t(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function d1t(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function yJ(e,t,n){var r=li.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function bJ(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function h1t(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function p1t(e,t,n){var r=li.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function m1t(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function vJ(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function g1t(e,t,n){var r=li.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function xJ(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function y1t(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function b1t(e,t,n){var r=li.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function v1t(e,t,n){var r=li.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function x1t(e,t,n){var r=li.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function w1t(e,t,n){var r=s1t.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function S1t(e,t,n){var r=li.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function C1t(e,t,n){var r=li.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function wJ(e,t){return Gt(e.getDate(),t,2)}function k1t(e,t){return Gt(e.getHours(),t,2)}function $1t(e,t){return Gt(e.getHours()%12||12,t,2)}function _1t(e,t){return Gt(1+md.count(Pl(e),e),t,3)}function Hbe(e,t){return Gt(e.getMilliseconds(),t,3)}function E1t(e,t){return Hbe(e,t)+"000"}function T1t(e,t){return Gt(e.getMonth()+1,t,2)}function A1t(e,t){return Gt(e.getMinutes(),t,2)}function N1t(e,t){return Gt(e.getSeconds(),t,2)}function I1t(e){var t=e.getDay();return t===0?7:t}function D1t(e,t){return Gt(UC.count(Pl(e)-1,e),t,2)}function Gbe(e){var t=e.getDay();return t>=4||t===0?m1(e):m1.ceil(e)}function O1t(e,t){return e=Gbe(e),Gt(m1.count(Pl(e),e)+(Pl(e).getDay()===4),t,2)}function F1t(e){return e.getDay()}function R1t(e,t){return Gt(iA.count(Pl(e)-1,e),t,2)}function M1t(e,t){return Gt(e.getFullYear()%100,t,2)}function P1t(e,t){return e=Gbe(e),Gt(e.getFullYear()%100,t,2)}function L1t(e,t){return Gt(e.getFullYear()%1e4,t,4)}function z1t(e,t){var n=e.getDay();return e=n>=4||n===0?m1(e):m1.ceil(e),Gt(e.getFullYear()%1e4,t,4)}function B1t(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Gt(t/60|0,"0",2)+Gt(t%60,"0",2)}function SJ(e,t){return Gt(e.getUTCDate(),t,2)}function U1t(e,t){return Gt(e.getUTCHours(),t,2)}function W1t(e,t){return Gt(e.getUTCHours()%12||12,t,2)}function V1t(e,t){return Gt(1+Tp.count(Ll(e),e),t,3)}function qbe(e,t){return Gt(e.getUTCMilliseconds(),t,3)}function j1t(e,t){return qbe(e,t)+"000"}function H1t(e,t){return Gt(e.getUTCMonth()+1,t,2)}function G1t(e,t){return Gt(e.getUTCMinutes(),t,2)}function q1t(e,t){return Gt(e.getUTCSeconds(),t,2)}function X1t(e){var t=e.getUTCDay();return t===0?7:t}function K1t(e,t){return Gt(WC.count(Ll(e)-1,e),t,2)}function Xbe(e){var t=e.getUTCDay();return t>=4||t===0?g1(e):g1.ceil(e)}function Y1t(e,t){return e=Xbe(e),Gt(g1.count(Ll(e),e)+(Ll(e).getUTCDay()===4),t,2)}function Z1t(e){return e.getUTCDay()}function Q1t(e,t){return Gt(sA.count(Ll(e)-1,e),t,2)}function J1t(e,t){return Gt(e.getUTCFullYear()%100,t,2)}function eyt(e,t){return e=Xbe(e),Gt(e.getUTCFullYear()%100,t,2)}function tyt(e,t){return Gt(e.getUTCFullYear()%1e4,t,4)}function nyt(e,t){var n=e.getUTCDay();return e=n>=4||n===0?g1(e):g1.ceil(e),Gt(e.getUTCFullYear()%1e4,t,4)}function ryt(){return"+0000"}function CJ(){return"%"}function kJ(e){return+e}function $J(e){return Math.floor(+e/1e3)}var Ig,Kbe,Ybe;iyt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iyt(e){return Ig=i1t(e),Kbe=Ig.format,Ig.parse,Ybe=Ig.utcFormat,Ig.utcParse,Ig}function syt(e){return new Date(e)}function oyt(e){return e instanceof Date?+e:+new Date(+e)}function KV(e,t,n,r,i,s,o,a,u,l){var c=Obe(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),y=l("%a %d"),b=l("%b %d"),v=l("%B"),x=l("%Y");function w(S){return(u(S)<S?h:a(S)<S?p:o(S)<S?m:s(S)<S?g:r(S)<S?i(S)<S?y:b:n(S)<S?v:x)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,oyt)):d().map(syt)},c.ticks=function(S){var C=d();return e(C[0],C[C.length-1],S??10)},c.tickFormat=function(S,C){return C==null?w:l(C)},c.nice=function(S){var C=d();return(!S||typeof S.range!="function")&&(S=t(C[0],C[C.length-1],S??10)),S?d(Pbe(C,S)):c},c.copy=function(){return BC(c,KV(e,t,n,r,i,s,o,a,u,l))},c}function ayt(){return Kl.apply(KV(n1t,r1t,Pl,Qw,UC,md,iO,nO,Tc,Kbe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function uyt(){return Kl.apply(KV(e1t,t1t,Ll,Jw,WC,Tp,sO,rO,Tc,Ybe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function oO(){var e=0,t=1,n,r,i,s,o=Gs,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(s(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(Qm),l.rangeRound=c(eO),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function ph(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function YV(){var e=Jm(oO()(Gs));return e.copy=function(){return ph(e,YV())},dh.apply(e,arguments)}function Zbe(){var e=jV(oO()).domain([1,10]);return e.copy=function(){return ph(e,Zbe()).base(e.base())},dh.apply(e,arguments)}function Qbe(){var e=HV(oO());return e.copy=function(){return ph(e,Qbe()).constant(e.constant())},dh.apply(e,arguments)}function ZV(){var e=GV(oO());return e.copy=function(){return ph(e,ZV()).exponent(e.exponent())},dh.apply(e,arguments)}function lyt(){return ZV.apply(null,arguments).exponent(.5)}function aO(){var e=0,t=.5,n=1,r=1,i,s,o,a,u,l=Gs,c,f=!1,d;function h(m){return isNaN(m=+m)?d:(m=.5+((m=+c(m))-s)*(r*m<r*s?a:u),l(f?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t,n]=m,i=c(e=+e),s=c(t=+t),o=c(n=+n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h):[e,t,n]},h.clamp=function(m){return arguments.length?(f=!!m,h):f},h.interpolator=function(m){return arguments.length?(l=m,h):l};function p(m){return function(g){var y,b,v;return arguments.length?([y,b,v]=g,l=VV(m,[y,b,v]),h):[l(0),l(.5),l(1)]}}return h.range=p(Qm),h.rangeRound=p(eO),h.unknown=function(m){return arguments.length?(d=m,h):d},function(m){return c=m,i=m(e),s=m(t),o=m(n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h}}function Jbe(){var e=Jm(aO()(Gs));return e.copy=function(){return ph(e,Jbe())},dh.apply(e,arguments)}function eve(){var e=jV(aO()).domain([.1,1,10]);return e.copy=function(){return ph(e,eve()).base(e.base())},dh.apply(e,arguments)}function tve(){var e=HV(aO());return e.copy=function(){return ph(e,tve()).constant(e.constant())},dh.apply(e,arguments)}function QV(){var e=GV(aO());return e.copy=function(){return ph(e,QV()).exponent(e.exponent())},dh.apply(e,arguments)}function cyt(){return QV.apply(null,arguments).exponent(.5)}function Yl(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const fyt=Yl("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),dyt=Yl("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),hyt=Yl("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),pyt=Yl("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),myt=Yl("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),gyt=Yl("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),yyt=Yl("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),byt=Yl("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),vyt=Yl("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),xyt=Yl("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),JV="year",ej="quarter",tj="month",nj="week",rj="date",ij="day",sj="dayofyear",oj="hours",aj="minutes",uj="seconds",lj="milliseconds",wyt=[JV,ej,tj,nj,rj,ij,sj,oj,aj,uj,lj];wyt.reduce((e,t,n)=>(e[t]=1+n,e),{});JV+"",ej+"",Qw.every(3),tj+"",nj+"",rj+"",ij+"",sj+"",oj+"",aj+"",uj+"",lj+"";JV+"",ej+"",Jw.every(3),tj+"",nj+"",rj+"",ij+"",sj+"",oj+"",aj+"",uj+"",lj+"";function Syt(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const Cyt="identity",cj="linear",y1="log",fj="pow",dj="sqrt",hj="symlog",kyt="time",$yt="utc",db="sequential",VC="diverging",_J="quantile",_yt="quantize",Eyt="threshold",Tyt="ordinal",Ayt="point",Nyt="band",Iyt="bin-ordinal",ci="continuous",uO="discrete",lO="discretizing",Bu="interpolating",nve="temporal";function Dyt(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Oyt(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,o,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(s<0&&(s=u),o=u);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function pj(){const e=LV().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=Syt(f,a,u);let m=r[d-0];i=(h-m)/(p||1),o&&(i=Math.floor(i)),m+=(h-m-i*(f-a))*l,s=i*(1-a),o&&(m=Math.round(m),s=Math.round(s));const g=mat(f).map(y=>m+i*y);return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let m=+f[0],g=+f[1],y,b,v;if(!(m!==m||g!==g)&&(g<m&&(v=m,m=g,g=v),!(g<h[0]||m>r[1-d])))return y=Math.max(0,rm(h,m)-1),b=m===g?y:rm(h,g)-1,m-h[y]>s+1e-10&&++y,d&&(v=y,y=p-b,b=p-v),y>b?void 0:t().slice(y,b+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return pj().domain(t()).range(r).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function rve(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return rve(t())},e}function Fyt(){return rve(pj().paddingInner(1))}var Ryt=Array.prototype.map;function Myt(e){return Ryt.call(e,Sr)}const Pyt=Array.prototype.slice;function ive(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(rm(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=Myt(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Pyt.call(r),n):t.slice()},n.tickFormat=function(r,i){return Fbe(e[0],Vt(e),r??10,i)},n.copy=function(){return ive().domain(n.domain()).range(n.range())},n}const gL=new Map,Lyt=Symbol("vega_scale");function sve(e){return e[Lyt]=!0,e}function zyt(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?Dyt(s):s.invertExtent?Oyt(s):void 0),s.type=e,sve(s)};return r.metadata=Ft(xt(n)),r}function kn(e,t,n){return arguments.length>1?(gL.set(e,zyt(e,t,n)),this):Byt(e)?gL.get(e):void 0}kn(Cyt,Mbe);kn(cj,Rbe,ci);kn(y1,Lbe,[ci,y1]);kn(fj,qV,ci);kn(dj,H0t,ci);kn(hj,zbe,ci);kn(kyt,ayt,[ci,nve]);kn($yt,uyt,[ci,nve]);kn(db,YV,[ci,Bu]);kn(`${db}-${cj}`,YV,[ci,Bu]);kn(`${db}-${y1}`,Zbe,[ci,Bu,y1]);kn(`${db}-${fj}`,ZV,[ci,Bu]);kn(`${db}-${dj}`,lyt,[ci,Bu]);kn(`${db}-${hj}`,Qbe,[ci,Bu]);kn(`${VC}-${cj}`,Jbe,[ci,Bu]);kn(`${VC}-${y1}`,eve,[ci,Bu,y1]);kn(`${VC}-${fj}`,QV,[ci,Bu]);kn(`${VC}-${dj}`,cyt,[ci,Bu]);kn(`${VC}-${hj}`,tve,[ci,Bu]);kn(_J,Bbe,[lO,_J]);kn(_yt,Ube,lO);kn(Eyt,Wbe,lO);kn(Iyt,ive,[uO,lO]);kn(Tyt,LV,uO);kn(Nyt,pj,uO);kn(Ayt,Fyt,uO);function Byt(e){return gL.has(e)}function Uyt(e,t,n){return VV(Wyt("rgb",n),e)}function Wyt(e,t){const n=O0t[Vyt(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Vyt(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const jyt={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Hyt={accent:dyt,category10:fyt,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:hyt,observable10:pyt,paired:myt,pastel1:gyt,pastel2:yyt,set1:byt,set2:vyt,set3:xyt,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function ove(e){if(be(e))return e;const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function ave(e,t){for(const n in e)Gyt(n,t(e[n]))}const EJ={};ave(Hyt,ove);ave(jyt,e=>Uyt(ove(e)));function Gyt(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(EJ[e]=t,this):EJ[e]}const qyt=qye(),yL=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Xyt(e,t){return function n(){const r=t();return r.type=e,r.path=qye().projection(r),r.copy=r.copy||function(){const i=n();return yL.forEach(s=>{r[s]&&i[s](r[s]())}),i.path.pointRadius(r.path.pointRadius()),i},sve(r)}}function mj(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(oA[e]=Xyt(e,t),this):oA[e]||null}function uve(e){return e&&e.path||qyt}const oA={albers:Kye,albersusa:$gt,azimuthalequalarea:_gt,azimuthalequidistant:Egt,conicconformal:Ngt,conicequalarea:ZT,conicequidistant:Ogt,equalEarth:Rgt,equirectangular:Igt,gnomonic:Mgt,identity:Pgt,mercator:Tgt,mollweide:Xgt,naturalEarth1:Lgt,orthographic:zgt,stereographic:Bgt,transversemercator:Ugt};for(const e in oA)mj(e,oA[e]);function gj(e){ue.call(this,null,e)}gj.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};var Kyt=Ne(gj,ue);Kyt.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Fl,s=e.as||"path",o=n.SOURCE;function a(l){l[s]=r(i(l))}!r||e.modified()?(this.value=r=uve(e.projection),n.materialize().reflow()):o=i===Fl||t.modified(i.fields)?n.ADD_MOD:n.ADD;var u=Yyt(r,e.pointRadius);return n.visit(o,a),r.pointRadius(u),n.modifies(s)};function Yyt(e,t){var n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function yj(e){ue.call(this,null,e)}yj.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};var Zyt=Ne(yj,ue);Zyt.transform=function(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],u;function l(c){var f=n([r(c),i(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)};function bj(e){ue.call(this,null,e)}bj.Definition={type:"GeoShape",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};var Qyt=Ne(bj,ue);Qyt.transform=function(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Vo("datum"),s=e.as||"shape",o=n.ADD_MOD;return(!r||e.modified())&&(this.value=r=Jyt(uve(e.projection),i,e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,function(a){a[s]=r}),n.modifies(s)};function Jyt(e,t,n){var r=n==null?function(i){return e(t(i))}:function(i){var s=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(s),o};return r.context=function(i){return e.context(i),r},r}function vj(){return new aA}function aA(){this.reset()}aA.prototype={constructor:aA,reset:function(){this.s=this.t=0},add:function(e){TJ(L$,e,this.t),TJ(this,L$.s,this.s),this.s?this.t+=L$.t:this.s=L$.t},valueOf:function(){return this.s}};var L$=new aA;function TJ(e,t,n){var r=e.s=t+n,i=r-t,s=r-i;e.t=t-s+(n-i)}var aa=1e-6,AJ=1e-12,jC=Math.PI,NJ=jC/2,lve=jC/4,IJ=jC*2,Px=180/jC,qi=jC/180,e2=Math.abs,cO=Math.atan2,Ss=Math.cos,z$=Math.ceil,Cs=Math.sin,fO=Math.sqrt;function xj(e){return e>1?NJ:e<-1?-NJ:Math.asin(e)}function ex(){}function uA(e,t){e&&OJ.hasOwnProperty(e.type)&&OJ[e.type](e,t)}var DJ={Feature:function(e,t){uA(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)uA(n[r].geometry,t)}},OJ={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){bL(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)bL(n[r],t,0)},Polygon:function(e,t){FJ(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)FJ(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)uA(n[r],t)}};function bL(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function FJ(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)bL(e[n],t,1);t.polygonEnd()}function wj(e,t){e&&DJ.hasOwnProperty(e.type)?DJ[e.type](e,t):uA(e,t)}var lA=vj(),cA=vj(),cve,fve,vL,xL,wL,zl={point:ex,lineStart:ex,lineEnd:ex,polygonStart:function(){lA.reset(),zl.lineStart=ebt,zl.lineEnd=tbt},polygonEnd:function(){var e=+lA;cA.add(e<0?IJ+e:e),this.lineStart=this.lineEnd=this.point=ex},sphere:function(){cA.add(IJ)}};function ebt(){zl.point=nbt}function tbt(){dve(cve,fve)}function nbt(e,t){zl.point=dve,cve=e,fve=t,e*=qi,t*=qi,vL=e,xL=Ss(t=t/2+lve),wL=Cs(t)}function dve(e,t){e*=qi,t*=qi,t=t/2+lve;var n=e-vL,r=n>=0?1:-1,i=r*n,s=Ss(t),o=Cs(t),a=wL*o,u=xL*s+a*Ss(i),l=a*r*Cs(i);lA.add(cO(l,u)),vL=e,xL=s,wL=o}function rbt(e){return cA.reset(),wj(e,zl),cA*2}function ibt(e){return[cO(e[1],e[0]),xj(e[2])]}function sbt(e){var t=e[0],n=e[1],r=Ss(n);return[r*Ss(t),r*Cs(t),Cs(n)]}function RJ(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function obt(e){var t=fO(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var jn,zs,Zn,wo,Kh,hve,pve,C0,Lx=vj(),Lf,tf,pc={point:SL,lineStart:MJ,lineEnd:PJ,polygonStart:function(){pc.point=gve,pc.lineStart=abt,pc.lineEnd=ubt,Lx.reset(),zl.polygonStart()},polygonEnd:function(){zl.polygonEnd(),pc.point=SL,pc.lineStart=MJ,pc.lineEnd=PJ,lA<0?(jn=-(Zn=180),zs=-(wo=90)):Lx>aa?wo=90:Lx<-aa&&(zs=-90),tf[0]=jn,tf[1]=Zn},sphere:function(){jn=-(Zn=180),zs=-(wo=90)}};function SL(e,t){Lf.push(tf=[jn=e,Zn=e]),t<zs&&(zs=t),t>wo&&(wo=t)}function mve(e,t){var n=sbt([e*qi,t*qi]);if(C0){var r=RJ(C0,n),i=[r[1],-r[0],0],s=RJ(i,r);obt(s),s=ibt(s);var o=e-Kh,a=o>0?1:-1,u=s[0]*Px*a,l,c=e2(o)>180;c^(a*Kh<u&&u<a*e)?(l=s[1]*Px,l>wo&&(wo=l)):(u=(u+360)%360-180,c^(a*Kh<u&&u<a*e)?(l=-s[1]*Px,l<zs&&(zs=l)):(t<zs&&(zs=t),t>wo&&(wo=t))),c?e<Kh?vo(jn,e)>vo(jn,Zn)&&(Zn=e):vo(e,Zn)>vo(jn,Zn)&&(jn=e):Zn>=jn?(e<jn&&(jn=e),e>Zn&&(Zn=e)):e>Kh?vo(jn,e)>vo(jn,Zn)&&(Zn=e):vo(e,Zn)>vo(jn,Zn)&&(jn=e)}else Lf.push(tf=[jn=e,Zn=e]);t<zs&&(zs=t),t>wo&&(wo=t),C0=n,Kh=e}function MJ(){pc.point=mve}function PJ(){tf[0]=jn,tf[1]=Zn,pc.point=SL,C0=null}function gve(e,t){if(C0){var n=e-Kh;Lx.add(e2(n)>180?n+(n>0?360:-360):n)}else hve=e,pve=t;zl.point(e,t),mve(e,t)}function abt(){zl.lineStart()}function ubt(){gve(hve,pve),zl.lineEnd(),e2(Lx)>aa&&(jn=-(Zn=180)),tf[0]=jn,tf[1]=Zn,C0=null}function vo(e,t){return(t-=e)<0?t+360:t}function lbt(e,t){return e[0]-t[0]}function LJ(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function cbt(e){var t,n,r,i,s,o,a;if(wo=Zn=-(jn=zs=1/0),Lf=[],wj(e,pc),n=Lf.length){for(Lf.sort(lbt),t=1,r=Lf[0],s=[r];t<n;++t)i=Lf[t],LJ(r,i[0])||LJ(r,i[1])?(vo(r[0],i[1])>vo(r[0],r[1])&&(r[1]=i[1]),vo(i[0],r[1])>vo(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(o=-1/0,n=s.length-1,t=0,r=s[n];t<=n;r=i,++t)i=s[t],(a=vo(r[1],i[0]))>o&&(o=a,jn=i[0],Zn=r[1])}return Lf=tf=null,jn===1/0||zs===1/0?[[NaN,NaN],[NaN,NaN]]:[[jn,zs],[Zn,wo]]}var tx,fA,dA,hA,pA,mA,gA,yA,CL,kL,$L,yve,bve,rs,is,ss,lu={sphere:ex,point:Sj,lineStart:zJ,lineEnd:BJ,polygonStart:function(){lu.lineStart=hbt,lu.lineEnd=pbt},polygonEnd:function(){lu.lineStart=zJ,lu.lineEnd=BJ}};function Sj(e,t){e*=qi,t*=qi;var n=Ss(t);HC(n*Ss(e),n*Cs(e),Cs(t))}function HC(e,t,n){++tx,dA+=(e-dA)/tx,hA+=(t-hA)/tx,pA+=(n-pA)/tx}function zJ(){lu.point=fbt}function fbt(e,t){e*=qi,t*=qi;var n=Ss(t);rs=n*Ss(e),is=n*Cs(e),ss=Cs(t),lu.point=dbt,HC(rs,is,ss)}function dbt(e,t){e*=qi,t*=qi;var n=Ss(t),r=n*Ss(e),i=n*Cs(e),s=Cs(t),o=cO(fO((o=is*s-ss*i)*o+(o=ss*r-rs*s)*o+(o=rs*i-is*r)*o),rs*r+is*i+ss*s);fA+=o,mA+=o*(rs+(rs=r)),gA+=o*(is+(is=i)),yA+=o*(ss+(ss=s)),HC(rs,is,ss)}function BJ(){lu.point=Sj}function hbt(){lu.point=mbt}function pbt(){vve(yve,bve),lu.point=Sj}function mbt(e,t){yve=e,bve=t,e*=qi,t*=qi,lu.point=vve;var n=Ss(t);rs=n*Ss(e),is=n*Cs(e),ss=Cs(t),HC(rs,is,ss)}function vve(e,t){e*=qi,t*=qi;var n=Ss(t),r=n*Ss(e),i=n*Cs(e),s=Cs(t),o=is*s-ss*i,a=ss*r-rs*s,u=rs*i-is*r,l=fO(o*o+a*a+u*u),c=xj(l),f=l&&-c/l;CL+=f*o,kL+=f*a,$L+=f*u,fA+=c,mA+=c*(rs+(rs=r)),gA+=c*(is+(is=i)),yA+=c*(ss+(ss=s)),HC(rs,is,ss)}function gbt(e){tx=fA=dA=hA=pA=mA=gA=yA=CL=kL=$L=0,wj(e,lu);var t=CL,n=kL,r=$L,i=t*t+n*n+r*r;return i<AJ&&(t=mA,n=gA,r=yA,fA<aa&&(t=dA,n=hA,r=pA),i=t*t+n*n+r*r,i<AJ)?[NaN,NaN]:[cO(n,t)*Px,xj(r/fO(i))*Px]}function xve(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ybt(e){return e.length===1&&(e=bbt(e)),{left:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var s=r+i>>>1;e(t[s],n)<0?r=s+1:i=s}return r},right:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var s=r+i>>>1;e(t[s],n)>0?i=s:r=s+1}return r}}}function bbt(e){return function(t,n){return xve(e(t),n)}}ybt(xve);function r0(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function UJ(e,t,n){var r=r0(e,t-aa,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function WJ(e,t,n){var r=r0(e,t-aa,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function vbt(){var e,t,n,r,i,s,o,a,u=10,l=u,c=90,f=360,d,h,p,m,g=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return r0(z$(r/c)*c,n,c).map(p).concat(r0(z$(a/f)*f,o,f).map(m)).concat(r0(z$(t/u)*u,e,u).filter(function(v){return e2(v%c)>aa}).map(d)).concat(r0(z$(s/l)*l,i,l).filter(function(v){return e2(v%f)>aa}).map(h))}return y.lines=function(){return b().map(function(v){return{type:"LineString",coordinates:v}})},y.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(m(o).slice(1),p(n).reverse().slice(1),m(a).reverse().slice(1))]}},y.extent=function(v){return arguments.length?y.extentMajor(v).extentMinor(v):y.extentMinor()},y.extentMajor=function(v){return arguments.length?(r=+v[0][0],n=+v[1][0],a=+v[0][1],o=+v[1][1],r>n&&(v=r,r=n,n=v),a>o&&(v=a,a=o,o=v),y.precision(g)):[[r,a],[n,o]]},y.extentMinor=function(v){return arguments.length?(t=+v[0][0],e=+v[1][0],s=+v[0][1],i=+v[1][1],t>e&&(v=t,t=e,e=v),s>i&&(v=s,s=i,i=v),y.precision(g)):[[t,s],[e,i]]},y.step=function(v){return arguments.length?y.stepMajor(v).stepMinor(v):y.stepMinor()},y.stepMajor=function(v){return arguments.length?(c=+v[0],f=+v[1],y):[c,f]},y.stepMinor=function(v){return arguments.length?(u=+v[0],l=+v[1],y):[u,l]},y.precision=function(v){return arguments.length?(g=+v,d=UJ(s,i,90),h=WJ(t,e,g),p=UJ(a,o,90),m=WJ(r,n,g),y):g},y.extentMajor([[-180,-90+aa],[180,90-aa]]).extentMinor([[-180,-80-aa],[180,80+aa]])}function Cj(e){ue.call(this,[],e),this.generator=vbt()}Cj.Definition={type:"Graticule",metadata:{changes:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};var xbt=Ne(Cj,ue);xbt.transform=function(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(var s in e)Ot(r[s])&&r[s](e[s]);return i=r(),n.length?t.mod.push(Tpe(n[0],i)):t.add.push(nr(i)),n[0]=i,t};function wve(e){ue.call(this,null,e),this.modified(!0)}var wbt=Ne(wve,ue);wbt.transform=function(e,t){var n=this.value;return!n||e.modified("type")?(this.value=n=Cbt(e.type),yL.forEach(function(r){e[r]!=null&&VJ(n,r,e[r])})):yL.forEach(function(r){e.modified(r)&&VJ(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Sbt(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)};function Sbt(e,t){var n=kbt(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Cbt(e){var t=mj((e||"mercator").toLowerCase());return t||he("Unrecognized projection type: "+e),t()}function VJ(e,t,n){Ot(e[t])&&e[t](n)}function kbt(e){return e=xt(e),e.length===1?e[0]:{type:jP,features:e.reduce(function(t,n){return n&&n.type===jP?t.push.apply(t,n.features):be(n)?t.push.apply(t,n):t.push(n),t},[])}}const $bt=Object.freeze(Object.defineProperty({__proto__:null,contour:NV,geojson:IV,geopath:gj,geopoint:yj,geoshape:bj,graticule:Cj,projection:wve},Symbol.toStringTag,{value:"Module"}));function _bt(e,t){var n;e==null&&(e=0),t==null&&(t=0);function r(){var i,s=n.length,o,a=0,u=0;for(i=0;i<s;++i)o=n[i],a+=o.x,u+=o.y;for(a=a/s-e,u=u/s-t,i=0;i<s;++i)o=n[i],o.x-=a,o.y-=u}return r.initialize=function(i){n=i},r.x=function(i){return arguments.length?(e=+i,r):e},r.y=function(i){return arguments.length?(t=+i,r):t},r}function cs(e){return function(){return e}}function Zf(){return(Math.random()-.5)*1e-6}function Ebt(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return Sve(this.cover(t,n),t,n,e)}function Sve(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,m,g,y,b;if(!s)return e._root=o,e;for(;s.length;)if((m=t>=(f=(a+l)/2))?a=f:l=f,(g=n>=(d=(u+c)/2))?u=d:c=d,i=s,!(s=s[y=g<<1|m]))return i[y]=o,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return o.next=s,i?i[y]=o:e._root=o,e;do i=i?i[y]=new Array(4):e._root=new Array(4),(m=t>=(f=(a+l)/2))?a=f:l=f,(g=n>=(d=(u+c)/2))?u=d:c=d;while((y=g<<1|m)===(b=(p>=d)<<1|h>=f));return i[b]=s,i[y]=o,e}function Tbt(e){var t,n,r=e.length,i,s,o=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,a[n]=s,i<u&&(u=i),i>c&&(c=i),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)Sve(this,o[n],a[n],e[n]);return this}function Abt(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n,a=this._root,u,l;n>e||e>=i||r>t||t>=s;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function Nbt(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Ibt(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function as(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Dbt(e,t,n){var r,i=this._x0,s=this._y0,o,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,m;for(h&&d.push(new as(h,i,s,c,f)),n==null?n=1/0:(i=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(a=p.y0)>f||(u=p.x1)<i||(l=p.y1)<s))if(h.length){var g=(o+u)/2,y=(a+l)/2;d.push(new as(h[3],g,y,u,l),new as(h[2],o,y,g,l),new as(h[1],g,a,u,y),new as(h[0],o,a,g,y)),(m=(t>=y)<<1|e>=g)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-m],d[d.length-1-m]=p)}else{var b=e-+this._x.call(null,h.data),v=t-+this._y.call(null,h.data),x=b*b+v*v;if(x<n){var w=Math.sqrt(n=x);i=e-w,s=t-w,c=e+w,f=t+w,r=h.data}}return r}function Obt(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,m,g,y;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(m=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[g=m<<1|p]))return this;if(!n.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(r=t,y=g)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[g]=s:delete t[g],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=s,this)}function Fbt(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Rbt(){return this._root}function Mbt(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Pbt(e){var t=[],n,r=this._root,i,s,o,a,u;for(r&&t.push(new as(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&r.length){var l=(s+a)/2,c=(o+u)/2;(i=r[3])&&t.push(new as(i,l,c,a,u)),(i=r[2])&&t.push(new as(i,s,c,l,u)),(i=r[1])&&t.push(new as(i,l,o,a,c)),(i=r[0])&&t.push(new as(i,s,o,l,c))}return this}function Lbt(e){var t=[],n=[],r;for(this._root&&t.push(new as(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,a=r.y0,u=r.x1,l=r.y1,c=(o+u)/2,f=(a+l)/2;(s=i[0])&&t.push(new as(s,o,a,c,f)),(s=i[1])&&t.push(new as(s,c,a,u,f)),(s=i[2])&&t.push(new as(s,o,f,c,l)),(s=i[3])&&t.push(new as(s,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function zbt(e){return e[0]}function Bbt(e){return arguments.length?(this._x=e,this):this._x}function Ubt(e){return e[1]}function Wbt(e){return arguments.length?(this._y=e,this):this._y}function kj(e,t,n){var r=new $j(t??zbt,n??Ubt,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function $j(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function jJ(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ts=kj.prototype=$j.prototype;Ts.copy=function(){var e=new $j(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=jJ(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=jJ(r));return e};Ts.add=Ebt;Ts.addAll=Tbt;Ts.cover=Abt;Ts.data=Nbt;Ts.extent=Ibt;Ts.find=Dbt;Ts.remove=Obt;Ts.removeAll=Fbt;Ts.root=Rbt;Ts.size=Mbt;Ts.visit=Pbt;Ts.visitAfter=Lbt;Ts.x=Bbt;Ts.y=Wbt;function Vbt(e){return e.x+e.vx}function jbt(e){return e.y+e.vy}function Hbt(e){var t,n,r=1,i=1;typeof e!="function"&&(e=cs(e==null?1:+e));function s(){for(var u,l=t.length,c,f,d,h,p,m,g=0;g<i;++g)for(c=kj(t,Vbt,jbt).visitAfter(o),u=0;u<l;++u)f=t[u],p=n[f.index],m=p*p,d=f.x+f.vx,h=f.y+f.vy,c.visit(y);function y(b,v,x,w,S){var C=b.data,k=b.r,E=p+k;if(C){if(C.index>f.index){var _=d-C.x-C.vx,T=h-C.y-C.vy,D=_*_+T*T;D<E*E&&(_===0&&(_=Zf(),D+=_*_),T===0&&(T=Zf(),D+=T*T),D=(E-(D=Math.sqrt(D)))/D*r,f.vx+=(_*=D)*(E=(k*=k)/(m+k)),f.vy+=(T*=D)*E,C.vx-=_*(E=1-E),C.vy-=T*E)}return}return v>d+E||w<d-E||x>h+E||S<h-E}}function o(u){if(u.data)return u.r=n[u.data.index];for(var l=u.r=0;l<4;++l)u[l]&&u[l].r>u.r&&(u.r=u[l].r)}function a(){if(t){var u,l=t.length,c;for(n=new Array(l),u=0;u<l;++u)c=t[u],n[c.index]=+e(c,u,t)}}return s.initialize=function(u){t=u,a()},s.iterations=function(u){return arguments.length?(i=+u,s):i},s.strength=function(u){return arguments.length?(r=+u,s):r},s.radius=function(u){return arguments.length?(e=typeof u=="function"?u:cs(+u),a(),s):e},s}function Gbt(e){return e.index}function HJ(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function qbt(e){var t=Gbt,n=c,r,i=cs(30),s,o,a,u,l=1;e==null&&(e=[]);function c(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function f(m){for(var g=0,y=e.length;g<l;++g)for(var b=0,v,x,w,S,C,k,E;b<y;++b)v=e[b],x=v.source,w=v.target,S=w.x+w.vx-x.x-x.vx||Zf(),C=w.y+w.vy-x.y-x.vy||Zf(),k=Math.sqrt(S*S+C*C),k=(k-s[b])/k*m*r[b],S*=k,C*=k,w.vx-=S*(E=u[b]),w.vy-=C*E,x.vx+=S*(E=1-E),x.vy+=C*E}function d(){if(o){var m,g=o.length,y=e.length,b=Rd(o,t),v;for(m=0,a=new Array(g);m<y;++m)v=e[m],v.index=m,typeof v.source!="object"&&(v.source=HJ(b,v.source)),typeof v.target!="object"&&(v.target=HJ(b,v.target)),a[v.source.index]=(a[v.source.index]||0)+1,a[v.target.index]=(a[v.target.index]||0)+1;for(m=0,u=new Array(y);m<y;++m)v=e[m],u[m]=a[v.source.index]/(a[v.source.index]+a[v.target.index]);r=new Array(y),h(),s=new Array(y),p()}}function h(){if(o)for(var m=0,g=e.length;m<g;++m)r[m]=+n(e[m],m,e)}function p(){if(o)for(var m=0,g=e.length;m<g;++m)s[m]=+i(e[m],m,e)}return f.initialize=function(m){o=m,d()},f.links=function(m){return arguments.length?(e=m,d(),f):e},f.id=function(m){return arguments.length?(t=m,f):t},f.iterations=function(m){return arguments.length?(l=+m,f):l},f.strength=function(m){return arguments.length?(n=typeof m=="function"?m:cs(+m),h(),f):n},f.distance=function(m){return arguments.length?(i=typeof m=="function"?m:cs(+m),p(),f):i},f}var Xbt={value:function(){}};function Cve(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new q_(n)}function q_(e){this._=e}function Kbt(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}q_.prototype=Cve.prototype={constructor:q_,on:function(e,t){var n=this._,r=Kbt(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=Ybt(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=GJ(n[i],e.name,t);else if(t==null)for(i in n)n[i]=GJ(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new q_(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function Ybt(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function GJ(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Xbt,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var b1=0,nx=0,pv=0,kve=1e3,bA,rx,vA=0,fm=0,dO=0,t2=typeof performance=="object"&&performance.now?performance:Date,$ve=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function _j(){return fm||($ve(Zbt),fm=t2.now()+dO)}function Zbt(){fm=0}function xA(){this._call=this._time=this._next=null}xA.prototype=_ve.prototype={constructor:xA,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?_j():+n)+(t==null?0:+t),!this._next&&rx!==this&&(rx?rx._next=this:bA=this,rx=this),this._call=e,this._time=n,_L()},stop:function(){this._call&&(this._call=null,this._time=1/0,_L())}};function _ve(e,t,n){var r=new xA;return r.restart(e,t,n),r}function Qbt(){_j(),++b1;for(var e=bA,t;e;)(t=fm-e._time)>=0&&e._call.call(null,t),e=e._next;--b1}function qJ(){fm=(vA=t2.now())+dO,b1=nx=0;try{Qbt()}finally{b1=0,evt(),fm=0}}function Jbt(){var e=t2.now(),t=e-vA;t>kve&&(dO-=t,vA=e)}function evt(){for(var e,t=bA,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:bA=n);rx=e,_L(r)}function _L(e){if(!b1){nx&&(nx=clearTimeout(nx));var t=e-fm;t>24?(e<1/0&&(nx=setTimeout(qJ,e-t2.now()-dO)),pv&&(pv=clearInterval(pv))):(pv||(vA=t2.now(),pv=setInterval(Jbt,kve)),b1=1,$ve(qJ))}}function tvt(e,t,n){var r=new xA,i=t;return t==null?(r.restart(e,t,n),r):(t=+t,n=n==null?_j():+n,r.restart(function s(o){o+=i,r.restart(s,i+=t,n),e(o)},t,n),r)}function nvt(e){return e.x}function rvt(e){return e.y}var ivt=10,svt=Math.PI*(3-Math.sqrt(5));function ovt(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,a=Rd(),u=_ve(c),l=Cve("tick","end");e==null&&(e=[]);function c(){f(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function f(p){var m,g=e.length,y;p===void 0&&(p=1);for(var b=0;b<p;++b)for(n+=(s-n)*i,a.each(function(v){v(n)}),m=0;m<g;++m)y=e[m],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function d(){for(var p=0,m=e.length,g;p<m;++p){if(g=e[p],g.index=p,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var y=ivt*Math.sqrt(p),b=p*svt;g.x=y*Math.cos(b),g.y=y*Math.sin(b)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function h(p){return p.initialize&&p.initialize(e),p}return d(),t={tick:f,restart:function(){return u.restart(c),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,d(),a.each(h),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(r=+p,t):r},alphaDecay:function(p){return arguments.length?(i=+p,t):+i},alphaTarget:function(p){return arguments.length?(s=+p,t):s},velocityDecay:function(p){return arguments.length?(o=1-p,t):1-o},force:function(p,m){return arguments.length>1?(m==null?a.remove(p):a.set(p,h(m)),t):a.get(p)},find:function(p,m,g){var y=0,b=e.length,v,x,w,S,C;for(g==null?g=1/0:g*=g,y=0;y<b;++y)S=e[y],v=p-S.x,x=m-S.y,w=v*v+x*x,w<g&&(C=S,g=w);return C},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function avt(){var e,t,n,r=cs(-30),i,s=1,o=1/0,a=.81;function u(d){var h,p=e.length,m=kj(e,nvt,rvt).visitAfter(c);for(n=d,h=0;h<p;++h)t=e[h],m.visit(f)}function l(){if(e){var d,h=e.length,p;for(i=new Array(h),d=0;d<h;++d)p=e[d],i[p.index]=+r(p,d,e)}}function c(d){var h=0,p,m,g=0,y,b,v;if(d.length){for(y=b=v=0;v<4;++v)(p=d[v])&&(m=Math.abs(p.value))&&(h+=p.value,g+=m,y+=m*p.x,b+=m*p.y);d.x=y/g,d.y=b/g}else{p=d,p.x=p.data.x,p.y=p.data.y;do h+=i[p.data.index];while(p=p.next)}d.value=h}function f(d,h,p,m){if(!d.value)return!0;var g=d.x-t.x,y=d.y-t.y,b=m-h,v=g*g+y*y;if(b*b/a<v)return v<o&&(g===0&&(g=Zf(),v+=g*g),y===0&&(y=Zf(),v+=y*y),v<s&&(v=Math.sqrt(s*v)),t.vx+=g*d.value*n/v,t.vy+=y*d.value*n/v),!0;if(d.length||v>=o)return;(d.data!==t||d.next)&&(g===0&&(g=Zf(),v+=g*g),y===0&&(y=Zf(),v+=y*y),v<s&&(v=Math.sqrt(s*v)));do d.data!==t&&(b=i[d.data.index]*n/v,t.vx+=g*b,t.vy+=y*b);while(d=d.next)}return u.initialize=function(d){e=d,l()},u.strength=function(d){return arguments.length?(r=typeof d=="function"?d:cs(+d),l(),u):r},u.distanceMin=function(d){return arguments.length?(s=d*d,u):Math.sqrt(s)},u.distanceMax=function(d){return arguments.length?(o=d*d,u):Math.sqrt(o)},u.theta=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u}function uvt(e){var t=cs(.1),n,r,i;typeof e!="function"&&(e=cs(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*a}function o(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:cs(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:cs(+a),o(),s):e},s}function lvt(e){var t=cs(.1),n,r,i;typeof e!="function"&&(e=cs(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*a}function o(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:cs(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:cs(+a),o(),s):e},s}var XJ={center:_bt,collide:Hbt,nbody:avt,link:qbt,x:uvt,y:lvt},ix="forces",EL=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],cvt=["static","iterations"],Eve=["x","y","vx","vy"];function Ej(e){ue.call(this,null,e)}Ej.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Eve}]};var Tve=Ne(Ej,ue);Tve.transform=function(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(EL),s=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&Ave(n,e,0,t)):(this.value=n=dvt(t.source,e),n.on("tick",fvt(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(cvt)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)};Tve.finish=function(e,t){for(var n=t.dataflow,r=this._argops,i=0,s=r.length,o;i<s;++i)if(o=r[i],!(o.name!==ix||o.op._argval.force!=="link")){for(var a=o.op._argops,u=0,l=a.length,c;u<l;++u)if(a[u].name==="links"&&(c=a[u].op.source)){n.pulse(c,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(Eve)};function fvt(e,t){return function(){e.touch(t).run()}}function dvt(e,t){var n=ovt(e),r=!1,i=n.stop,s=n.restart;return n.stopped=function(){return r},n.restart=function(){return r=!1,s()},n.stop=function(){return r=!0,i()},Ave(n,t,!0).on("end",function(){r=!0})}function Ave(e,t,n,r){var i=xt(t.forces),s,o,a,u;for(s=0,o=EL.length;s<o;++s)a=EL[s],a!==ix&&t.modified(a)&&e[a](t[a]);for(s=0,o=i.length;s<o;++s)u=ix+s,a=n||t.modified(ix,s)?pvt(i[s]):r&&hvt(i[s],r)?e.force(u):null,a&&e.force(u,a);for(o=e.numForces||0;s<o;++s)e.force(ix+s,null);return e.numForces=i.length,e}function hvt(e,t){var n,r;for(n in e)if(Ot(r=e[n])&&t.modified(Zs(r)))return 1;return 0}function pvt(e){var t,n;XJ.hasOwnProperty(e.force)||he("Unrecognized force: "+e.force),t=XJ[e.force]();for(n in e)Ot(t[n])&&mvt(t[n],e[n],e);return t}function mvt(e,t,n){e(Ot(t)?function(r){return t(r,n)}:t)}const gvt=Object.freeze(Object.defineProperty({__proto__:null,force:Ej},Symbol.toStringTag,{value:"Module"}));function TL(e,t,n){var r={};return e.each(function(i){var s=i.data;n(s)&&(r[t(s)]=i)}),e.lookup=r,e}function yvt(e,t){return e.parent===t.parent?1:2}function bvt(e){return e.reduce(vvt,0)/e.length}function vvt(e,t){return e+t.x}function xvt(e){return 1+e.reduce(wvt,0)}function wvt(e,t){return Math.max(e,t.y)}function Svt(e){for(var t;t=e.children;)e=t[0];return e}function Cvt(e){for(var t;t=e.children;)e=t[t.length-1];return e}function kvt(){var e=yvt,t=1,n=1,r=!1;function i(s){var o,a=0;s.eachAfter(function(d){var h=d.children;h?(d.x=bvt(h),d.y=xvt(h)):(d.x=o?a+=e(d,o):0,d.y=0,o=d)});var u=Svt(s),l=Cvt(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(r?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}function $vt(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function _vt(){return this.eachAfter($vt)}function Evt(e){var t=this,n,r=[t],i,s,o;do for(n=r.reverse(),r=[];t=n.pop();)if(e(t),i=t.children,i)for(s=0,o=i.length;s<o;++s)r.push(i[s]);while(r.length);return this}function Tvt(e){for(var t=this,n=[t],r,i;t=n.pop();)if(e(t),r=t.children,r)for(i=r.length-1;i>=0;--i)n.push(r[i]);return this}function Avt(e){for(var t=this,n=[t],r=[],i,s,o;t=n.pop();)if(r.push(t),i=t.children,i)for(s=0,o=i.length;s<o;++s)n.push(i[s]);for(;t=r.pop();)e(t);return this}function Nvt(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Ivt(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Dvt(e){for(var t=this,n=Ovt(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Ovt(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Fvt(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Rvt(){var e=[];return this.each(function(t){e.push(t)}),e}function Mvt(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Pvt(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function Tj(e,t){var n=new v1(e),r=+e.value&&(n.value=e.value),i,s=[n],o,a,u,l;for(t==null&&(t=zvt);i=s.pop();)if(r&&(i.value=+i.data.value),(a=t(i.data))&&(l=a.length))for(i.children=new Array(l),u=l-1;u>=0;--u)s.push(o=i.children[u]=new v1(a[u])),o.parent=i,o.depth=i.depth+1;return n.eachBefore(Nve)}function Lvt(){return Tj(this).eachBefore(Bvt)}function zvt(e){return e.children}function Bvt(e){e.data=e.data.data}function Nve(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function v1(e){this.data=e,this.depth=this.height=0,this.parent=null}v1.prototype=Tj.prototype={constructor:v1,count:_vt,each:Evt,eachAfter:Avt,eachBefore:Tvt,sum:Nvt,sort:Ivt,path:Dvt,ancestors:Fvt,descendants:Rvt,leaves:Mvt,links:Pvt,copy:Lvt};var Uvt=Array.prototype.slice;function Wvt(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function Vvt(e){for(var t=0,n=(e=Wvt(Uvt.call(e))).length,r=[],i,s;t<n;)i=e[t],s&&Ive(s,i)?++t:(s=Hvt(r=jvt(r,i)),t=0);return s}function jvt(e,t){var n,r;if(yM(t,e))return[t];for(n=0;n<e.length;++n)if(B$(t,e[n])&&yM(sx(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(B$(sx(e[n],e[r]),t)&&B$(sx(e[n],t),e[r])&&B$(sx(e[r],t),e[n])&&yM(Dve(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function B$(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function Ive(e,t){var n=e.r-t.r+1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function yM(e,t){for(var n=0;n<t.length;++n)if(!Ive(e,t[n]))return!1;return!0}function Hvt(e){switch(e.length){case 1:return Gvt(e[0]);case 2:return sx(e[0],e[1]);case 3:return Dve(e[0],e[1],e[2])}}function Gvt(e){return{x:e.x,y:e.y,r:e.r}}function sx(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,o=t.y,a=t.r,u=s-n,l=o-r,c=a-i,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+a)/2}}function Dve(e,t,n){var r=e.x,i=e.y,s=e.r,o=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-o,h=r-l,p=i-a,m=i-c,g=u-s,y=f-s,b=r*r+i*i-s*s,v=b-o*o-a*a+u*u,x=b-l*l-c*c+f*f,w=h*p-d*m,S=(p*x-m*v)/(w*2)-r,C=(m*g-p*y)/w,k=(h*v-d*x)/(w*2)-i,E=(d*y-h*g)/w,_=C*C+E*E-1,T=2*(s+S*C+k*E),D=S*S+k*k-s*s,O=-(_?(T+Math.sqrt(T*T-4*_*D))/(2*_):D/T);return{x:r+S+C*O,y:i+k+E*O,r:O}}function KJ(e,t,n){var r=e.x-t.x,i,s,o=e.y-t.y,a,u,l=r*r+o*o;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(i=(l+u-s)/(2*l),a=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-a*o,n.y=e.y-i*o+a*r):(i=(l+s-u)/(2*l),a=Math.sqrt(Math.max(0,s/l-i*i)),n.x=t.x+i*r-a*o,n.y=t.y+i*o+a*r)):(n.x=t.x+n.r,n.y=t.y)}function YJ(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function ZJ(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function U$(e){this._=e,this.next=null,this.previous=null}function qvt(e){if(!(i=e.length))return 0;var t,n,r,i,s,o,a,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;KJ(n,t,r=e[2]),t=new U$(t),n=new U$(n),r=new U$(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(a=3;a<i;++a){KJ(t._,n._,r=e[a]),r=new U$(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(YJ(u._,r._)){n=u,t.next=n,n.previous=t,--a;continue e}c+=u._.r,u=u.next}else{if(YJ(l._,r._)){t=l,t.next=n,n.previous=t,--a;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,s=ZJ(t);(r=r.next)!==n;)(o=ZJ(r))<s&&(t=r,s=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=Vvt(t),a=0;a<i;++a)t=e[a],t.x-=r.x,t.y-=r.y;return r.r}function Xvt(e){return e==null?null:wA(e)}function wA(e){if(typeof e!="function")throw new Error;return e}function sp(){return 0}function Bg(e){return function(){return e}}function Kvt(e){return Math.sqrt(e.value)}function Yvt(){var e=null,t=1,n=1,r=sp;function i(s){return s.x=t/2,s.y=n/2,e?s.eachBefore(QJ(e)).eachAfter(bM(r,.5)).eachBefore(JJ(1)):s.eachBefore(QJ(Kvt)).eachAfter(bM(sp,1)).eachAfter(bM(r,s.r/Math.min(t,n))).eachBefore(JJ(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=Xvt(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:Bg(+s),i):r},i}function QJ(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function bM(e,t){return function(n){if(r=n.children){var r,i,s=r.length,o=e(n)*t||0,a;if(o)for(i=0;i<s;++i)r[i].r+=o;if(a=qvt(r),o)for(i=0;i<s;++i)r[i].r-=o;n.r=a+o}}}function JJ(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function Ove(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function GC(e,t,n,r,i){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(r-t)/e.value;++a<u;)o=s[a],o.y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}function Zvt(){var e=1,t=1,n=0,r=!1;function i(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),r&&o.eachBefore(Ove),o}function s(o,a){return function(u){u.children&&GC(u,u.x0,o*(u.depth+1)/a,u.x1,o*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var eee="$",Qvt={depth:-1},tee={};function Jvt(e){return e.id}function ext(e){return e.parentId}function nee(){var e=Jvt,t=ext;function n(r){var i,s,o=r.length,a,u,l,c=new Array(o),f,d,h={};for(s=0;s<o;++s)i=r[s],l=c[s]=new v1(i),(f=e(i,s,r))!=null&&(f+="")&&(d=eee+(l.id=f),h[d]=d in h?tee:l);for(s=0;s<o;++s)if(l=c[s],f=t(r[s],s,r),f==null||!(f+="")){if(a)throw new Error("multiple roots");a=l}else{if(u=h[eee+f],!u)throw new Error("missing: "+f);if(u===tee)throw new Error("ambiguous: "+f);u.children?u.children.push(l):u.children=[l],l.parent=u}if(!a)throw new Error("no root");if(a.parent=Qvt,a.eachBefore(function(p){p.depth=p.parent.depth+1,--o}).eachBefore(Nve),a.parent=null,o>0)throw new Error("cycle");return a}return n.id=function(r){return arguments.length?(e=wA(r),n):e},n.parentId=function(r){return arguments.length?(t=wA(r),n):t},n}function txt(e,t){return e.parent===t.parent?1:2}function vM(e){var t=e.children;return t?t[0]:e.t}function xM(e){var t=e.children;return t?t[t.length-1]:e.t}function nxt(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function rxt(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function ixt(e,t,n){return e.a.parent===t.parent?e.a:n}function X_(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}X_.prototype=Object.create(v1.prototype);function sxt(e){for(var t=new X_(e,0),n,r=[t],i,s,o,a;n=r.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)r.push(i=n.children[o]=new X_(s[o],o)),i.parent=n;return(t.parent=new X_(null,0)).children=[t],t}function oxt(){var e=txt,t=1,n=1,r=null;function i(l){var c=sxt(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(b){b.x<f.x&&(f=b),b.x>d.x&&(d=b),b.depth>h.depth&&(h=b)});var p=f===d?1:e(f,d)/2,m=p-f.x,g=t/(d.x+p+m),y=n/(h.depth||1);l.eachBefore(function(b){b.x=(b.x+m)*g,b.y=b.depth*y})}return l}function s(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){rxt(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,m=d.parent.children[0],g=d.m,y=h.m,b=p.m,v=m.m,x;p=xM(p),d=vM(d),p&&d;)m=vM(m),h=xM(h),h.a=l,x=p.z+b-d.z-g+e(p._,d._),x>0&&(nxt(ixt(p,l,f),l,x),g+=x,y+=x),b+=p.m,g+=d.m,v+=m.m,y+=h.m;p&&!xM(h)&&(h.t=p,h.m+=b-y),d&&!vM(m)&&(m.t=d,m.m+=g-v,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function hO(e,t,n,r,i){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(i-n)/e.value;++a<u;)o=s[a],o.x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var Fve=(1+Math.sqrt(5))/2;function Rve(e,t,n,r,i,s){for(var o=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,m=t.value,g,y,b,v,x,w,S;c<d;){h=i-n,p=s-r;do g=a[f++].value;while(!g&&f<d);for(y=b=g,w=Math.max(p/h,h/p)/(m*e),S=g*g*w,x=Math.max(b/S,S/y);f<d;++f){if(g+=l=a[f].value,l<y&&(y=l),l>b&&(b=l),S=g*g*w,v=Math.max(b/S,S/y),v>x){g-=l;break}x=v}o.push(u={value:g,dice:h<p,children:a.slice(c,f)}),u.dice?GC(u,n,r,i,m?r+=p*g/m:s):hO(u,n,r,m?n+=h*g/m:i,s),m-=g,c=f}return o}const Mve=function e(t){function n(r,i,s,o,a){Rve(t,r,i,s,o,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Fve);function axt(){var e=Mve,t=!1,n=1,r=1,i=[0],s=sp,o=sp,a=sp,u=sp,l=sp;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(Ove),d}function f(d){var h=i[d.depth],p=d.x0+h,m=d.y0+h,g=d.x1-h,y=d.y1-h;g<p&&(p=g=(p+g)/2),y<m&&(m=y=(m+y)/2),d.x0=p,d.y0=m,d.x1=g,d.y1=y,d.children&&(h=i[d.depth+1]=s(d)/2,p+=l(d)-h,m+=o(d)-h,g-=a(d)-h,y-=u(d)-h,g<p&&(p=g=(p+g)/2),y<m&&(m=y=(m+y)/2),e(d,p,m,g,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=wA(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:Bg(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:Bg(+d),c):o},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:Bg(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Bg(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Bg(+d),c):l},c}function uxt(e,t,n,r,i){var s=e.children,o,a=s.length,u,l=new Array(a+1);for(l[0]=u=o=0;o<a;++o)l[o+1]=u+=s[o].value;c(0,a,e.value,t,n,r,i);function c(f,d,h,p,m,g,y){if(f>=d-1){var b=s[f];b.x0=p,b.y0=m,b.x1=g,b.y1=y;return}for(var v=l[f],x=h/2+v,w=f+1,S=d-1;w<S;){var C=w+S>>>1;l[C]<x?w=C+1:S=C}x-l[w-1]<l[w]-x&&f+1<w&&--w;var k=l[w]-v,E=h-k;if(g-p>y-m){var _=(p*E+g*k)/h;c(f,w,k,p,m,_,y),c(w,d,E,_,m,g,y)}else{var T=(m*E+y*k)/h;c(f,w,k,p,m,g,T),c(w,d,E,p,T,g,y)}}}function lxt(e,t,n,r,i){(e.depth&1?hO:GC)(e,t,n,r,i)}const cxt=function e(t){function n(r,i,s,o,a){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,m=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?GC(l,i,s,o,s+=(a-s)*l.value/m):hO(l,i,s,i+=(o-i)*l.value/m,a),m-=l.value}else r._squarify=u=Rve(t,r,i,s,o,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Fve);function Aj(e){ue.call(this,null,e)}Aj.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};var fxt=Ne(Aj,ue);function dxt(e){return e.values}fxt.transform=function(e,t){t.source||he("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),s=this.value;return(!s||r||t.changed())&&(s&&s.each(function(o){o.children&&uD(o.data)&&i.rem.push(o.data)}),this.value=s=Tj({values:xt(e.keys).reduce(function(o,a){return o.key(a),o},gdt()).entries(i.source)},dxt),n&&s.each(function(o){o.children&&(o=nr(o.data),i.add.push(o),i.source.push(o))}),TL(s,Je,Je)),i.source.root=s,i};function bf(e){ue.call(this,null,e)}var hxt=Ne(bf,ue);hxt.transform=function(e,t){(!t.source||!t.source.root)&&he(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(e.method),r=this.fields,i=t.source.root,s=e.as||r;e.field&&i.sum(e.field),e.sort&&i.sort(e.sort),pxt(n,this.params,e),n.separation&&n.separation(e.separation!==!1?gxt:iD);try{this.value=n(i)}catch(o){he(o)}return i.each(function(o){mxt(o,r,s)}),t.reflow(e.modified()).modifies(s).modifies("leaf")};function pxt(e,t,n){for(var r,i=0,s=t.length;i<s;++i)r=t[i],r in n&&e[r](n[r])}function mxt(e,t,n){for(var r=e.data,i=0,s=t.length-1;i<s;++i)r[n[i]]=e[t[i]];r[n[s]]=e.children?e.children.length:0}function gxt(e,t){return e.parent===t.parent?1:2}var AL=["x","y","r","depth","children"];function Nj(e){bf.call(this,e)}Nj.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:AL.length,default:AL}]};var Ij=Ne(Nj,bf);Ij.layout=Yvt;Ij.params=["size","padding"];Ij.fields=AL;var NL=["x0","y0","x1","y1","depth","children"];function Dj(e){bf.call(this,e)}Dj.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:NL.length,default:NL}]};var Oj=Ne(Dj,bf);Oj.layout=Zvt;Oj.params=["size","round","padding"];Oj.fields=NL;function Fj(e){ue.call(this,null,e)}Fj.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};var yxt=Ne(Fj,ue);yxt.transform=function(e,t){t.source||he("Stratify transform requires an upstream data source.");var n=this.value,r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),s=!this.value||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),s&&(i.source.length?n=TL(nee().id(e.key).parentId(e.parentKey)(i.source),e.key,ih):n=TL(nee()([{}]),e.key,e.key)),i.source.root=this.value=n,i};var ree={tidy:oxt,cluster:kvt},IL=["x","y","depth","children"];function Rj(e){bf.call(this,e)}Rj.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:IL.length,default:IL}]};var Mj=Ne(Rj,bf);Mj.layout=function(e){var t=e||"tidy";if(ree.hasOwnProperty(t))return ree[t]();he("Unrecognized Tree layout method: "+t)};Mj.params=["size","nodeSize"];Mj.fields=IL;function Pj(e){ue.call(this,[],e)}Pj.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};var bxt=Ne(Pj,ue);bxt.transform=function(e,t){var n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),s={};return r||he("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,function(o){s[Je(o)]=1}),r.each(function(o){var a=o.data,u=o.parent&&o.parent.data;u&&s[Je(a)]&&s[Je(u)]&&i.add.push(nr({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,function(o){s[Je(o)]=1}),n.forEach(function(o){(s[Je(o.source)]||s[Je(o.target)])&&i.mod.push(o)})),i};var iee={binary:uxt,dice:GC,slice:hO,slicedice:lxt,squarify:Mve,resquarify:cxt},DL=["x0","y0","x1","y1","depth","children"];function Lj(e){bf.call(this,e)}Lj.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:DL.length,default:DL}]};var zj=Ne(Lj,bf);zj.layout=function(){var e=axt();return e.ratio=function(t){var n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=function(t){iee.hasOwnProperty(t)?e.tile(iee[t]):he("Unrecognized Treemap layout method: "+t)},e};zj.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"];zj.fields=DL;const vxt=Object.freeze(Object.defineProperty({__proto__:null,nest:Aj,pack:Nj,partition:Dj,stratify:Fj,tree:Rj,treelinks:Pj,treemap:Lj},Symbol.toStringTag,{value:"Module"}));function see(e){return function(){return e}}function xxt(e){return e[0]}function wxt(e){return e[1]}function SA(){this._=null}function pO(e){e.U=e.C=e.L=e.R=e.P=e.N=null}SA.prototype={constructor:SA,insert:function(e,t){var n,r,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=oee(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.R&&(mv(this,n),e=n,n=e.U),n.C=!1,r.C=!0,gv(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.L&&(gv(this,n),e=n,n=e.U),n.C=!1,r.C=!0,mv(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,r=e.L,i=e.R,s,o;if(r?i?s=oee(i):s=r:s=i,t?t.L===e?t.L=s:t.R=s:this._=s,r&&i?(o=s.C,s.C=e.C,s.L=r,r.U=s,s!==i?(t=s.U,s.U=e.U,e=s.R,t.L=e,s.R=i,i.U=s):(s.U=t,t=s,e=s.R)):(o=e.C,e=s),e&&(e.U=t),!o){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,mv(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,gv(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,mv(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,gv(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,mv(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,gv(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function mv(e,t){var n=t,r=t.R,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function gv(e,t){var n=t,r=t.L,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function oee(e){for(;e.L;)e=e.L;return e}function ox(e,t,n,r){var i=[null,null],s=Ni.push(i)-1;return i.left=e,i.right=t,n&&CA(i,e,t,n),r&&CA(i,t,e,r),ko[e.index].halfedges.push(s),ko[t.index].halfedges.push(s),i}function yv(e,t,n){var r=[t,n];return r.left=e,r}function CA(e,t,n,r){!e[0]&&!e[1]?(e[0]=r,e.left=t,e.right=n):e.left===n?e[1]=r:e[0]=r}function Sxt(e,t,n,r,i){var s=e[0],o=e[1],a=s[0],u=s[1],l=o[0],c=o[1],f=0,d=1,h=l-a,p=c-u,m;if(m=t-a,!(!h&&m>0)){if(m/=h,h<0){if(m<f)return;m<d&&(d=m)}else if(h>0){if(m>d)return;m>f&&(f=m)}if(m=r-a,!(!h&&m<0)){if(m/=h,h<0){if(m>d)return;m>f&&(f=m)}else if(h>0){if(m<f)return;m<d&&(d=m)}if(m=n-u,!(!p&&m>0)){if(m/=p,p<0){if(m<f)return;m<d&&(d=m)}else if(p>0){if(m>d)return;m>f&&(f=m)}if(m=i-u,!(!p&&m<0)){if(m/=p,p<0){if(m>d)return;m>f&&(f=m)}else if(p>0){if(m<f)return;m<d&&(d=m)}return!(f>0)&&!(d<1)||(f>0&&(e[0]=[a+f*h,u+f*p]),d<1&&(e[1]=[a+d*h,u+d*p])),!0}}}}}function Cxt(e,t,n,r,i){var s=e[1];if(s)return!0;var o=e[0],a=e.left,u=e.right,l=a[0],c=a[1],f=u[0],d=u[1],h=(l+f)/2,p=(c+d)/2,m,g;if(d===c){if(h<t||h>=r)return;if(l>f){if(!o)o=[h,n];else if(o[1]>=i)return;s=[h,i]}else{if(!o)o=[h,i];else if(o[1]<n)return;s=[h,n]}}else if(m=(l-f)/(d-c),g=p-m*h,m<-1||m>1)if(l>f){if(!o)o=[(n-g)/m,n];else if(o[1]>=i)return;s=[(i-g)/m,i]}else{if(!o)o=[(i-g)/m,i];else if(o[1]<n)return;s=[(n-g)/m,n]}else if(c<d){if(!o)o=[t,m*t+g];else if(o[0]>=r)return;s=[r,m*r+g]}else{if(!o)o=[r,m*r+g];else if(o[0]<t)return;s=[t,m*t+g]}return e[0]=o,e[1]=s,!0}function kxt(e,t,n,r){for(var i=Ni.length,s;i--;)(!Cxt(s=Ni[i],e,t,n,r)||!Sxt(s,e,t,n,r)||!(Math.abs(s[0][0]-s[1][0])>un||Math.abs(s[0][1]-s[1][1])>un))&&delete Ni[i]}function $xt(e){return ko[e.index]={site:e,halfedges:[]}}function _xt(e,t){var n=e.site,r=t.left,i=t.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=t[1],i=t[0]):(r=t[0],i=t[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Pve(e,t){return t[+(t.left!==e.site)]}function Ext(e,t){return t[+(t.left===e.site)]}function Txt(){for(var e=0,t=ko.length,n,r,i,s;e<t;++e)if((n=ko[e])&&(s=(r=n.halfedges).length)){var o=new Array(s),a=new Array(s);for(i=0;i<s;++i)o[i]=i,a[i]=_xt(n,Ni[r[i]]);for(o.sort(function(u,l){return a[l]-a[u]}),i=0;i<s;++i)a[i]=r[o[i]];for(i=0;i<s;++i)r[i]=a[i]}}function Axt(e,t,n,r){var i=ko.length,s,o,a,u,l,c,f,d,h,p,m,g,y=!0;for(s=0;s<i;++s)if(o=ko[s]){for(a=o.site,l=o.halfedges,u=l.length;u--;)Ni[l[u]]||l.splice(u,1);for(u=0,c=l.length;u<c;)p=Ext(o,Ni[l[u]]),m=p[0],g=p[1],f=Pve(o,Ni[l[++u%c]]),d=f[0],h=f[1],(Math.abs(m-d)>un||Math.abs(g-h)>un)&&(l.splice(u,0,Ni.push(yv(a,p,Math.abs(m-e)<un&&r-g>un?[e,Math.abs(d-e)<un?h:r]:Math.abs(g-r)<un&&n-m>un?[Math.abs(h-r)<un?d:n,r]:Math.abs(m-n)<un&&g-t>un?[n,Math.abs(d-n)<un?h:t]:Math.abs(g-t)<un&&m-e>un?[Math.abs(h-t)<un?d:e,t]:null))-1),++c);c&&(y=!1)}if(y){var b,v,x,w=1/0;for(s=0,y=null;s<i;++s)(o=ko[s])&&(a=o.site,b=a[0]-e,v=a[1]-t,x=b*b+v*v,x<w&&(w=x,y=o));if(y){var S=[e,t],C=[e,r],k=[n,r],E=[n,t];y.halfedges.push(Ni.push(yv(a=y.site,S,C))-1,Ni.push(yv(a,C,k))-1,Ni.push(yv(a,k,E))-1,Ni.push(yv(a,E,S))-1)}}for(s=0;s<i;++s)(o=ko[s])&&(o.halfedges.length||delete ko[s])}var Lve=[],Bj;function Nxt(){pO(this),this.x=this.y=this.arc=this.site=this.cy=null}function i0(e){var t=e.P,n=e.N;if(!(!t||!n)){var r=t.site,i=e.site,s=n.site;if(r!==s){var o=i[0],a=i[1],u=r[0]-o,l=r[1]-a,c=s[0]-o,f=s[1]-a,d=2*(u*f-l*c);if(!(d>=-Rxt)){var h=u*u+l*l,p=c*c+f*f,m=(f*h-l*p)/d,g=(u*p-c*h)/d,y=Lve.pop()||new Nxt;y.arc=e,y.site=i,y.x=m+o,y.y=(y.cy=g+a)+Math.sqrt(m*m+g*g),e.circle=y;for(var b=null,v=n2._;v;)if(y.y<v.y||y.y===v.y&&y.x<=v.x)if(v.L)v=v.L;else{b=v.P;break}else if(v.R)v=v.R;else{b=v;break}n2.insert(b,y),b||(Bj=y)}}}}function k0(e){var t=e.circle;t&&(t.P||(Bj=t.N),n2.remove(t),Lve.push(t),pO(t),e.circle=null)}var zve=[];function Ixt(){pO(this),this.edge=this.site=this.circle=null}function aee(e){var t=zve.pop()||new Ixt;return t.site=e,t}function wM(e){k0(e),$0.remove(e),zve.push(e),pO(e)}function Dxt(e){var t=e.circle,n=t.x,r=t.cy,i=[n,r],s=e.P,o=e.N,a=[e];wM(e);for(var u=s;u.circle&&Math.abs(n-u.circle.x)<un&&Math.abs(r-u.circle.cy)<un;)s=u.P,a.unshift(u),wM(u),u=s;a.unshift(u),k0(u);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<un&&Math.abs(r-l.circle.cy)<un;)o=l.N,a.push(l),wM(l),l=o;a.push(l),k0(l);var c=a.length,f;for(f=1;f<c;++f)l=a[f],u=a[f-1],CA(l.edge,u.site,l.site,i);u=a[0],l=a[c-1],l.edge=ox(u.site,l.site,null,i),i0(u),i0(l)}function Oxt(e){for(var t=e[0],n=e[1],r,i,s,o,a=$0._;a;)if(s=Bve(a,n)-t,s>un)a=a.L;else if(o=t-Fxt(a,n),o>un){if(!a.R){r=a;break}a=a.R}else{s>-un?(r=a.P,i=a):o>-un?(r=a,i=a.N):r=i=a;break}$xt(e);var u=aee(e);if($0.insert(r,u),!(!r&&!i)){if(r===i){k0(r),i=aee(r.site),$0.insert(u,i),u.edge=i.edge=ox(r.site,u.site),i0(r),i0(i);return}if(!i){u.edge=ox(r.site,u.site);return}k0(r),k0(i);var l=r.site,c=l[0],f=l[1],d=e[0]-c,h=e[1]-f,p=i.site,m=p[0]-c,g=p[1]-f,y=2*(d*g-h*m),b=d*d+h*h,v=m*m+g*g,x=[(g*b-h*v)/y+c,(d*v-m*b)/y+f];CA(i.edge,l,p,x),u.edge=ox(l,e,null,x),i.edge=ox(e,p,null,x),i0(r),i0(i)}}function Bve(e,t){var n=e.site,r=n[0],i=n[1],s=i-t;if(!s)return r;var o=e.P;if(!o)return-1/0;n=o.site;var a=n[0],u=n[1],l=u-t;if(!l)return a;var c=a-r,f=1/s-1/l,d=c/l;return f?(-d+Math.sqrt(d*d-2*f*(c*c/(-2*l)-u+l/2+i-s/2)))/f+r:(r+a)/2}function Fxt(e,t){var n=e.N;if(n)return Bve(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var un=1e-6,Rxt=1e-12,$0,ko,n2,Ni;function Mxt(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function Pxt(e,t){return t[1]-e[1]||t[0]-e[0]}function OL(e,t){var n=e.sort(Pxt).pop(),r,i,s;for(Ni=[],ko=new Array(e.length),$0=new SA,n2=new SA;;)if(s=Bj,n&&(!s||n[1]<s.y||n[1]===s.y&&n[0]<s.x))(n[0]!==r||n[1]!==i)&&(Oxt(n),r=n[0],i=n[1]),n=e.pop();else if(s)Dxt(s.arc);else break;if(Txt(),t){var o=+t[0][0],a=+t[0][1],u=+t[1][0],l=+t[1][1];kxt(o,a,u,l),Axt(o,a,u,l)}this.edges=Ni,this.cells=ko,$0=n2=Ni=ko=null}OL.prototype={constructor:OL,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(r){return Pve(t,e[r])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(a=(s=n.halfedges).length)for(var i=n.site,s,o=-1,a,u,l=t[s[a-1]],c=l.left===i?l.right:l.left;++o<a;)u=c,l=t[s[o]],c=l.left===i?l.right:l.left,u&&c&&r<u.index&&r<c.index&&Mxt(i,u,c)<0&&e.push([i.data,u.data,c.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r=this,i,s=r._found||0,o=r.cells.length,a;!(a=r.cells[s]);)if(++s>=o)return null;var u=e-a.site[0],l=t-a.site[1],c=u*u+l*l;do a=r.cells[i=s],s=null,a.halfedges.forEach(function(f){var d=r.edges[f],h=d.left;if(!((h===a.site||!h)&&!(h=d.right))){var p=e-h[0],m=t-h[1],g=p*p+m*m;g<c&&(c=g,s=h.index)}});while(s!==null);return r._found=i,n==null||c<=n*n?a.site:null}};function Lxt(){var e=xxt,t=wxt,n=null;function r(i){return new OL(i.map(function(s,o){var a=[Math.round(e(s,o,i)/un)*un,Math.round(t(s,o,i)/un)*un];return a.index=o,a.data=s,a}),n)}return r.polygons=function(i){return r(i).polygons()},r.links=function(i){return r(i).links()},r.triangles=function(i){return r(i).triangles()},r.x=function(i){return arguments.length?(e=typeof i=="function"?i:see(+i),r):e},r.y=function(i){return arguments.length?(t=typeof i=="function"?i:see(+i),r):t},r.extent=function(i){return arguments.length?(n=i==null?null:[[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(i){return arguments.length?(n=i==null?null:[[0,0],[+i[0],+i[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r}function Uj(e){ue.call(this,null,e)}Uj.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var zxt=Ne(Uj,ue),Bxt=[[-1e5,-1e5],[1e5,1e5]];zxt.transform=function(e,t){var n=e.as||"path",r=t.source,i,s,o,a;for(i=Lxt().x(e.x).y(e.y),e.size?i.size(e.size):i.extent(e.extent||Bxt),this.value=i=i(r),s=i.polygons(),o=0,a=r.length;o<a;++o)r[o][n]=s[o]?"M"+s[o].join("L")+"Z":null;return t.reflow(e.modified()).modifies(n)};const Uxt=Object.freeze(Object.defineProperty({__proto__:null,voronoi:Uj},Symbol.toStringTag,{value:"Module"}));var SM=Math.PI/180,ax=64,K_=2048;function Wxt(){var e=[256,256],t,n,r,i,s,o,a,u=Uve,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(DW()),m=Xxt((e[0]>>5)*e[1]),g=null,y=l.length,b=-1,v=[],x=l.map(function(S){return{text:t(S),font:n(S),style:i(S),weight:s(S),rotate:o(S),size:~~r(S),padding:a(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S}}).sort(function(S,C){return C.size-S.size});++b<y;){var w=x[b];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Vxt(p,w,x,b),w.hasText&&h(m,w,g)&&(v.push(w),g?Hxt(g,w):g=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return v};function d(p){p.width=p.height=1;var m=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(ax<<5)/m,p.height=K_/m;var g=p.getContext("2d");return g.fillStyle=g.strokeStyle="red",g.textAlign="center",{context:g,ratio:m}}function h(p,m,g){for(var y=m.x,b=m.y,v=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,S=-w,C,k,E;(C=x(S+=w))&&(k=~~C[0],E=~~C[1],!(Math.min(Math.abs(k),Math.abs(E))>=v));)if(m.x=y+k,m.y=b+E,!(m.x+m.x0<0||m.y+m.y0<0||m.x+m.x1>e[0]||m.y+m.y1>e[1])&&(!g||!jxt(m,p,e[0]))&&(!g||Gxt(m,g))){for(var _=m.sprite,T=m.width>>5,D=e[0]>>5,O=m.x-(T<<4),M=O&127,I=32-M,P=m.y1-m.y0,V=(m.y+m.y0)*D+(O>>5),F,B=0;B<P;B++){F=0;for(var q=0;q<=T;q++)p[V+q]|=F<<I|(q<T?(F=_[B*T+q])>>>M:0);V+=D}return m.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Th(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Th(p),f):i},f.fontWeight=function(p){return arguments.length?(s=Th(p),f):s},f.rotate=function(p){return arguments.length?(o=Th(p),f):o},f.text=function(p){return arguments.length?(t=Th(p),f):t},f.spiral=function(p){return arguments.length?(u=Kxt[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=Th(p),f):r},f.padding=function(p){return arguments.length?(a=Th(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function Vxt(e,t,n,r){if(!t.sprite){var i=e.context,s=e.ratio;i.clearRect(0,0,(ax<<5)/s,K_/s);var o=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=i.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var m=Math.sin(t.rotate*SM),g=Math.cos(t.rotate*SM),y=c*g,b=c*m,v=d*g,x=d*m;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,d=~~Math.max(Math.abs(b+v),Math.abs(b-v))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=ax<<5&&(o=0,a+=u,u=0),a+d>=K_)break;i.translate((o+(c>>1))/s,(a+(d>>1))/s),t.rotate&&i.rotate(t.rotate*SM),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var w=i.getImageData(0,0,(ax<<5)/s,K_/s).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(o=t.xoff,o==null)return;a=t.yoff;var C=0,k=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var E=f*p+(h>>5),_=w[(a+p)*(ax<<5)+(o+h)<<2]?1<<31-h%32:0;S[E]|=_,C|=_}C?k=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+k,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function jxt(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,s=e.x-(i<<4),o=s&127,a=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function Hxt(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Gxt(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Uve(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function qxt(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Xxt(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Th(e){return typeof e=="function"?e:function(){return e}}var Kxt={archimedean:Uve,rectangular:qxt},Wve=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Yxt=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Wj(e){ue.call(this,Wxt(),e)}Wj.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Wve}]};var Zxt=Ne(Wj,ue);Zxt.transform=function(e,t){function n(v){var x=e[v];return Ot(x)&&t.modified(x.fields)}var r=e.modified();if(r||t.changed(t.ADD_REM)||Yxt.some(n)){var i=t.materialize(t.SOURCE).source,s=this.value,o=e.as||Wve,a=e.fontSize||14,u;if(Ot(a)?u=e.fontSizeRange:a=Rl(a),u){var l=a,c=GD("sqrt")().domain(Qxt(l,i)).range(u);a=function(v){return c(l(v))}}i.forEach(function(v){v[o[0]]=NaN,v[o[1]]=NaN,v[o[3]]=0});for(var f=s.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Fa).layout(),d=s.size(),h=d[0]>>1,p=d[1]>>1,m=0,g=f.length,y,b;m<g;++m)y=f[m],b=y.datum,b[o[0]]=y.x+h,b[o[1]]=y.y+p,b[o[2]]=y.font,b[o[3]]=y.size,b[o[4]]=y.style,b[o[5]]=y.weight,b[o[6]]=y.rotate;return t.reflow(r).modifies(o)}};function Qxt(e,t){for(var n=1/0,r=-1/0,i=0,s=t.length,o;i<s;++i)o=e(t[i]),o<n&&(n=o),o>r&&(r=o);return[n,r]}const Jxt=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:Wj},Symbol.toStringTag,{value:"Module"}));function ewt(e){return new Uint8Array(e)}function twt(e){return new Uint16Array(e)}function zx(e){return new Uint32Array(e)}function nwt(){var e=8,t=[],n=zx(0),r=W$(0,e),i=W$(0,e);return{data:function(){return t},seen:function(){return n=rwt(n,t.length)},add:function(s){for(var o=0,a=t.length,u=s.length,l;o<u;++o)l=s[o],l._index=a++,t.push(l)},remove:function(s,o){var a=t.length,u=Array(a-s),l=t,c,f,d;for(f=0;!o[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:function(){return t.length},curr:function(){return r},prev:function(){return i},reset:function(s){i[s]=r[s]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(s,o){r[s]|=o},clear:function(s,o){r[s]&=~o},resize:function(s,o){var a=r.length;(s>a||o>e)&&(e=Math.max(o,e),r=W$(s,e,r),i=W$(s,e))}}}function rwt(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function W$(e,t,n){var r=(t<257?ewt:t<65537?twt:zx)(e);return n&&r.set(n),r}function Vve(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(i,s){var o=this,a=o.bisect(o.range,i.value),u=i.index,l=a[0],c=a[1],f=u.length,d;for(d=0;d<l;++d)s[u[d]]|=r;for(d=c;d<f;++d)s[u[d]]|=r;return o}}}function jve(){var e=zx(0),t=[],n=0;function r(a,u,l){if(!u.length)return[];var c=n,f=u.length,d=Array(f),h=zx(f),p,m,g;for(g=0;g<f;++g)d[g]=a(u[g]),h[g]=g;if(d=iwt(d,h),c)p=t,m=e,t=Array(c+f),e=zx(c+f),swt(l,p,m,c,d,h,f,t,e);else{if(l>0)for(g=0;g<f;++g)h[g]+=l;t=d,e=h}return n=c+f,{index:h,value:d}}function i(a,u){var l=n,c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function s(a){for(var u=0,l=n;u<l;++u)e[u]=a[e[u]]}function o(a,u){var l;return u?l=u.length:(u=t,l=n),[Xat(u,a[0],0,l),_T(u,a[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:s,index:function(){return e},size:function(){return n}}}function iwt(e,t){return e.sort.call(t,function(n,r){var i=e[n],s=e[r];return i<s?-1:i>s?1:0}),Kat(e,t)}function swt(e,t,n,r,i,s,o,a,u){var l=0,c=0,f;for(f=0;l<r&&c<o;++f)t[l]<i[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=i[c],u[f]=s[c++]+e);for(;l<r;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)a[f]=i[c],u[f]=s[c]+e}function Vj(e){ue.call(this,nwt(),e),this._indices=null,this._dims=null}Vj.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var Uu=Ne(Vj,ue);Uu.transform=function(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(function(r){return t.modified(r.fields)});return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)};Uu.init=function(e,t){for(var n=e.fields,r=e.query,i=this._indices={},s=this._dims=[],o=r.length,a=0,u,l;a<o;++a)u=n[a].fname,l=i[u]||(i[u]=jve()),s.push(Vve(l,a,r[a]));return this.eval(e,t)};Uu.reinit=function(e,t){var n=t.materialize().fork(),r=e.fields,i=e.query,s=this._indices,o=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={},m,g,y,b,v,x,w,S,C;if(l.set(u),t.rem.length&&(v=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(x={},b=t.mod,w=0,S=b.length;w<S;++w)x[b[w]._index]=1;for(w=0;w<h;++w)C=r[w],(!o[w]||e.modified("fields",w)||t.modified(C.fields))&&(y=C.fname,(m=p[y])||(s[y]=g=jve(),p[y]=m=g.insert(C,t.source,0)),o[w]=Vve(g,w,i[w]).onAdd(m,u));for(w=0,S=a.data().length;w<S;++w)v[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return a.mask=(1<<h)-1,n};Uu.eval=function(e,t){var n=t.materialize().fork(),r=this._dims.length,i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n};Uu.insert=function(e,t,n){var r=t.add,i=this.value,s=this._dims,o=this._indices,a=e.fields,u={},l=n.add,c=i.size(),f=c+r.length,d=s.length,h,p,m;i.resize(f,d),i.add(r);var g=i.curr(),y=i.prev(),b=i.all();for(h=0;h<d;++h)p=a[h].fname,m=u[p]||(u[p]=o[p].insert(a[h],r,c)),s[h].onAdd(m,g);for(;c<f;++c)y[c]=b,g[c]!==b&&l.push(c)};Uu.modify=function(e,t){var n=t.mod,r=this.value,i=r.curr(),s=r.all(),o=e.mod,a,u,l;for(a=0,u=o.length;a<u;++a)l=o[a]._index,i[l]!==s&&n.push(l)};Uu.remove=function(e,t,n){var r=this._indices,i=this.value,s=i.curr(),o=i.prev(),a=i.all(),u={},l=n.rem,c=t.rem,f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=s[h],s[h]=a,p!==a&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u};Uu.reindex=function(e,t,n){var r=this._indices,i=this.value;e.runAfter(function(){var s=i.remove(t,n);for(var o in r)r[o].reindex(s)})};Uu.update=function(e,t,n){var r=this._dims,i=e.query,s=t.stamp,o=r.length,a=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,a=0;l<o;++l)e.modified("query",l)&&(a|=r[l].one,this.incrementAll(r[l],i[l],s,n.add),n.rem=n.add);return a};Uu.incrementAll=function(e,t,n,r){var i=this.value,s=i.seen(),o=i.curr(),a=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],m=e.one,g,y,b;if(f<h)for(g=f,y=Math.min(h,d);g<y;++g)b=u[g],s[b]!==n&&(a[b]=o[b],s[b]=n,r.push(b)),o[b]^=m;else if(f>h)for(g=h,y=Math.min(f,p);g<y;++g)b=u[g],s[b]!==n&&(a[b]=o[b],s[b]=n,r.push(b)),o[b]^=m;if(d>p)for(g=Math.max(f,p),y=d;g<y;++g)b=u[g],s[b]!==n&&(a[b]=o[b],s[b]=n,r.push(b)),o[b]^=m;else if(d<p)for(g=Math.max(h,d),y=p;g<y;++g)b=u[g],s[b]!==n&&(a[b]=o[b],s[b]=n,r.push(b)),o[b]^=m;e.range=t.slice()};Uu.incrementOne=function(e,t,n,r){var i=this.value,s=i.curr(),o=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one,p,m,g;if(l<f)for(p=l,m=Math.min(f,c);p<m;++p)g=o[p],s[g]^=h,n.push(g);else if(l>f)for(p=f,m=Math.min(l,d);p<m;++p)g=o[p],s[g]^=h,r.push(g);if(c>d)for(p=Math.max(l,d),m=c;p<m;++p)g=o[p],s[g]^=h,n.push(g);else if(c<d)for(p=Math.max(f,c),m=d;p<m;++p)g=o[p],s[g]^=h,r.push(g);e.range=t.slice()};function jj(e){ue.call(this,null,e)}jj.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};var owt=Ne(jj,ue);owt.transform=function(e,t){var n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;var s=t.fork(t.ALL),o=r.data(),a=r.curr(),u=r.prev(),l=function(c){return a[c]&n?null:o[c]};return s.filter(s.MOD,l),i&i-1?(s.filter(s.ADD,function(c){var f=a[c]&n,d=!f&&f^u[c]&n;return d?o[c]:null}),s.filter(s.REM,function(c){var f=a[c]&n,d=f&&!(f^(f^u[c]&n));return d?o[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,function(c){return(a[c]&n)===i?o[c]:null})),s.filter(s.SOURCE,function(c){return l(c._index)})};const awt=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:Vj,resolvefilter:jj},Symbol.toStringTag,{value:"Module"})),uwt="4.4.0";var CM="default";function lwt(e){var t=e._signals.cursor;t||(e._signals.cursor=t=e.add({user:CM,item:null})),e.on(e.events("view","mousemove"),t,function(n,r){var i=t.value,s=i?ft(i)?i:i.user:CM,o=r.item&&r.item.cursor||null;return i&&s===i.user&&o==i.item?i:{user:s,item:o}}),e.add(null,function(n){var r=n.cursor,i=this.value;return ft(r)||(i=r.item,r=r.user),cwt(r&&r!==CM?r:i||r),i},{cursor:t})}function cwt(e){typeof document<"u"&&document.body&&(document.body.style.cursor=e)}function mO(e,t){var n=e._runtime.data;return n.hasOwnProperty(t)||he("Unrecognized data set: "+t),n[t]}function fwt(e){return mO(this,e).values.value}function Hj(e,t){Ape(t)||he("Second argument to changes must be a changeset.");var n=mO(this,e);return n.modified=!0,this.pulse(n.input,t)}function dwt(e,t){return Hj.call(this,e,rb().insert(t))}function hwt(e,t){return Hj.call(this,e,rb().remove(t))}function Hve(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Gve(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function gO(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function pwt(e){var t=gO(e),n=Hve(e),r=Gve(e);e._renderer.background(e._background),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(function(i){try{i(n,r)}catch(s){e.error(s)}})}function mwt(e,t,n){var r=e._renderer.canvas(),i,s,o;return r&&(o=gO(e),s=t.changedTouches?t.changedTouches[0]:t,i=OD(s,r),i[0]-=o[0],i[1]-=o[1]),t.dataflow=e,t.vega=gwt(e,n,i),t.item=n,t}function gwt(e,t,n){var r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(o){var a=r,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;ft(o)&&(o=i(o));for(var a=n.slice();o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:Rl(e),item:Rl(t||{}),group:i,xy:s,x:function(o){return s(o)[0]},y:function(o){return s(o)[1]}}}var uee="view",ywt="timer",bwt="window",vwt={trap:!1};function xwt(e){e=on({},e);var t=e.defaults;return t&&(be(t.prevent)&&(t.prevent=Ft(t.prevent)),be(t.allow)&&(t.allow=Ft(t.allow))),e}function wwt(e,t){var n=e._eventConfig.defaults,r=n&&n.prevent,i=n&&n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function Swt(e,t,n){var r=this,i=new fD(n),s=function(l,c){e===uee&&wwt(r,t)&&l.preventDefault();try{i.receive(mwt(r,l,c))}catch(f){r.error(f)}finally{r.run()}},o;if(e===ywt)r.timer(s,t);else if(e===uee)r.addEventListener(t,s,vwt);else if(e===bwt?typeof window<"u"&&(o=[window]):typeof document<"u"&&(o=document.querySelectorAll(e)),!o)r.warn("Can not resolve event source: "+e);else{for(var a=0,u=o.length;a<u;++a)o[a].addEventListener(t,s);r._eventListeners.push({type:t,sources:o,handler:s})}return i}function lee(e){return e.item}function cee(e){var t=e.item.mark.source;return t.source||t}function fee(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Cwt(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",lee),cee,fee(e)),this.on(this.events("view","mouseout",lee),cee,fee(t)),this}function kwt(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,s;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(s=n[r],i=s.sources.length;--i>=0;)s.sources[i].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function _a(e,t,n){var r=document.createElement(e);for(var i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}var $wt="vega-bind",_wt="vega-bind-name",Ewt="vega-bind-radio",Twt="vega-option-";function Awt(e,t,n){if(t){var r=n.param,i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:function(s){s!==e.signal(r.signal)&&(i.source=!0,e.signal(r.signal,s).run())}},r.debounce&&(i.update=AU(r.debounce,i.update))),Nwt(i,t,r,e.signal(r.signal)),i.active||(e.on(e._signals[r.signal],null,function(){i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}}function Nwt(e,t,n,r){var i=_a("div",{class:$wt});i.appendChild(_a("span",{class:_wt},n.name||n.signal)),t.appendChild(i);var s=Iwt;switch(n.input){case"checkbox":s=Dwt;break;case"select":s=Owt;break;case"radio":s=Fwt;break;case"range":s=Rwt;break}s(e,i,n,r)}function Iwt(e,t,n,r){var i=_a("input");for(var s in n)s!=="signal"&&s!=="element"&&i.setAttribute(s==="input"?"type":s,n[s]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",function(){e.update(i.value)}),e.elements=[i],e.set=function(o){i.value=o}}function Dwt(e,t,n,r){var i={type:"checkbox",name:n.signal};r&&(i.checked=!0);var s=_a("input",i);t.appendChild(s),s.addEventListener("change",function(){e.update(s.checked)}),e.elements=[s],e.set=function(o){s.checked=!!o||null}}function Owt(e,t,n,r){var i=_a("select",{name:n.signal});n.options.forEach(function(s){var o={value:s};kA(s,r)&&(o.selected=!0),i.appendChild(_a("option",o,s+""))}),t.appendChild(i),i.addEventListener("change",function(){e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=function(s){for(var o=0,a=n.options.length;o<a;++o)if(kA(n.options[o],s)){i.selectedIndex=o;return}}}function Fwt(e,t,n,r){var i=_a("span",{class:Ewt});t.appendChild(i),e.elements=n.options.map(function(s){var o=Twt+n.signal+"-"+s,a={id:o,type:"radio",name:n.signal,value:s};kA(s,r)&&(a.checked=!0);var u=_a("input",a);return u.addEventListener("change",function(){e.update(s)}),i.appendChild(u),i.appendChild(_a("label",{for:o},s+"")),u}),e.set=function(s){for(var o=e.elements,a=0,u=o.length;a<u;++a)kA(o[a].value,s)&&(o[a].checked=!0)}}function Rwt(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;var i=n.min||Math.min(0,+r)||0,s=n.max||Math.max(100,+r)||100,o=n.step||Jat(i,s,100),a=_a("input",{type:"range",name:n.signal,min:i,max:s,step:o});a.value=r;var u=_a("label",{},+r);t.appendChild(a),t.appendChild(u);function l(){u.textContent=a.value,e.update(+a.value)}a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=function(c){a.value=c,u.textContent=c}}function kA(e,t){return e===t||e+""==t+""}function qve(e,t,n,r,i){return t=t||new r(e.loader()),t.initialize(n,Hve(e),Gve(e),gO(e),i).background(e._background)}function Gj(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Mwt(e,t,n,r){var i=new r(e.loader(),Gj(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,gO(e),e);return t&&t.handlers().forEach(function(s){i.on(s.type,s.handler)}),i}function Pwt(e,t){var n=this,r=n._renderType,i=RD(r),s,o;return e=n._el=e?kM(n,e):null,i||n.error("Unrecognized renderer type: "+r),s=i.handler||OC,o=e?i.renderer:i.headless,n._renderer=o?qve(n,n._renderer,e,o):null,n._handler=Mwt(n,n._handler,e,s),n._redraw=!0,e&&(t=t?kM(n,t):e.appendChild(_a("div",{class:"vega-bindings"})),n._bind.forEach(function(a){a.param.element&&(a.element=kM(n,a.param.element))}),n._bind.forEach(function(a){Awt(n,a.element||t,a)})),n}function kM(e,t){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}function qj(e,t,n){var r=RD(t),i=r&&r.headless;return i?e.runAsync().then(function(){return qve(e,null,null,i,n).renderAsync(e._scenegraph.root)}):Promise.reject("Unrecognized renderer type: "+t)}function Lwt(e,t){return e!==Kf.Canvas&&e!==Kf.SVG&&e!==Kf.PNG?Promise.reject("Unrecognized image type: "+e):qj(this,e,t).then(function(n){return e===Kf.SVG?zwt(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")})}function zwt(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function Bwt(e){return qj(this,Kf.Canvas,e).then(function(t){return t.canvas()})}function Uwt(e){return qj(this,Kf.SVG,e).then(function(t){return t.svg()})}function Wwt(e,t){return e=e||t.autosize,yt(e)?e:(e=e||"pad",{type:e})}function Vwt(e,t){return e=e||t.padding,yt(e)?{top:bv(e.top),bottom:bv(e.bottom),left:bv(e.left),right:bv(e.right)}:jwt(bv(e))}function bv(e){return+e||0}function jwt(e){return{top:e,bottom:e,left:e,right:e}}var Hwt="outer",Gwt=["value","update","init","react","bind"];function dee(e,t){he(e+' for "outer" push: '+Fe(t))}function Xve(e,t){var n=e.name;if(e.push===Hwt)t.signals[n]||dee("No prior signal definition",n),Gwt.forEach(function(i){e[i]!==void 0&&dee("Invalid property ",i)});else{var r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}const qwt="RawCode",Xwt="Literal",Kwt="Property",Ywt="Identifier",Zwt="ArrayExpression",Qwt="BinaryExpression",Jwt="CallExpression",e2t="ConditionalExpression",t2t="LogicalExpression",n2t="MemberExpression",r2t="ObjectExpression",i2t="UnaryExpression";function Wu(e){this.type=e}Wu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=s2t(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function s2t(e){switch(e.type){case Zwt:return e.elements;case Qwt:case t2t:return[e.left,e.right];case Jwt:return[e.callee].concat(e.arguments);case e2t:return[e.test,e.consequent,e.alternate];case n2t:return[e.object,e.property];case r2t:return e.properties;case Kwt:return[e.key,e.value];case i2t:return[e.argument];case Ywt:case Xwt:case qwt:default:return[]}}var Zl,Ge,ie,Bi,tn,yO=1,qC=2,dm=3,mh=4,bO=5,ng=6,Ms=7,XC=8,o2t=9;Zl={};Zl[yO]="Boolean";Zl[qC]="<end>";Zl[dm]="Identifier";Zl[mh]="Keyword";Zl[bO]="Null";Zl[ng]="Numeric";Zl[Ms]="Punctuator";Zl[XC]="String";Zl[o2t]="RegularExpression";var a2t="ArrayExpression",u2t="BinaryExpression",l2t="CallExpression",c2t="ConditionalExpression",Kve="Identifier",f2t="Literal",d2t="LogicalExpression",h2t="MemberExpression",p2t="ObjectExpression",m2t="Property",g2t="UnaryExpression",mi="Unexpected token %0",y2t="Unexpected number",b2t="Unexpected string",v2t="Unexpected identifier",x2t="Unexpected reserved word",w2t="Unexpected end of input",FL="Invalid regular expression",$M="Invalid regular expression: missing /",Yve="Octal literals are not allowed in strict mode.",S2t="Duplicate data property in object literal not allowed in strict mode",Pi="ILLEGAL",r2="Disabled.",C2t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),k2t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function vO(e,t){if(!e)throw new Error("ASSERT: "+t)}function mc(e){return e>=48&&e<=57}function Xj(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Bx(e){return"01234567".indexOf(e)>=0}function $2t(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function i2(e){return e===10||e===13||e===8232||e===8233}function KC(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&C2t.test(String.fromCharCode(e))}function $A(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&k2t.test(String.fromCharCode(e))}var _2t={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Zve(){for(var e;ie<Bi&&(e=Ge.charCodeAt(ie),$2t(e)||i2(e));)++ie}function RL(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)ie<Bi&&Xj(Ge[ie])?(r=Ge[ie++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Xt({},mi,Pi);return String.fromCharCode(i)}function E2t(){var e,t,n,r;for(e=Ge[ie],t=0,e==="}"&&Xt({},mi,Pi);ie<Bi&&(e=Ge[ie++],!!Xj(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Xt({},mi,Pi),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Qve(){var e,t;for(e=Ge.charCodeAt(ie++),t=String.fromCharCode(e),e===92&&(Ge.charCodeAt(ie)!==117&&Xt({},mi,Pi),++ie,e=RL("u"),(!e||e==="\\"||!KC(e.charCodeAt(0)))&&Xt({},mi,Pi),t=e);ie<Bi&&(e=Ge.charCodeAt(ie),!!$A(e));)++ie,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Ge.charCodeAt(ie)!==117&&Xt({},mi,Pi),++ie,e=RL("u"),(!e||e==="\\"||!$A(e.charCodeAt(0)))&&Xt({},mi,Pi),t+=e);return t}function T2t(){var e,t;for(e=ie++;ie<Bi;){if(t=Ge.charCodeAt(ie),t===92)return ie=e,Qve();if($A(t))++ie;else break}return Ge.slice(e,ie)}function A2t(){var e,t,n;return e=ie,t=Ge.charCodeAt(ie)===92?Qve():T2t(),t.length===1?n=dm:_2t.hasOwnProperty(t)?n=mh:t==="null"?n=bO:t==="true"||t==="false"?n=yO:n=dm,{type:n,value:t,start:e,end:ie}}function _M(){var e=ie,t=Ge.charCodeAt(ie),n,r=Ge[ie],i,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ie,{type:Ms,value:String.fromCharCode(t),start:e,end:ie};default:if(n=Ge.charCodeAt(ie+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ie+=2,{type:Ms,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:ie};case 33:case 61:return ie+=2,Ge.charCodeAt(ie)===61&&++ie,{type:Ms,value:Ge.slice(e,ie),start:e,end:ie}}}if(o=Ge.substr(ie,4),o===">>>=")return ie+=4,{type:Ms,value:o,start:e,end:ie};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return ie+=3,{type:Ms,value:s,start:e,end:ie};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return ie+=2,{type:Ms,value:i,start:e,end:ie};if("<>=!+-*%&|^/".indexOf(r)>=0)return++ie,{type:Ms,value:r,start:e,end:ie};Xt({},mi,Pi)}function N2t(e){for(var t="";ie<Bi&&Xj(Ge[ie]);)t+=Ge[ie++];return t.length===0&&Xt({},mi,Pi),KC(Ge.charCodeAt(ie))&&Xt({},mi,Pi),{type:ng,value:parseInt("0x"+t,16),start:e,end:ie}}function I2t(e){for(var t="0"+Ge[ie++];ie<Bi&&Bx(Ge[ie]);)t+=Ge[ie++];return(KC(Ge.charCodeAt(ie))||mc(Ge.charCodeAt(ie)))&&Xt({},mi,Pi),{type:ng,value:parseInt(t,8),octal:!0,start:e,end:ie}}function hee(){var e,t,n;if(n=Ge[ie],vO(mc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=ie,e="",n!=="."){if(e=Ge[ie++],n=Ge[ie],e==="0"){if(n==="x"||n==="X")return++ie,N2t(t);if(Bx(n))return I2t(t);n&&mc(n.charCodeAt(0))&&Xt({},mi,Pi)}for(;mc(Ge.charCodeAt(ie));)e+=Ge[ie++];n=Ge[ie]}if(n==="."){for(e+=Ge[ie++];mc(Ge.charCodeAt(ie));)e+=Ge[ie++];n=Ge[ie]}if(n==="e"||n==="E")if(e+=Ge[ie++],n=Ge[ie],(n==="+"||n==="-")&&(e+=Ge[ie++]),mc(Ge.charCodeAt(ie)))for(;mc(Ge.charCodeAt(ie));)e+=Ge[ie++];else Xt({},mi,Pi);return KC(Ge.charCodeAt(ie))&&Xt({},mi,Pi),{type:ng,value:parseFloat(e),start:t,end:ie}}function D2t(){var e="",t,n,r,i,s=!1;for(t=Ge[ie],vO(t==="'"||t==='"',"String literal must starts with a quote"),n=ie,++ie;ie<Bi;)if(r=Ge[ie++],r===t){t="";break}else if(r==="\\")if(r=Ge[ie++],!r||!i2(r.charCodeAt(0)))switch(r){case"u":case"x":Ge[ie]==="{"?(++ie,e+=E2t()):e+=RL(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Bx(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),ie<Bi&&Bx(Ge[ie])&&(s=!0,i=i*8+"01234567".indexOf(Ge[ie++]),"0123".indexOf(r)>=0&&ie<Bi&&Bx(Ge[ie])&&(i=i*8+"01234567".indexOf(Ge[ie++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&Ge[ie]===`
`&&++ie;else{if(i2(r.charCodeAt(0)))break;e+=r}return t!==""&&Xt({},mi,Pi),{type:XC,value:e,octal:s,start:n,end:ie}}function O2t(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Xt({},FL)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Xt({},FL)}try{return new RegExp(e,t)}catch{return null}}function F2t(){var e,t,n,r,i;for(e=Ge[ie],vO(e==="/","Regular expression literal must start with a slash"),t=Ge[ie++],n=!1,r=!1;ie<Bi;)if(e=Ge[ie++],t+=e,e==="\\")e=Ge[ie++],i2(e.charCodeAt(0))&&Xt({},$M),t+=e;else if(i2(e.charCodeAt(0)))Xt({},$M);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Xt({},$M),i=t.substr(1,t.length-2),{value:i,literal:t}}function R2t(){var e,t,n;for(t="",n="";ie<Bi&&(e=Ge[ie],!!$A(e.charCodeAt(0)));)++ie,e==="\\"&&ie<Bi?Xt({},mi,Pi):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Xt({},FL,n),{value:n,literal:t}}function M2t(){var e,t,n,r;return tn=null,Zve(),e=ie,t=F2t(),n=R2t(),r=O2t(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:ie}}function P2t(e){return e.type===dm||e.type===mh||e.type===yO||e.type===bO}function Jve(){var e;return Zve(),ie>=Bi?{type:qC,start:ie,end:ie}:(e=Ge.charCodeAt(ie),KC(e)?A2t():e===40||e===41||e===59?_M():e===39||e===34?D2t():e===46?mc(Ge.charCodeAt(ie+1))?hee():_M():mc(e)?hee():_M())}function Us(){var e;return e=tn,ie=e.end,tn=Jve(),ie=e.end,e}function exe(){var e;e=ie,tn=Jve(),ie=e}function L2t(e){var t=new Wu(a2t);return t.elements=e,t}function pee(e,t,n){var r=new Wu(e==="||"||e==="&&"?d2t:u2t);return r.operator=e,r.left=t,r.right=n,r}function z2t(e,t){var n=new Wu(l2t);return n.callee=e,n.arguments=t,n}function B2t(e,t,n){var r=new Wu(c2t);return r.test=e,r.consequent=t,r.alternate=n,r}function Kj(e){var t=new Wu(Kve);return t.name=e,t}function ux(e){var t=new Wu(f2t);return t.value=e.value,t.raw=Ge.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function mee(e,t,n){var r=new Wu(h2t);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function U2t(e){var t=new Wu(p2t);return t.properties=e,t}function gee(e,t,n){var r=new Wu(m2t);return r.key=t,r.value=n,r.kind=e,r}function W2t(e,t){var n=new Wu(g2t);return n.operator=e,n.argument=t,n.prefix=!0,n}function Xt(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,o)=>(vO(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=ie,n.description=i,n}function xO(e){e.type===qC&&Xt(e,w2t),e.type===ng&&Xt(e,y2t),e.type===XC&&Xt(e,b2t),e.type===dm&&Xt(e,v2t),e.type===mh&&Xt(e,x2t),Xt(e,mi,e.value)}function Ui(e){var t=Us();(t.type!==Ms||t.value!==e)&&xO(t)}function Tn(e){return tn.type===Ms&&tn.value===e}function EM(e){return tn.type===mh&&tn.value===e}function V2t(){var e=[];for(ie=tn.start,Ui("[");!Tn("]");)Tn(",")?(Us(),e.push(null)):(e.push(hm()),Tn("]")||Ui(","));return Us(),L2t(e)}function yee(){var e;return ie=tn.start,e=Us(),e.type===XC||e.type===ng?(e.octal&&Xt(e,Yve),ux(e)):Kj(e.value)}function j2t(){var e,t,n,r;if(ie=tn.start,e=tn,e.type===dm)return n=yee(),Ui(":"),r=hm(),gee("init",n,r);if(e.type===qC||e.type===Ms)xO(e);else return t=yee(),Ui(":"),r=hm(),gee("init",t,r)}function H2t(){var e=[],t,n,r,i={},s=String;for(ie=tn.start,Ui("{");!Tn("}");)t=j2t(),t.key.type===Kve?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Xt({},S2t):i[r]=!0,e.push(t),Tn("}")||Ui(",");return Ui("}"),U2t(e)}function G2t(){var e;return Ui("("),e=Yj(),Ui(")"),e}var q2t={if:1};function X2t(){var e,t,n;if(Tn("("))return G2t();if(Tn("["))return V2t();if(Tn("{"))return H2t();if(e=tn.type,ie=tn.start,e===dm||q2t[tn.value])n=Kj(Us().value);else if(e===XC||e===ng)tn.octal&&Xt(tn,Yve),n=ux(Us());else{if(e===mh)throw new Error(r2);e===yO?(t=Us(),t.value=t.value==="true",n=ux(t)):e===bO?(t=Us(),t.value=null,n=ux(t)):Tn("/")||Tn("/=")?(n=ux(M2t()),exe()):xO(Us())}return n}function K2t(){var e=[];if(Ui("("),!Tn(")"))for(;ie<Bi&&(e.push(hm()),!Tn(")"));)Ui(",");return Ui(")"),e}function Y2t(){var e;return ie=tn.start,e=Us(),P2t(e)||xO(e),Kj(e.value)}function Z2t(){return Ui("."),Y2t()}function Q2t(){var e;return Ui("["),e=Yj(),Ui("]"),e}function J2t(){var e,t,n;for(e=X2t();;)if(Tn("."))n=Z2t(),e=mee(".",e,n);else if(Tn("("))t=K2t(),e=z2t(e,t);else if(Tn("["))n=Q2t(),e=mee("[",e,n);else break;return e}function bee(){var e=J2t();if(tn.type===Ms&&(Tn("++")||Tn("--")))throw new Error(r2);return e}function Y_(){var e,t;if(tn.type!==Ms&&tn.type!==mh)t=bee();else{if(Tn("++")||Tn("--"))throw new Error(r2);if(Tn("+")||Tn("-")||Tn("~")||Tn("!"))e=Us(),t=Y_(),t=W2t(e.value,t);else{if(EM("delete")||EM("void")||EM("typeof"))throw new Error(r2);t=bee()}}return t}function vee(e){var t=0;if(e.type!==Ms&&e.type!==mh)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function eSt(){var e,t,n,r,i,s,o,a,u,l;if(e=tn,u=Y_(),r=tn,i=vee(r),i===0)return u;for(r.prec=i,Us(),t=[e,tn],o=Y_(),s=[u,r,o];(i=vee(tn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=pee(a,u,o),s.push(n);r=Us(),r.prec=i,s.push(r),t.push(tn),n=Y_(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=pee(s[l-1].value,s[l-2],n),l-=2;return n}function hm(){var e,t,n;return e=eSt(),Tn("?")&&(Us(),t=hm(),Ui(":"),n=hm(),e=B2t(e,t,n)),e}function Yj(){var e=hm();if(Tn(","))throw new Error(r2);return e}function tSt(e){Ge=e,ie=0,Bi=Ge.length,tn=null,exe();var t=Yj();if(tn.type!==qC)throw new Error("Unexpect token after expression.");return t}const txe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function nxe(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&he("Missing arguments to clamp function."),o.length>3&&he("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(o){return"("+e(o[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),replace:n("replace",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&he("Missing arguments to if function."),o.length>3&&he("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function nSt(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function rSt(e){e=e||{};const t=e.whitelist?Ft(e.whitelist):{},n=e.blacklist?Ft(e.blacklist):{},r=e.constants||txe,i=(e.functions||nxe)(f),s=e.globalvar,o=e.fieldvar,a=Ot(s)?s:p=>`${s}["${p}"]`;let u={},l={},c=0;function f(p){if(ft(p))return p;const m=d[p.type];return m==null&&he("Unsupported type: "+p.type),m(p)}const d={Literal:p=>p.raw,Identifier:p=>{const m=p.name;return c>0?m:os(n,m)?he("Illegal identifier: "+m):os(r,m)?r[m]:os(t,m)?m:(u[m]=1,a(m))},MemberExpression:p=>{const m=!p.computed,g=f(p.object);m&&(c+=1);const y=f(p.property);return g===o&&(l[nSt(y)]=1),m&&(c-=1),g+(m?"."+y:"["+y+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&he("Illegal callee type: "+p.callee.type);const m=p.callee.name,g=p.arguments,y=os(i,m)&&i[m];return y||he("Unrecognized function: "+m),Ot(y)?y(g):y+"("+g.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const m=f(p.key);return c-=1,m+":"+f(p.value)}};function h(p){const m={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},m}return h.functions=i,h.constants=r,h}var xee={};function YC(e,t,n){var r=e+":"+n,i=xee[r];return(!i||i[0]!==t)&&(xee[r]=i=[t,t(n)]),i[1]}function iSt(e,t){return YC("format",bu,t)(e)}function rxe(e,t){return YC("timeFormat",VU,t)(e)}function sSt(e,t){return YC("utcFormat",HU,t)(e)}function oSt(e,t){return YC("timeParse",jU,t)(e)}function aSt(e,t){return YC("utcParse",GU,t)(e)}var TM=new Date(2e3,0,1);function wO(e,t,n){return TM.setMonth(e),TM.setDate(t),rxe(TM,n)}function uSt(e){return wO(e,1,"%B")}function lSt(e){return wO(e,1,"%b")}function cSt(e){return wO(0,2+e,"%A")}function fSt(e){return wO(0,2+e,"%a")}function dSt(e){var t=0,n,r,i,s;if(e&&(n=e.length)){for(r=e[t];r==null||r!==r;r=e[++t]);for(i=s=r;t<n;++t)r=e[t],r!=null&&(r<i&&(i=r),r>s&&(s=r))}return[i,s]}function mp(e,t,n,r){var i=t[0],s=t[t.length-1],o;return i>s&&(o=i,i=s,s=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function hSt(e,t,n){var r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function pSt(e){return e[e.length-1]-e[0]||0}function mSt(e){return 1+~~(new Date(e).getMonth()/3)}function gSt(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Zj(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function ySt(){return Zj(this.context.dataflow,"warn",arguments)}function bSt(){return Zj(this.context.dataflow,"info",arguments)}function vSt(){return Zj(this.context.dataflow,"debug",arguments)}function xSt(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function wSt(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function SSt(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}var Ux=typeof window<"u"&&window||null;function CSt(){return Ux?Ux.screen:{}}function kSt(){return Ux?[Ux.innerWidth,Ux.innerHeight]:[void 0,void 0]}function $St(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function _St(e,t,n,r,i,s){if(!n&&n!==0)return s;var o=e[0],a=Vt(e),u=+n,l,c;return a<o&&(l=o,o=a,a=l),l=Math.abs(t-o),c=Math.abs(a-t),l<c&&l<=u?r:c<=u?i:s}function ESt(){var e=[].slice.call(arguments);return e.unshift({}),on.apply(null,e)}var x1="Literal",TSt="Identifier",Qj="@",Z_="%",ASt=":";function vf(e,t){var n;return Ot(e)?e:ft(e)?(n=t.scales[e])&&n.value:void 0}function wee(e,t,n){var r=Z_+n;if(!t.hasOwnProperty(r))try{t[r]=e.scaleRef(n)}catch{}}function Vu(e,t,n,r){if(t[0].type===x1)wee(n,r,t[0].value);else if(t[0].type===TSt)for(e in n.scales)wee(n,r,e)}function NSt(e,t){var n=vf(e,(t||this).context);return n&&n.range?n.range():[]}function ISt(e,t){var n=vf(e,(t||this).context);return n?n.domain():[]}function DSt(e,t){var n=vf(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function OSt(e,t,n){return cV(e||0,t||0,n||0)}function FSt(e,t){var n=vf(e,(t||this).context);return n?n.copy():void 0}function RSt(e,t,n){var r=vf(e,(n||this).context);return r?r(t):void 0}function MSt(e,t,n){var r=vf(e,(n||this).context);return r?be(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function PSt(e,t,n,r,i){e=vf(e,(i||this).context);var s=hge(t,n),o=e.domain(),a=o[0],u=Vt(o),l=h1e(e,a,u);e.ticks&&(o=e.ticks(+r||15),a!==o[0]&&o.unshift(a),u!==Vt(o)&&o.push(u));for(var c=0,f=o.length;c<f;++c)s.stop(l(o[c]),e(o[c]));return s}function Jj(e,t){return function(n,r,i){if(n){var s=vf(n,(i||this).context);return s&&s.path[e](r)}else return t(r)}}var LSt=Jj("area",rbt),zSt=Jj("bounds",cbt),BSt=Jj("centroid",gbt);function USt(e,t,n){var r=vf(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function WSt(e){var t=null;return function(n){return n?kD(n,t=t||o1(e)):e}}function ixe(e){var t=this.context.data[e];return t?t.values.value:[]}function xf(e,t,n,r){t[0].type!==x1&&he("First argument to data functions must be a string literal.");var i=t[0].value,s=ASt+i;r.hasOwnProperty(s)||(r[s]=n.getData(i).tuplesRef())}function VSt(e,t,n){var r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function jSt(e,t,n,r){t[0].type!==x1&&he("First argument to indata must be a string literal."),t[1].type!==x1&&he("Second argument to indata must be a string literal.");var i=t[0].value,s=t[1].value,o=Qj+s;r.hasOwnProperty(o)||(r[o]=n.getData(i).indataRef(n,s))}function HSt(e,t){var n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(ih).insert(t)),1}var GSt={};function sxe(e){return e.data}function oxe(e,t){var n=ixe.call(t,e);return n.root&&n.root.lookup||GSt}function qSt(e,t,n){var r=oxe(e,this),i=r[t],s=r[n];return i&&s?i.path(s).map(sxe):void 0}function XSt(e,t){var n=oxe(e,this)[t];return n?n.ancestors().map(sxe):void 0}function KSt(e,t,n){if(e){var r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}function axe(e,t){return e===t||e!==e&&t!==t?!0:be(e)&&be(t)&&e.length===t.length?YSt(e,t):!1}function YSt(e,t){for(var n=0,r=e.length;n<r;++n)if(!axe(e[n],t[n]))return!1;return!0}function See(e){return function(t){for(var n in e)if(!axe(t[n],e[n]))return!1;return!0}}function ZSt(e,t,n,r,i,s){var o=this.context.dataflow,a=this.context.data[e],u=a.input,l=a.changes,c=o.stamp(),f,d;if(o._trigger===!1||!(u.value.length||t||r))return 0;if((!l||l.stamp<c)&&(a.changes=l=o.changeset(),l.stamp=c,o.runAfter(function(){a.modified=!0,o.pulse(u,l).run()},!0,1)),n&&(f=n===!0?ih:be(n)||uD(n)?n:See(n),l.remove(f)),t&&l.insert(t),r&&(f=See(r),u.value.some(f)?l.remove(f):l.insert(r)),i)for(d in s)l.modify(i,d,s[d]);return 1}var QSt="E",JSt="R",eCt="R-E",tCt="R-LE",nCt="R-RE",uxe="intersect",rCt="union",Cee="index:unit";function kee(e,t){for(var n=t.fields,r=t.values,i=n.length,s=0,o,a;s<i;++s)if(a=n[s],a.getter=Vo.getter||Vo(a.field),o=a.getter(e),Qs(o)&&(o=Sr(o)),Qs(r[s])&&(r[s]=Sr(r[s])),Qs(r[s][0])&&(r[s]=r[s].map(Sr)),a.type===QSt){if(be(r[s])?r[s].indexOf(o)<0:o!==r[s])return!1}else if(a.type===JSt){if(!mp(o,r[s]))return!1}else if(a.type===nCt){if(!mp(o,r[s],!0,!1))return!1}else if(a.type===eCt){if(!mp(o,r[s],!1,!1))return!1}else if(a.type===tCt&&!mp(o,r[s],!1,!0))return!1;return!0}function iCt(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],s=r?r[Cee]&&r[Cee].value:void 0,o=n===uxe,a=i.length,u=0,l,c,f,d,h;u<a;++u)if(l=i[u],s&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=kee(t,l),c[d]=h?-1:++f,h&&s.size===1)return!0;if(!h&&f===s.get(d).count)return!1}else if(h=kee(t,l),o^h)return h;return a&&o}function lxe(e,t,n,r){t[0].type!==x1&&he("First argument to indata must be a string literal.");var i=t[0].value,s=t.length>=2&&t[t.length-1].value,o="unit",a=Qj+o;s===uxe&&!r.hasOwnProperty(a)&&(r[a]=n.getData(i).indataRef(n,o)),xf(e,t,n,r)}function sCt(e,t){for(var n=this.context.data[e],r=n?n.values.value:[],i={},s={},o,a,u,l,c,f,d,h,p,m=r.length,g=0,y,b;g<m;++g)for(o=r[g],l=o.unit,a=o.fields,u=o.values,y=0,b=a.length;y<b;++y)c=a[y],f=i[c.field]||(i[c.field]={}),d=f[l]||(f[l]=[]),s[c.field]=h=c.type.charAt(0),p=$ee[h+"_union"],f[l]=p(d,xt(u[y]));return t=t||rCt,Object.keys(i).forEach(function(v){i[v]=Object.keys(i[v]).map(function(x){return i[v][x]}).reduce(function(x,w){return x===void 0?w:$ee[s[v]+"_"+t](x,w)})}),i}var $ee={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(function(n){return t.indexOf(n)>=0}):t},R_union:function(e,t){var n=Sr(t[0]),r=Sr(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Sr(t[0]),r=Sr(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}},cxe="bin_",ZC="intersect",AM="union",_A="index:unit";function oCt(e,t){for(var n=t.fields,r=t.values,i=t.getter||(t.getter=[]),s=n.length,o=0,a;o<s;++o)if(i[o]=i[o]||Vo(n[o]),a=i[o](e),Qs(a)&&(a=Sr(a)),Qs(r[o])&&(r[o]=Sr(r[o])),t[cxe+n[o]]){if(Qs(r[o][0])&&(r[o]=r[o].map(Sr)),!mp(a,r[o],!0,!1))return!1}else if(a!==r[o])return!1;return!0}function aCt(e,t){for(var n=t.intervals,r=n.length,i=0,s,o,a;i<r;++i){if(o=n[i].extent,s=n[i].getter||(n[i].getter=Vo(n[i].field)),a=s(e),!o||o[0]===o[1]||(Qs(a)&&(a=Sr(a)),Qs(o[0])&&(o=n[i].extent=o.map(Sr)),Rr(o[0])&&!mp(a,o)))return!1;if(ft(o[0])&&o.indexOf(a)<0)return!1}return!0}function fxe(e,t,n,r){for(var i=this.context.data[e],s=i?i.values.value:[],o=i?i[_A]&&i[_A].value:void 0,a=n===ZC,u=s.length,l=0,c,f,d,h,p;l<u;++l)if(c=s[l],o&&a){if(f=f||{},d=f[h=c.unit]||0,d===-1)continue;if(p=r(t,c),f[h]=p?-1:++d,p&&o.size===1)return!0;if(!p&&d===o.get(h).count)return!1}else if(p=r(t,c),a^p)return p;return u&&a}function dxe(e,t,n){return fxe.call(this,e,t,n,oCt)}function uCt(e,t,n){return fxe.call(this,e,t,n,aCt)}function hxe(e,t,n,r){t[0].type!==x1&&he("First argument to indata must be a string literal.");var i=t[0].value,s=t.length>=2&&t[t.length-1].value,o="unit",a=Qj+o;s===ZC&&!r.hasOwnProperty(a)&&(r[a]=n.getData(i).indataRef(n,o)),xf(e,t,n,r)}function pxe(e,t,n,r){var i=this.context.data[e],s=i?i.values.value:[],o=i?i[_A]&&i[_A].value:void 0,a=s[0],u=0,l,c,f,d,h;if(a){for(l=t?a.encodings.length:a.fields.length;u<l;++u)if(t&&a.encodings[u]===t||n&&a.fields[u]===n){c=u,d=a[cxe+a.fields[u]];break}return o&&o.size===1&&(r=AM),o&&r===ZC?(h=s.reduce(function(p,m){var g=p[m.unit]||(p[m.unit]=[]);return g.push({unit:m.unit,value:m.values[c]}),p},{}),f=Object.keys(h).map(function(p){return{unit:p,value:d?PL(h[p],AM):ML(h[p],AM)}})):f=s.map(function(p){return{unit:p.unit,value:p.values[c]}}),d?PL(f,r):ML(f,r)}}function lCt(e,t,n,r){var i=this.context.data[e],s=i?i.values.value:[],o=s[0],a=0,u,l,c,f,d;if(o){for(u=o.intervals.length;a<u;++a)if(l=o.intervals[a],t&&l.encoding===t||n&&l.field===n){if(!l.extent)return;c=a,d=l.extent.length>2;break}return f=s.reduce(function(h,p){var m=p.intervals[c].extent,g=d?m.map(function(y){return{unit:p.unit,value:y}}):{unit:p.unit,value:m};return d?h.push.apply(h,g):h.push(g),h},[]),d?ML(f,r):PL(f,r)}}function ML(e,t){for(var n={},r=0,i={},s=[],o=0,a=e.length,u,l,c,f;o<a;++o)u=e[o],l=u.unit,f=u.value,n[l]||(n[l]=++r),(c=i[f])||(i[f]=c={value:f,units:{},count:0}),c.units[l]||(c.units[l]=++c.count);for(f in i)c=i[f],!(t===ZC&&c.count!==r)&&s.push(c.value);return s.length?s:void 0}function PL(e,t){for(var n=t===ZC?fCt:cCt,r=0,i=e.length,s,o,a,u;r<i;++r)s=e[r].value,Qs(s[0])&&(s=s.map(Sr)),a=s[0],u=s[1],a>u&&(u=s[0],a=s[1]),o=o?n(o,a,u):[a,u];return o&&o.length&&+o[0]!=+o[1]?o:void 0}function cCt(e,t,n){return e[0]>t&&(e[0]=t),e[1]<n&&(e[1]=n),e}function fCt(e,t,n){return n<e[0]||e[1]<t?[]:(e[0]<t&&(e[0]=t),e[1]>n&&(e[1]=n),e)}var EA={random:function(){return Fa()},isArray:be,isBoolean:nb,isDate:Qs,isNumber:Rr,isObject:yt,isRegExp:Spe,isString:ft,isTuple:uD,toBoolean:IU,toDate:DU,toNumber:Sr,toString:OU,pad:kpe,peek:Vt,truncate:$pe,rgb:l1,lab:zT,hcl:BT,hsl:PT,sequence:TC,format:iSt,utcFormat:sSt,utcParse:aSt,timeFormat:rxe,timeParse:oSt,monthFormat:uSt,monthAbbrevFormat:lSt,dayFormat:cSt,dayAbbrevFormat:fSt,quarter:mSt,utcquarter:gSt,warn:ySt,info:bSt,debug:vSt,extent:dSt,inScope:xSt,clampRange:hSt,pinchDistance:wSt,pinchAngle:SSt,screen:CSt,containerSize:$St,windowSize:kSt,span:pSt,merge:ESt,flush:_St,bandspace:OSt,inrange:mp,setdata:HSt,pathShape:WSt,panLinear:bpe,panLog:vpe,panPow:xpe,zoomLinear:$U,zoomLog:_U,zoomPow:vT,encode:KSt,modify:ZSt},dCt=["view","item","group","xy","x","y"],hCt="event.vega.",mxe="this.",gxe={};function Un(e,t,n){return arguments.length===1?EA[e]:(EA[e]=t,n&&(gxe[e]=n),LL&&(LL.functions[e]=mxe+e),this)}Un("bandwidth",DSt,Vu);Un("copy",FSt,Vu);Un("domain",ISt,Vu);Un("range",NSt,Vu);Un("invert",MSt,Vu);Un("scale",RSt,Vu);Un("gradient",PSt,Vu);Un("geoArea",LSt,Vu);Un("geoBounds",zSt,Vu);Un("geoCentroid",BSt,Vu);Un("geoShape",USt,Vu);Un("indata",VSt,jSt);Un("data",ixe,xf);Un("treePath",qSt,xf);Un("treeAncestors",XSt,xf);Un("vlSelectionTest",iCt,lxe);Un("vlSelectionResolve",sCt,lxe);Un("vlSingle",dxe,xf);Un("vlSingleDomain",pxe,xf);Un("vlMulti",dxe,hxe);Un("vlMultiDomain",pxe,hxe);Un("vlInterval",uCt,xf);Un("vlIntervalDomain",lCt,xf);function pCt(e){var t=nxe(e);dCt.forEach(function(r){t[r]=hCt+r});for(var n in EA)t[n]=mxe+n;return t}var yxe={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+Fe("$"+e)+"]"},functions:pCt,constants:txe,visitors:gxe},LL=rSt(yxe),mCt="$";function Bl(e,t,n){var r={},i,s;try{e=ft(e)?e:Fe(e)+"",i=tSt(e)}catch{he("Expression parse error: "+e)}return i.visit(function(a){if(a.type==="CallExpression"){var u=a.callee.name,l=yxe.visitors[u];l&&l(u,a.arguments,t,r)}}),s=LL(i),s.globals.forEach(function(o){var a=mCt+o;!r.hasOwnProperty(a)&&t.getSignal(o)&&(r[a]=t.signalRef(o))}),{$expr:n?n+"return("+s.code+");":s.code,$fields:s.fields,$params:r}}function eH(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function SO(e,t,n,r){return new eH(e,t,n,r)}function CO(e,t){return SO("operator",e,t)}function Qe(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}var bxe={$tupleid:1,toString:function(){return":_tupleid_:"}};function s2(e,t){return t?{$field:e,$name:t}:{$field:e}}var zL=s2("key");function vxe(e,t){return{$compare:e,$order:t}}function gCt(e,t){var n={$key:e};return t&&(n.$flat=!0),n}var yCt="ascending",bCt="descending";function vCt(e){return yt(e)?(e.order===bCt?"-":"+")+tH(e.op,e.field):""}function tH(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var nH="scope",BL="view";function pm(e){return e&&e.signal}function UL(e){if(pm(e))return!0;if(yt(e)){for(var t in e)if(UL(e[t]))return!0}return!1}function vu(e,t){return e??t}function Ap(e){return e&&e.signal||e}var _ee="timer";function o2(e,t){var n=e.merge?wCt:e.stream?SCt:e.type?CCt:he("Invalid stream specification: "+Fe(e));return n(e,t)}function xCt(e){return e===nH?BL:e||BL}function wCt(e,t){var n=e.merge.map(function(i){return o2(i,t)}),r=rH({merge:n},e,t);return t.addStream(r).id}function SCt(e,t){var n=o2(e.stream,t),r=rH({stream:n},e,t);return t.addStream(r).id}function CCt(e,t){var n,r;return e.type===_ee?(n=t.event(_ee,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(xCt(e.source),e.type),r=rH({stream:n},e,t),Object.keys(r).length===1?n:t.addStream(r).id}function rH(e,t,n){var r=t.between;return r&&(r.length!==2&&he('Stream "between" parameter must have 2 entries: '+Fe(t)),e.between=[o2(r[0],n),o2(r[1],n)]),r=t.filter?xt(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(kCt(t.marktype,t.markname,t.markrole)),t.source===nH&&r.push("inScope(event.item)"),r.length&&(e.filter=Bl("("+r.join(")&&(")+")").$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function kCt(e,t,n){var r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const $Ct="view",TA="[",AA="]",xxe="{",wxe="}",_Ct=":",Sxe=",",ECt="@",TCt=">",ACt=/[[\]{}]/,NCt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Cxe,kxe;function ICt(e,t,n){return Cxe=t||$Ct,kxe=NCt,$xe(e.trim()).map(WL)}function DCt(e){return kxe[e]}function Wx(e,t,n,r,i){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return t}function $xe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=Wx(e,i,Sxe,TA+xxe,AA+wxe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function WL(e){return e[0]==="["?OCt(e):FCt(e)}function OCt(e){const t=e.length;let n=1,r;if(n=Wx(e,n,AA,TA,AA),n===t)throw"Empty between selector: "+e;if(r=$xe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==TCt)throw"Expected '>' after between selector: "+e;r=r.map(WL);const i=WL(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function FCt(e){const t={source:Cxe},n=[];let r=[0,0],i=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===wxe){if(a=e.lastIndexOf(xxe),a>=0){try{r=RCt(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===ECt&&(i=++a),u=Wx(e,a,_Ct),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=Wx(e,a,TA),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Wx(e,a,AA),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==TA)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||ACt.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):DCt(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function RCt(e){const t=e.split(Sxe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}var Eee="var datum=event.item&&event.item.datum;";function MCt(e,t,n){var r=e.events,i=e.update,s=e.encode,o=[],a="",u;r||he("Signal update missing events specification."),ft(r)&&(r=ICt(r,t.isSubscope()?nH:BL)),r=xt(r).filter(function(l){return l.signal||l.scale?(o.push(l),0):1}),r.length&&o.push(r.length>1?{merge:r}:r[0]),s!=null&&(i&&he("Signal encode and update are mutually exclusive."),i="encode(item(),"+Fe(s)+")"),a=ft(i)?Bl(i,t,Eee):i.expr!=null?Bl(i.expr,t,Eee):i.value!=null?i.value:i.signal!=null?{$expr:"_.value",$params:{value:t.signalRef(i.signal)}}:he("Invalid signal update specification."),u={target:n,update:a},e.force&&(u.options={force:!0}),o.forEach(function(l){t.addUpdate(on(PCt(l,t),u))})}function PCt(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):o2(e,t)}}function LCt(e,t){var n=t.getSignal(e.name),r=e.update;e.init&&(r?he("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Bl(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(function(i){MCt(i,t,n.id)})}function hn(e){return function(t,n,r){return SO(e,n,t||void 0,r)}}var _xe=hn("aggregate"),zCt=hn("axisticks"),Exe=hn("bound"),ju=hn("collect"),Txe=hn("compare"),BCt=hn("datajoin"),Axe=hn("encode"),UCt=hn("expression"),WCt=hn("facet"),VCt=hn("field"),jCt=hn("key"),HCt=hn("legendentries"),GCt=hn("load"),qCt=hn("mark"),XCt=hn("multiextent"),KCt=hn("multivalues"),YCt=hn("overlap"),ZCt=hn("params"),Nxe=hn("prefacet"),QCt=hn("projection"),JCt=hn("proxy"),ekt=hn("relay"),Ixe=hn("render"),tkt=hn("scale"),rg=hn("sieve"),nkt=hn("sortitems"),Dxe=hn("viewlayout"),rkt=hn("values"),ikt=0,kO=["identity","ordinal","band","point","bin-linear","bin-ordinal","quantize","quantile","threshold","linear","pow","sqrt","log","sequential","time","utc"],skt=Ft(kO),okt=Ft(kO.slice(4,9)),akt=Ft(kO.slice(9)),ukt=Ft(kO.slice(1,6));function NA(e){return ukt.hasOwnProperty(e)}function Tee(e){return okt.hasOwnProperty(e)}function lkt(e){return akt.hasOwnProperty(e)}function Oxe(e){return e==="quantile"}function ckt(e,t){var n=e.type||"linear";skt.hasOwnProperty(n)||he("Unrecognized scale type: "+Fe(n)),t.addScale(e.name,{type:n,domain:void 0})}function fkt(e,t){var n=t.getScale(e.name).params,r;n.domain=Fxe(e.domain,e,t),e.range!=null&&(n.range=Mxe(e,t,n)),e.interpolate!=null&&wkt(e.interpolate,n),e.nice!=null&&xkt(e.nice,n);for(r in e)n.hasOwnProperty(r)||r==="name"||(n[r]=wa(e[r],t))}function wa(e,t){return yt(e)?e.signal?t.signalRef(e.signal):he("Unsupported object: "+Fe(e)):e}function dkt(e,t){return e.signal?t.signalRef(e.signal):e.map(function(n){return wa(n,t)})}function $O(e){he("Can not find data set: "+Fe(e))}function Fxe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&he("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(be(e)?hkt:e.fields?mkt:pkt)(e,t,n)}function hkt(e,t,n){return e.map(function(r){return wa(r,n)})}function pkt(e,t,n){var r=n.getData(e.data);return r||$O(e.data),NA(t.type)?r.valuesRef(n,e.field,Rxe(e.sort,!1)):Oxe(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function mkt(e,t,n){var r=e.data,i=e.fields.reduce(function(s,o){return o=ft(o)?{data:r,field:o}:be(o)||o.signal?gkt(o,n):o,s.push(o),s},[]);return(NA(t.type)?ykt:Oxe(t.type)?bkt:vkt)(e,n,i)}function gkt(e,t){var n="_:vega:_"+ikt++,r=ju({});if(be(e))r.value={$ingest:e};else if(e.signal){var i="setdata("+Fe(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,rg({})]),{data:n,field:"data"}}function ykt(e,t,n){var r,i,s,o;return r=n.map(function(a){var u=t.getData(a.data);return u||$O(a.data),u.countsRef(t,a.field)}),i=t.add(_xe({groupby:zL,ops:["sum"],fields:[t.fieldRef("count")],as:["count"],pulse:r})),s=t.add(ju({pulse:Qe(i)})),o=t.add(rkt({field:zL,sort:t.sortRef(Rxe(e.sort,!0)),pulse:Qe(s)})),Qe(o)}function Rxe(e,t){return e&&(!e.field&&!e.op?yt(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?he("No field provided for sort aggregate op: "+e.op):t&&e.field?he("Multiple domain scales can not sort by field."):t&&e.op&&e.op!=="count"&&he("Multiple domain scales support op count only.")),e}function bkt(e,t,n){var r=n.map(function(i){var s=t.getData(i.data);return s||$O(i.data),s.domainRef(t,i.field)});return Qe(t.add(KCt({values:r})))}function vkt(e,t,n){var r=n.map(function(i){var s=t.getData(i.data);return s||$O(i.data),s.extentRef(t,i.field)});return Qe(t.add(XCt({extents:r})))}function xkt(e,t){t.nice=yt(e)?{interval:wa(e.interval),step:wa(e.step)}:wa(e)}function wkt(e,t){t.interpolate=wa(e.type||e),e.gamma!=null&&(t.interpolateGamma=wa(e.gamma))}function Mxe(e,t,n){var r=e.range,i=t.config.range;if(r.signal)return t.signalRef(r.signal);if(ft(r)){if(i&&i.hasOwnProperty(r))return e=on({},e,{range:i[r]}),Mxe(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=NA(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:he("Unrecognized scale range value: "+Fe(r))}else if(r.scheme){n.scheme=wa(r.scheme,t),r.extent&&(n.schemeExtent=dkt(r.extent,t)),r.count&&(n.schemeCount=wa(r.count,t));return}else if(r.step){n.rangeStep=wa(r.step,t);return}else{if(NA(e.type)&&!be(r))return Fxe(r,e,t);be(r)||he("Unsupported range type: "+Fe(r))}return r.map(function(s){return wa(s,t)})}function Skt(e,t){var n={};for(var r in e)r!=="name"&&(n[r]=Pxe(e[r],r,t));t.addProjection(e.name,n)}function Pxe(e,t,n){return be(e)?e.map(function(r){return Pxe(r,t,n)}):yt(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:he("Unsupported parameter object: "+Fe(e)):e}var Li="top",ig="left",iH="right",Rc="bottom",Ckt="center",kkt="vertical",$kt="start",_kt="end",VL="index",sH="label",Ekt="offset",w1="perc",Tkt="perc2",Aee="size",Ea="value",_O="guide-label",Lxe="guide-title",Akt="group-title",Nee="symbol",Q_="gradient",jL="discrete",oH=["size","shape","fill","stroke","strokeDash","opacity"],EO={name:1,interactive:1},Nkt=Ft(["rule"]),Iee=Ft(["group","image","rect"]);function Ikt(e,t){var n="";return Nkt[t]||(e.x2&&(e.x?(Iee[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(Iee[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Dkt(e,t,n,r){function i(s,o,a,u){var l=_0(null,o,t,n,r),c=_0(null,a,t,n,r),f=_0(null,u,t,n,r);return"this."+s+"("+[l,c,f].join(",")+").toString()"}return e.c?i("hcl",e.h,e.c,e.l):e.h||e.s?i("hsl",e.h,e.s,e.l):e.l||e.a?i("lab",e.l,e.a,e.b):e.r||e.g||e.b?i("rgb",e.r,e.g,e.b):null}function TO(e,t,n,r){var i=Bl(e,t);return i.$fields.forEach(function(s){r[s]=1}),on(n,i.$params),i.$expr}function zxe(e,t,n,r){return Bxe(yt(e)?e:{datum:e},t,n,r)}function Bxe(e,t,n,r){var i,s,o;if(e.signal)i="datum",o=TO(e.signal,t,n,r);else if(e.group||e.parent){for(s=Math.max(1,e.level||1),i="item";s-- >0;)i+=".mark.group";e.parent?(o=e.parent,i+=".datum"):o=e.group}else e.datum?(i="datum",o=e.datum):he("Invalid field reference: "+Fe(e));return e.signal||(ft(o)?(r[o]=1,o=Hl(o).map(Fe).join("][")):o=Bxe(o,t,n,r)),i+"["+o+"]"}function Okt(e,t,n,r,i){var s=Uxe(e.scale,n,r,i),o,a,u;return e.range!=null?(o=+e.range,a=s+".range()",t=o===0?a+"[0]":"($="+a+","+(o===1?"$[$.length-1]":"$[0]+"+o+"*($[$.length-1]-$[0])")+")"):(t!==void 0&&(t=s+"("+t+")"),e.band&&(u=Fkt(e.scale,n))&&(a=s+".bandwidth",o=+e.band,o=a+"()"+(o===1?"":"*"+o),u<0&&(o="("+a+"?"+o+":0)"),t=(t?t+"+":"")+o,e.extra&&(t="(datum.extra?"+s+"(datum.extra.value):"+t+")")),t==null&&(t="0")),t}function Fkt(e,t){if(!ft(e))return-1;var n=t.scaleType(e);return n==="band"||n==="point"?1:0}function Uxe(e,t,n,r){var i;if(ft(e))i=Z_+e,n.hasOwnProperty(i)||(n[i]=t.scaleRef(e)),i=Fe(i);else{for(i in t.scales)n[Z_+i]=t.scaleRef(i);i=Fe(Z_)+"+"+(e.signal?"("+TO(e.signal,t,n,r)+")":zxe(e,t,n,r))}return"_["+i+"]"}function Rkt(e,t,n,r){return"this.gradient("+Uxe(e.gradient,t,n,r)+","+Fe(e.start)+","+Fe(e.stop)+","+Fe(e.count)+")"}function NM(e,t,n,r){return yt(e)?"("+_0(null,e,t,n,r)+")":e}function _0(e,t,n,r,i){if(t.gradient!=null)return Rkt(t,n,r,i);var s=t.signal?TO(t.signal,n,r,i):t.color?Dkt(t.color,n,r,i):t.field!=null?zxe(t.field,n,r,i):t.value!==void 0?Fe(t.value):void 0;return t.scale!=null&&(s=Okt(t,s,n,r,i)),s===void 0&&(s=null),t.exponent!=null&&(s="Math.pow("+s+","+NM(t.exponent,n,r,i)+")"),t.mult!=null&&(s+="*"+NM(t.mult,n,r,i)),t.offset!=null&&(s+="+"+NM(t.offset,n,r,i)),t.round&&(s="Math.round("+s+")"),s}function Wxe(e,t,n){return e+"["+Fe(t)+"]="+n+";"}function Mkt(e,t,n,r,i){var s="";return t.forEach(function(o){var a=_0(e,o,n,r,i);s+=o.test?TO(o.test,n,r,i)+"?"+a+":":a}),Vt(s)===":"&&(s+="null"),Wxe("o",e,s)}function Pkt(e,t,n,r){var i={},s="var o=item,datum=o.datum,$;",o,a,u;for(o in e)a=e[o],be(a)?s+=Mkt(o,a,r,n,i):(u=_0(o,a,r,n,i),s+=Wxe("o",o,u));return s+=Ikt(e,t),s+="return 1;",{$expr:s,$fields:Object.keys(i),$output:Object.keys(e)}}var aH="mark",uH="frame",lH="scope",Lkt="axis",zkt="axis-domain",Bkt="axis-grid",Ukt="axis-label",Wkt="axis-tick",Vkt="axis-title",jkt="legend",Hkt="legend-band",Gkt="legend-entry",qkt="legend-gradient",Vxe="legend-label",Xkt="legend-symbol",Kkt="legend-title",Ykt="title";function vr(e){return yt(e)?on({},e):{value:e}}function $e(e,t,n,r){return n!=null?(yt(n)&&!be(n)?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function QC(e,t,n){for(var r in t)n&&n.hasOwnProperty(r)||(e[r]=on(e[r]||{},t[r]));return e}function jxe(e,t,n,r,i,s){var o,a;s=s||{},s.encoders={$encode:o={}},e=Zkt(e,t,n,r,i.config);for(a in e)o[a]=Pkt(e[a],t,s,i);return s}function Zkt(e,t,n,r,i){var s={},o,a,u;(n=="legend"||String(n).indexOf("axis")===0)&&(n=null),u=n===uH?i.group:n===aH?on({},i.mark,i[t]):null;for(o in u)a=s0(o,e)||(o==="fill"||o==="stroke")&&(s0("fill",e)||s0("stroke",e)),a||(s[o]=Dee(u[o]));return xt(r).forEach(function(l){var c=i.style&&i.style[l];for(var f in c)s0(f,e)||(s[f]=Dee(c[f]))}),e=on({},e),e.enter=on(s,e.enter),e}function Dee(e){return e&&e.signal?{signal:e.signal}:{value:e}}function s0(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function Ma(e,t,n,r,i,s,o){return{type:e,name:o?o.name:void 0,role:t,style:o&&o.style||n,key:r,from:i,interactive:!!(o&&o.interactive),encode:QC(s,o,EO)}}function ce(e,t,n){return vu(t[e],n[e])}function JC(e,t){return vu(e.direction,t)===kkt}function AO(e,t){return vu(e.gradientLength,t.gradientLength||t.gradientWidth)}function cH(e,t){return vu(e.gradientThickness,t.gradientThickness||t.gradientHeight)}function Qkt(e,t){return vu(e.columns,vu(t.columns,+JC(e,t.symbolDirection)))}function HL(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Jkt(e,t,n){var r=t.config.style[n];return r&&r[e]}var NO="group",Hxe="rect",fH="rule",e$t="symbol",hb="text";function t$t(e,t,n,r){var i={value:0},s=JC(e,n.gradientDirection),o=cH(e,n),a=AO(e,n),u,l,c,f,d,h;return s?(c=[0,1],f=[0,0],d=o,h=a):(c=[0,0],f=[1,0],d=a,h=o),u={enter:l={opacity:i,x:i,y:i,width:vr(d),height:vr(h)},update:on({},l,{opacity:{value:1},fill:{gradient:t,start:c,stop:f}}),exit:{opacity:i}},$e(u,"stroke",ce("gradientStrokeColor",e,n)),$e(u,"strokeWidth",ce("gradientStrokeWidth",e,n)),$e(u,"opacity",ce("gradientOpacity",e,n),"update"),Ma(Hxe,qkt,null,void 0,void 0,u,r)}function n$t(e,t,n,r,i){var s={value:0},o=JC(e,n.gradientDirection),a=cH(e,n),u=AO(e,n),l,c,f,d,h,p,m="";return o?(f="y",h="y2",d="x",p="width",m="1-"):(f="x",h="x2",d="y",p="height"),c={opacity:s,fill:{scale:t,field:Ea}},c[f]={signal:m+"datum."+w1,mult:u},c[d]=s,c[h]={signal:m+"datum."+Tkt,mult:u},c[p]=vr(a),l={enter:c,update:on({},c,{opacity:{value:1}}),exit:{opacity:s}},$e(l,"stroke",ce("gradientStrokeColor",e,n)),$e(l,"strokeWidth",ce("gradientStrokeWidth",e,n)),$e(l,"opacity",ce("gradientOpacity",e,n),"update"),Ma(Hxe,Hkt,null,Ea,i,l,r)}var r$t="datum."+w1+'<=0?"left":datum.'+w1+'>=1?"right":"center"',i$t="datum."+w1+'<=0?"bottom":datum.'+w1+'>=1?"top":"middle"';function Oee(e,t,n,r){var i={value:0},s=JC(e,t.gradientDirection),o=vr(cH(e,t)),a=AO(e,t),u=ce("labelOverlap",e,t),l,c,f,d,h,p="";return l={enter:c={opacity:i},update:f={opacity:{value:1},text:{field:sH}},exit:{opacity:i}},$e(l,"fill",ce("labelColor",e,t)),$e(l,"font",ce("labelFont",e,t)),$e(l,"fontSize",ce("labelFontSize",e,t)),$e(l,"fontWeight",ce("labelFontWeight",e,t)),$e(l,"fillOpacity",ce("labelOpacity",e,t)),$e(l,"limit",vu(e.labelLimit,t.gradientLabelLimit)),s?(c.align={value:"left"},c.baseline=f.baseline={signal:i$t},d="y",h="x",p="1-"):(c.align=f.align={signal:r$t},c.baseline={value:"top"},d="x",h="y"),c[d]=f[d]={signal:p+"datum."+w1,mult:a},c[h]=f[h]=o,o.offset=vu(e.labelOffset,t.gradientLabelOffset)||0,e=Ma(hb,Vxe,_O,Ea,r,l,n),u&&(e.overlap={method:u,order:"datum."+VL}),e}function IA(e,t,n,r,i,s,o,a){return{type:NO,name:n,role:e,style:t,from:r,interactive:i||!1,encode:s,marks:o,layout:a}}var Nf={value:0};function s$t(e,t,n,r,i){var s=n.entries,o=!!(s&&s.interactive),a=s?s.name:void 0,u=ce("clipHeight",e,t),l=ce("symbolOffset",e,t),c={data:"value"},f={},d=i+"?datum."+Ekt+":datum."+Aee,h=u?vr(u):{field:Aee},p="datum."+VL,m="max(1,"+i+")",g,y,b,v,x,w,S;return h.mult=.5,f={enter:g={opacity:Nf,x:{signal:d,mult:.5,offset:l},y:h},update:y={opacity:{value:1},x:g.x,y:g.y},exit:{opacity:Nf}},e.fill||($e(f,"fill",t.symbolBaseFillColor),$e(f,"stroke",t.symbolBaseStrokeColor)),$e(f,"shape",ce("symbolType",e,t)),$e(f,"size",ce("symbolSize",e,t)),$e(f,"strokeWidth",ce("symbolStrokeWidth",e,t)),$e(f,"fill",ce("symbolFillColor",e,t)),$e(f,"stroke",ce("symbolStrokeColor",e,t)),$e(f,"opacity",ce("symbolOpacity",e,t),"update"),oH.forEach(function(C){e[C]&&(y[C]=g[C]={scale:e[C],field:Ea})}),v=Ma(e$t,Xkt,null,Ea,c,f,n.symbols),u&&(v.clip=!0),b=vr(l),b.offset=ce("labelOffset",e,t),f={enter:g={opacity:Nf,x:{signal:d,offset:b},y:h},update:y={opacity:{value:1},text:{field:sH},x:g.x,y:g.y},exit:{opacity:Nf}},$e(f,"align",ce("labelAlign",e,t)),$e(f,"baseline",ce("labelBaseline",e,t)),$e(f,"fill",ce("labelColor",e,t)),$e(f,"font",ce("labelFont",e,t)),$e(f,"fontSize",ce("labelFontSize",e,t)),$e(f,"fontWeight",ce("labelFontWeight",e,t)),$e(f,"limit",ce("labelLimit",e,t)),$e(f,"fillOpacity",ce("labelOpacity",e,t)),x=Ma(hb,Vxe,_O,Ea,c,f,n.labels),f={enter:{noBound:{value:!0},width:Nf,height:u?vr(u):Nf,opacity:Nf},exit:{opacity:Nf},update:y={opacity:{value:1},row:{signal:null},column:{signal:null}}},JC(e,t.symbolDirection)?(w="ceil(item.mark.items.length/"+m+")",y.row.signal=p+"%"+w,y.column.signal="floor("+p+"/"+w+")",S={field:["row",p]}):(y.row.signal="floor("+p+"/"+m+")",y.column.signal=p+"%"+m,S={field:p}),y.column.signal=i+"?"+y.column.signal+":"+p,r={facet:{data:r,name:"value",groupby:VL}},e=IA(lH,null,a,r,o,QC(f,s,EO),[v,x]),e.sort=S,e}function o$t(e,t){return{align:ce("gridAlign",e,t),center:{row:!0,column:!1},columns:Qkt(e,t),padding:{row:ce("rowPadding",e,t),column:ce("columnPadding",e,t)}}}function a$t(e,t,n,r){var i={value:0},s,o;return s={enter:o={opacity:i,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},update:{opacity:{value:1},text:vr(e.title),x:o.x,y:o.y},exit:{opacity:i}},$e(s,"align",ce("titleAlign",e,t)),$e(s,"baseline",ce("titleBaseline",e,t)),$e(s,"fill",ce("titleColor",e,t)),$e(s,"font",ce("titleFont",e,t)),$e(s,"fontSize",ce("titleFontSize",e,t)),$e(s,"fontWeight",ce("titleFontWeight",e,t)),$e(s,"limit",ce("titleLimit",e,t)),$e(s,"fillOpacity",ce("titleOpacity",e,t)),Ma(hb,Kkt,Lxe,null,r,s,n)}function u$t(e,t){var n;return yt(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Fee(e.path)+")":e.sphere&&(n="geoShape("+Fee(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Fee(e){return yt(e)&&e.signal?e.signal:Fe(e)}function Gxe(e){var t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")?t:e.type===NO?lH:t||aH}function l$t(e){return{marktype:e.type,name:e.name||void 0,role:e.role||Gxe(e),zindex:+e.zindex||void 0}}function c$t(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function dH(e,t){var n=tme(e.type);n||he("Unrecognized transform type: "+Fe(e.type));var r=SO(n.type.toLowerCase(),null,qxe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function qxe(e,t,n){var r={},i,s,o;for(s=0,o=e.params.length;s<o;++s)i=e.params[s],r[i.name]=f$t(i,t,n);return r}function f$t(e,t,n){var r=e.type,i=t[e.name];if(r==="index")return d$t(e,t,n);if(i===void 0){e.required&&he("Missing required "+Fe(t.type)+" parameter: "+Fe(e.name));return}else{if(r==="param")return h$t(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!pm(i)?i.map(function(s){return Ree(e,s,n)}):Ree(e,i,n)}function Ree(e,t,n){var r=e.type;if(pm(t))return Pee(r)?he("Expression references can not be signals."):IM(r)?n.fieldRef(t):Lee(r)?n.compareRef(t):n.signalRef(t.signal);var i=e.expr||IM(r);return i&&p$t(t)?n.exprRef(t.expr,t.as):i&&m$t(t)?s2(t.field,t.as):Pee(r)?Bl(t,n):g$t(r)?Qe(n.getData(t).values):IM(r)?s2(t):Lee(r)?n.compareRef(t):t}function d$t(e,t,n){return ft(t.from)||he('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function h$t(e,t,n){var r=t[e.name];return e.array?(be(r)||he("Expected an array of sub-parameters. Instead: "+Fe(r)),r.map(function(i){return Mee(e,i,n)})):Mee(e,r,n)}function Mee(e,t,n){var r,i,s,o,a;for(o=0,a=e.params.length;o<a;++o){i=e.params[o];for(s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}return i||he("Unsupported parameter: "+Fe(t)),r=on(qxe(i,t,n),i.key),Qe(n.add(ZCt(r)))}function p$t(e){return e&&e.expr}function m$t(e){return e&&e.field}function g$t(e){return e==="data"}function Pee(e){return e==="expr"}function IM(e){return e==="field"}function Lee(e){return e==="compare"}function y$t(e,t,n){var r,i,s,o,a;return e?(r=e.facet)&&(t||he("Only group marks can be faceted."),r.field!=null?o=a=J_(r,n):(e.data?a=Qe(n.getData(e.data).aggregate):(s=dH(on({type:"aggregate",groupby:xt(r.groupby)},r.aggregate),n),s.params.key=n.keyRef(r.groupby),s.params.pulse=J_(r,n),o=a=Qe(n.add(s))),i=n.keyRef(r.groupby,!0))):o=Qe(n.add(ju(null,[{}]))),o||(o=J_(e,n)),{key:i,pulse:o,parent:a}}function J_(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Qe(t.getData(e.data).output)}function mm(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}mm.fromEntries=function(e,t){var n=t.length,r=1,i=t[0],s=t[n-1],o=t[n-2],a=null;for(e.add(t[0]);r<n;++r)t[r].params.pulse=Qe(t[r-1]),e.add(t[r]),t[r].type==="aggregate"&&(a=t[r]);return new mm(e,i,o,s,a)};var sg=mm.prototype;sg.countsRef=function(e,t,n){var r=this,i=r.counts||(r.counts={}),s=Xxe(t),o,a,u;return s!=null&&(e=r.scope,o=i[s]),o?n&&n.field&&zee(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:Qe(r.output)},n&&n.field&&zee(e,u,n),a=e.add(_xe(u)),o=e.add(ju({pulse:Qe(a)})),o={agg:a,ref:Qe(o)},s!=null&&(i[s]=o)),o.ref};function Xxe(e){return ft(e)?e:null}function zee(e,t,n){var r=tH(n.op,n.field),i;if(t.ops){for(var s=0,o=t.as.length;s<o;++s)if(t.as[s]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function ek(e,t,n,r,i,s,o){var a=t[n]||(t[n]={}),u=vCt(s),l=Xxe(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){var d=s?{field:zL,pulse:t.countsRef(e,i,s)}:{field:e.fieldRef(i),pulse:Qe(t.output)};u&&(d.sort=e.sortRef(s)),f=e.add(SO(r,void 0,d)),o&&(t.index[i]=f),c=Qe(f),l!=null&&(a[l]=c)}return c}sg.tuplesRef=function(){return Qe(this.values)};sg.extentRef=function(e,t){return ek(e,this,"extent","extent",t,!1)};sg.domainRef=function(e,t){return ek(e,this,"domain","values",t,!1)};sg.valuesRef=function(e,t,n){return ek(e,this,"vals","values",t,n||!0)};sg.lookupRef=function(e,t){return ek(e,this,"lookup","tupleindex",t,!1)};sg.indataRef=function(e,t){return ek(e,this,"indata","tupleindex",t,!0,!0)};function b$t(e,t,n){var r=e.from.facet,i=r.name,s=J_(r,t),o,a,u,l;r.name||he("Facet must have a name: "+Fe(r)),r.data||he("Facet must reference a data set: "+Fe(r)),r.field?l=t.add(Nxe({field:t.fieldRef(r.field),pulse:s})):r.groupby?l=t.add(WCt({key:t.keyRef(r.groupby),group:Qe(t.proxy(n.parent)),pulse:s})):he("Facet must specify groupby or field: "+Fe(r)),o=t.fork(),a=o.add(ju()),u=o.add(rg({pulse:Qe(a)})),o.addData(i,new mm(o,a,a,u)),o.addSignal("parent",null),l.params.subflow={$subflow:DO(e,o).toRuntime()}}function v$t(e,t,n){var r=t.add(Nxe({pulse:n.pulse})),i=t.fork();i.add(rg()),i.addSignal("parent",null),r.params.subflow={$subflow:DO(e,i).toRuntime()}}function Kxe(e,t,n){var r=e.remove,i=e.insert,s=e.toggle,o=e.modify,a=e.values,u=t.add(CO()),l,c;l="if("+e.trigger+',modify("'+n+'",'+[i,r,s,o,a].map(function(f){return f??"null"}).join(",")+"),0)",c=Bl(l,t),u.update=c.$expr,u.params=c.$params}function IO(e,t){var n=Gxe(e),r=e.type===NO,i=e.from&&e.from.facet,s=e.layout||n===lH||n===uH,o=n===aH||s||i,a=e.overlap,u,l,c,f,d,h,p,m,g,y,b,v,x;c=y$t(e.from,r,t),l=t.add(BCt({key:c.key||(e.key?s2(e.key):void 0),pulse:c.pulse,clean:!r})),g=Qe(l),l=f=t.add(ju({pulse:g})),l=t.add(qCt({markdef:l$t(e),interactive:c$t(e.interactive,t),clip:u$t(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Qe(l)})),y=Qe(l),l=t.add(Axe(jxe(e.encode,e.type,n,e.style,t,{pulse:y}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(function(w){var S=dH(w,t);(S.metadata.generates||S.metadata.changes)&&he("Mark transforms should not generate new data."),S.params.pulse=Qe(l),t.add(l=S)}),e.sort&&(l=t.add(nkt({sort:t.compareRef(e.sort,!0),pulse:Qe(l)}))),b=Qe(l),(i||s)&&(s=t.add(Dxe({layout:t.objectProperty(e.layout),legendMargin:t.config.legendMargin,mark:y,pulse:b})),v=Qe(s)),d=t.add(Exe({mark:y,pulse:v||b})),x=Qe(d),r&&(o&&(u=t.operators,u.pop(),s&&u.pop()),t.pushState(b,v||x,g),i?b$t(e,t,c):o?v$t(e,t,c):DO(e,t),t.popState(),o&&(s&&u.push(s),u.push(d))),a&&(x=x$t(a,x,t)),h=t.add(Ixe({pulse:x})),p=t.add(rg({pulse:Qe(h)},void 0,t.parent())),e.name!=null&&(m=e.name,t.addData(m,new mm(t,f,h,p)),e.on&&e.on.forEach(function(w){(w.insert||w.remove||w.toggle)&&he("Marks only support modify triggers."),Kxe(w,t,m)}))}function x$t(e,t,n){var r=e.method,i=e.bound,s,o={method:pm(r)?n.signalRef(r.signal):r,pulse:t};return e.order&&(o.sort=n.compareRef({field:e.order})),i&&(s=i.tolerance,o.boundTolerance=pm(s)?n.signalRef(s.signal):+s,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient),Qe(n.add(YCt(o)))}function w$t(e,t){var n=t.config.legend,r=e.encode||{},i=r.legend||{},s=i.name||void 0,o=i.interactive,a=i.style,u,l,c,f,d,h,p,m,g,y=oH.reduce(function(b,v){return b||e[v]},0);return y||he("Missing valid scale for legend."),d=S$t(e,t.scaleType(y)),h={orient:ce("orient",e,n),title:e.title!=null,type:d},p=Qe(t.add(ju(null,[h]))),i=QC(k$t(e,n),i,EO),u={enter:{x:{value:0},y:{value:0}}},m=Qe(t.add(HCt(c={type:d,scale:t.scaleRef(y),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)}))),d===Q_?(f=[t$t(e,y,n,r.gradient),Oee(e,n,r.labels,m)],c.count=c.count||t.signalRef("max(2,2*floor(("+Ap(AO(e,n))+")/100))")):d===jL?f=[n$t(e,y,n,r.gradient,m),Oee(e,n,r.labels,m)]:(l=o$t(e,n),f=[s$t(e,n,r,m,Ap(l.columns))],c.size=$$t(e,t,f[0].marks)),f=[IA(Gkt,null,null,p,o,u,f,l)],h.title&&f.push(a$t(e,n,r.title,p)),g=IA(jkt,a,s,p,o,i,f),e.zindex&&(g.zindex=e.zindex),IO(g,t)}function S$t(e,t){var n=e.type||Nee;return!e.type&&C$t(e)===1&&(e.fill||e.stroke)&&(n=lkt(t)?Q_:Tee(t)?jL:Nee),n!==Q_?n:Tee(t)?jL:Q_}function C$t(e){return oH.reduce(function(t,n){return t+(e[n]?1:0)},0)}function k$t(e,t){var n={enter:{},update:{}};return $e(n,"offset",ce("offset",e,t)),$e(n,"padding",ce("padding",e,t)),$e(n,"titlePadding",ce("titlePadding",e,t)),$e(n,"fill",ce("fillColor",e,t)),$e(n,"stroke",ce("strokeColor",e,t)),$e(n,"strokeWidth",ce("strokeWidth",e,t)),$e(n,"cornerRadius",ce("cornerRadius",e,t)),$e(n,"strokeDash",t.strokeDash),n}function $$t(e,t,n){var r,i,s,o;return s=HL("strokeWidth",n[0].encode),i=e.size?'scale("'+e.size+'",datum)':HL("size",n[0].encode),r=_$t(n[1].encode,t,_O),o="max(ceil(sqrt("+Ap(i)+")+"+Ap(s)+"),"+Ap(r)+")",Bl(o,t)}function _$t(e,t,n){return HL("fontSize",e)||Jkt("fontSize",t,n)}function Yxe(e,t,n){return'item.anchor==="'+$kt+'"?'+e+':item.anchor==="'+_kt+'"?'+t+":"+n}var E$t=Yxe(Fe(ig),Fe(iH),Fe(Ckt)),T$t=Yxe('+(item.orient==="'+iH+'")','+(item.orient!=="'+ig+'")',"0.5");function A$t(e,t){e=ft(e)?{text:e}:e;var n=t.config.title,r=on({},e.encode),i,s,o;return i={orient:ce("orient",e,n)},s=Qe(t.add(ju(null,[i]))),r.name=e.name,r.interactive=e.interactive,o=N$t(e,n,r,s),e.zindex&&(o.zindex=e.zindex),IO(o,t)}function N$t(e,t,n,r){var i={value:0},s=e.text,o=ce("orient",e,t),a=ce("anchor",e,t),u=o===ig||o===Li?-1:1,l=o===Li||o===Rc,c={group:l?"width":"height"},f,d,h,p,m;return p={field:c,mult:{signal:T$t}},m=u<0?i:l?{field:{group:"height"}}:{field:{group:"width"}},f={enter:d={opacity:i},update:h={opacity:{value:1},text:vr(s),anchor:vr(a),orient:vr(o),extent:{field:c},align:{signal:E$t}},exit:{opacity:i}},l?(h.x=p,h.y=m,d.angle=i,d.baseline={value:o===Li?Rc:Li}):(h.x=m,h.y=p,d.angle={value:u*90},d.baseline={value:Rc}),$e(f,"align",ce("align",e,t),"update"),$e(f,"angle",ce("angle",e,t)),$e(f,"baseline",ce("baseline",e,t)),$e(f,"fill",ce("color",e,t)),$e(f,"font",ce("font",e,t)),$e(f,"fontSize",ce("fontSize",e,t)),$e(f,"fontWeight",ce("fontWeight",e,t)),$e(f,"frame",ce("frame",e,t)),$e(f,"limit",ce("limit",e,t)),$e(f,"offset",ce("offset",e,t)||0),Ma(hb,Ykt,e.style||Akt,null,r,f,n)}function I$t(e,t){var n=[];e.transform&&e.transform.forEach(function(r){n.push(dH(r,t))}),e.on&&e.on.forEach(function(r){Kxe(r,t,e.name)}),t.addDataPipeline(e.name,D$t(e,t,n))}function D$t(e,t,n){var r=[],i=null,s=!1,o=!1,a,u,l,c,f;for(e.values?r.push(i=vv({$ingest:e.values,$format:e.format})):e.url?(i=UL(e.url)||UL(e.format)?{$load:Qe(t.add(O$t(t,e)))}:{$request:e.url,$format:e.format},r.push(i=vv(i))):e.source&&(i=a=xt(e.source).map(function(d){return Qe(t.getData(d).output)}),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=vv()),r.push(c),f.generates&&(o=!0),f.modifies&&!o&&(s=!0),f.source?i=c:f.changes&&(i=null);return a&&(l=a.length-1,r[0]=ekt({derive:s,pulse:l?a:a[0]}),(s||l)&&r.splice(1,0,vv())),i||r.push(vv()),r.push(rg({})),r}function vv(e){var t=ju({},e);return t.metadata={source:!0},t}function O$t(e,t){return GCt({url:e.property(t.url),format:e.objectProperty(t.format)})}function F$t(e,t){var n=t.config,r=e.orient,i=r===Li||r===Rc?n.axisX:n.axisY,s=n["axis"+r[0].toUpperCase()+r.slice(1)],o=t.scaleType(e.scale)==="band"&&n.axisBand;return i||s||o?on({},n.axis,i,s,o):n.axis}function R$t(e,t,n,r){var i=e.orient,s={value:0},o,a,u,l,c,f;return o={enter:a={opacity:s},update:u={opacity:{value:1}},exit:{opacity:s}},$e(o,"stroke",ce("domainColor",e,t)),$e(o,"strokeWidth",ce("domainWidth",e,t)),$e(o,"strokeOpacity",ce("domainOpacity",e,t)),i===Li||i===Rc?(l="x",f="y"):(l="y",f="x"),c=l+"2",a[f]=s,u[l]=a[l]=Bee(e,0),u[c]=a[c]=Bee(e,1),Ma(fH,zkt,null,null,r,o,n)}function Bee(e,t){return{scale:e.scale,range:t}}function M$t(e,t,n,r){var i=e.orient,s=e.gridScale,o=i===ig||i===Li?1:-1,a=o*e.offset||0,u={value:0},l,c,f,d,h,p,m,g,y;return l={enter:c={opacity:u},update:d={opacity:{value:1}},exit:f={opacity:u}},$e(l,"stroke",ce("gridColor",e,t)),$e(l,"strokeDash",ce("gridDash",e,t)),$e(l,"strokeOpacity",ce("gridOpacity",e,t)),$e(l,"strokeWidth",ce("gridWidth",e,t)),h={scale:e.scale,field:Ea,band:ce("bandPosition",e,t),round:ce("tickRound",e,t),extra:ce("tickExtra",e,t),offset:ce("tickOffset",e,t)},i===Li||i===Rc?(p="x",m="y",y="height"):(p="y",m="x",y="width"),g=m+"2",d[p]=c[p]=f[p]=h,s?(c[m]={scale:s,range:0,mult:o,offset:a},d[g]=c[g]={scale:s,range:1,mult:o,offset:a}):(c[m]={value:a},d[g]=c[g]={signal:y,mult:o,offset:a}),Ma(fH,Bkt,null,Ea,r,l,n)}function P$t(e,t,n,r,i){var s=e.orient,o=s===ig||s===Li?-1:1,a={value:0},u,l,c,f,d,h;return u={enter:l={opacity:a},update:f={opacity:{value:1}},exit:c={opacity:a}},$e(u,"stroke",ce("tickColor",e,t)),$e(u,"strokeOpacity",ce("tickOpacity",e,t)),$e(u,"strokeWidth",ce("tickWidth",e,t)),d=vr(i),d.mult=o,h={scale:e.scale,field:Ea,band:ce("bandPosition",e,t),round:ce("tickRound",e,t),extra:ce("tickExtra",e,t),offset:ce("tickOffset",e,t)},s===Li||s===Rc?(f.y=l.y=a,f.y2=l.y2=d,f.x=l.x=c.x=h):(f.x=l.x=a,f.x2=l.x2=d,f.y=l.y=c.y=h),Ma(fH,Wkt,null,Ea,r,u,n)}function DM(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function L$t(e,t,n,r,i){var s=e.orient,o=s===ig||s===Li?-1:1,a=s===Li||s===Rc,u=e.scale,l=Ap(ce("labelFlush",e,t)),c=Ap(ce("labelFlushOffset",e,t)),f=l===0||!!l,d=ce("labelAlign",e,t),h=ce("labelBaseline",e,t),p={value:0},m,g,y,b,v,x,w,S,C;return y=vr(i),y.mult=o,y.offset=vr(ce("labelPadding",e,t)||0),y.offset.mult=o,b={scale:u,field:Ea,band:.5,offset:ce("tickOffset",e,t)},a?(v=d||(f?DM(u,l,'"left"','"right"','"center"'):"center"),x=h||(s===Li?"bottom":"top"),w=!d):(v=d||(s===iH?"left":"right"),x=h||(f?DM(u,l,'"top"','"bottom"','"middle"'):"middle"),w=!h),w=w&&f&&c?DM(u,l,"-"+c,c,0):null,m={enter:g={opacity:p,x:a?b:y,y:a?y:b},update:{opacity:{value:1},text:{field:sH},x:g.x,y:g.y},exit:{opacity:p,x:g.x,y:g.y}},$e(m,a?"dx":"dy",w),$e(m,"align",v),$e(m,"baseline",x),$e(m,"angle",ce("labelAngle",e,t)),$e(m,"fill",ce("labelColor",e,t)),$e(m,"font",ce("labelFont",e,t)),$e(m,"fontSize",ce("labelFontSize",e,t)),$e(m,"fontWeight",ce("labelFontWeight",e,t)),$e(m,"limit",ce("labelLimit",e,t)),$e(m,"fillOpacity",ce("labelOpacity",e,t)),S=ce("labelBound",e,t),C=ce("labelOverlap",e,t),e=Ma(hb,Ukt,_O,Ea,r,m,n),(C||S)&&(e.overlap={method:C,order:"datum.index",bound:S?{scale:u,orient:s,tolerance:S}:null}),e}function z$t(e,t,n,r){var i=e.orient,s=i===ig||i===Li?-1:1,o=i===Li||i===Rc,a={value:0},u,l,c,f;return u={enter:l={opacity:a},update:c={opacity:{value:1},text:vr(e.title)},exit:{opacity:a}},f={scale:e.scale,range:.5},o?(c.x=f,l.angle={value:0},l.baseline={value:i===Li?"bottom":"top"}):(c.y=f,l.angle={value:s*90},l.baseline={value:"bottom"}),$e(u,"align",ce("titleAlign",e,t)),$e(u,"angle",ce("titleAngle",e,t)),$e(u,"baseline",ce("titleBaseline",e,t)),$e(u,"fill",ce("titleColor",e,t)),$e(u,"font",ce("titleFont",e,t)),$e(u,"fontSize",ce("titleFontSize",e,t)),$e(u,"fontWeight",ce("titleFontWeight",e,t)),$e(u,"limit",ce("titleLimit",e,t)),$e(u,"fillOpacity",ce("titleOpacity",e,t)),!$e(u,"x",ce("titleX",e,t),"update")&&o&&!s0("x",n)&&(u.enter.auto={value:!0}),!$e(u,"y",ce("titleY",e,t),"update")&&!o&&!s0("y",n)&&(u.enter.auto={value:!0}),Ma(hb,Vkt,Lxe,null,r,u,n)}function B$t(e,t){var n=F$t(e,t),r=e.encode||{},i=r.axis||{},s=i.name||void 0,o=i.interactive,a=i.style,u,l,c,f,d,h;return u={orient:e.orient,ticks:!!ce("ticks",e,n),labels:!!ce("labels",e,n),grid:!!ce("grid",e,n),domain:!!ce("domain",e,n),title:!!vu(e.title,!1)},l=Qe(t.add(ju({},[u]))),i=QC({update:{range:{signal:'abs(span(range("'+e.scale+'")))'},offset:vr(vu(e.offset,0)),position:vr(vu(e.position,0)),titlePadding:vr(ce("titlePadding",e,n)),minExtent:vr(ce("minExtent",e,n)),maxExtent:vr(ce("maxExtent",e,n))}},r.axis,EO),c=Qe(t.add(zCt({scale:t.scaleRef(e.scale),extra:t.property(ce("tickExtra",e,n)),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)}))),h=[],u.grid&&h.push(M$t(e,n,r.grid,c)),u.ticks&&(f=ce("tickSize",e,n),h.push(P$t(e,n,r.ticks,c,f))),u.labels&&(f=u.ticks?f:0,h.push(L$t(e,n,r.labels,c,f))),u.domain&&h.push(R$t(e,n,r.domain,l)),u.title&&h.push(z$t(e,n,r.title,l)),d=IA(Lkt,a,s,l,o,i,h),e.zindex&&(d.zindex=e.zindex),IO(d,t)}function DO(e,t,n){var r=xt(e.signals),i=xt(e.scales);return n||r.forEach(function(s){Xve(s,t)}),xt(e.projections).forEach(function(s){Skt(s,t)}),i.forEach(function(s){ckt(s,t)}),xt(e.data).forEach(function(s){I$t(s,t)}),i.forEach(function(s){fkt(s,t)}),r.forEach(function(s){LCt(s,t)}),xt(e.axes).forEach(function(s){B$t(s,t)}),xt(e.marks).forEach(function(s){IO(s,t)}),xt(e.legends).forEach(function(s){w$t(s,t)}),e.title&&A$t(e.title,t),t.parseLambdas(),t}var U$t=Ft(["width","height","padding","autosize"]);function W$t(e,t){var n=t.config,r,i,s,o,a;return t.background=e.background||n.background,t.eventConfig=n.events,a=Qe(t.root=t.add(CO())),t.addSignal("width",e.width||0),t.addSignal("height",e.height||0),t.addSignal("padding",Vwt(e.padding,n)),t.addSignal("autosize",Wwt(e.autosize,n)),xt(e.signals).forEach(function(u){U$t[u.name]||Xve(u,t)}),i=t.add(ju()),s=QC({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e.encode),s=t.add(Axe(jxe(s,NO,uH,e.style,t,{pulse:Qe(i)}))),o=t.add(Dxe({layout:t.objectProperty(e.layout),legendMargin:n.legendMargin,autosize:t.signalRef("autosize"),mark:a,pulse:Qe(s)})),t.operators.pop(),t.pushState(Qe(s),Qe(o),null),DO(e,t,!0),t.operators.push(o),r=t.add(Exe({mark:a,pulse:Qe(o)})),r=t.add(Ixe({pulse:Qe(r)})),r=t.add(rg({pulse:Qe(r)})),t.addData("root",new mm(t,i,i,r)),t}function Zxe(e){this.config=e,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this.eventConfig=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Qxe(e){this.config=e.config,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}var _t=Zxe.prototype=Qxe.prototype;_t.fork=function(){return new Qxe(this)};_t.isSubscope=function(){return this._subid>0};_t.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}};_t.id=function(){return(this._subid?this._subid+":":0)+this._id++};_t.add=function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(function(t){t.$ref=e.id}),e.refs=null),e};_t.proxy=function(e){var t=e instanceof eH?Qe(e):e;return this.add(JCt({value:t}))};_t.addStream=function(e){return this.streams.push(e),e.id=this.id(),e};_t.addUpdate=function(e){return this.updates.push(e),e};_t.finish=function(){var e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,s,o){var a,u;i&&(a=i.data||(i.data={}),u=a[s]||(a[s]=[]),u.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(var r in t.index)n(t.index[r],e,"index:"+r)}return this};_t.pushState=function(e,t,n){this._encode.push(Qe(this.add(rg({pulse:e})))),this._parent.push(t),this._lookup.push(n?Qe(this.proxy(n)):null),this._markpath.push(-1)};_t.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()};_t.parent=function(){return Vt(this._parent)};_t.encode=function(){return Vt(this._encode)};_t.lookup=function(){return Vt(this._lookup)};_t.markpath=function(){var e=this._markpath;return++e[e.length-1]};_t.fieldRef=function(e,t){if(ft(e))return s2(e,t);e.signal||he("Unsupported field reference: "+Fe(e));var n=e.signal,r=this.field[n],i;return r||(i={name:this.signalRef(n)},t&&(i.as=t),this.field[n]=r=Qe(this.add(VCt(i)))),r};_t.compareRef=function(e,t){function n(a){return pm(a)?(i=!0,r.signalRef(a.signal)):a}var r=this,i=!1,s=xt(e.field).map(n),o=xt(e.order).map(n);return t&&s.push(bxe),i?Qe(this.add(Txe({fields:s,orders:o}))):vxe(s,o)};_t.keyRef=function(e,t){function n(s){return pm(s)?(i=!0,Qe(r[s.signal])):s}var r=this.signals,i=!1;return e=xt(e).map(n),i?Qe(this.add(jCt({fields:e,flat:t}))):gCt(e,t)};_t.sortRef=function(e){if(!e)return e;var t=[tH(e.op,e.field),bxe],n=e.order||yCt;return n.signal?Qe(this.add(Txe({fields:t,orders:[n=this.signalRef(n.signal),n]}))):vxe(t,[n,n])};_t.event=function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]};_t.addSignal=function(e,t){this.signals.hasOwnProperty(e)&&he("Duplicate signal name: "+Fe(e));var n=t instanceof eH?t:this.add(CO(t));return this.signals[e]=n};_t.getSignal=function(e){return this.signals[e]||he("Unrecognized signal name: "+Fe(e)),this.signals[e]};_t.signalRef=function(e){return this.signals[e]?Qe(this.signals[e]):(this.lambdas.hasOwnProperty(e)||(this.lambdas[e]=this.add(CO(null))),Qe(this.lambdas[e]))};_t.parseLambdas=function(){for(var e=Object.keys(this.lambdas),t=0,n=e.length;t<n;++t){var r=e[t],i=Bl(r,this),s=this.lambdas[r];s.params=i.$params,s.update=i.$expr}};_t.property=function(e){return e&&e.signal?this.signalRef(e.signal):e};_t.objectProperty=function(e){return!e||!yt(e)?e:this.signalRef(e.signal||hH(e))};function hH(e){return(be(e)?V$t:j$t)(e)}function V$t(e){for(var t="[",n=0,r=e.length,i;n<r;++n)i=e[n],t+=(n>0?",":"")+(yt(i)?i.signal||hH(i):Fe(i));return t+"]"}function j$t(e){var t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+Fe(r)+":"+(yt(i)?i.signal||hH(i):Fe(i));return t+"}"}_t.exprRef=function(e,t){var n={expr:Bl(e,this)};return t&&(n.expr.$name=t),Qe(this.add(UCt(n)))};_t.addBinding=function(e,t){this.bindings||he("Nested signals do not support binding: "+Fe(e)),this.bindings.push(on({signal:e},t))};_t.addScaleProj=function(e,t){this.scales.hasOwnProperty(e)&&he("Duplicate scale or projection name: "+Fe(e)),this.scales[e]=this.add(t)};_t.addScale=function(e,t){this.addScaleProj(e,tkt(t))};_t.addProjection=function(e,t){this.addScaleProj(e,QCt(t))};_t.getScale=function(e){return this.scales[e]||he("Unrecognized scale name: "+Fe(e)),this.scales[e]};_t.projectionRef=_t.scaleRef=function(e){return Qe(this.getScale(e))};_t.projectionType=_t.scaleType=function(e){return this.getScale(e).params.type};_t.addData=function(e,t){return this.data.hasOwnProperty(e)&&he("Duplicate data set name: "+Fe(e)),this.data[e]=t};_t.getData=function(e){return this.data[e]||he("Undefined data set name: "+Fe(e)),this.data[e]};_t.addDataPipeline=function(e,t){return this.data.hasOwnProperty(e)&&he("Duplicate data set name: "+Fe(e)),this.addData(e,mm.fromEntries(this,t))};function H$t(e){var t=G$t();return(e||[]).forEach(function(n){var r,i,s;if(n)for(r in n)if(r==="style"){s=t.style||(t.style={});for(r in n.style)s[r]=on(s[r]||{},n.style[r])}else i=n[r],t[r]=yt(i)&&!be(i)?on(yt(t[r])?t[r]:{},i):i}),t}var V$="sans-serif",OM=30,j$=2,Ah="#4c78a8",xv="#000",FM="#888",RM="#ddd";function G$t(){return{padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:Ah},area:{fill:Ah},image:null,line:{stroke:Ah,strokeWidth:j$},path:{stroke:Ah},rect:{fill:Ah},rule:{stroke:xv},shape:{stroke:Ah},symbol:{fill:Ah,size:64},text:{fill:xv,font:V$,fontSize:11},style:{"guide-label":{fill:xv,font:V$,fontSize:10},"guide-title":{fill:xv,font:V$,fontSize:11,fontWeight:"bold"},"group-title":{fill:xv,font:V$,fontSize:13,fontWeight:"bold"},point:{size:OM,strokeWidth:j$,shape:"circle"},circle:{size:OM,strokeWidth:j$},square:{size:OM,strokeWidth:j$,shape:"square"},cell:{fill:"transparent",stroke:RM}},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:FM,grid:!1,gridWidth:1,gridColor:RM,labels:!0,labelAngle:0,labelLimit:180,labelPadding:2,ticks:!0,tickColor:FM,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titleAlign:"center",titlePadding:4},axisBand:{tickOffset:-1},legend:{orient:"right",offset:18,padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:RM,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:FM,titleAlign:"left",titleBaseline:"top",titleLimit:180,titlePadding:5},title:{orient:"top",anchor:"middle",offset:4},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues",extent:[.2,1]},heatmap:{scheme:"viridis"},ramp:{scheme:"blues",extent:[.2,1]},diverging:{scheme:"blueorange"},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function q$t(e,t){return yt(e)||he("Input Vega specification must be an object."),W$t(e,new Zxe(H$t([t,e.config]))).toRuntime()}function tk(e,t,n){t[t.length-1]!==";"&&(t="return("+t+");");var r=Function.apply(null,e.concat(t));return n&&n.functions?r.bind(n.functions):r}function X$t(e,t){return tk(["_"],e,t)}function K$t(e,t){return tk(["datum","_"],e,t)}function Jxe(e,t){return tk(["event"],e,t)}function Y$t(e,t){return tk(["_","event"],e,t)}function Z$t(e,t){return tk(["item","_"],e,t)}function pH(e,t,n){n=n||{};var r,i;for(r in e)i=e[r],n[r]=be(i)?i.map(function(s){return Uee(s,t,n)}):Uee(i,t,n);return n}function Uee(e,t,n){if(!e||!yt(e))return e;for(var r=0,i=Wee.length,s;r<i;++r)if(s=Wee[r],e.hasOwnProperty(s.key))return s.parse(e,t,n);return e}var Wee=[{key:"$ref",parse:Q$t},{key:"$key",parse:e_t},{key:"$expr",parse:J$t},{key:"$field",parse:t_t},{key:"$encode",parse:r_t},{key:"$compare",parse:n_t},{key:"$context",parse:i_t},{key:"$subflow",parse:s_t},{key:"$tupleid",parse:o_t}];function Q$t(e,t){return t.get(e.$ref)||he("Operator not defined: "+e.$ref)}function J$t(e,t,n){e.$params&&pH(e.$params,t,n);var r="e:"+e.$expr+"_"+e.$name;return t.fn[r]||(t.fn[r]=co(K$t(e.$expr,t),e.$fields,e.$name))}function e_t(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=NU(e.$key,e.$flat))}function t_t(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Vo(e.$field,e.$name))}function n_t(e,t){var n="c:"+e.$compare+"_"+e.$order,r=xt(e.$compare).map(function(i){return i&&i.$tupleid?Je:i});return t.fn[n]||(t.fn[n]=EU(r,e.$order))}function r_t(e,t){var n=e.$encode,r={},i,s;for(i in n)s=n[i],r[i]=co(Z$t(s.$expr,t),s.$fields),r[i].output=s.$output;return r}function i_t(e,t){return t}function s_t(e,t){var n=e.$subflow;return function(r,i,s){var o=gH(n,t.fork()),a=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(s),a}}function o_t(){return Je}function mH(e){return(e+"").toLowerCase()}function a_t(e){return mH(e)==="operator"}function u_t(e){return mH(e)==="collect"}function l_t(e,t){a_t(e.type)||!e.type?t.operator(e,e.update?X$t(e.update,t):null):t.transform(e,e.type)}function c_t(e,t){if(e.params){var n=t.get(e.id);n||he("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(pH(e.params,t),e.react,e.initonly))}}function f_t(e,t){var n=e.filter!=null?Jxe(e.filter,t):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(t.get.bind(t)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(t.get.bind(t)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&he("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function d_t(e,t){var n=yt(n=e.source)?n.$ref:n,r=t.get(n),i=null,s=e.update,o=void 0;r||he("Source not defined: "+e.source),e.target&&e.target.$expr?i=Jxe(e.target.$expr,t):i=t.get(e.target),s&&s.$expr&&(s.$params&&(o=pH(s.$params,t)),s=Y$t(s.$expr,t)),t.update(e,r,i,s,o)}function gH(e,t){var n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),n.forEach(function(r){l_t(r,t)}),n.forEach(function(r){c_t(r,t)}),(e.streams||[]).forEach(function(r){f_t(r,t)}),(e.updates||[]).forEach(function(r){d_t(r,t)}),t.resolve()}var h_t={skip:!0};function p_t(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(function(s){var o=t.signals[s];e.signals(s,o)&&(r[s]=o.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(function(s){var o=t.data[s];e.data(s,o)&&(i[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(function(s){return s.getState(e)})),n}function m_t(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(function(s){n.update(t.signals[s],i[s],h_t)}),Object.keys(r||{}).forEach(function(s){n.pulse(t.data[s].input,n.changeset().remove(ih).insert(r[s]))}),(e.subcontext||[]).forEach(function(s,o){var a=t.subcontext[o];a&&a.setState(s)})}function ewe(e,t,n){return new twe(e,t,n)}function twe(e,t,n){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Vee(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.functions=e.functions,this.events=e.events,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}twe.prototype=Vee.prototype={fork:function(){var e=new Vee(this);return(this.subcontext||(this.subcontext=[])).push(e),e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,i;if(n.set(e.id,t),u_t(e.type)&&(i=e.value)&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$load?n.get(i.$load.$ref).target=t:i.$request?r.request(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){var s=n.get(e.parent.$ref);s?(r.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(function(){s=n.get(e.parent.$ref),r.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(var o in e.data)i=n.data[o]||(n.data[o]={}),e.data[o].forEach(function(a){i[a]=t})},resolve:function(){return(this.unresolved||[]).forEach(function(e){e()}),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[mH(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},getState:p_t,setState:m_t};function g_t(e,t,n){var r=n||EA;return gH(t,ewe(e,n1,r))}function y_t(e){var t=this._runtime.scales;return t.hasOwnProperty(e)||he("Unrecognized scale or projection: "+e),t[e].value}var nwe="width",rwe="height",yH="padding",jee={skip:!0};function iwe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===yH?r.left+r.right:0)}function swe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===yH?r.top+r.bottom:0)}function b_t(e){var t=e._signals,n=t[nwe],r=t[rwe],i=t[yH];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,function(a){e._width=a.size,e._viewWidth=iwe(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,function(a){e._height=a.size,e._viewHeight=swe(e,a.size),s()},{size:r});var o=e.add(null,s,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function v_t(e,t,n,r,i,s){this.runAfter(function(o){var a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(nwe,n,jee),o._resizeWidth.skip(!0)),o.height()!==r&&(a=1,o.signal(rwe,r,jee),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),a&&o.run("enter"),s&&o.runAfter(function(){o.resize()})},!1,1)}function x_t(e){return this._runtime.getState(e||{data:w_t,signals:S_t,recurse:!0})}function w_t(e,t){return t.modified&&be(t.input.value)&&e.indexOf("_:vega:_")}function S_t(e,t){return!(e==="parent"||t instanceof n1.proxy)}function C_t(e){var t=this;return t.runAfter(function(){t._trigger=!1,t._runtime.setState(e),t.run().runAfter(function(){t._trigger=!0})}),this}function k_t(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(tvt(n,t))}function $_t(e,t,n,r){var i=e.element();i&&i.setAttribute("title",__t(r))}function __t(e){return e==null?"":be(e)?owe(e):yt(e)&&!Qs(e)?E_t(e):e+""}function E_t(e){return Object.keys(e).map(function(t){var n=e[t];return t+": "+(be(n)?owe(n):awe(n))}).join(`
`)}function owe(e){return"["+e.map(awe).join(", ")+"]"}function awe(e){return be(e)?"[]":yt(e)&&!Qs(e)?"{}":e}function uwe(e,t){var n=this;t=t||{},sb.call(n),n.loader(t.loader||n._loader),n.logLevel(t.logLevel||0),n._el=null,n._renderType=t.renderer||Kf.Canvas,n._scenegraph=new ZW;var r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||$_t,n._redraw=!0,n._handler=new OC().scene(r),n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[];var i=g_t(n,e,t.functions);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(function(s){return{state:null,param:on({},s)}}),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._background=i.background||null,n._eventConfig=xwt(i.eventConfig),n._width=n.width(),n._height=n.height(),n._viewWidth=iwe(n,n._width),n._viewHeight=swe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,b_t(n),lwt(n)}var bt=Ne(uwe,sb);bt.run=function(e){if(sb.prototype.run.call(this,e),this._pending)this.resize();else if(this._redraw||this._resize)try{this.render()}catch(t){this.error(t)}return this};bt.render=function(){return this._renderer&&(this._resize&&(this._resize=0,pwt(this)),this._renderer.render(this._scenegraph.root)),this._redraw=!1,this};bt.dirty=function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)};bt.container=function(){return this._el};bt.scenegraph=function(){return this._scenegraph};bt.origin=function(){return this._origin.slice()};function OO(e,t){return e._signals.hasOwnProperty(t)?e._signals[t]:he("Unrecognized signal name: "+Fe(t))}bt.signal=function(e,t,n){var r=OO(this,e);return arguments.length===1?r.value:this.update(r,t,n)};bt.background=function(e){return arguments.length?(this._background=e,this._resize=1,this):this._background};bt.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")};bt.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")};bt.padding=function(e){return arguments.length?this.signal("padding",e):this.signal("padding")};bt.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")};bt.renderer=function(e){return arguments.length?(RD(e)||he("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType};bt.tooltip=function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip};bt.loader=function(e){return arguments.length?(e!==this._loader&&(sb.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader};bt.resize=function(){return this._autosize=1,this.touch(OO(this,"autosize"))};bt._resetRenderer=function(){this._renderer&&(this._renderer=null,this.initialize(this._el))};bt._resizeView=v_t;bt.addEventListener=function(e,t,n){var r=t;return n&&n.trap===!1||(r=Gj(this,t),r.raw=t),this._handler.on(e,r),this};bt.removeEventListener=function(e,t){for(var n=this._handler.handlers(e),r=n.length,i,s;--r>=0;)if(s=n[r].type,i=n[r].handler,e===s&&(t===i||t===i.raw)){this._handler.off(s,i);break}return this};bt.addResizeListener=function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this};bt.removeResizeListener=function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this};function lwe(e,t){var n=e._targets||[],r=n.filter(function(i){var s=i._update;return s&&s.handler===t});return r.length?r[0]:null}function cwe(e,t,n,r){var i=lwe(n,r);return i||(i=Gj(this,function(){r(t,n.value)}),i.handler=r,e.on(n,null,i)),e}function fwe(e,t,n){var r=lwe(t,n);return r&&t._targets.remove(r),e}bt.addSignalListener=function(e,t){return cwe(this,e,OO(this,e),t)};bt.removeSignalListener=function(e,t){return fwe(this,OO(this,e),t)};bt.addDataListener=function(e,t){return cwe(this,e,mO(this,e).values,t)};bt.removeDataListener=function(e,t){return fwe(this,mO(this,e).values,t)};bt.preventDefault=function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault};bt.timer=k_t;bt.events=Swt;bt.finalize=kwt;bt.hover=Cwt;bt.data=fwt;bt.change=Hj;bt.insert=dwt;bt.remove=hwt;bt.scale=y_t;bt.initialize=Pwt;bt.toImageURL=Lwt;bt.toCanvas=Bwt;bt.toSVG=Uwt;bt.getState=x_t;bt.setState=C_t;on(n1,jut,sdt,xmt,$bt,gvt,vxt,Uxt,Jxt,awt);const T_t=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Es,CanvasHandler:OC,CanvasRenderer:OT,Dataflow:sb,Debug:SU,Error:xU,EventStream:fD,Gradient:hge,GroupItem:xD,Handler:lh,Info:yT,Item:vD,Marks:ql,MultiPulse:XU,None:hpe,Operator:gn,Parameters:cD,Pulse:ah,RenderType:Kf,Renderer:zu,ResourceLoader:OW,SVGHandler:JW,SVGRenderer:tV,SVGStringRenderer:rV,Scenegraph:ZW,Transform:ue,View:uwe,Warn:wU,accessor:co,accessorFields:Zs,accessorName:ka,array:xt,ascending:TU,bandwidthNRD:pme,bin:mme,bootstrapCI:gme,boundClip:c0e,boundContext:fo,boundItem:$P,boundMark:Kge,boundStroke:mf,changeset:rb,clampRange:Tit,closeTag:hi,compare:EU,constant:Rl,cumulativeLogNormal:Sme,cumulativeNormal:rW,cumulativeUniform:Eme,debounce:AU,definition:tme,densityLogNormal:wme,densityNormal:bme,densityUniform:_me,domChild:Sl,domClear:Qc,domCreate:y0,domFind:QW,dotbin:yat,error:he,expressionFunction:Un,extend:on,extent:Oit,extentIndex:wpe,falsy:sc,fastmap:tb,field:Vo,flush:Rit,font:DD,fontFamily:DC,fontSize:uh,format:j_,formatLocale:vV,formats:zpe,hasOwnProperty:os,id:xC,identity:Fl,inferType:Dpe,inferTypes:Ope,ingest:nr,inherits:Ne,inrange:Mit,interpolate:p1e,interpolateRange:d1e,isArray:be,isBoolean:nb,isDate:Qs,isFunction:Ot,isIterable:Pit,isNumber:Rr,isObject:yt,isRegExp:Spe,isString:ft,isTuple:uD,key:NU,lerp:Lit,loader:dD,logger:CU,lruCache:Bit,merge:Cpe,mergeConfig:Sit,one:iD,openTag:di,pad:kpe,panLinear:bpe,panLog:vpe,panPow:xpe,panSymlog:kit,parse:q$t,pathCurves:zW,pathEqual:f0e,pathParse:o1,pathRectangle:Oge,pathRender:kD,pathSymbols:Dge,pathTrail:Fge,peek:Vt,point:OD,projection:mj,quantileLogNormal:Cme,quantileNormal:iW,quantileUniform:Tme,quantiles:hme,quarter:_it,quartiles:tW,get random(){return Fa},randomInteger:xat,randomKDE:vme,randomLCG:vat,randomLogNormal:Cat,randomMixture:kme,randomNormal:sW,randomUniform:Ame,read:qU,regressionConstant:Nme,regressionExp:$at,regressionLinear:Ime,regressionLoess:Nat,regressionLog:kat,regressionPoly:Eat,regressionPow:_at,regressionQuad:Dme,renderModule:RD,repeat:Hv,resetSVGClipId:Nct,runtime:gH,runtimeContext:ewe,sampleCurve:Rat,sampleLogNormal:xme,sampleNormal:nW,sampleUniform:$me,scale:GD,sceneEqual:iV,sceneFromJSON:Zge,scenePickVisit:IT,sceneToJSON:Yge,sceneVisit:Au,sceneZOrder:UW,scheme:UP,schemeDiscretized:vpt,setRandom:gat,span:Uit,splitAccessPath:Hl,stringValue:Fe,textMetrics:DT,timeFormatLocale:Gpe,timeInterval:iye,toBoolean:IU,toDate:DU,toNumber:Sr,toSet:Ft,toString:OU,transform:nme,transforms:n1,truncate:$pe,truthy:ih,tupleid:Je,typeParsers:dP,utcInterval:sye,utcquarter:Eit,version:uwt,visitArray:Mf,writeConfig:kU,zero:dpe,zoomLinear:$U,zoomLog:_U,zoomPow:vT,zoomSymlog:$it},Symbol.toStringTag,{value:"Module"})),A_t="vega-lite",N_t='Jeffrey Heer, Dominik Moritz, Kanit "Ham" Wongsuphasawat',I_t="3.0.0-rc12",D_t=["Kanit Wongsuphasawat <kanitw@gmail.com> (http://kanitw.yellowpigz.com)","Dominik Moritz <domoritz@cs.washington.edu> (https://www.domoritz.de)","Jeffrey Heer <jheer@uw.edu> (http://jheer.org)"],O_t="https://vega.github.io/vega-lite/",F_t="Vega-Lite is a concise high-level language for interactive visualization.",R_t="build/vega-lite.js",M_t="build/vega-lite.min.js",P_t="build/vega-lite.min.js",L_t="build/src/index",z_t="build/src/index.d.ts",B_t={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},U_t={test:"test"},W_t={prebuild:"mkdir -p build/src",build:"npm run build:only","build:only":"tsc && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && npm run schema","build:examples":"npm run build:only","postbuild:examples":"npm run data && TZ=America/Los_Angeles scripts/build-examples.sh","build:examples-full":"npm run build:only","postbuild:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"bundle exec jekyll build -q && scripts/generate-toc","build:site":"tsc -p site && webpack --config site/webpack.config.js","build:versions":"scripts/update-version.sh",clean:"rm -rf build && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' -type f -delete",data:"rsync -r node_modules/vega-datasets/data/* data",deploy:"scripts/deploy.sh","deploy:gh":"scripts/deploy-gh.sh","deploy:schema":"scripts/deploy-schema.sh",preschema:"npm run prebuild",schema:"node --stack-size=2800 ./node_modules/.bin/ts-json-schema-generator --no-type-check --path tsconfig.json --type TopLevelSpec > build/vega-lite-schema.json && npm run renameschema && cp build/vega-lite-schema.json _data/",renameschema:"scripts/rename-schema.sh",presite:"npm run prebuild && npm run data && npm run build:site && npm run build:toc && npm run build:versions && scripts/create-example-pages",site:"bundle exec jekyll serve --incremental",prettierbase:"prettier '{src,test,test-runtime,site,typings}/**/*.{ts,md,css}'",format:"tslint -p . --fix -e 'package.json' && npm run prettierbase -- --write",lint:"tslint -p . -e 'package.json' && npm run prettierbase -- --list-different",test:"jest test/ && npm run lint && npm run schema && jest examples/ && npm run test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":`TZ=America/Los_Angeles TS_NODE_COMPILER_OPTIONS='{"module":"commonjs"}' wdio wdio.conf.js`,"test:runtime:generate":"rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true npm run test:runtime","watch:build":"npm run build:only && concurrently --kill-others -n Typescript,Rollup 'tsc -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Webpack 'tsc -p site --watch' 'webpack --config site/webpack.config.js --mode development --watch'","watch:test":"jest --watch"},V_t={type:"git",url:"https://github.com/vega/vega-lite.git"},j_t="BSD-3-Clause",H_t={url:"https://github.com/vega/vega-lite/issues"},G_t={"@types/chai":"^4.1.7","@types/d3":"^5.5.0","@types/highlight.js":"^9.12.3","@types/jest":"^23.3.10","@types/mkdirp":"^0.5.2","@types/node":"10.12.18","@types/webdriverio":"^4.13.0",ajv:"^6.6.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.2",chromedriver:"^2.45.0",codecov:"^3.1.0",concurrently:"^4.1.0",d3:"^5.7.0","highlight.js":"^9.13.1",jest:"^23.6.0",mkdirp:"^0.5.1",prettier:"^1.15.3",rollup:"^1.0.0","rollup-plugin-commonjs":"^9.2.0","rollup-plugin-json":"^3.1.0","rollup-plugin-node-resolve":"^4.0.0","rollup-plugin-sourcemaps":"^0.4.2","source-map-support":"^0.5.9","svg2png-many":"^0.0.7",terser:"^3.13.1","ts-jest":"^23.10.5","ts-json-schema-generator":"^0.38.1","ts-node":"^7.0.1",tslint:"5.12.0","tslint-config-prettier":"^1.17.0","tslint-eslint-rules":"^5.4.0",typescript:"^3.2.2",vega:"^4.4.0","vega-datasets":"^1.20.0","vega-embed":"^3.28.0","vega-tooltip":"^0.15.0","wdio-chromedriver-service":"^0.1.5","wdio-dot-reporter":"0.0.10","wdio-mocha-framework":"^0.6.4","wdio-static-server-service":"^1.0.1",webdriverio:"^4.14.0",webpack:"^4.28.2","webpack-cli":"^3.1.2","yaml-front-matter":"^4.0.0"},q_t={"@types/clone":"^0.1.30",clone:"^2.1.2","fast-deep-equal":"^2.0.1","fast-json-stable-stringify":"^2.0.0","json-stringify-pretty-compact":"^1.2.0",tslib:"^1.9.3","vega-event-selector":"^2.0.0","vega-expression":"^2.4.0","vega-typings":"0.3.53","vega-util":"^1.7.1",yargs:"^12.0.5"},X_t={testURL:"http://localhost/",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["node_modules","test-runtime","<rootDir>/build","_site","src"],coverageDirectory:"./coverage/",collectCoverage:!1},K_t={name:A_t,author:N_t,version:I_t,collaborators:D_t,homepage:O_t,description:F_t,main:R_t,unpkg:M_t,jsdelivr:P_t,module:L_t,types:z_t,bin:B_t,directories:U_t,scripts:W_t,repository:V_t,license:j_t,bugs:H_t,devDependencies:G_t,dependencies:q_t,jest:X_t};var dwe={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var s;try{s=Promise}catch{s=function(){}}function o(d,h,p,m,g){typeof h=="object"&&(p=h.depth,m=h.prototype,g=h.includeNonEnumerable,h=h.circular);var y=[],b=[],v=typeof Buffer<"u";typeof h>"u"&&(h=!0),typeof p>"u"&&(p=1/0);function x(w,S){if(w===null)return null;if(S===0)return w;var C,k;if(typeof w!="object")return w;if(n(w,r))C=new r;else if(n(w,i))C=new i;else if(n(w,s))C=new s(function(V,F){w.then(function(B){V(x(B,S-1))},function(B){F(x(B,S-1))})});else if(o.__isArray(w))C=[];else if(o.__isRegExp(w))C=new RegExp(w.source,f(w)),w.lastIndex&&(C.lastIndex=w.lastIndex);else if(o.__isDate(w))C=new Date(w.getTime());else{if(v&&Buffer.isBuffer(w))return Buffer.allocUnsafe?C=Buffer.allocUnsafe(w.length):C=new Buffer(w.length),w.copy(C),C;n(w,Error)?C=Object.create(w):typeof m>"u"?(k=Object.getPrototypeOf(w),C=Object.create(k)):(C=Object.create(m),k=m)}if(h){var E=y.indexOf(w);if(E!=-1)return b[E];y.push(w),b.push(C)}n(w,r)&&w.forEach(function(V,F){var B=x(F,S-1),q=x(V,S-1);C.set(B,q)}),n(w,i)&&w.forEach(function(V){var F=x(V,S-1);C.add(F)});for(var _ in w){var T;k&&(T=Object.getOwnPropertyDescriptor(k,_)),!(T&&T.set==null)&&(C[_]=x(w[_],S-1))}if(Object.getOwnPropertySymbols)for(var D=Object.getOwnPropertySymbols(w),_=0;_<D.length;_++){var O=D[_],M=Object.getOwnPropertyDescriptor(w,O);M&&!M.enumerable&&!g||(C[O]=x(w[O],S-1),M.enumerable||Object.defineProperty(C,O,{enumerable:!1}))}if(g)for(var I=Object.getOwnPropertyNames(w),_=0;_<I.length;_++){var P=I[_],M=Object.getOwnPropertyDescriptor(w,P);M&&M.enumerable||(C[P]=x(w[P],S-1),Object.defineProperty(C,P,{enumerable:!1}))}return C}return x(d,p)}o.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function a(d){return Object.prototype.toString.call(d)}o.__objToStr=a;function u(d){return typeof d=="object"&&a(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&a(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&a(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(dwe);var Y_t=dwe.exports;const Z_t=O1(Y_t);var Hee=Array.isArray,Gee=Object.keys,Q_t=Object.prototype.hasOwnProperty,J_t=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){var r=Hee(t),i=Hee(n),s,o,a;if(r&&i){if(o=t.length,o!=n.length)return!1;for(s=o;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(r!=i)return!1;var u=t instanceof Date,l=n instanceof Date;if(u!=l)return!1;if(u&&l)return t.getTime()==n.getTime();var c=t instanceof RegExp,f=n instanceof RegExp;if(c!=f)return!1;if(c&&f)return t.toString()==n.toString();var d=Gee(t);if(o=d.length,o!==Gee(n).length)return!1;for(s=o;s--!==0;)if(!Q_t.call(n,d[s]))return!1;for(s=o;s--!==0;)if(a=d[s],!e(t[a],n[a]))return!1;return!0}return t!==t&&n!==n};const eEt=O1(J_t);var tEt=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(s){return function(o){return function(a,u){var l={key:a,value:o[a]},c={key:u,value:o[u]};return s(l,c)}}}(t.cmp),i=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var a,u;if(Array.isArray(o)){for(u="[",a=0;a<o.length;a++)a&&(u+=","),u+=s(o[a])||"null";return u+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(o)-1,c=Object.keys(o).sort(r&&r(o));for(u="",a=0;a<c.length;a++){var f=c[a],d=s(o[f]);d&&(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};const bH=O1(tEt);function vH(e){return!!e.or}function xH(e){return!!e.and}function wH(e){return!!e.not}function eE(e,t){if(wH(e))eE(e.not,t);else if(xH(e))for(const n of e.and)eE(n,t);else if(vH(e))for(const n of e.or)eE(n,t);else t(e)}function tE(e,t){return wH(e)?{not:tE(e.not,t)}:xH(e)?{and:e.and.map(n=>tE(n,t))}:vH(e)?{or:e.or.map(n=>tE(n,t))}:t(e)}const hwe=eEt,jt=Z_t;function DA(e){return new RegExp(`\\b${e}\\b`,"g")}function GL(e,t){const n={};for(const r of t)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function SH(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(bH).join(",")})`};const pn=bH;function mr(e){if(Rr(e))return e;const t=ft(e)?e:bH(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function et(e,t){return e.indexOf(t)>-1}function pwe(e,t){return e.filter(n=>!et(t,n))}function nEt(e,t){return e.concat(pwe(t,e))}function a2(e,t){let n=0;for(let r=0;r<e.length;r++)if(t(e[r],r,n++))return!0;return!1}function CH(e,t){let n=0;for(let r=0;r<e.length;r++)if(!t(e[r],r,n++))return!1;return!0}function Pd(e){return[].concat(...e)}function rEt(e,t){const n=new Array(t);for(let r=0;r<t;++r)n[r]=e;return n}function S1(e,...t){for(const n of t)e=iEt(e,n);return e}function iEt(e,t){if(typeof t!="object"||t===null)return e;for(const n in t)t.hasOwnProperty(n)&&t[n]!==void 0&&(typeof t[n]!="object"||be(t[n])||t[n]===null?e[n]=t[n]:typeof e[n]!="object"||e[n]===null?e[n]=S1(be(t[n].constructor)?[]:{},t[n]):S1(e[n],t[n]));return e}function o0(e,t){const n=[],r={};let i;for(const s of e)i=t(s),!(i in r)&&(r[i]=1,n.push(s));return n}function sEt(e,t){const n=Se(e),r=Se(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function mwe(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function kH(e,t){for(const n of e)if(t.has(n))return!0;return!1}function qL(e){const t=new Set;for(const n of e){const i=Hl(n).map((o,a)=>a===0?o:`[${o}]`);i.map((o,a)=>i.slice(0,a+1).join("")).forEach(o=>t.add(o))}return t}function gwe(e,t){return kH(qL(e),qL(t))}function oEt(e){return!isNaN(e)}function aEt(e,t){if(e.length!==t.length)return!0;e.sort(),t.sort();for(let n=0;n<e.length;n++)if(t[n]!==e[n])return!0;return!1}const Se=Object.keys;function Mc(e){const t=[];for(const n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}function uEt(e){const t=[];for(const n in e)e.hasOwnProperty(n)&&t.push({key:n,value:e[n]});return t}function _r(e){return Se(e)}function u2(e){return e===!0||e===!1}function Ul(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function E0(e,t){return wH(e)?"!("+E0(e.not,t)+")":xH(e)?"("+e.and.map(n=>E0(n,t)).join(") && (")+")":vH(e)?"("+e.or.map(n=>E0(n,t)).join(") || (")+")":t(e)}function OA(e,t){if(t.length===0)return!0;const n=t.shift();return OA(e[n],t)&&delete e[n],Se(e).length===0}function FO(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Ta(e,t="datum"){const n=Hl(e),r=[];for(let i=1;i<=n.length;i++){const s=`[${n.slice(0,i).map(Fe).join("][")}]`;r.push(`${t}${s}`)}return r.join(" && ")}function ywe(e,t="datum"){return`${t}[${Fe(Hl(e).join("."))}]`}function RO(e){return`${Hl(e).map(t=>t.replace(".","\\.")).join("\\.")}`}function bwe(e){return`${Hl(e).join(".")}`}function lx(e){return e?Hl(e).length:0}function ct(...e){for(const t of e)if(t!==void 0)return t}let vwe=42;function xwe(e){const t=++vwe;return e?String(e)+t:t}function lEt(){vwe=42}const cEt=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:lx,accessPathWithDatum:Ta,contains:et,deepEqual:hwe,deleteNestedProperty:OA,differArray:aEt,duplicate:jt,entries:uEt,every:CH,fieldIntersection:gwe,fill:rEt,flagKeys:_r,flatAccessWithDatum:ywe,flatten:Pd,getFirstDefined:ct,globalWholeWordRegExp:DA,hasIntersection:kH,hash:mr,isBoolean:u2,isEqual:sEt,isNumeric:oEt,keys:Se,logicalExpr:E0,mergeDeep:S1,omit:SH,pick:GL,prefixGenerator:qL,removePathFromField:bwe,replacePathInField:RO,resetIdCounter:lEt,setEqual:mwe,some:a2,stringify:pn,titlecase:FO,union:nEt,unique:o0,uniqueId:xwe,vals:Mc,varName:Ul,without:pwe},Symbol.toStringTag,{value:"Module"})),wwe={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},fEt=_r(wwe);function $H(e){return!!wwe[e]}const Swe=["count","valid","missing","distinct"];function Cwe(e){return e&&et(Swe,e)}function kwe(e){return e&&et(["min","max"],e)}const $we=["count","sum","distinct","valid","missing"],_we=["mean","average","median","q1","q3","min","max"],Ewe=Ft(_we),dEt=Object.freeze(Object.defineProperty({__proto__:null,AGGREGATE_OPS:fEt,COUNTING_OPS:Swe,SHARED_DOMAIN_OPS:_we,SHARED_DOMAIN_OP_INDEX:Ewe,SUM_OPS:$we,isAggregateOp:$H,isCountingAggregateOp:Cwe,isMinMaxOp:kwe},Symbol.toStringTag,{value:"Module"})),_H=["domain","grid","labels","ticks","title"],Twe={grid:"grid",gridColor:"grid",gridDash:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",domain:"main",domainColor:"main",domainOpacity:"main",domainWidth:"main",format:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontWeight:"main",labelLimit:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",maxExtent:"main",minExtent:"main",offset:"main",position:"main",tickColor:"main",tickExtra:"main",tickOffset:"both",tickOpacity:"main",tickRound:"main",ticks:"main",tickSize:"main",title:"main",titleAlign:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontWeight:"main",titleLimit:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",tickWidth:"both",tickCount:"both",values:"both",scale:"both",zindex:"both"},Awe={orient:1,bandPosition:1,domain:1,domainColor:1,domainOpacity:1,domainWidth:1,format:1,grid:1,gridColor:1,gridDash:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontWeight:1,labelLimit:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,maxExtent:1,minExtent:1,offset:1,position:1,tickColor:1,tickCount:1,tickExtra:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontWeight:1,titleLimit:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,values:1,zindex:1},Nwe=Object.assign({},Awe,{encoding:1,labelAngle:1,tickStep:1}),hEt=Object.assign({gridScale:1,scale:1},Awe,{encode:1});function Iwe(e){return!!Nwe[e]}const EH=_r(hEt),pEt=_r(Nwe),mEt=Object.freeze(Object.defineProperty({__proto__:null,AXIS_PARTS:_H,AXIS_PROPERTIES:pEt,AXIS_PROPERTY_TYPE:Twe,VG_AXIS_PROPERTIES:EH,isAxisProperty:Iwe},Symbol.toStringTag,{value:"Module"}));var lt;(function(e){e.ROW="row",e.COLUMN="column",e.X="x",e.Y="y",e.X2="x2",e.Y2="y2",e.XERROR="xError",e.YERROR="yError",e.XERROR2="xError2",e.YERROR2="yError2",e.LATITUDE="latitude",e.LONGITUDE="longitude",e.LATITUDE2="latitude2",e.LONGITUDE2="longitude2",e.COLOR="color",e.FILL="fill",e.STROKE="stroke",e.SHAPE="shape",e.SIZE="size",e.OPACITY="opacity",e.FILLOPACITY="fillOpacity",e.STROKEOPACITY="strokeOpacity",e.STROKEWIDTH="strokeWidth",e.TEXT="text",e.ORDER="order",e.DETAIL="detail",e.KEY="key",e.TOOLTIP="tooltip",e.HREF="href"})(lt||(lt={}));const Dt=lt.X,fn=lt.Y,og=lt.X2,ag=lt.Y2,TH=lt.XERROR,AH=lt.YERROR,NH=lt.XERROR2,IH=lt.YERROR2,pb=lt.LATITUDE,mb=lt.LATITUDE2,gb=lt.LONGITUDE,gm=lt.LONGITUDE2,Ld=lt.ROW,zd=lt.COLUMN,so=lt.SHAPE,ug=lt.SIZE,Nu=lt.COLOR,gh=lt.FILL,yh=lt.STROKE,DH=lt.TEXT,OH=lt.DETAIL,FH=lt.KEY,RH=lt.ORDER,bh=lt.OPACITY,lg=lt.FILLOPACITY,cg=lt.STROKEOPACITY,fg=lt.STROKEWIDTH,MH=lt.TOOLTIP,PH=lt.HREF,LH={longitude:1,longitude2:1,latitude:1,latitude2:1},Dwe=_r(LH),zH=Object.assign({x:1,y:1,x2:1,y2:1,xError:1,yError:1,xError2:1,yError2:1},LH,{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1});function T0(e){return e==="color"||e==="fill"||e==="stroke"}const gEt={row:1,column:1},BH=Object.assign({},zH,gEt),UH=_r(BH),yEt=Mt(BH,["order","detail"]),bEt=_r(yEt);function WH(e){return!!BH[e]}function VH(e){return MO(e)!==e}function MO(e){switch(e){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude"}return e}const vEt=_r(zH),jH=Mt(zH,["x","y","x2","y2","xError","yError","xError2","yError2","latitude","longitude","latitude2","longitude2"]),Owe=_r(jH),Fwe={x:1,y:1},yb=_r(Fwe),Rwe=Mt(jH,["text","tooltip","href","detail","key","order"]),Mwe=_r(Rwe);function Pwe(e){return!!jH[e]}const Lwe=Object.assign({},Fwe,Rwe),nk=_r(Lwe);function dg(e){return!!Lwe[e]}function zwe(e,t){return xEt(e)[t]}function xEt(e){switch(e){case Nu:case gh:case yh:case OH:case FH:case MH:case PH:case RH:case bh:case lg:case cg:case fg:case Ld:case zd:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",rect:"always",line:"always",trail:"always",area:"always",text:"always",geoshape:"always"};case Dt:case fn:case pb:case gb:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",rect:"always",line:"always",trail:"always",area:"always",text:"always"};case og:case ag:case mb:case gm:return{rule:"always",bar:"always",rect:"always",area:"always",circle:"binned",point:"binned",square:"binned",tick:"binned"};case ug:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case so:return{point:"always",geoshape:"always"};case DH:return{text:"always"};case TH:case AH:case NH:case IH:return{}}}function Vx(e){switch(e){case Dt:case fn:case ug:case fg:case bh:case lg:case cg:case og:case ag:case TH:case AH:case NH:case IH:return;case Ld:case zd:case so:case DH:case MH:case PH:return"discrete";case Nu:case gh:case yh:return"flexible";case pb:case gb:case mb:case gm:case OH:case FH:case RH:return}throw new Error("rangeType not implemented for "+e)}const wEt=Object.freeze(Object.defineProperty({__proto__:null,CHANNELS:UH,COLOR:Nu,COLUMN:zd,get Channel(){return lt},DETAIL:OH,FILL:gh,FILLOPACITY:lg,GEOPOSITION_CHANNELS:Dwe,GEOPOSITION_CHANNEL_INDEX:LH,HREF:PH,KEY:FH,LATITUDE:pb,LATITUDE2:mb,LONGITUDE:gb,LONGITUDE2:gm,NONPOSITION_CHANNELS:Owe,NONPOSITION_SCALE_CHANNELS:Mwe,OPACITY:bh,ORDER:RH,POSITION_SCALE_CHANNELS:yb,ROW:Ld,SCALE_CHANNELS:nk,SHAPE:so,SINGLE_DEF_CHANNELS:bEt,SIZE:ug,STROKE:yh,STROKEOPACITY:cg,STROKEWIDTH:fg,TEXT:DH,TOOLTIP:MH,UNIT_CHANNELS:vEt,X:Dt,X2:og,XERROR:TH,XERROR2:NH,Y:fn,Y2:ag,YERROR:AH,YERROR2:IH,getMainRangeChannel:MO,isChannel:WH,isColorChannel:T0,isNonPositionScaleChannel:Pwe,isScaleChannel:dg,isSecondaryRangeChannel:VH,rangeType:Vx,supportMark:zwe},Symbol.toStringTag,{value:"Module"}));function PO(e){return nb(e)?"bin":"bin"+Se(e).map(t=>Ul(`_${t}_${e[t]}`)).join("")}function dn(e){return e===!0||HH(e)}function Do(e){return e==="binned"}function HH(e){return yt(e)}function XL(e){switch(e){case Ld:case zd:case ug:case Nu:case gh:case yh:case fg:case bh:case lg:case cg:case so:return 6;default:return 10}}const SEt=Object.freeze(Object.defineProperty({__proto__:null,autoMaxBins:XL,binToString:PO,isBinParams:HH,isBinned:Do,isBinning:dn},Symbol.toStringTag,{value:"Module"}));var ks;(function(e){e.AREA="area",e.BAR="bar",e.LINE="line",e.POINT="point",e.RECT="rect",e.RULE="rule",e.TEXT="text",e.TICK="tick",e.TRAIL="trail",e.CIRCLE="circle",e.SQUARE="square",e.GEOSHAPE="geoshape"})(ks||(ks={}));const rk=ks.AREA,bb=ks.BAR,ik=ks.LINE,sk=ks.POINT,LO=ks.TEXT,ok=ks.TICK,Bwe=ks.TRAIL,zO=ks.RECT,l2=ks.RULE,GH=ks.GEOSHAPE,ak=ks.CIRCLE,uk=ks.SQUARE,Uwe={area:1,bar:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function CEt(e){return!!Uwe[e]}function vb(e){return et(["line","area","trail"],e)}const qH=_r(Uwe);function Ko(e){return e.type}const kEt=Ft(qH);function XH(e){return(Ko(e)?e.type:e)in kEt}const Wwe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Vwe=["fill","fillOpacity"],jwe=[].concat(Wwe,Vwe),KL=["filled","color","tooltip"],Hwe={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],text:["shortTimeLabels"],tick:["bandSize","thickness"]},Gwe={color:"#4c78a8",tooltip:{content:"encoding"}},qwe={binSpacing:1,continuousBandSize:5},Xwe={thickness:1},$Et=Object.freeze(Object.defineProperty({__proto__:null,AREA:rk,BAR:bb,CIRCLE:ak,FILL_CONFIG:Vwe,FILL_STROKE_CONFIG:jwe,GEOSHAPE:GH,LINE:ik,get Mark(){return ks},POINT:sk,PRIMITIVE_MARKS:qH,RECT:zO,RULE:l2,SQUARE:uk,STROKE_CONFIG:Wwe,TEXT:LO,TICK:ok,TRAIL:Bwe,VL_ONLY_MARK_CONFIG_PROPERTIES:KL,VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX:Hwe,defaultBarConfig:qwe,defaultMarkConfig:Gwe,defaultTickConfig:Xwe,isMark:CEt,isMarkDef:Ko,isPathMark:vb,isPrimitiveMark:XH},Symbol.toStringTag,{value:"Module"})),Kwe=CU(wU);let Bd=Kwe;function _Et(e){return Bd=e,Bd}function EEt(){return Bd=Kwe,Bd}function _e(...e){Bd.warn.apply(Bd,arguments)}function TEt(...e){Bd.debug.apply(Bd,arguments)}var we;(function(e){e.INVALID_SPEC="Invalid spec",e.FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.',e.CANNOT_FIX_RANGE_STEP_WITH_FIT='Cannot use a fixed value of "rangeStep" when "autosize" is "fit".';function t(Z){return`Cannot project a selection on encoding channel "${Z}", which has no field.`}e.cannotProjectOnChannelWithoutField=t;function n(Z){return`The "nearest" transform is not supported for ${Z} marks.`}e.nearestNotSupportForContinuous=n;function r(Z){return`Selection not supported for ${Z} yet`}e.selectionNotSupported=r;function i(Z){return`Cannot find a selection named "${Z}"`}e.selectionNotFound=i,e.SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.";function s(Z){return`Unknown repeated value "${Z}".`}e.noSuchRepeatedValue=s,e.CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated views.",e.REPEAT_CANNOT_SHARE_AXIS="Axes cannot be shared in repeated views.";function o(Z){return`Cannot set title "anchor" for a ${Z} spec`}e.cannotSetTitleAnchor=o;function a(Z){return`Unrecognized parse "${Z}".`}e.unrecognizedParse=a;function u(Z,Ee,it){return`An ancestor parsed field "${Z}" as ${it} but a child wants to parse the field as ${Ee}.`}e.differentParse=u;function l(Z){return`Ignoring an invalid transform: ${pn(Z)}.`}e.invalidTransformIgnored=l,e.NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function c(Z){return`Layer's shared ${Z.join(",")} channel ${Z.length===1?"is":"are"} overriden`}e.encodingOverridden=c;function f(Z){const{parentProjection:Ee,projection:it}=Z;return`Layer's shared projection ${pn(Ee)} is overridden by a child projection ${pn(it)}.`}e.projectionOverridden=f;function d(Z,Ee,it){return`Channel ${Z} is a ${Ee}. Converted to {value: ${pn(it)}}.`}e.primitiveChannelDef=d;function h(Z){return`Invalid field type "${Z}"`}e.invalidFieldType=h;function p(Z,Ee,it){return`A ${it.scaleType?`${it.scaleType} scale`:it.zeroFalse?"scale with zero=false":"scale with custom domain that excludes zero"} is used to encode ${Z}'s ${Ee}. This can be misleading as the ${Ee==="x"?"width":"height"} of the ${Z} can be arbitrary based on the scale domain. You may want to use point mark instead.`}e.nonZeroScaleUsedWithLengthMark=p;function m(Z,Ee){return`Invalid field type "${Z}" for aggregate: "${Ee}", using "quantitative" instead.`}e.invalidFieldTypeForCountAggregate=m;function g(Z){return`Invalid aggregation operator "${Z}"`}e.invalidAggregate=g;function y(Z,Ee){return`Missing type for channel "${Z}", using "${Ee}" instead.`}e.missingFieldType=y;function b(Z,Ee){const{fill:it,stroke:qt}=Ee;return`Dropping color ${Z} as the plot also has `+(it&&qt?"fill and stroke":it?"fill":"stroke")}e.droppingColor=b;function v(Z,Ee){return`Dropping ${pn(Z)} from channel "${Ee}" since it does not contain data field or value.`}e.emptyFieldDef=v;function x(Z,Ee,it){return`${Z}-encoding with type ${Ee} is deprecated. Replacing with ${it}-encoding.`}e.latLongDeprecated=x,e.LINE_WITH_VARYING_SIZE="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function w(Z,Ee,it){return`${Z} dropped as it is incompatible with "${Ee}"${it?` when ${it}`:""}.`}e.incompatibleChannel=w;function S(Z){return`${Z}-encoding is dropped as ${Z} is not a valid encoding channel.`}e.invalidEncodingChannel=S;function C(Z){return`${Z} encoding should be discrete (ordinal / nominal / binned).`}e.facetChannelShouldBeDiscrete=C;function k(Z,Ee){return`Using discrete channel "${Z}" to encode "${Ee}" field can be misleading as it does not encode ${Ee==="ordinal"?"order":"magnitude"}.`}e.discreteChannelCannotEncode=k,e.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL="Bar mark should not be used with point scale when rangeStep is null. Please use band scale instead.";function E(Z,Ee){return`Line mark is for continuous lines and thus cannot be used with ${Z&&Ee?"x2 and y2":Z?"x2":"y2"}. We will use the rule mark (line segments) instead.`}e.lineWithRange=E;function _(Z,Ee){return`Specified orient "${Z}" overridden with "${Ee}"`}e.orientOverridden=_,e.CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN="custom domain scale cannot be unioned with default field-based domain";function T(Z){return`Cannot use the scale property "${Z}" with non-color channel.`}e.cannotUseScalePropertyWithNonColor=T;function D(Z){return`Using unaggregated domain with raw field has no effect (${pn(Z)}).`}e.unaggregateDomainHasNoEffectForRawField=D;function O(Z){return`Unaggregated domain not applicable for "${Z}" since it produces values outside the origin domain of the source data.`}e.unaggregateDomainWithNonSharedDomainOp=O;function M(Z){return`Unaggregated domain is currently unsupported for log scale (${pn(Z)}).`}e.unaggregatedDomainWithLogScale=M;function I(Z){return`Cannot apply size to non-oriented mark "${Z}".`}e.cannotApplySizeToNonOrientedMark=I;function P(Z){return`rangeStep for "${Z}" is dropped as top-level ${Z==="x"?"width":"height"} is provided.`}e.rangeStepDropped=P;function V(Z,Ee,it){return`Channel "${Z}" does not work with "${Ee}" scale. We are using "${it}" scale instead.`}e.scaleTypeNotWorkWithChannel=V;function F(Z,Ee){return`FieldDef does not work with "${Z}" scale. We are using "${Ee}" scale instead.`}e.scaleTypeNotWorkWithFieldDef=F;function B(Z,Ee,it){return`${it}-scale's "${Ee}" is dropped as it does not work with ${Z} scale.`}e.scalePropertyNotWorkWithScaleType=B;function q(Z,Ee){return`Scale type "${Ee}" does not work with mark "${Z}".`}e.scaleTypeNotWorkWithMark=q;function J(Z,Ee,it,qt){return`Conflicting ${Ee.toString()} property "${Z.toString()}" (${pn(it)} and ${pn(qt)}).  Using ${pn(it)}.`}e.mergeConflictingProperty=J;function ne(Z){return`Setting the scale to be independent for "${Z}" means we also have to set the guide (axis or legend) to be independent.`}e.independentScaleMeansIndependentGuide=ne;function re(Z){return`Dropping sort property ${pn(Z)} as unioned domains only support boolean or op 'count'.`}e.domainSortDropped=re,e.UNABLE_TO_MERGE_DOMAINS="Unable to merge domains",e.MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",e.INVALID_CHANNEL_FOR_AXIS="Invalid channel for axis.";function ae(Z){return`Cannot stack "${Z}" if there is already "${Z}2"`}e.cannotStackRangedMark=ae;function le(Z){return`Cannot stack non-linear scale (${Z})`}e.cannotStackNonLinearScale=le;function me(Z){return`Stacking is applied even though the aggregate function is non-summative ("${Z}")`}e.stackNonSummativeAggregate=me;function Oe(Z,Ee){return`Invalid ${Z}: ${pn(Ee)}`}e.invalidTimeUnit=Oe;function Me(Z){return`Time unit "${Z}" is not supported. We are replacing it with ${Z.replace("day","date")}.`}e.dayReplacedWithDate=Me;function X(Z){return`Dropping day from datetime ${pn(Z)} as day cannot be combined with other units.`}e.droppedDay=X;function oe(Z,Ee){return`${Ee?"extent ":""}${Ee&&Z?"and ":""}${Z?"center ":""}${Ee&&Z?"are ":"is "}not needed when data are aggregated.`}e.errorBarCenterAndExtentAreNotNeeded=oe;function fe(Z,Ee,it){return`${Z} is not usually used with ${Ee} for ${it}.`}e.errorBarCenterIsUsedWithWrongExtent=fe;function W(Z,Ee){return`Continuous axis should not have customized aggregation function ${Z}; ${Ee} already agregates the axis.`}e.errorBarContinuousAxisHasCustomizedAggregate=W;function Ve(Z,Ee){return`Center is not needed to be specified in ${Ee} when extent is ${Z}.`}e.errorBarCenterIsNotNeeded=Ve;function ke(Z){return`1D error band does not support ${Z}`}e.errorBand1DNotSupport=ke;function Ke(Z){return`Channel ${Z} is required for "binned" bin`}e.channelRequiredForBinned=Ke;function He(Z){return`Domain for ${Z} is required for threshold scale`}e.domainRequiredForThresholdScale=He})(we||(we={}));const AEt=2006;function KH(e){return!!e&&(!!e.year||!!e.quarter||!!e.month||!!e.date||!!e.day||!!e.hours||!!e.minutes||!!e.seconds||!!e.milliseconds)}const YH=["january","february","march","april","may","june","july","august","september","october","november","december"],Ywe=YH.map(e=>e.substr(0,3)),ZH=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Zwe=ZH.map(e=>e.substr(0,3));function NEt(e){if(Rr(e))return e>4&&_e(we.invalidTimeUnit("quarter",e)),(e-1).toString();throw new Error(we.invalidTimeUnit("quarter",e))}function IEt(e){if(Rr(e))return(e-1).toString();{const t=e.toLowerCase(),n=YH.indexOf(t);if(n!==-1)return n+"";const r=t.substr(0,3),i=Ywe.indexOf(r);if(i!==-1)return i+"";throw new Error(we.invalidTimeUnit("month",e))}}function DEt(e){if(Rr(e))return e%7+"";{const t=e.toLowerCase(),n=ZH.indexOf(t);if(n!==-1)return n+"";const r=t.substr(0,3),i=Zwe.indexOf(r);if(i!==-1)return i+"";throw new Error(we.invalidTimeUnit("day",e))}}function FA(e,t=!1){const n=[];if(t&&e.day!==void 0&&Se(e).length>1&&(_e(we.droppedDay(e)),e=jt(e),delete e.day),e.year!==void 0?n.push(e.year):e.day!==void 0?n.push(AEt):n.push(0),e.month!==void 0){const r=t?IEt(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?NEt(e.quarter):e.quarter;n.push(r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?DEt(e.day):e.day;n.push(r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"])e[r]!==void 0?n.push(e[r]):n.push(0);return e.utc?`utc(${n.join(", ")})`:`datetime(${n.join(", ")})`}const OEt=Object.freeze(Object.defineProperty({__proto__:null,DAYS:ZH,MONTHS:YH,SHORT_DAYS:Zwe,SHORT_MONTHS:Ywe,dateTimeExpr:FA,isDateTime:KH},Symbol.toStringTag,{value:"Module"}));function FEt(e){return!!e&&!!e.header}function hg(e){return e.facet!==void 0}var Ii;(function(e){e.YEAR="year",e.MONTH="month",e.DAY="day",e.DATE="date",e.HOURS="hours",e.MINUTES="minutes",e.SECONDS="seconds",e.MILLISECONDS="milliseconds",e.YEARMONTH="yearmonth",e.YEARMONTHDATE="yearmonthdate",e.YEARMONTHDATEHOURS="yearmonthdatehours",e.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",e.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",e.MONTHDATE="monthdate",e.MONTHDATEHOURS="monthdatehours",e.HOURSMINUTES="hoursminutes",e.HOURSMINUTESSECONDS="hoursminutesseconds",e.MINUTESSECONDS="minutesseconds",e.SECONDSMILLISECONDS="secondsmilliseconds",e.QUARTER="quarter",e.YEARQUARTER="yearquarter",e.QUARTERMONTH="quartermonth",e.YEARQUARTERMONTH="yearquartermonth",e.UTCYEAR="utcyear",e.UTCMONTH="utcmonth",e.UTCDAY="utcday",e.UTCDATE="utcdate",e.UTCHOURS="utchours",e.UTCMINUTES="utcminutes",e.UTCSECONDS="utcseconds",e.UTCMILLISECONDS="utcmilliseconds",e.UTCYEARMONTH="utcyearmonth",e.UTCYEARMONTHDATE="utcyearmonthdate",e.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",e.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",e.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",e.UTCMONTHDATE="utcmonthdate",e.UTCMONTHDATEHOURS="utcmonthdatehours",e.UTCHOURSMINUTES="utchoursminutes",e.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",e.UTCMINUTESSECONDS="utcminutesseconds",e.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",e.UTCQUARTER="utcquarter",e.UTCYEARQUARTER="utcyearquarter",e.UTCQUARTERMONTH="utcquartermonth",e.UTCYEARQUARTERMONTH="utcyearquartermonth"})(Ii||(Ii={}));const QH={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},BO=_r(QH);function Qwe(e){return!!QH[e]}const JH={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};function Jwe(e){return!!JH[e]}const REt={yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,monthdatehours:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1},e2e={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utcmonthdatehours:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},MEt=Object.assign({},JH,e2e);function eG(e){return!!MEt[e]}function t2e(e){return e.substr(3)}const n2e=Object.assign({},QH,JH,REt,e2e),PEt=_r(n2e);function LEt(e){return!!n2e[e]}const zEt={year:"setFullYear",month:"setMonth",date:"setDate",hours:"setHours",minutes:"setMinutes",seconds:"setSeconds",milliseconds:"setMilliseconds",quarter:null,day:null};function BEt(e,t){const n=eG(e),r=n?new Date(Date.UTC(1972,0,1,0,0,0,0)):new Date(1972,0,1,0,0,0,0);for(const i of BO)if(xo(e,i))switch(i){case Ii.DAY:throw new Error("Cannot convert to TimeUnits containing 'day'");case Ii.QUARTER:{const{getDateMethod:a,setDateMethod:u}=qee("month",n);r[u](Math.floor(t[a]()/3)*3);break}default:const{getDateMethod:s,setDateMethod:o}=qee(i,n);r[o](t[s]())}return r}function qee(e,t){const n=zEt[e],r=t?"setUTC"+n.substr(3):n,i="get"+(t?"UTC":"")+n.substr(3);return{setDateMethod:r,getDateMethod:i}}function r2e(e){return BO.reduce((t,n)=>xo(e,n)?t.concat(n):t,[])}function xo(e,t){const n=e.indexOf(t);return n>-1&&(t!==Ii.SECONDS||n===0||e.charAt(n-1)!=="i")}function tG(e,t){const n=Ta(t),r=eG(e)?"utc":"";function i(o){return o===Ii.QUARTER?`(${r}quarter(${n})-1)`:`${r}${o}(${n})`}const s=BO.reduce((o,a)=>(xo(e,a)&&(o[a]=i(a)),o),{});return FA(s)}function nG(e,t){if(!e)return;const n=[],r=xo(e,Ii.YEAR);xo(e,Ii.MONTH)&&n.push(t!==!1?"%b":"%B"),xo(e,Ii.DAY)?n.push(t?"%a":"%A"):xo(e,Ii.DATE)&&n.push("%d"+(r?",":"")),r&&n.push(t?"%y":"%Y");const i=[];xo(e,Ii.HOURS)&&i.push("%H"),xo(e,Ii.MINUTES)&&i.push("%M"),xo(e,Ii.SECONDS)&&i.push("%S"),xo(e,Ii.MILLISECONDS)&&i.push("%L");const s=[];return n.length>0&&s.push(n.join(" ")),i.length>0&&s.push(i.join(":")),s}function i2e(e,t,n,r){if(!e)return;const i=nG(e,n);let s="";return xo(e,Ii.QUARTER)&&(s=`'Q' + quarter(${t})`),i.length>0&&(s&&(s+=" + ' ' + "),r?s+=`utcFormat(${t}, '${i.join(" ")}')`:s+=`timeFormat(${t}, '${i.join(" ")}')`),s||void 0}function rG(e){return e!=="day"&&e.indexOf("day")>=0?(_e(we.dayReplacedWithDate(e)),e.replace("day","date")):e}const UEt=Object.freeze(Object.defineProperty({__proto__:null,TIMEUNITS:PEt,TIMEUNIT_PARTS:BO,get TimeUnit(){return Ii},containsTimeUnit:xo,convert:BEt,fieldExpr:tG,formatExpression:i2e,getDateTimeComponents:nG,getLocalTimeUnit:t2e,getTimeUnitParts:r2e,isLocalSingleTimeUnit:Qwe,isTimeUnit:LEt,isUTCTimeUnit:eG,isUtcSingleTimeUnit:Jwe,normalizeTimeUnit:rG},Symbol.toStringTag,{value:"Module"}));var qs;(function(e){e.QUANTITATIVE="quantitative",e.ORDINAL="ordinal",e.TEMPORAL="temporal",e.NOMINAL="nominal",e.GEOJSON="geojson"})(qs||(qs={}));const iG={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1};function WEt(e){return!!iG[e]}const Ud=qs.QUANTITATIVE,sG=qs.ORDINAL,RA=qs.TEMPORAL,oG=qs.NOMINAL,pg=qs.GEOJSON;function s2e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Ud:return"quantitative";case"t":case RA:return"temporal";case"o":case sG:return"ordinal";case"n":case oG:return"nominal";case pg:return"geojson"}}const VEt=Object.freeze(Object.defineProperty({__proto__:null,GEOJSON:pg,NOMINAL:oG,ORDINAL:sG,QUANTITATIVE:Ud,TEMPORAL:RA,TYPE_INDEX:iG,get Type(){return qs},getFullName:s2e,isType:WEt},Symbol.toStringTag,{value:"Module"}));function o2e(e){return e.selection}function a2e(e){return e&&!ft(e)&&"repeat"in e}function YL(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign({},n?{timeUnit:n}:{},r?{bin:r}:{},i?{aggregate:i}:{},{field:t})}function u2e(e){return Wl(e)&&!!e.sort}function aG(e){return!!e&&!!e.condition}function Iu(e){return!!e&&!!e.condition&&!be(e.condition)&&ye(e.condition)}function l2e(e){return!!e&&!!e.condition&&(be(e.condition)||nf(e.condition))}function ye(e){return!!e&&(!!e.field||e.aggregate==="count")}function Wl(e){return!!e&&(!!e.field&&!!e.type||e.aggregate==="count")}function nE(e){return ye(e)&&ft(e.field)}function nf(e){return e&&"value"in e&&e.value!==void 0}function UO(e){return!!e&&(!!e.scale||!!e.sort)}function c2e(e){return!!e&&(!!e.axis||!!e.stack||!!e.impute)}function f2e(e){return!!e&&!!e.legend}function d2e(e){return!!e&&!!e.format}function jEt(e){return!!e.op}function Pe(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix;if(p2e(e))n="count_*";else{let s;t.nofn||(jEt(e)?s=e.op:dn(e.bin)?(s=PO(e.bin),i=(t.binSuffix||"")+(t.suffix||"")):e.aggregate?s=String(e.aggregate):e.timeUnit&&(s=String(e.timeUnit))),s&&(n=n?`${s}_${n}`:s)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?n:t.expr?ywe(n,t.expr):RO(n)}function h2e(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!e.bin;case"temporal":return!1}throw new Error(we.invalidFieldType(e.type))}function cu(e){return!h2e(e)}function p2e(e){return e.aggregate==="count"}function m2e(e,t){const{field:n,bin:r,timeUnit:i,aggregate:s}=e;if(s==="count")return t.countTitle;if(dn(r))return`${n} (binned)`;if(i){const o=r2e(i).join("-");return`${n} (${o})`}else if(s)return`${FO(s)} of ${n}`;return n}function g2e(e,t){const n=e.aggregate||e.timeUnit||dn(e.bin)&&"bin";return n?n.toUpperCase()+"("+e.field+")":e.field}const uG=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return g2e(e);default:return m2e(e,t)}};let y2e=uG;function lG(e){y2e=e}function b2e(){lG(uG)}function gd(e,t,{allowDisabling:n}){const i=(WO(e)||{}).title;return n?ct(i,e.title,MA(e,t)):i||e.title||MA(e,t)}function WO(e){if(c2e(e)&&e.axis)return e.axis;if(f2e(e)&&e.legend)return e.legend;if(FEt(e)&&e.header)return e.header}function MA(e,t){return y2e(e,t)}function v2e(e){return d2e(e)&&e.format?e.format:(WO(e)||{}).format}function x2e(e,t){if(e.timeUnit)return"temporal";if(dn(e.bin))return"quantitative";switch(Vx(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function PA(e){if(ye(e))return e;if(Iu(e))return e.condition}function vh(e){if(ye(e))return e;if(Iu(e))return e.condition}function cG(e,t){if(ft(e)||Rr(e)||nb(e)){const n=ft(e)?"string":Rr(e)?"number":"boolean";return _e(we.primitiveChannelDef(t,n,e)),{value:e}}return ye(e)?LA(e,t):Iu(e)?Object.assign({},e,{condition:LA(e.condition,t)}):e}function LA(e,t){if(e.aggregate&&!$H(e.aggregate)){const n=Mt(e,["aggregate"]);_e(we.invalidAggregate(e.aggregate)),e=n}if(e.timeUnit&&(e=Object.assign({},e,{timeUnit:rG(e.timeUnit)})),dn(e.bin)&&(e=Object.assign({},e,{bin:fG(e.bin,t)})),Do(e.bin)&&!et(yb,t)&&_e(`Channel ${t} should not be used with "binned" bin`),Wl(e)){const n=s2e(e.type);e.type!==n&&(e=Object.assign({},e,{type:n})),e.type!=="quantitative"&&Cwe(e.aggregate)&&(_e(we.invalidFieldTypeForCountAggregate(e.type,e.aggregate)),e=Object.assign({},e,{type:"quantitative"}))}else if(!VH(t)){const n=x2e(e,t);_e(we.missingFieldType(t,n)),e=Object.assign({},e,{type:n})}if(Wl(e)){const{compatible:n,warning:r}=w2e(e,t);n||_e(r)}return e}function fG(e,t){return nb(e)?{maxbins:XL(t)}:!e.maxbins&&!e.step?Object.assign({},e,{maxbins:XL(t)}):e}const Dg={compatible:!0};function w2e(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case"row":case"column":return cu(e)?{compatible:!1,warning:we.facetChannelShouldBeDiscrete(t)}:Dg;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":return Dg;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==Ud?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Dg;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"size":case"x2":case"y2":return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Dg;case"shape":return et(["ordinal","nominal","geojson"],e.type)?Dg:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Dg}throw new Error("channelCompatability not implemented for channel "+t)}function S2e(e){return e.type==="quantitative"||dn(e.bin)}function xb(e){return e.type==="temporal"||!!e.timeUnit}function lk(e,{timeUnit:t,type:n,time:r,undefinedIfExprNotRequired:i}){let s;return KH(e)?s=FA(e,!0):(ft(e)||Rr(e))&&(t||n==="temporal")&&(Qwe(t)?s=FA({[t]:e},!0):Jwe(t)?s=lk(e,{timeUnit:t2e(t)}):s=`datetime(${JSON.stringify(e)})`),s?r?`time(${s})`:s:i?void 0:JSON.stringify(e)}function dG(e,t){const{timeUnit:n,type:r}=e;return t.map(i=>{const s=lk(i,{timeUnit:n,type:r,undefinedIfExprNotRequired:!0});return s!==void 0?{signal:s}:i})}function wb(e,t){return dn(e.bin)?dg(t)&&et(["ordinal","nominal"],e.type):(console.warn("Only use this method with binned field defs"),!1)}const HEt=Object.freeze(Object.defineProperty({__proto__:null,binRequiresRange:wb,channelCompatibility:w2e,defaultTitle:MA,defaultTitleFormatter:uG,defaultType:x2e,format:v2e,functionalTitleFormatter:g2e,getFieldDef:PA,getGuide:WO,getTypedFieldDef:vh,hasConditionalFieldDef:Iu,hasConditionalValueDef:l2e,isConditionalDef:aG,isConditionalSelection:o2e,isContinuous:cu,isCount:p2e,isDiscrete:h2e,isFieldDef:ye,isMarkPropFieldDef:f2e,isNumberFieldDef:S2e,isPositionFieldDef:c2e,isRepeatRef:a2e,isScaleFieldDef:UO,isSortableFieldDef:u2e,isStringFieldDef:nE,isTextFieldDef:d2e,isTimeFieldDef:xb,isTypedFieldDef:Wl,isValueDef:nf,normalize:cG,normalizeBin:fG,normalizeFieldDef:LA,resetTitleFormatter:b2e,setTitleFormatter:lG,title:gd,toFieldDefBase:YL,valueArray:dG,valueExpr:lk,verbalTitleFormatter:m2e,vgField:Pe},Symbol.toStringTag,{value:"Module"}));function Wd(e,t){const n=e&&e[t];return n?be(n)?a2(n,r=>!!r.field):ye(n)||Iu(n):!1}function hG(e){return a2(UH,t=>{if(Wd(e,t)){const n=e[t];if(be(n))return a2(n,r=>!!r.aggregate);{const r=PA(n);return r&&!!r.aggregate}}return!1})}function VO(e,t){const n=[],r=[],i=[],s=[],o={};return ck(e,(a,u)=>{if(ye(a)){const{field:l,aggregate:c,timeUnit:f,bin:d}=a,h=Mt(a,["field","aggregate","timeUnit","bin"]);if(c||f||d){const p=WO(a),m=p&&p.title,g=Pe(a,{forAs:!0}),y=Object.assign({},m?[]:{title:gd(a,t,{allowDisabling:!0})},h,{field:g}),b=u===lt.X||u===lt.Y;if(c&&$H(c)){const v={op:c,as:g};l&&(v.field=l),s.push(v)}else if(Wl(a)&&dn(d)){if(r.push({bin:d,field:l,as:g}),n.push(Pe(a,{binSuffix:"end"})),wb(a,u)&&n.push(Pe(a,{binSuffix:"range"})),b){const v={field:g+"_end",type:qs.QUANTITATIVE};o[u+"2"]=v}y.bin="binned",VH(u)||(y.type=qs.QUANTITATIVE)}else if(f){i.push({timeUnit:f,field:l,as:g});const v=nG(f,t.axis.shortTimeLabels).join(" ");Pwe(u)?y.legend=Object.assign({format:v},y.legend):b?y.axis=Object.assign({format:v},y.axis):(u==="text"||u==="tooltip")&&(y.format=y.format||v)}c||n.push(g),o[u]=y}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:r,timeUnits:i,aggregate:s,groupby:n,encoding:o}}function C2e(e,t,n){const r=zwe(t,n);if(r){if(r==="binned"){const i=e[t==="x2"?"x":"y"];return!!(ye(i)&&ye(e[t])&&i.bin==="binned")}}else return!1;return!0}function k2e(e,t){return Se(e).reduce((n,r)=>{if(!WH(r))return _e(we.invalidEncodingChannel(r)),n;if(!C2e(e,r,t))return _e(we.incompatibleChannel(r,t)),n;if(r==="size"&&t==="line"){const s=vh(e[r]);if(s&&s.aggregate)return _e(we.LINE_WITH_VARYING_SIZE),n}if(r==="color"&&("fill"in e||"stroke"in e))return _e(we.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),n;const i=e[r];if(r==="detail"||r==="order"&&!be(i)&&!nf(i)||r==="tooltip"&&be(i))i&&(n[r]=(be(i)?i:[i]).reduce((s,o)=>(ye(o)?s.push(LA(o,r)):_e(we.emptyFieldDef(o,r)),s),[]));else{if(r==="tooltip"&&i===null)n[r]=null;else if(!ye(i)&&!nf(i)&&!aG(i))return _e(we.emptyFieldDef(i,r)),n;n[r]=cG(i,r)}return n},{})}function GEt(e){return e&&(!!e.x&&!!e.x2||!!e.y&&!!e.y2)}function jx(e){const t=[];for(const n of Se(e))if(Wd(e,n)){const r=e[n];(be(r)?r:[r]).forEach(i=>{ye(i)?t.push(i):Iu(i)&&t.push(i.condition)})}return t}function ck(e,t,n){if(e)for(const r of Se(e))be(e[r])?e[r].forEach(i=>{t.call(n,i,r)}):t.call(n,e[r],r)}function jO(e,t,n,r){return e?Se(e).reduce((i,s)=>{const o=e[s];return be(o)?o.reduce((a,u)=>t.call(r,a,u,s),i):t.call(r,i,o,s)},n):n}const qEt=Object.freeze(Object.defineProperty({__proto__:null,channelHasField:Wd,extractTransformsFromEncoding:VO,fieldDefs:jx,forEach:ck,isAggregate:hG,isRanged:GEt,markChannelCompatible:C2e,normalizeEncoding:k2e,reduce:jO},Symbol.toStringTag,{value:"Module"}));function $2e(e,t,n,r=!0){return{tooltip:[...e.map(({fieldPrefix:s,titlePrefix:o})=>({field:s+t.field,type:t.type,title:o+(r?" of "+t.field:"")})),...jx(n)]}}function pG(e,t,n,r,i){const{scale:s,axis:o}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=o&&o.title!==void 0?void 0:n.title!==void 0?n.title:n.field;return _2e(e,a,i,{mark:u,encoding:Object.assign({[t]:Object.assign({field:l+"_"+n.field,type:n.type},d?{title:d}:{},s?{scale:s}:{},o?{axis:o}:{})},ft(c)?{[t+"2"]:{field:c+"_"+n.field,type:n.type}}:{},r,f)})}}function _2e(e,t,n,r){const{clip:i,color:s,opacity:o}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign({},r,{mark:Object.assign({},n[t],i?{clip:i}:{},s?{color:s}:{},o?{opacity:o}:{},Ko(r.mark)?r.mark:{type:r.mark},{style:`${a}-${t}`},nb(e[t])?{}:e[t])})]:[]}function E2e(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",s=r[i],o=r[i+"2"],a=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:H$(s,n),continuousAxisChannelDef2:H$(o,n),continuousAxisChannelDefError:H$(a,n),continuousAxisChannelDefError2:H$(u,n),continuousAxis:i}}function H$(e,t){if(ye(e)&&e&&e.aggregate){const{aggregate:n}=e,r=Mt(e,["aggregate"]);return n!==t&&_e(we.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}else return e}function T2e(e,t){const{mark:n,encoding:r}=e;if(ye(r.x)&&cu(r.x)){if(ye(r.y)&&cu(r.y)){if(r.x.aggregate===void 0&&r.y.aggregate===t)return"vertical";if(r.y.aggregate===void 0&&r.x.aggregate===t)return"horizontal";if(r.x.aggregate===t&&r.y.aggregate===t)throw new Error("Both x and y cannot have aggregate");return Ko(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(ye(r.y)&&cu(r.y))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}function A2e(e,t,n){return Object.assign({},e,{encoding:jO(e.encoding,(r,i,s)=>(t.indexOf(s)>-1?r[s]=i:_e(we.incompatibleChannel(s,n)),r),{})})}const zA="boxplot",XEt={box:1,median:1,outliers:1,rule:1,ticks:1},KEt=Se(XEt),YEt=["x","y","color","detail","opacity","size"];function ZEt(e,t){e=A2e(e,YEt,zA);const{mark:n,encoding:r,selection:i,projection:s}=e,o=Mt(e,["mark","encoding","selection","projection"]),a=Ko(n)?n:{type:n};i&&_e(we.selectionNotSupported("boxplot"));const u=a.extent||t.boxplot.extent,l=ct(a.size,t.boxplot.size),c=!Rr(u),{transform:f,continuousAxisChannelDef:d,continuousAxis:h,groupby:p,encodingWithoutContinuousAxis:m,ticksOrient:g,tooltipEncoding:y}=QEt(e,u,t),{color:b,size:v}=m,x=Mt(m,["color","size"]),w=M=>pG(a,h,d,M,t.boxplot),S=w(x),C=w(m),k=w(Object.assign({},x,v?{size:v}:{})),E={type:"tick",color:"black",opacity:1,orient:g},_=Object.assign({type:"bar"},l?{size:l}:{}),T=Object.assign({type:"tick"},yt(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},l?{size:l}:{},{orient:g}),D=[...S({partName:"rule",mark:"rule",positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:y}),...S({partName:"rule",mark:"rule",positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:y}),...S({partName:"ticks",mark:E,positionPrefix:"lower_whisker",extraEncoding:y}),...S({partName:"ticks",mark:E,positionPrefix:"upper_whisker",extraEncoding:y}),...C({partName:"box",mark:_,positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:y}),...k({partName:"median",mark:T,positionPrefix:"mid_box",extraEncoding:y})];let O=[];if(!c){const M="datum.lower_box_"+d.field,I="datum.upper_box_"+d.field,P=`(${I} - ${M})`,V=`${M} - ${u} * ${P}`,F=`${I} + ${u} * ${P}`,B=`datum.${d.field}`;O=_2e(a,"outliers",t.boxplot,{transform:[{window:N2e(d.field),frame:[null,null],groupby:p},{filter:`(${B} < ${V}) || (${B} > ${F})`}],mark:"point",encoding:Object.assign({[h]:{field:d.field,type:d.type}},x)})}return O.length>0?Object.assign({},o,{layer:[{transform:f,layer:D},...O]}):Object.assign({},o,{transform:(o.transform||[]).concat(f),layer:D})}function N2e(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function QEt(e,t,n){const r=T2e(e,zA),{continuousAxisChannelDef:i,continuousAxis:s}=E2e(e,r,zA),o=i.field,a=!Rr(t),u=[...N2e(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(a?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(a?"upper_whisker_":"max_")+o}],l=a?[]:[{calculate:`datum.upper_box_${o} - datum.lower_box_${o}`,as:"iqr_"+o},{calculate:`min(datum.upper_box_${o} + datum.iqr_${o} * ${t}, datum.max_${o})`,as:"upper_whisker_"+o},{calculate:`max(datum.lower_box_${o} - datum.iqr_${o} * ${t}, datum.min_${o})`,as:"lower_whisker_"+o}],c=e.encoding,f=s;c[f];const d=Mt(c,[typeof f=="symbol"?f:f+""]),{bins:h,timeUnits:p,aggregate:m,groupby:g,encoding:y}=VO(d,n),b=r==="vertical"?"horizontal":"vertical",x=$2e([{fieldPrefix:"upper_whisker_",titlePrefix:a?"Max":"Upper Whisker"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"lower_whisker_",titlePrefix:a?"Min":"Lower Whisker"}],i,y);return{transform:[...h,...p,{aggregate:[...m,...u],groupby:g},...l],groupby:g,continuousAxisChannelDef:i,continuousAxis:s,encodingWithoutContinuousAxis:y,ticksOrient:b,tooltipEncoding:x}}const I2e="errorbar",JEt={ticks:1,rule:1},eTt=Se(JEt);function tTt(e,t){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:u,tooltipEncoding:l}=D2e(e,I2e,t),c=pG(a,i,r,s,t.errorbar),f={type:"tick",orient:o};return Object.assign({},u,{transform:n,layer:[...c({partName:"ticks",mark:f,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:"rule",positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})]})}function nTt(e,t){const{encoding:n}=e;if(rTt(n))return{orient:T2e(e,t),inputType:"raw"};const r=iTt(n),i=sTt(n),s=n.x,o=n.y;if(r){if(i)throw new Error(t+" cannot be both type aggregated-upper-lower and aggregated-error");const a=n.x2,u=n.y2;if(ye(a)&&ye(u))throw new Error(t+" cannot have both x2 and y2");if(ye(a)){if(ye(s)&&cu(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+t)}else if(ye(u)){if(ye(o)&&cu(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+t)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ye(u)&&!ye(a))throw new Error(t+" cannot have xError2 without xError");if(ye(c)&&!ye(l))throw new Error(t+" cannot have yError2 without yError");if(ye(a)&&ye(l))throw new Error(t+" cannot have both xError and yError with both are quantiative");if(ye(a)){if(ye(s)&&cu(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ye(l)){if(ye(o)&&cu(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function rTt(e){return(ye(e.x)||ye(e.y))&&!ye(e.x2)&&!ye(e.y2)&&!ye(e.xError)&&!ye(e.xError2)&&!ye(e.yError)&&!ye(e.yError2)}function iTt(e){return ye(e.x2)||ye(e.y2)}function sTt(e){return ye(e.xError)||ye(e.xError2)||ye(e.yError)||ye(e.yError2)}const oTt=["x","y","x2","y2","xError","yError","xError2","yError2","color","detail","opacity"];function D2e(e,t,n){e=A2e(e,oTt,t);const{mark:r,encoding:i,selection:s,projection:o}=e,a=Mt(e,["mark","encoding","selection","projection"]),u=Ko(r)?r:{type:r};s&&_e(we.selectionNotSupported(t));const{orient:l,inputType:c}=nTt(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:m}=E2e(e,l,t),{errorBarSpecificAggregate:g,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:v}=aTt(u,f,d,h,p,c,t,n),x=m;i[x];const w=m==="x"?"x2":"y2";i[w];const S=m==="x"?"xError":"yError";i[S];const C=m==="x"?"xError2":"yError2";i[C];const k=Mt(i,[typeof x=="symbol"?x:x+"",typeof w=="symbol"?w:w+"",typeof S=="symbol"?S:S+"",typeof C=="symbol"?C:C+""]),{bins:E,timeUnits:_,aggregate:T,groupby:D,encoding:O}=VO(k,n),M=[...T,...g],I=c!=="raw"?[]:D,P=$2e(b,f,O,v);return{transform:[...a.transform||[],...E,..._,...M.length?[{aggregate:M,groupby:I}]:[],...y],groupby:I,continuousAxisChannelDef:f,continuousAxis:m,encodingWithoutContinuousAxis:O,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:P}}function aTt(e,t,n,r,i,s,o,a){let u=[],l=[];const c=t.field;let f,d=!1;if(s==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&_e(we.errorBarCenterIsUsedWithWrongExtent(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum.center_${c} + datum.extent_${c}`,as:"upper_"+c},{calculate:`datum.center_${c} - datum.extent_${c}`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:FO(h)},{fieldPrefix:"upper_",titlePrefix:Xee(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:Xee(h,p,"-")}],d=!0;else{e.center&&e.extent&&_e(we.errorBarCenterIsNotNeeded(e.extent,o));let m,g,y;p==="ci"?(m="mean",g="ci0",y="ci1"):(m="median",g="q1",y="q3"),u=[{op:g,field:c,as:"lower_"+c},{op:y,field:c,as:"upper_"+c},{op:m,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:gd({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:gd({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:gd({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&_e(we.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum.${n.field}`,as:"upper_"+c},{calculate:`datum.${c}`,as:"lower_"+c}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum.${c} + datum.${r.field}`,as:"upper_"+c}],i?l.push({calculate:`datum.${c} + datum.${i.field}`,as:"lower_"+c}):l.push({calculate:`datum.${c} - datum.${r.field}`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:h.calculate.replace(new RegExp("datum.","g"),"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function Xee(e,t,n){return FO(e)+" "+n+" "+t}const O2e="errorband",uTt={band:1,borders:1},lTt=Se(uTt);function cTt(e,t){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:u}=D2e(e,O2e,t),l=pG(o,i,r,s,t.errorband),c=e.encoding.x!==void 0&&e.encoding.y!==void 0;let f={type:c?"area":"rect"},d={type:c?"line":"rule"};const h=Object.assign({},o.interpolate?{interpolate:o.interpolate}:{},o.tension&&o.interpolate?{interpolate:o.tension}:{});return c?(f=Object.assign({},f,h),d=Object.assign({},d,h)):o.interpolate?_e(we.errorBand1DNotSupport("interpolate")):o.tension&&_e(we.errorBand1DNotSupport("tension")),Object.assign({},a,{transform:n,layer:[...l({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...l({partName:"borders",mark:d,positionPrefix:"lower",extraEncoding:u}),...l({partName:"borders",mark:d,positionPrefix:"upper",extraEncoding:u})]})}const ym={};function HO(e,t,n){ym[e]={normalizer:t,parts:n}}function fTt(e){delete ym[e]}function F2e(){return Se(ym)}function dTt(e){if(e in ym)return ym[e].parts;throw new Error(`Unregistered composite mark ${e}`)}HO(zA,ZEt,KEt);HO(I2e,tTt,eTt);HO(O2e,cTt,lTt);function R2e(e,t){const n=Ko(e.mark)?e.mark.type:e.mark;if(n in ym){const{normalizer:r}=ym[n];return r(e,t)}throw new Error(`Invalid mark type "${n}"`)}const hTt=Object.freeze(Object.defineProperty({__proto__:null,add:HO,getAllCompositeMarks:F2e,getCompositeMarkParts:dTt,normalize:R2e,remove:fTt},Symbol.toStringTag,{value:"Module"})),Kee=["shortTimeLabels"],pTt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength"],M2e={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64},P2e={clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,direction:1,fillColor:1,format:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,strokeWidth:1,symbolFillColor:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,title:1,titleAlign:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontWeight:1,titleLimit:1,titleOpacity:1,titlePadding:1,type:1,values:1,zindex:1},mTt=Object.assign({},P2e,{opacity:1,shape:1,stroke:1,fill:1,size:1,encode:1}),L2e=_r(P2e),z2e=_r(mTt),gTt=Object.freeze(Object.defineProperty({__proto__:null,LEGEND_PROPERTIES:L2e,VG_LEGEND_PROPERTIES:z2e,defaultLegendConfig:M2e},Symbol.toStringTag,{value:"Module"}));var Ut;(function(e){e.LINEAR="linear",e.BIN_LINEAR="bin-linear",e.LOG="log",e.POW="pow",e.SQRT="sqrt",e.TIME="time",e.UTC="utc",e.SEQUENTIAL="sequential",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.ORDINAL="ordinal",e.BIN_ORDINAL="bin-ordinal",e.POINT="point",e.BAND="band"})(Ut||(Ut={}));const ZL={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric","bin-linear":"bin-linear",time:"time",utc:"time",sequential:"sequential",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},B2e=Se(ZL);function U2e(e,t){const n=ZL[e],r=ZL[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const yTt={linear:0,log:1,pow:1,sqrt:1,time:0,utc:0,point:10,band:11,"bin-linear":0,sequential:0,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function QL(e){return yTt[e]}const mG=["linear","bin-linear","log","pow","sqrt","time","utc"],bTt=Ft(mG),W2e=["quantile","quantize","threshold"],vTt=Ft(W2e),V2e=mG.concat(["sequential","quantile","quantize","threshold"]),xTt=Ft(V2e),j2e=["ordinal","bin-ordinal","point","band"],wTt=Ft(j2e),STt=Ft(["bin-linear","bin-ordinal"]),CTt=["time","utc"];function ki(e){return e in wTt}function fk(e){return e in STt}function wf(e){return e in xTt}function fu(e){return e in bTt}function c2(e){return e in vTt}const gG={textXRangeStep:90,rangeStep:20,pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,facetSpacing:16,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function H2e(e){return e&&!!e.name}function GO(e){return e&&e.selection}const G2e={type:1,domain:1,range:1,rangeStep:1,scheme:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},kTt=_r(G2e),$Tt=Mt(G2e,["type","domain","range","rangeStep","scheme"]),q2e=_r($Tt),X2e=ETt();function yG(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":return et(["sequential","ordinal","bin-ordinal","quantile","quantize","threshold"],e);case"interpolate":return et(["linear","bin-linear","pow","log","sqrt","utc","time"],e);case"round":return fu(e)||e==="band"||e==="point";case"padding":return fu(e)||et(["point","band"],e);case"paddingOuter":case"rangeStep":return et(["point","band"],e);case"paddingInner":return e==="band";case"clamp":return fu(e)||e==="sequential";case"nice":return fu(e)||e==="sequential"||e==="quantize";case"exponent":return e==="pow";case"base":return e==="log";case"zero":return wf(e)&&!et(["log","time","utc","bin-linear","threshold","quantile"],e)}throw new Error(`Invalid scale property ${t}.`)}function bG(e,t){switch(t){case"interpolate":case"scheme":return T0(e)?void 0:we.cannotUseScalePropertyWithNonColor(e);case"type":case"domain":case"range":case"base":case"exponent":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeStep":case"reverse":case"round":case"clamp":case"zero":return}throw new Error(`Invalid scale property "${t}".`)}function vG(e,t,n){return et([qs.ORDINAL,qs.NOMINAL],t)?e===void 0||ki(e):t===qs.TEMPORAL?et([Ut.TIME,Ut.UTC,Ut.SEQUENTIAL,void 0],e):t===qs.QUANTITATIVE?et(n?[Ut.BIN_LINEAR,Ut.BIN_ORDINAL,Ut.LINEAR]:[Ut.LOG,Ut.POW,Ut.SQRT,Ut.QUANTILE,Ut.QUANTIZE,Ut.THRESHOLD,Ut.LINEAR,Ut.SEQUENTIAL,void 0],e):!0}function xG(e,t){switch(e){case lt.X:case lt.Y:return fu(t)||et(["band","point"],t);case lt.SIZE:case lt.STROKEWIDTH:case lt.OPACITY:case lt.FILLOPACITY:case lt.STROKEOPACITY:return fu(t)||c2(t)||et(["band","point"],t);case lt.COLOR:case lt.FILL:case lt.STROKE:return t!=="band";case lt.SHAPE:return t==="ordinal"}return!1}function _Tt(e,t,n){return X2e[K2e(e,t,n)]}function ETt(){const e={};for(const t of UH)for(const n of Se(iG))for(const r of B2e)for(const i of[!1,!0]){const s=K2e(t,n,i);xG(t,r)&&vG(r,n,i)&&(e[s]=e[s]||[],e[s].push(r))}return e}function K2e(e,t,n){const r=e+"_"+t;return n?r+"_bin":r}const TTt=Object.freeze(Object.defineProperty({__proto__:null,CONTINUOUS_DOMAIN_SCALES:V2e,CONTINUOUS_TO_CONTINUOUS_SCALES:mG,CONTINUOUS_TO_DISCRETE_SCALES:W2e,DISCRETE_DOMAIN_SCALES:j2e,NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES:q2e,SCALE_PROPERTIES:kTt,SCALE_TYPES:B2e,SCALE_TYPE_INDEX:X2e,get ScaleType(){return Ut},TIME_SCALE_TYPES:CTt,channelScalePropertyIncompatability:bG,channelSupportScaleType:xG,defaultScaleConfig:gG,getSupportedScaleType:_Tt,hasContinuousDomain:wf,hasDiscreteDomain:ki,isBinScale:fk,isContinuousToContinuous:fu,isContinuousToDiscrete:c2,isExtendedScheme:H2e,isSelectionDomain:GO,scaleCompatible:U2e,scaleTypePrecedence:QL,scaleTypeSupportDataType:vG,scaleTypeSupportProperty:yG},Symbol.toStringTag,{value:"Module"})),f2="_vgsid_",ATt={single:{on:"click",fields:[f2],resolve:"global",empty:"all"},multi:{on:"click",fields:[f2],toggle:"event.shiftKey",resolve:"global",empty:"all"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global"}};function Y2e(e){const{anchor:t,frame:n,offset:r,orient:i,color:s}=e,o=Mt(e,["anchor","frame","offset","orient","color"]),a=Object.assign({},o,s?{fill:s}:{}),u=Object.assign({},t?{anchor:t}:{},r?{offset:r}:{},i?{orient:i}:{});return{mark:a,nonMark:u}}const Z2e={width:200,height:200};function Q2e(e){return e&&!!e.scheme}const J2e={padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",invalidValues:"filter",view:Z2e,mark:Gwe,area:{},bar:qwe,circle:{},geoshape:{},line:{},point:{},rect:{},rule:{color:"black"},square:{},text:{color:"black"},tick:Xwe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:gG,projection:{},axis:{},axisX:{},axisY:{minExtent:30},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:M2e,selection:ATt,style:{},title:{}};function eSe(e){return S1(jt(J2e),e)}const NTt=["view",...qH],ITt=["padding","numberFormat","timeFormat","countTitle","stack","scale","selection","invalidValues","overlay"],DTt=Object.assign({view:["width","height"]},Hwe);function tSe(e){e=jt(e);for(const t of ITt)delete e[t];if(e.axis)for(const t of Kee)delete e.axis[t];if(e.legend){for(const t of Kee)delete e.legend[t];for(const t of pTt)delete e.legend[t]}if(e.mark)for(const t of KL)delete e.mark[t];for(const t of NTt){for(const r of KL)delete e[t][r];const n=DTt[t];if(n)for(const r of n)delete e[t][r];Yee(e,t)}for(const t of F2e())delete e[t];Yee(e,"title","group-title");for(const t in e)yt(e[t])&&Se(e[t]).length===0&&delete e[t];return Se(e).length>0?e:void 0}function Yee(e,t,n,r){const i=t==="title"?Y2e(e.title).mark:e[t];t==="view"&&(n="cell");const s=Object.assign({},i,e.style[t]);Se(s).length>0&&(e.style[n||t]=s),delete e[t]}const OTt=Object.freeze(Object.defineProperty({__proto__:null,defaultConfig:J2e,defaultViewConfig:Z2e,initConfig:eSe,isVgScheme:Q2e,stripAndRedirectConfig:tSe},Symbol.toStringTag,{value:"Module"}));function C1(e){return!!e.url}function d2(e){return!!e.values}function wG(e){return!!e.name&&!C1(e)&&!d2(e)}const ts="main",h2="raw",FTt=Object.freeze(Object.defineProperty({__proto__:null,MAIN:ts,RAW:h2,isInlineData:d2,isNamedData:wG,isUrlData:C1},Symbol.toStringTag,{value:"Module"})),SG={titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontWeight:"fontWeight",titleLimit:"limit",titlePadding:"offset"},CG={labelAngle:"angle",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelLimit:"limit",labelPadding:"offset"},nSe=Se(SG),rSe=Se(CG),RTt=Object.freeze(Object.defineProperty({__proto__:null,HEADER_LABEL_PROPERTIES:rSe,HEADER_LABEL_PROPERTIES_MAP:CG,HEADER_TITLE_PROPERTIES:nSe,HEADER_TITLE_PROPERTIES_MAP:SG},Symbol.toStringTag,{value:"Module"}));function Aa(e){return!!e&&(e.op==="count"||!!e.field)&&!!e.op}function kG(e){return!!e&&be(e)}const MTt=Object.freeze(Object.defineProperty({__proto__:null,isSortArray:kG,isSortField:Aa},Symbol.toStringTag,{value:"Module"})),PTt={zero:1,center:1,normalize:1};function iSe(e){return!!PTt[e]}const sSe=[bb,rk,l2,sk,ak,uk,ik,LO,ok],oSe=[bb,rk];function LTt(e){const t=e.x,n=e.y;if(ye(t)&&ye(n))if(t.type==="quantitative"&&n.type==="quantitative"){if(t.stack)return"x";if(n.stack)return"y";if(!!t.aggregate!=!!n.aggregate)return t.aggregate?"x":"y"}else{if(t.type==="quantitative")return"x";if(n.type==="quantitative")return"y"}else{if(ye(t)&&t.type==="quantitative")return"x";if(ye(n)&&n.type==="quantitative")return"y"}}function qO(e,t,n){const r=Ko(e)?e.type:e;if(!et(sSe,r))return null;const i=LTt(t);if(!i)return null;const s=t[i],o=nE(s)?Pe(s,{}):void 0,a=i==="x"?"y":"x",u=t[a],l=nE(u)?Pe(u,{}):void 0,c=Owe.reduce((d,h)=>{if(Wd(t,h)){const p=t[h];(be(p)?p:[p]).forEach(m=>{const g=vh(m);if(g.aggregate)return;const y=nE(g)?Pe(g,{}):void 0;(!y||y!==l&&y!==o)&&d.push({channel:h,fieldDef:g})})}return d},[]);if(c.length===0)return null;let f;return s.stack!==void 0?f=s.stack:et(oSe,r)?f=ct(n,"zero"):f=n,!f||!iSe(f)?null:(s.scale&&s.scale.type&&s.scale.type!==Ut.LINEAR&&_e(we.cannotStackNonLinearScale(s.scale.type)),Wd(t,i===Dt?og:ag)?(s.stack!==void 0&&_e(we.cannotStackRangedMark(i)),null):(s.aggregate&&!et($we,s.aggregate)&&_e(we.stackNonSummativeAggregate(s.aggregate)),{groupbyChannel:u?a:void 0,fieldChannel:i,impute:vb(r),stackBy:c,offset:f}))}const zTt=Object.freeze(Object.defineProperty({__proto__:null,STACKABLE_MARKS:sSe,STACK_BY_DEFAULT_MARKS:oSe,isStackOffset:iSe,stack:qO},Symbol.toStringTag,{value:"Module"}));function $G(e){return bm(e)||XO(e)}function bm(e){return e.vconcat!==void 0}function XO(e){return e.hconcat!==void 0}function Ql(e){return e.layer!==void 0}function Sb(e){return e.repeat!==void 0}function aSe(e,t){return dk(e,t)}function dk(e,t){if(hg(e))return BTt(e,t);if(Ql(e))return cSe(e,t);if(Sb(e))return UTt(e,t);if(bm(e))return WTt(e,t);if(XO(e))return VTt(e,t);if(Sf(e)){const n=Wd(e.encoding,Ld),r=Wd(e.encoding,zd);return n||r?jTt(e,t):p2(e,t)}throw new Error(we.INVALID_SPEC)}function BTt(e,t){const{spec:n}=e,r=Mt(e,["spec"]);return Object.assign({},r,{spec:dk(n,t)})}function uSe(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Se(t).reduce((s,o)=>(n[o]&&s.push(o),s),[]);i.length>0&&_e(we.encodingOverridden(i))}const r=Object.assign({},t||{},n||{});return Se(r).length>0?r:void 0}function lSe(e){const{parentProjection:t,projection:n}=e;return t&&n&&_e(we.projectionOverridden({parentProjection:t,projection:n})),n||t}function cSe(e,t,n,r){const{layer:i,encoding:s,projection:o}=e,a=Mt(e,["layer","encoding","projection"]),u=uSe({parentEncoding:n,encoding:s}),l=lSe({parentProjection:r,projection:o});return Object.assign({},a,{layer:i.map(c=>Ql(c)?cSe(c,t,u,l):p2(c,t,u,l))})}function UTt(e,t){const{spec:n}=e,r=Mt(e,["spec"]);return Object.assign({},r,{spec:dk(n,t)})}function WTt(e,t){const{vconcat:n}=e,r=Mt(e,["vconcat"]);return Object.assign({},r,{vconcat:n.map(i=>dk(i,t))})}function VTt(e,t){const{hconcat:n}=e,r=Mt(e,["hconcat"]);return Object.assign({},r,{hconcat:n.map(i=>dk(i,t))})}function jTt(e,t){const n=e.encoding,{row:r,column:i}=n,s=Mt(n,["row","column"]),{mark:o,width:a,projection:u,height:l,selection:c,encoding:f}=e,d=Mt(e,["mark","width","projection","height","selection","encoding"]);return Object.assign({},d,{facet:Object.assign({},r?{row:r}:{},i?{column:i}:{}),spec:p2(Object.assign({},u?{projection:u}:{},{mark:o},a?{width:a}:{},l?{height:l}:{},{encoding:s},c?{selection:c}:{}),t)})}function HTt(e){return XH(e.mark)}function GTt(e,t,n){return e.point==="transparent"?{opacity:0}:e.point?yt(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?yt(t.point)?t.point:{}:null}function qTt(e,t){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:null}function p2(e,t,n,r){const{encoding:i,projection:s}=e,o=Ko(e.mark)?e.mark.type:e.mark;if(n||r){const a=lSe({parentProjection:r,projection:s}),u=uSe({parentEncoding:n,encoding:i});return p2(Object.assign({},e,a?{projection:a}:{},u?{encoding:u}:{}),t)}return HTt(e)?o==="line"&&(i.x2||i.y2)?(_e(we.lineWithRange(!!i.x2,!!i.y2)),p2(Object.assign({mark:"rule"},e),t,n,r)):vb(o)?XTt(e,t):e:R2e(e,t)}function Zee(e){const t=Mt(e,["point","line"]);return Se(t).length>1?t:t.type}function XTt(e,t={}){const{selection:n,projection:r,encoding:i,mark:s}=e,o=Mt(e,["selection","projection","encoding","mark"]),a=Ko(s)?s:{type:s},u=GTt(a,t[a.type],i),l=a.type==="area"&&qTt(a,t[a.type]);if(!u&&!l)return Object.assign({},e,{mark:Zee(a)});const c=[Object.assign({},n?{selection:n}:{},{mark:Zee(Object.assign({},a,a.type==="area"?{opacity:.7}:{})),encoding:SH(i,["shape"])})],f=qO(a,i,t?t.stack:void 0);let d=i;if(f){const{fieldChannel:h,offset:p}=f;d=Object.assign({},i,{[h]:Object.assign({},i[h],p?{stack:p}:{})})}return l&&c.push(Object.assign({},r?{projection:r}:{},{mark:Object.assign({type:"line"},GL(a,["clip","interpolate","tension"]),l),encoding:d})),u&&c.push(Object.assign({},r?{projection:r}:{},{mark:Object.assign({type:"point",opacity:1,filled:!0},GL(a,["clip"]),u),encoding:d})),Object.assign({},o,{layer:c})}function Sf(e){return!!e.mark}function MM(e,t){return t.forEach(n=>{const r=["field","type","value","timeUnit","bin","aggregate"].reduce((s,o)=>(n[o]!==void 0&&(s[o]=n[o]),s),{}),i=mr(r);e[i]=e[i]||n}),e}function cx(e,t={}){return Ql(e)?e.layer.forEach(n=>{Sf(n)?MM(t,jx(n.encoding)):cx(n,t)}):hg(e)?(MM(t,jx(e.facet)),cx(e.spec,t)):Sb(e)?cx(e.spec,t):$G(e)?(bm(e)?e.vconcat:e.hconcat).forEach(r=>cx(r,t)):MM(t,jx(e.encoding)),t}function KTt(e){return Mc(cx(e))}function YTt(e,t){return t=t||e.config,XH(e.mark)?qO(e.mark,e.encoding,t?t.stack:void 0)!==null:!1}function _G(e){if(hg(e)||Sb(e))return JTt(e);if(Ql(e))return QTt(e);if(Sf(e))return ZTt(e);throw new Error(we.INVALID_SPEC)}function ZTt(e){const t=[];return ck(e.encoding,(n,r)=>{ye(n)&&t.push(n.field)}),t}function QTt(e){let t=[];return e.layer.map(n=>{t=t.concat(_G(n))}),t}function JTt(e){return _G(e.spec)}const eAt=Object.freeze(Object.defineProperty({__proto__:null,fieldDefs:KTt,isConcatSpec:$G,isFacetSpec:hg,isHConcatSpec:XO,isLayerSpec:Ql,isRepeatSpec:Sb,isStacked:YTt,isUnitSpec:Sf,isVConcatSpec:bm,normalize:aSe,usedFields:_G},Symbol.toStringTag,{value:"Module"}));function tAt(e){return e&&e.selection}function EG(e){return e&&!!e.field&&e.equal!==void 0}function fSe(e){return e&&!!e.field&&e.lt!==void 0}function dSe(e){return e&&!!e.field&&e.lte!==void 0}function hSe(e){return e&&!!e.field&&e.gt!==void 0}function pSe(e){return e&&!!e.field&&e.gte!==void 0}function TG(e){return!!(e&&e.field&&be(e.range)&&e.range.length===2)}function AG(e){return e&&!!e.field&&(be(e.oneOf)||be(e.in))}function nAt(e){return e&&!!e.field&&e.valid!==void 0}function mSe(e){return AG(e)||EG(e)||TG(e)||fSe(e)||hSe(e)||dSe(e)||pSe(e)}function Ju(e,t){return lk(e,{timeUnit:t,time:!0})}function rAt(e,t){return e.map(n=>Ju(n,t))}function gSe(e,t=!0){const{field:n,timeUnit:r}=e,i=r?"time("+tG(r,n)+")":Pe(e,{expr:"datum"});if(EG(e))return i+"==="+Ju(e.equal,r);if(fSe(e)){const s=e.lt;return`${i}<${Ju(s,r)}`}else if(hSe(e)){const s=e.gt;return`${i}>${Ju(s,r)}`}else if(dSe(e)){const s=e.lte;return`${i}<=${Ju(s,r)}`}else if(pSe(e)){const s=e.gte;return`${i}>=${Ju(s,r)}`}else{if(AG(e))return`indexof([${rAt(e.oneOf,r).join(",")}], ${i}) !== -1`;if(nAt(e))return e.valid?`${i}!==null&&!isNaN(${i})`:`${i}===null||isNaN(${i})`;if(TG(e)){const s=e.range[0],o=e.range[1];if(s!==null&&o!==null&&t)return"inrange("+i+", ["+Ju(s,r)+", "+Ju(o,r)+"])";const a=[];return s!==null&&a.push(`${i} >= ${Ju(s,r)}`),o!==null&&a.push(`${i} <= ${Ju(o,r)}`),a.length>0?a.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function iAt(e){return mSe(e)&&e.timeUnit?Object.assign({},e,{timeUnit:rG(e.timeUnit)}):e}function NG(e){return e.filter!==void 0}function ySe(e){return e&&e.start!==void 0&&e.stop!==void 0}function bSe(e){return e.lookup!==void 0}function vSe(e){return e.sample!==void 0}function xSe(e){return e.window!==void 0}function wSe(e){return e.flatten!==void 0}function SSe(e){return e.calculate!==void 0}function CSe(e){return!!e.bin}function kSe(e){return e.impute!==void 0}function $Se(e){return e.timeUnit!==void 0}function _Se(e){return e.aggregate!==void 0}function ESe(e){return e.stack!==void 0}function TSe(e){return e.fold!==void 0}function ASe(e){return e.map(t=>NG(t)?{filter:tE(t.filter,iAt)}:t)}const sAt=Object.freeze(Object.defineProperty({__proto__:null,isAggregate:_Se,isBin:CSe,isCalculate:SSe,isFilter:NG,isFlatten:wSe,isFold:TSe,isImpute:kSe,isImputeSequence:ySe,isLookup:bSe,isSample:vSe,isStack:ESe,isTimeUnit:$Se,isWindow:xSe,normalizeTransform:ASe},Symbol.toStringTag,{value:"Module"})),NSe={text:["text"],line:["x","y"],trail:["x","y"],area:["x","y"]},ISe={bar:Ft(["row","column","x","y","size","color","fill","stroke","detail"]),line:Ft(["row","column","x","y","color","fill","stroke","color","detail"]),trail:Ft(["row","column","x","y","color","fill","stroke","color","detail","size"]),area:Ft(["row","column","x","y","color","fill","stroke","detail"]),tick:Ft(["row","column","x","y","color","fill","stroke","detail"]),circle:Ft(["row","column","x","y","color","fill","stroke","size","detail"]),square:Ft(["row","column","x","y","color","fill","stroke","size","detail"]),point:Ft(["row","column","x","y","color","fill","stroke","size","detail","shape"]),geoshape:Ft(["row","column","color","fill","stroke","detail","shape"]),text:Ft(["row","column","size","color","fill","stroke","text"])};function oAt(e,t=NSe,n=ISe){const r=Ko(e.mark)?e.mark.type:e.mark,i=e.encoding,s=t[r],o=n[r];for(const a in s)if(!(s[a]in i))return'Missing encoding channel "'+s[a]+'" for mark "'+r+'"';for(const a in i)if(!o[a])return'Encoding channel "'+a+'" is not supported by mark type "'+r+'"';return r===bb&&!i.x&&!i.y?"Missing both x and y for bar":null}const aAt=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_REQUIRED_CHANNEL_MAP:NSe,DEFAULT_SUPPORTED_CHANNEL_TYPE:ISe,getEncodingMappingError:oAt},Symbol.toStringTag,{value:"Module"}));function uAt(e){const{align:t=void 0,center:n=void 0,bounds:r=void 0,spacing:i=void 0}=e||{};return{align:t,bounds:r,center:n,spacing:i}}function Qee(e){return ft(e)?{type:e}:e||{}}function lAt(e,t,n=!0){const r=Object.assign({type:"pad"},Qee(t),Qee(e));return r.type==="fit"&&(n||(_e(we.FIT_NON_SINGLE),r.type="pad")),r}const cAt=["background","padding"];function Jee(e){return cAt.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}function fAt(e){return!!e.signal}function Cf(e){return!!e.step}function dAt(e){return be(e)?!1:"fields"in e&&!("data"in e)}function hAt(e){return be(e)?!1:"fields"in e&&"data"in e}function Qf(e){return be(e)?!1:"field"in e&&"data"in e}const pAt={opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeMiterLimit:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,cursor:1,href:1,tooltip:1,cornerRadius:1},mAt=_r(pAt);function gAt(e,t){return be(e)?e.map(n=>MA(n,t)).join(", "):e}function fx(e,t,n,r={header:!1}){const i=e.combine(),{orient:s,scale:o,title:a,zindex:u}=i,l=Mt(i,["orient","scale","title","zindex"]);if(Se(l).forEach(c=>{const f=Twe[c];f&&f!==t&&f!=="both"&&delete l[c]}),t==="grid"){if(!l.grid)return;if(l.encode){const{grid:c}=l.encode;l.encode=Object.assign({},c?{grid:c}:{}),Se(l.encode).length===0&&delete l.encode}return Object.assign({scale:o,orient:s},l,{domain:!1,labels:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ct(u,0)})}else{if(!r.header&&e.mainExtracted)return;if(l.encode){for(const f of _H)e.hasAxisPart(f)||delete l.encode[f];Se(l.encode).length===0&&delete l.encode}const c=gAt(a,n);return Object.assign({scale:o,orient:s,grid:!1},c?{title:c}:{},l,{zindex:ct(u,1)})}}function yAt(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>fx(i,"main",t)),...n.map(i=>fx(i,"grid",t)),...r.map(i=>fx(i,"main",t)),...r.map(i=>fx(i,"grid",t))].filter(i=>i)}function bAt(e,t,n){for(const r of n){const i=Js(r,t.markDef,t.config);i!==void 0&&(e[r]={value:i})}return e}function DSe(e){return[].concat(e.type,e.style||[])}function Js(e,t,n,{skipGeneralMarkConfig:r=!1}={}){return ct(JL(e,t,n.style),n[t.type][e],r?void 0:n.mark[e])}function JL(e,t,n){const r=DSe(t);let i;for(const s of r){const o=n[s],a=e;o&&o[a]!==void 0&&(i=o[a])}return i}function OSe(e,t,n,r){const i=IG(e,t,r);if(dn(e.bin)){const s=Pe(e,{expr:n}),o=Pe(e,{expr:n,binSuffix:"end"});return{signal:RSe(s,o,i,r)}}else{if(e.type==="quantitative")return{signal:`${FSe(Pe(e,{expr:n,binSuffix:"range"}),i)}`};if(xb(e)){const s=UO(e)&&e.scale&&e.scale.type===Ut.UTC;return{signal:DG(Pe(e,{expr:n}),e.timeUnit,t,r.text.shortTimeLabels,r.timeFormat,s,!0)}}else return{signal:`''+${Pe(e,{expr:n})}`}}}function IG(e,t,n){if(!xb(e)){if(t)return t;if(e.type===Ud)return n.numberFormat}}function FSe(e,t){return`format(${e}, "${t||""}")`}function ete(e,t,n){return FSe(e,t||n.numberFormat)}function RSe(e,t,n,r){return`${e} === null || isNaN(${e}) ? "null" : ${ete(e,n,r)} + " - " + ${ete(t,n,r)}`}function DG(e,t,n,r,i,s,o=!1){return!t||n?(n=n||i,n||o?`${s?"utc":"time"}Format(${e}, '${n}')`:void 0):i2e(t,e,r,s)}function MSe(e,t){return(be(e)?e:[e]).reduce((n,r)=>(n.field.push(Pe(r,t)),n.order.push(r.sort||"ascending"),n),{field:[],order:[]})}function PSe(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(pn(i)===pn(r))return;n.push(r)}),n}function LSe(e,t){return e===t||!t?e:e?e+", "+t:t}function zSe(e,t){if(be(e.value)&&be(t.value))return{explicit:e.explicit,value:PSe(e.value,t.value)};if(!be(e.value)&&!be(t.value))return{explicit:e.explicit,value:LSe(e.value,t.value)};throw new Error("It should never reach here")}class Br{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}hash(){return this._hash===void 0&&(this._hash=xwe()),this._hash}producedFields(){return new Set}dependentFields(){return new Set}get parent(){return this._parent}set parent(t){this._parent=t,t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class xu extends Br{constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}const vAt="RawCode",xAt="Literal",wAt="Property",SAt="Identifier",CAt="ArrayExpression",kAt="BinaryExpression",$At="CallExpression",_At="ConditionalExpression",EAt="LogicalExpression",TAt="MemberExpression",AAt="ObjectExpression",NAt="UnaryExpression";function Hu(e){this.type=e}Hu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=IAt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function IAt(e){switch(e.type){case CAt:return e.elements;case kAt:case EAt:return[e.left,e.right];case $At:return[e.callee].concat(e.arguments);case _At:return[e.test,e.consequent,e.alternate];case TAt:return[e.object,e.property];case AAt:return e.properties;case wAt:return[e.key,e.value];case NAt:return[e.argument];case SAt:case xAt:case vAt:default:return[]}}var Jl,qe,se,Wi,nn,KO=1,hk=2,vm=3,xh=4,YO=5,mg=6,Ps=7,pk=8,DAt=9;Jl={};Jl[KO]="Boolean";Jl[hk]="<end>";Jl[vm]="Identifier";Jl[xh]="Keyword";Jl[YO]="Null";Jl[mg]="Numeric";Jl[Ps]="Punctuator";Jl[pk]="String";Jl[DAt]="RegularExpression";var OAt="ArrayExpression",FAt="BinaryExpression",RAt="CallExpression",MAt="ConditionalExpression",BSe="Identifier",PAt="Literal",LAt="LogicalExpression",zAt="MemberExpression",BAt="ObjectExpression",UAt="Property",WAt="UnaryExpression",gi="Unexpected token %0",VAt="Unexpected number",jAt="Unexpected string",HAt="Unexpected identifier",GAt="Unexpected reserved word",qAt="Unexpected end of input",e6="Invalid regular expression",PM="Invalid regular expression: missing /",USe="Octal literals are not allowed in strict mode.",XAt="Duplicate data property in object literal not allowed in strict mode",zi="ILLEGAL",m2="Disabled.",KAt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),YAt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function ZO(e,t){if(!e)throw new Error("ASSERT: "+t)}function gc(e){return e>=48&&e<=57}function OG(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Hx(e){return"01234567".indexOf(e)>=0}function ZAt(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function g2(e){return e===10||e===13||e===8232||e===8233}function mk(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&KAt.test(String.fromCharCode(e))}function BA(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&YAt.test(String.fromCharCode(e))}var QAt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function WSe(){for(var e;se<Wi&&(e=qe.charCodeAt(se),ZAt(e)||g2(e));)++se}function t6(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)se<Wi&&OG(qe[se])?(r=qe[se++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Kt({},gi,zi);return String.fromCharCode(i)}function JAt(){var e,t,n,r;for(e=qe[se],t=0,e==="}"&&Kt({},gi,zi);se<Wi&&(e=qe[se++],!!OG(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Kt({},gi,zi),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function VSe(){var e,t;for(e=qe.charCodeAt(se++),t=String.fromCharCode(e),e===92&&(qe.charCodeAt(se)!==117&&Kt({},gi,zi),++se,e=t6("u"),(!e||e==="\\"||!mk(e.charCodeAt(0)))&&Kt({},gi,zi),t=e);se<Wi&&(e=qe.charCodeAt(se),!!BA(e));)++se,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),qe.charCodeAt(se)!==117&&Kt({},gi,zi),++se,e=t6("u"),(!e||e==="\\"||!BA(e.charCodeAt(0)))&&Kt({},gi,zi),t+=e);return t}function eNt(){var e,t;for(e=se++;se<Wi;){if(t=qe.charCodeAt(se),t===92)return se=e,VSe();if(BA(t))++se;else break}return qe.slice(e,se)}function tNt(){var e,t,n;return e=se,t=qe.charCodeAt(se)===92?VSe():eNt(),t.length===1?n=vm:QAt.hasOwnProperty(t)?n=xh:t==="null"?n=YO:t==="true"||t==="false"?n=KO:n=vm,{type:n,value:t,start:e,end:se}}function LM(){var e=se,t=qe.charCodeAt(se),n,r=qe[se],i,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++se,{type:Ps,value:String.fromCharCode(t),start:e,end:se};default:if(n=qe.charCodeAt(se+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return se+=2,{type:Ps,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:se};case 33:case 61:return se+=2,qe.charCodeAt(se)===61&&++se,{type:Ps,value:qe.slice(e,se),start:e,end:se}}}if(o=qe.substr(se,4),o===">>>=")return se+=4,{type:Ps,value:o,start:e,end:se};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return se+=3,{type:Ps,value:s,start:e,end:se};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return se+=2,{type:Ps,value:i,start:e,end:se};if("<>=!+-*%&|^/".indexOf(r)>=0)return++se,{type:Ps,value:r,start:e,end:se};Kt({},gi,zi)}function nNt(e){for(var t="";se<Wi&&OG(qe[se]);)t+=qe[se++];return t.length===0&&Kt({},gi,zi),mk(qe.charCodeAt(se))&&Kt({},gi,zi),{type:mg,value:parseInt("0x"+t,16),start:e,end:se}}function rNt(e){for(var t="0"+qe[se++];se<Wi&&Hx(qe[se]);)t+=qe[se++];return(mk(qe.charCodeAt(se))||gc(qe.charCodeAt(se)))&&Kt({},gi,zi),{type:mg,value:parseInt(t,8),octal:!0,start:e,end:se}}function tte(){var e,t,n;if(n=qe[se],ZO(gc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=se,e="",n!=="."){if(e=qe[se++],n=qe[se],e==="0"){if(n==="x"||n==="X")return++se,nNt(t);if(Hx(n))return rNt(t);n&&gc(n.charCodeAt(0))&&Kt({},gi,zi)}for(;gc(qe.charCodeAt(se));)e+=qe[se++];n=qe[se]}if(n==="."){for(e+=qe[se++];gc(qe.charCodeAt(se));)e+=qe[se++];n=qe[se]}if(n==="e"||n==="E")if(e+=qe[se++],n=qe[se],(n==="+"||n==="-")&&(e+=qe[se++]),gc(qe.charCodeAt(se)))for(;gc(qe.charCodeAt(se));)e+=qe[se++];else Kt({},gi,zi);return mk(qe.charCodeAt(se))&&Kt({},gi,zi),{type:mg,value:parseFloat(e),start:t,end:se}}function iNt(){var e="",t,n,r,i,s=!1;for(t=qe[se],ZO(t==="'"||t==='"',"String literal must starts with a quote"),n=se,++se;se<Wi;)if(r=qe[se++],r===t){t="";break}else if(r==="\\")if(r=qe[se++],!r||!g2(r.charCodeAt(0)))switch(r){case"u":case"x":qe[se]==="{"?(++se,e+=JAt()):e+=t6(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Hx(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),se<Wi&&Hx(qe[se])&&(s=!0,i=i*8+"01234567".indexOf(qe[se++]),"0123".indexOf(r)>=0&&se<Wi&&Hx(qe[se])&&(i=i*8+"01234567".indexOf(qe[se++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&qe[se]===`
`&&++se;else{if(g2(r.charCodeAt(0)))break;e+=r}return t!==""&&Kt({},gi,zi),{type:pk,value:e,octal:s,start:n,end:se}}function sNt(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Kt({},e6)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Kt({},e6)}try{return new RegExp(e,t)}catch{return null}}function oNt(){var e,t,n,r,i;for(e=qe[se],ZO(e==="/","Regular expression literal must start with a slash"),t=qe[se++],n=!1,r=!1;se<Wi;)if(e=qe[se++],t+=e,e==="\\")e=qe[se++],g2(e.charCodeAt(0))&&Kt({},PM),t+=e;else if(g2(e.charCodeAt(0)))Kt({},PM);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Kt({},PM),i=t.substr(1,t.length-2),{value:i,literal:t}}function aNt(){var e,t,n;for(t="",n="";se<Wi&&(e=qe[se],!!BA(e.charCodeAt(0)));)++se,e==="\\"&&se<Wi?Kt({},gi,zi):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Kt({},e6,n),{value:n,literal:t}}function uNt(){var e,t,n,r;return nn=null,WSe(),e=se,t=oNt(),n=aNt(),r=sNt(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:se}}function lNt(e){return e.type===vm||e.type===xh||e.type===KO||e.type===YO}function jSe(){var e;return WSe(),se>=Wi?{type:hk,start:se,end:se}:(e=qe.charCodeAt(se),mk(e)?tNt():e===40||e===41||e===59?LM():e===39||e===34?iNt():e===46?gc(qe.charCodeAt(se+1))?tte():LM():gc(e)?tte():LM())}function Ws(){var e;return e=nn,se=e.end,nn=jSe(),se=e.end,e}function HSe(){var e;e=se,nn=jSe(),se=e}function cNt(e){var t=new Hu(OAt);return t.elements=e,t}function nte(e,t,n){var r=new Hu(e==="||"||e==="&&"?LAt:FAt);return r.operator=e,r.left=t,r.right=n,r}function fNt(e,t){var n=new Hu(RAt);return n.callee=e,n.arguments=t,n}function dNt(e,t,n){var r=new Hu(MAt);return r.test=e,r.consequent=t,r.alternate=n,r}function FG(e){var t=new Hu(BSe);return t.name=e,t}function dx(e){var t=new Hu(PAt);return t.value=e.value,t.raw=qe.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function rte(e,t,n){var r=new Hu(zAt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function hNt(e){var t=new Hu(BAt);return t.properties=e,t}function ite(e,t,n){var r=new Hu(UAt);return r.key=t,r.value=n,r.kind=e,r}function pNt(e,t){var n=new Hu(WAt);return n.operator=e,n.argument=t,n.prefix=!0,n}function Kt(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,o)=>(ZO(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=se,n.description=i,n}function QO(e){e.type===hk&&Kt(e,qAt),e.type===mg&&Kt(e,VAt),e.type===pk&&Kt(e,jAt),e.type===vm&&Kt(e,HAt),e.type===xh&&Kt(e,GAt),Kt(e,gi,e.value)}function Vi(e){var t=Ws();(t.type!==Ps||t.value!==e)&&QO(t)}function An(e){return nn.type===Ps&&nn.value===e}function zM(e){return nn.type===xh&&nn.value===e}function mNt(){var e=[];for(se=nn.start,Vi("[");!An("]");)An(",")?(Ws(),e.push(null)):(e.push(xm()),An("]")||Vi(","));return Ws(),cNt(e)}function ste(){var e;return se=nn.start,e=Ws(),e.type===pk||e.type===mg?(e.octal&&Kt(e,USe),dx(e)):FG(e.value)}function gNt(){var e,t,n,r;if(se=nn.start,e=nn,e.type===vm)return n=ste(),Vi(":"),r=xm(),ite("init",n,r);if(e.type===hk||e.type===Ps)QO(e);else return t=ste(),Vi(":"),r=xm(),ite("init",t,r)}function yNt(){var e=[],t,n,r,i={},s=String;for(se=nn.start,Vi("{");!An("}");)t=gNt(),t.key.type===BSe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Kt({},XAt):i[r]=!0,e.push(t),An("}")||Vi(",");return Vi("}"),hNt(e)}function bNt(){var e;return Vi("("),e=RG(),Vi(")"),e}var vNt={if:1};function xNt(){var e,t,n;if(An("("))return bNt();if(An("["))return mNt();if(An("{"))return yNt();if(e=nn.type,se=nn.start,e===vm||vNt[nn.value])n=FG(Ws().value);else if(e===pk||e===mg)nn.octal&&Kt(nn,USe),n=dx(Ws());else{if(e===xh)throw new Error(m2);e===KO?(t=Ws(),t.value=t.value==="true",n=dx(t)):e===YO?(t=Ws(),t.value=null,n=dx(t)):An("/")||An("/=")?(n=dx(uNt()),HSe()):QO(Ws())}return n}function wNt(){var e=[];if(Vi("("),!An(")"))for(;se<Wi&&(e.push(xm()),!An(")"));)Vi(",");return Vi(")"),e}function SNt(){var e;return se=nn.start,e=Ws(),lNt(e)||QO(e),FG(e.value)}function CNt(){return Vi("."),SNt()}function kNt(){var e;return Vi("["),e=RG(),Vi("]"),e}function $Nt(){var e,t,n;for(e=xNt();;)if(An("."))n=CNt(),e=rte(".",e,n);else if(An("("))t=wNt(),e=fNt(e,t);else if(An("["))n=kNt(),e=rte("[",e,n);else break;return e}function ote(){var e=$Nt();if(nn.type===Ps&&(An("++")||An("--")))throw new Error(m2);return e}function rE(){var e,t;if(nn.type!==Ps&&nn.type!==xh)t=ote();else{if(An("++")||An("--"))throw new Error(m2);if(An("+")||An("-")||An("~")||An("!"))e=Ws(),t=rE(),t=pNt(e.value,t);else{if(zM("delete")||zM("void")||zM("typeof"))throw new Error(m2);t=ote()}}return t}function ate(e){var t=0;if(e.type!==Ps&&e.type!==xh)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function _Nt(){var e,t,n,r,i,s,o,a,u,l;if(e=nn,u=rE(),r=nn,i=ate(r),i===0)return u;for(r.prec=i,Ws(),t=[e,nn],o=rE(),s=[u,r,o];(i=ate(nn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=nte(a,u,o),s.push(n);r=Ws(),r.prec=i,s.push(r),t.push(nn),n=rE(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=nte(s[l-1].value,s[l-2],n),l-=2;return n}function xm(){var e,t,n;return e=_Nt(),An("?")&&(Ws(),t=xm(),Vi(":"),n=xm(),e=dNt(e,t,n)),e}function RG(){var e=xm();if(An(","))throw new Error(m2);return e}function GSe(e){qe=e,se=0,Wi=qe.length,nn=null,HSe();var t=RG();if(nn.type!==hk)throw new Error("Unexpect token after expression.");return t}const ENt={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function TNt(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&he("Missing arguments to clamp function."),o.length>3&&he("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(o){return"("+e(o[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),replace:n("replace",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&he("Missing arguments to if function."),o.length>3&&he("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function ANt(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function NNt(e){e=e||{};const t=e.whitelist?Ft(e.whitelist):{},n=e.blacklist?Ft(e.blacklist):{},r=e.constants||ENt,i=(e.functions||TNt)(f),s=e.globalvar,o=e.fieldvar,a=Ot(s)?s:p=>`${s}["${p}"]`;let u={},l={},c=0;function f(p){if(ft(p))return p;const m=d[p.type];return m==null&&he("Unsupported type: "+p.type),m(p)}const d={Literal:p=>p.raw,Identifier:p=>{const m=p.name;return c>0?m:os(n,m)?he("Illegal identifier: "+m):os(r,m)?r[m]:os(t,m)?m:(u[m]=1,a(m))},MemberExpression:p=>{const m=!p.computed,g=f(p.object);m&&(c+=1);const y=f(p.property);return g===o&&(l[ANt(y)]=1),m&&(c-=1),g+(m?"."+y:"["+y+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&he("Illegal callee type: "+p.callee.type);const m=p.callee.name,g=p.arguments,y=os(i,m)&&i[m];return y||he("Unrecognized function: "+m),Ot(y)?y(g):y+"("+g.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const m=f(p.key);return c-=1,m+":"+f(p.value)}};function h(p){const m={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},m}return h.functions=i,h.constants=r,h}function n6(e){let t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t=t.concat(n6(e.object)),t=t.concat(n6(e.property))),t)}function qSe(e){return e.object.type==="MemberExpression"?qSe(e.object):e.object.name==="datum"}function XSe(e){const t=GSe(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&qSe(r)&&n.add(n6(r).slice(1).join("."))}),n}class wm extends Br{constructor(t,n){super(t),this.transform=n,this._dependentFields=XSe(this.transform.calculate)}clone(){return new wm(null,jt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(UO(r)&&kG(r.sort)){const{field:s,timeUnit:o}=r,a=r.sort,u=a.map((l,c)=>`${gSe({field:s,timeUnit:o,equal:l})} ? ${c} : `).join("")+a.length;t=new wm(t,{calculate:u,as:k1(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${mr(this.transform)}`}}function k1(e,t,n){return Pe(e,Object.assign({prefix:t,suffix:"sort_index"},n||{}))}const ute=["row","column"],INt=["header","footer"];function DNt(e){return e==="top"||e==="left"?"header":"footer"}function ONt(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0;return{name:`${t}-title`,type:"group",role:`${t}-title`,title:Object.assign({text:n,offset:10},t==="row"?{orient:"left"}:{},{style:"guide-title"},KSe(r,i,nSe,SG))}}function FNt(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of INt)if(n[i])for(const s of n[i])r.push(LNt(e,t,i,n,s));return r}function RNt(e){return e=(e%360+360)%360,(e+90)%180===0?{}:e<90||270<e?{align:{value:"right"}}:135<=e&&e<225?{align:{value:"left"}}:{}}function MNt(e){return e=(e%360+360)%360,45<=e&&e<=135?{baseline:"top"}:{baseline:"middle"}}function PNt(e,t){const{sort:n}=e;return Aa(n)?{field:Pe(n,{expr:"datum"}),order:n.order||"ascending"}:be(n)?{field:k1(e,t,{expr:"datum"}),order:"ascending"}:{field:Pe(e,{expr:"datum"}),order:n||"ascending"}}function LNt(e,t,n,r,i){if(i){let s=null;const{facetFieldDef:o}=r;if(o&&i.labels){const{header:l={}}=o,{format:c,labelAngle:f}=l,d=e.config?e.config:void 0,h=Object.assign({},RNt(f));s=Object.assign({text:OSe(o,c,"parent",e.config),offset:10},t==="row"?{orient:"left"}:{},{style:"guide-label"},f!==void 0?{angle:f}:{},MNt(f),KSe(d,o,rSe,CG),Se(h).length>0?{encode:{update:h}}:{})}const a=i.axes,u=a&&a.length>0;if(s||u){const l=t==="row"?"height":"width";return Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:PNt(o,t)}:{},s?{title:s}:{},i.sizeSignal?{encode:{update:{[l]:i.sizeSignal}}}:{},u?{axes:a}:{})}}return null}function KSe(e,t,n,r){const i={};for(const s of n)e&&e.header&&e.header[s]&&(i[r[s]]=e.header[s]),t&&t.header&&t.header[s]&&(i[r[s]]=t.header[s]);return i}function MG(e){return[].concat(lte(e,"width"),lte(e,"height"))}function lte(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="range-step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(ki(o)&&Cf(a)){const u=e.scaleName(n);return Tl(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[cte(u,a)]:[cte(u,a),{name:i,update:YSe(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is range step although there is no rangeStep.")}else return[{name:i,value:r}]}function cte(e,t){return{name:e+"_step",value:t.step}}function YSe(e,t,n){const r=t.get("type"),i=t.get("padding"),s=ct(t.get("paddingOuter"),i);let o=t.get("paddingInner");return o=r==="band"?o!==void 0?o:i:1,`bandspace(${n}, ${o}, ${s}) * ${e}_step`}const UA="[",WA="]",ZSe="{",QSe="}",zNt=":",JSe=",",BNt="@",UNt=">",WNt=/[[\]{}]/,VNt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let eCe,tCe;function JO(e,t,n){return eCe=t,tCe=VNt,nCe(e.trim()).map(r6)}function jNt(e){return tCe[e]}function Gx(e,t,n,r,i){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return t}function nCe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=Gx(e,i,JSe,UA+ZSe,WA+QSe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function r6(e){return e[0]==="["?HNt(e):GNt(e)}function HNt(e){const t=e.length;let n=1,r;if(n=Gx(e,n,WA,UA,WA),n===t)throw"Empty between selector: "+e;if(r=nCe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==UNt)throw"Expected '>' after between selector: "+e;r=r.map(r6);const i=r6(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function GNt(e){const t={source:eCe},n=[];let r=[0,0],i=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===QSe){if(a=e.lastIndexOf(ZSe),a>=0){try{r=qNt(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===BNt&&(i=++a),u=Gx(e,a,zNt),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=Gx(e,a,UA),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Gx(e,a,WA),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==UA)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||WNt.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):jNt(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function qNt(e){const t=e.split(JSe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}class Pc extends Br{constructor(t,n){super(t),this.formula=n}clone(){return new Pc(null,jt(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s)=>{if(s.timeUnit){const o=Pe(s,{forAs:!0});i[o]={as:o,timeUnit:s.timeUnit,field:s.field}}return i},{});return Se(r).length===0?null:new Pc(t,r)}static makeFromTransform(t,n){return new Pc(t,{[n.field]:{as:n.as,timeUnit:n.timeUnit,field:n.field}})}merge(t){this.formula=Object.assign({},this.formula,t.formula),t.remove()}producedFields(){return new Set(Mc(this.formula).map(t=>t.as))}dependentFields(){return new Set(Mc(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${mr(this.formula)}`}assemble(){return Mc(this.formula).map(t=>({type:"formula",as:t.as,expr:tG(t.timeUnit,t.field)}))}}const eF="_fields",XNt={has:e=>{const t=e;return t.fields!==void 0||t.encodings!==void 0},parse:(e,t,n)=>{const r={},i={},s=n.project||(n.project=[]);n.fields={},t.fields&&s.push(...t.fields.map(o=>({field:o,type:"E"})));for(const o of t.encodings||[]){const a=e.fieldDef(o);if(a){let u=a.field;if(a.timeUnit&&(u=e.vgField(o),r[u]={as:u,field:a.field,timeUnit:a.timeUnit}),!i[u]){let l="E";if(n.type==="interval"){const c=e.getScaleComponent(o).get("type");wf(c)&&!fk(c)&&(l="R")}else a.bin&&(l="R-RE");s.push(i[u]={field:u,channel:o,type:l})}n.fields[o]=u}else _e(we.cannotProjectOnChannelWithoutField(o))}Se(r).length&&(n.timeUnit=new Pc(null,r))},signals:(e,t,n)=>{const r=t.name+Na+eF;return n.filter(s=>s.name===r).length?n:n.concat({name:r,update:`${JSON.stringify(t.project)}`})}},Vd={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t,n)=>{const r=Ul(n.name),i=n.scales=[];for(const s of n.project){const o=s.channel;if(!dg(o))continue;const a=e.getScaleComponent(o),u=a?a.get("type"):void 0;if(!a||!wf(u)||fk(u)){_e(we.SCALE_BINDINGS_CONTINUOUS);continue}a.set("domainRaw",{signal:Ta(s.field,r)},!0),i.push(o),e.repeater&&e.repeater.row===e.repeater.column&&e.getScaleComponent(o===Dt?fn:Dt).set("domainRaw",{signal:Ta(s.field,r)},!0)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(o=>!n.filter(a=>a.name===wu(t,o,"data")).length).map(o=>({channel:o,signal:wu(t,o,"data")}));if(!e.parent||!r.length)return n;const i=n.filter(o=>o.name===t.name)[0],s=i.update;if(s.indexOf(cCe)>=0)i.update="{"+r.map(o=>`${Fe(t.fields[o.channel])}: ${o.signal}`).join(", ")+"}";else for(const o of r){const a=`, ${Fe(t.fields[o.channel])}: ${o.signal}`;s.indexOf(a)<0&&(i.update=s.substring(0,s.length-1)+a+"}")}return n.concat(r.map(o=>({name:o.signal})))},signals:(e,t,n)=>{if(e.parent)for(const r of t.scales){const i=n.filter(s=>s.name===wu(t,r,"data"))[0];i.push="outer",delete i.value,delete i.update}return n}};function i6(e,t){return`domain(${Fe(e.scaleName(t))})`}const qx="_brush",s6="_scale_trigger",KNt={signals:(e,t)=>{const n=t.name,r=n+Na+eF,i=Vd.has(t),s=[],o=[],a=[];if(t.translate&&!i){const u=`!event.item || event.item.mark.name !== ${Fe(n+qx)}`;rCe(t,(l,c)=>{const f=c.between[0].filter||(c.between[0].filter=[]);f.indexOf(u)<0&&f.push(u)})}for(const u of t.project){const l=u.channel;if(l!==Dt&&l!==fn){_e("Interval selections only support x and y encoding channels.");continue}const c=YNt(e,t,l),f=wu(t,l,"data"),d=wu(t,l,"visual"),h=Fe(e.scaleName(l)),p=e.getScaleComponent(l).get("type"),m=wf(p)?"+":"";s.push(...c),o.push(f),a.push({scaleName:e.scaleName(l),expr:`(!isArray(${f}) || (${m}invert(${h}, ${d})[0] === ${m}${f}[0] && ${m}invert(${h}, ${d})[1] === ${m}${f}[1]))`})}return i||s.push({name:n+s6,update:a.map(u=>u.expr).join(" && ")+` ? ${n+s6} : {}`}),s.concat({name:n+Na,on:[{events:o.map(u=>({signal:u})),update:o.join(" && ")+` ? {unit: ${Np(e)}, fields: ${r}, values: [${o.join(", ")}]} : null`}]})},modifyExpr:(e,t)=>t.name+Na+", "+(t.resolve==="global"?"true":`{unit: ${Np(e)}}`),marks:(e,t,n)=>{const r=t.name,{xi:i,yi:s}=nF(t),o=`data(${Fe(t.name+$1)})`;if(Vd.has(t))return n;const a={x:i!==null?{signal:`${r}_x[0]`}:{value:0},y:s!==null?{signal:`${r}_y[0]`}:{value:0},x2:i!==null?{signal:`${r}_x[1]`}:{field:{group:"width"}},y2:s!==null?{signal:`${r}_y[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const h of Se(a))a[h]=[Object.assign({test:`${o}.length && ${o}[0].unit === ${Np(e)}`},a[h]),{value:0}];const u=t.mark,{fill:l,fillOpacity:c}=u,f=Mt(u,["fill","fillOpacity"]),d=Se(f).reduce((h,p)=>(h[p]=[{test:[i!==null&&`${r}_x[0] !== ${r}_x[1]`,s!=null&&`${r}_y[0] !== ${r}_y[1]`].filter(m=>m).join(" && "),value:f[p]},{value:null}],h),{});return[{name:r+qx+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:l},fillOpacity:{value:c}},update:a}}].concat(n,{name:r+qx,type:"rect",clip:!0,encode:{enter:{fill:{value:"transparent"}},update:Object.assign({},a,d)}})}};function YNt(e,t,n){const r=wu(t,n,"visual"),i=wu(t,n,"data"),s=Vd.has(t),o=e.scaleName(n),a=Fe(o),u=e.getScaleComponent(n),l=u?u.get("type"):void 0,c=e.getSizeSignalRef(n===Dt?"width":"height").signal,f=`${n}(unit)`,d=rCe(t,(h,p)=>h.concat({events:p.between[0],update:`[${f}, ${f}]`},{events:p,update:`[${r}[0], clamp(${f}, 0, ${c})]`}));return d.push({events:{signal:t.name+s6},update:wf(l)&&!fk(l)?`[scale(${a}, ${i}[0]), scale(${a}, ${i}[1])]`:"[0, 0]"}),s?[{name:i,on:[]}]:[{name:r,value:[],on:d},{name:i,on:[{events:{signal:r},update:`${r}[0] === ${r}[1] ? null : invert(${a}, ${r})`}]}]}function rCe(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(_e(`${r} is not an ordered event stream for interval selections`),n),[])}function iCe(e,t){const n=t.name,r=n+Na+eF,i=t.project,s="(item().isVoronoi ? datum.datum : datum)",o=i.map(a=>{const u=e.fieldDef(a.channel);return u&&u.bin?`[${Ta(e.vgField(a.channel,{}),s)}, ${Ta(e.vgField(a.channel,{binSuffix:"end"}),s)}]`:`${Ta(a.field,s)}`}).join(", ");return[{name:n+Na,value:{},on:[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? {unit: ${Np(e)}, fields: ${r}, values: [${o}]} : null`,force:!0}]}]}const ZNt={signals:iCe,modifyExpr:(e,t)=>t.name+Na+", "+(t.resolve==="global"?"null":`{unit: ${Np(e)}}`)},QNt={signals:iCe,modifyExpr:(e,t)=>t.name+Na+", "+(t.resolve==="global"?"true":`{unit: ${Np(e)}}`)},fte="voronoi",sCe={has:e=>e.type!=="interval"&&e.nearest,marks:(e,t,n)=>{const{x:r,y:i}=nF(t),s=e.mark;if(vb(s))return _e(we.nearestNotSupportForContinuous(s)),n;const o={name:e.getName(fte),type:"path",from:{data:e.getName("marks")},encode:{enter:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}}},transform:[{type:"voronoi",x:{expr:r||!r&&!i?"datum.datum.x || 0":"0"},y:{expr:i||!r&&!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{const f=l.name||"";f===e.component.mark[0].name?a=c:f.indexOf(fte)>=0&&(u=!0)}),u||n.splice(a+1,0,o),n}},JNt={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales",topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,s=t.bind,o=sCe.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";for(const a of i){const u=Ul(`${r}_${a.field}`);n.filter(c=>c.name===u).length||n.unshift({name:u,value:"",on:[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${Ta(a.field,o)} : null`}],bind:s[a.field]||s[a.channel]||s})}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.filter(l=>l.name===r+Na)[0],o=r+Na+eF,a=i.map(l=>Ul(`${r}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(s.update=`${u} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},dte="_toggle",eIt={has:e=>e.type==="multi"&&e.toggle,signals:(e,t,n)=>n.concat({name:t.name+dte,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t,n)=>{const r=t.name+Na,i=t.name+dte;return`${i} ? null : ${r}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${Np(e)}}, `)+`${i} ? ${r} : null`}},oCe="_translate_anchor",aCe="_translate_delta",tIt={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Vd.has(t),s=r+oCe,{x:o,y:a}=nF(t);let u=JO(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+qx,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==null?", extent_x: "+(i?i6(e,Dt):`slice(${wu(t,"x","visual")})`):"")+(a!==null?", extent_y: "+(i?i6(e,fn):`slice(${wu(t,"y","visual")})`):"")+"}"}]},{name:r+aCe,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==null&&hte(e,t,Dt,"width",n),a!==null&&hte(e,t,fn,"height",n),n}};function hte(e,t,n,r,i){const s=t.name,o=Vd.has(t),a=i.filter(b=>b.name===wu(t,n,o?"data":"visual"))[0],u=s+oCe,l=s+aCe,c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(n),d=f.get("type"),h=o&&n===Dt?"-":"",p=`${u}.extent_${n}`,m=`${h}${l}.${n} / `+(o?`${c}`:`span(${p})`),y=`${o?d==="log"?"panLog":d==="pow"?"panPow":"panLinear":"panLinear"}(${p}, ${m}`+(o&&d==="pow"?`, ${f.get("exponent")||1}`:"")+")";a.on.push({events:{signal:l},update:o?y:`clampRange(${y}, 0, ${c})`})}const uCe="_zoom_anchor",lCe="_zoom_delta",nIt={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Vd.has(t),s=r+lCe,{x:o,y:a}=nF(t),u=Fe(e.scaleName(Dt)),l=Fe(e.scaleName(fn));let c=JO(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+qx,f))),n.push({name:r+uCe,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==null&&pte(e,t,"x","width",n),a!==null&&pte(e,t,"y","height",n),n}};function pte(e,t,n,r,i){const s=t.name,o=Vd.has(t),a=i.filter(g=>g.name===wu(t,n,o?"data":"visual"))[0],u=e.getSizeSignalRef(r).signal,l=e.getScaleComponent(n),c=l.get("type"),f=o?i6(e,n):a.name,d=s+lCe,h=`${s}${uCe}.${n}`,m=`${o?c==="log"?"zoomLog":c==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${f}, ${h}, ${d}`+(o&&c==="pow"?`, ${l.get("exponent")||1}`:"")+")";a.on.push({events:{signal:d},update:o?m:`clampRange(${m}, 0, ${u})`})}const BM={project:XNt,toggle:eIt,scales:Vd,translate:tIt,zoom:nIt,inputs:JNt,nearest:sCe};function tF(e,t){for(const n in BM)BM[n].has(e)&&t(BM[n])}const $1="_store",Na="_tuple",rIt="_modify",PG="_selection_domain_",cCe="vlSelectionResolve";function iIt(e,t){const n={},r=e.config.selection;t&&(t=jt(t));for(let i in t){if(!t.hasOwnProperty(i))continue;const s=t[i],o=r[s.type];for(const u in o)u==="encodings"&&s.fields||u==="fields"&&s.encodings||(u==="mark"&&(s[u]=Object.assign({},o[u],s[u])),(s[u]===void 0||s[u]===!0)&&(s[u]=o[u]||s[u]));i=Ul(i);const a=n[i]=Object.assign({},s,{name:i,events:ft(s.on)?JO(s.on,"scope"):s.on});tF(a,u=>{u.parse&&u.parse(e,s,a)})}return n}function sIt(e,t){return gk(e,(n,r)=>{const i=n.name;let s=r.modifyExpr(e,n);t.push(...r.signals(e,n)),tF(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(s=o.modifyExpr(e,n,s))}),t.push({name:i+rIt,on:[{events:{signal:i+Na},update:`modify(${Fe(n.name+$1)}, ${s})`}]})}),t}function oIt(e,t){if(e.component.selection&&Se(e.component.selection).length){const n=Fe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:JO("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return t}function aIt(e,t){let n=!1;return gk(e,(r,i)=>{const s=r.name,o=Fe(s+$1);t.filter(u=>u.name===s).length||t.push({name:r.name,update:`${cCe}(${o}`+(r.resolve==="global"?")":`, ${Fe(r.resolve)})`)}),n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),tF(r,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))})}),n&&(t.filter(i=>i.name==="unit").length||t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})),t}function uIt(e,t){return gk(e,n=>{t.filter(i=>i.name===n.name+$1).length||t.push({name:n.name+$1})}),t}function fCe(e,t){return gk(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,tF(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function lIt(e,t){for(const n of e.children)us(n)&&(t=fCe(n,t));return t}function dCe(e,t,n){const r=[];function i(o){const a=Ul(o),u=e.getSelectionComponent(a,o),l=Fe(a+$1);if(u.timeUnit){const c=n||e.component.data.raw,f=u.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}return u.empty!=="none"&&r.push(l),`vlSelectionTest(${l}, datum`+(u.resolve==="global"?")":`, ${Fe(u.resolve)})`)}const s=E0(t,i);return(r.length?"!("+r.map(o=>`length(data(${o}))`).join(" || ")+") || ":"")+`(${s})`}function cIt(e){return e.signal.indexOf(PG)>=0}function fIt(e,t){const n=JSON.parse(t.signal.replace(PG,"")),r=Ul(n.selection),i=n.encoding;let s=n.field,o=e.component.selection&&e.component.selection[r];if(o)_e('Use "bind": "scales" to setup a binding for scales and selections within the same view.');else{if(o=e.getSelectionComponent(r,n.selection),!i&&!s)s=o.project[0].field,o.project.length>1&&_e(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Fe(s)}.`);else if(i&&!s){const a=o.project.filter(u=>u.channel===i);!a.length||a.length>1?(s=o.project[0].field,_e((a.length?"Multiple ":"No ")+`matching ${Fe(i)} encoding found for selection ${Fe(n.selection)}. Using "field": ${Fe(s)}.`)):s=a[0].field}return{signal:Ta(s,r)}}return{signal:"null"}}function gk(e,t){const n=e.component.selection;for(const r in n)if(n.hasOwnProperty(r)){const i=n[r];t(i,dIt(i.type))}}function dIt(e){switch(e){case"single":return QNt;case"multi":return ZNt;case"interval":return KNt}return null}function hIt(e){let t=e.parent;for(;t&&!Tl(t);)t=t.parent;return t}function Np(e){let t=Fe(e.name);const n=hIt(e);return n&&(t+=(n.facet.row?` + '_' + (${Ta(n.vgField("row"),"facet")})`:"")+(n.facet.column?` + '_' + (${Ta(n.vgField("column"),"facet")})`:"")),t}function o6(e){let t=!1;return gk(e,n=>{t=t||n.project.some(r=>r.field===f2)}),t}function wu(e,t,n){const r=e._signalNames||(e._signalNames={});if(r[t]&&r[t][n])return r[t][n];r[t]=r[t]||{};const i=Ul(e.name+"_"+(n==="visual"?t:e.fields[t]));let s=i,o=1;for(;r[s];)s=`${i}_${o++}`;return r[s]=r[t][n]=s}function nF(e){let t=null,n=null,r=null,i=null;return e.project.forEach((s,o)=>{s.channel===Dt?(t=s,n=o):s.channel===fn&&(r=s,i=o)}),{x:t,xi:n,y:r,yi:i}}function hCe(e,t,n){return E0(t,r=>ft(r)?r:tAt(r)?dCe(e,r.selection,n):gSe(r))}function pIt(e,t,n,r,i,s,o){return ye(t)&&s&&e===s.fieldChannel?fa(t,r,{suffix:"end"}):LG(e,t,n,r,i,s,o)}function mIt(e,t,n,r,i,s,o){return ye(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?fa(t,r,{suffix:"start"}):LG(e,n,void 0,r,i,s,o)}function pCe(e,t){const n=e+"Offset",r=t[n];if(r)return r}function mte(e,t,n,r){return fa(e,t,{binSuffix:n==="start"?void 0:"end"},r?{offset:r}:{})}function fa(e,t,n,r){const i=Object.assign({},t?{scale:t}:{},{field:Pe(e,n)});return r?Object.assign({},i,r):i}function mCe(e,t=!0){return{scale:e,band:t}}function gte(e,t,n){const r=Pe(t,{expr:"datum"}),i=n!==void 0?Pe(n,{expr:"datum"}):Pe(t,{binSuffix:"end",expr:"datum"});return{signal:`scale("${e}", (${r} + ${i}) / 2)`}}function LG(e,t,n,r,i,s,o){if(t){if(ye(t)){if(Wl(t)){if(dn(t.bin))return et([Dt,fn],e)&&t.type===Ud?s&&s.impute?fa(t,r,{binSuffix:"mid"}):gte(r,t):fa(t,r,wb(t,e)?{binSuffix:"range"}:{});if(Do(t.bin)){if(ye(n))return gte(r,t,n);{const a=e===Dt?og:ag;_e(we.channelRequiredForBinned(a))}}}if(i){const a=i.get("type");if(ki(a))return a==="band"?fa(t,r,{binSuffix:"range"},{band:.5}):fa(t,r,{binSuffix:"range"})}return fa(t,r,{})}else if(nf(t)){const a=t.value;return et(["x","x2"],e)&&a==="width"?{field:{group:"width"}}:et(["y","y2"],e)&&a==="height"?{field:{group:"height"}}:{value:a}}}return Ot(o)?o():o}function yte(e,t){const n=[],r={};function i(s,o){const a=MO(o);o!==a&&(s=Object.assign({},s,{type:e[a].type}));const u=gd(s,t,{allowDisabling:!1}),l=zG(s,t).signal;r[u]||n.push(`${Fe(u)}: ${l}`),r[u]=!0}return ck(e,(s,o)=>{ye(s)?i(s,o):Iu(s)&&i(s.condition,o)}),n.length?{signal:`{${n.join(", ")}}`}:void 0}function zG(e,t){if(e){if(nf(e))return{value:e.value};if(Wl(e))return OSe(e,v2e(e),"datum",t)}}function oo(e){return Object.assign({},e,{mult:.5})}function gIt(e){if(e.get("zero")!==!1)return!0;const t=e.domains;return be(t)?a2(t,n=>be(n)&&n.length===2&&n[0]<=0&&n[1]>=0):!1}function gCe(e,t,n,r,i){return()=>{if(ft(e)){if(n){const s=r.get("type");if(et([Ut.LOG,Ut.TIME,Ut.UTC],s))(i==="bar"||i==="area")&&_e(we.nonZeroScaleUsedWithLengthMark(i,t,{scaleType:s}));else{if(gIt(r))return{scale:n,value:0};(i==="bar"||i==="area")&&_e(we.nonZeroScaleUsedWithLengthMark(i,t,{zeroFalse:r.explicit.zero===!1}))}}return e==="zeroOrMin"?t==="x"?{value:0}:{field:{group:"height"}}:t==="x"?{field:{group:"width"}}:{value:0}}return e}}function G$(e){return e!=="transparent"&&e!==null&&e!==void 0}function yCe(e){const{markDef:t,encoding:n,config:r}=e,{filled:i,type:s}=t,o={fill:Js("fill",t,r),stroke:Js("stroke",t,r),color:Js("color",t,r)},a=et(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,u=ct(t.fill,o.fill,a),l=ct(t.stroke,o.stroke),c=i?"fill":"stroke",f=Object.assign({},u?{fill:{value:u}}:{},l?{stroke:{value:l}}:{});return n.fill||n.stroke?(t.color&&_e(we.droppingColor("property",{fill:"fill"in n,stroke:"stroke"in n})),Object.assign({},yi("fill",e,{defaultValue:ct(u,a)}),yi("stroke",e,{defaultValue:l}))):n.color?Object.assign({},f,yi("color",e,{vgChannel:c,defaultValue:ct(t[c],t.color,o[c],o.color,i?a:void 0)})):G$(t.fill)||G$(t.stroke)?(t.color&&_e(we.droppingColor("property",{fill:"fill"in t,stroke:"stroke"in t})),f):t.color?Object.assign({},f,{[c]:{value:t.color}}):G$(o.fill)||G$(o.stroke)?f:o.color?Object.assign({},a?{fill:{value:"transparent"}}:{},{[c]:{value:o.color}}):{}}function ec(e,t){const{fill:n,stroke:r}=yCe(e);return Object.assign({},yIt(e.markDef,t),bte(e,"fill",n),bte(e,"stroke",r),yi("opacity",e),yi("fillOpacity",e),yi("strokeOpacity",e),yi("strokeWidth",e),vIt(e),vCe(e,"href"))}function bte(e,t,n){const{config:r,mark:i}=e;if(r.invalidValues&&n&&!vb(i)){const s=bCe(e,{invalid:!0,channels:nk});if(s)return{[t]:[{test:s,value:null},...xt(n)]}}return n?{[t]:n}:{}}function yIt(e,t){return mAt.reduce((n,r)=>(e[r]!==void 0&&t[r]!=="ignore"&&(n[r]={value:e[r]}),n),{})}function bIt(e,t){if(t!==void 0)return{[e]:{value:t}}}function bCe(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&wf(u)&&(s[l]=!0)}return s},{}),i=Se(r);if(i.length>0){const s=t?"||":"&&";return i.map(o=>`${o} ${t?"===":"!=="} null ${s} ${t?"":"!"}isNaN(${o})`).join(` ${s} `)}}function BG(e){if(e.config.invalidValues==="filter"){const t=bCe(e,{channels:["x","y"]});if(t)return{defined:{signal:t}}}return{}}function yi(e,t,n={}){const{markDef:r,encoding:i}=t,{vgChannel:s=e}=n,{defaultValue:o=r[s]}=n,a=n.defaultRef||(o!==void 0?{value:o}:void 0),u=i[e];return rF(t,u,s,l=>LG(e,l,void 0,t.scaleName(e),t.getScaleComponent(e),null,a))}function rF(e,t,n,r){const i=t&&t.condition,s=r(t);if(i){const a=(be(i)?i:[i]).map(u=>{const l=r(u),c=o2e(u)?dCe(e,u.selection):hCe(e,u.test);return Object.assign({test:c},l)});return{[n]:[...a,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function vIt(e){const{encoding:t,markDef:n,config:r}=e,i=t.tooltip;return be(i)?{tooltip:yte({tooltip:i},r)}:rF(e,i,"tooltip",s=>{const o=zG(s,e.config);if(o)return o;if(s===null)return;const a=ct(n.tooltip,Js("tooltip",n,r));if(ft(a))return{value:a};if(yt(a))return a.content==="encoding"?yte(t,r):{signal:"datum"}})}function vCe(e,t="text"){const n=e.encoding[t];return rF(e,n,t,r=>zG(r,e.config))}function iF(e,t,n){const r=n.scaleName(t),i=t==="x"?"width":"height";if(n.encoding.size||n.markDef.size!==void 0)if(n.markDef.orient){const o={[t+"c"]:fa(e,r,{},{band:.5})};if(vh(n.encoding.size))return Object.assign({},o,yi("size",n,{vgChannel:i}));if(nf(n.encoding.size))return Object.assign({},o,yi("size",n,{vgChannel:i}));if(n.markDef.size!==void 0)return Object.assign({},o,{[i]:{value:n.markDef.size}})}else _e(we.cannotApplySizeToNonOrientedMark(n.markDef.type));return{[t]:fa(e,r,{binSuffix:"range"}),[i]:mCe(r)}}function xCe(e,t,n,r){const i=e==="x"?"xc":"yc",s=e==="x"?"width":"height";return Object.assign({},Mr(e,t,n,i),yi("size",t,{defaultRef:r,vgChannel:s}))}function _1(e,t,n,r,i,s){const o={x:s?i:0,x2:s?0:i,y:s?0:i,y2:s?i:0},a=n===Dt?og:ag;if(dn(e.bin))return{[a]:mte(e,r,"start",o[`${n}2`]),[n]:mte(e,r,"end",o[n])};if(Do(e.bin)&&ye(t))return{[a]:fa(e,r,{},{offset:o[`${n}2`]}),[n]:fa(t,r,{},{offset:o[n]})};_e(we.channelRequiredForBinned(a))}function Mr(e,t,n,r){const{encoding:i,mark:s,stack:o}=t,a=i[e],u=i[e===Dt?og:ag],l=t.scaleName(e),c=t.getScaleComponent(e),f=pCe(e,t.markDef),d=!a&&(i.latitude||i.longitude)?{field:t.getName(e)}:Object.assign({},pIt(e,a,u,l,c,o,gCe(n,e,l,c,s)),f?{offset:f}:{});return{[r||e]:d}}function Sm(e,t,n){const{encoding:r,mark:i,stack:s}=e,o=n==="x2"?"x":"y",a=r[o],u=e.scaleName(o),l=e.getScaleComponent(o),c=pCe(n,e.markDef),f=!a&&(r.latitude||r.longitude)?{field:e.getName(n)}:Object.assign({},mIt(n,a,r[n],u,l,s,gCe(t,o,u,l,i)),c?{offset:c}:{});return{[n]:f}}function wCe(e,t){return Se(e).reduce((n,r)=>{const i=e[r];return Object.assign({},n,rF(t,i,r,s=>({value:s.value})))},{})}function xIt(e,t){if(T1(t)||Tl(t))return"shared";if(jG(t)||VG(t))return et(yb,e)?"independent":"shared";throw new Error("invalid model type for resolve")}function UG(e,t){const n=e.scale[t],r=et(yb,t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&_e(we.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}class kf{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new kf(jt(this.explicit),jt(this.implicit))}combine(){return Object.assign({},this.explicit,this.implicit)}get(t){return ct(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Se(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function UM(e){return{explicit:!0,value:e}}function SCe(e){return{explicit:!1,value:e}}function CCe(e){return(t,n,r,i)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:sF(t,n,r,i)}}function sF(e,t,n,r){return e.explicit&&t.explicit&&_e(we.mergeConflictingProperty(n,r,e.value,t.value)),e}function yk(e,t,n,r,i=sF){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:pn(e.value)===pn(t.value)?e:i(e,t,n,r)}class wIt extends kf{}function SIt(e,t){const n=e.values;if(n)return dG(t,n)}function kCe(e){const{legend:t}=e;return ct(t.type,$Ce(e))}function $Ce({channel:e,timeUnit:t,scaleType:n,alwaysReturn:r}){if(T0(e)){if(et(["quarter","month","day"],t))return"symbol";if(fu(n))return r?"gradient":void 0}return r?"symbol":void 0}function _Ce({legend:e,legendConfig:t,timeUnit:n,channel:r,scaleType:i}){const s=ct(e.orient,t.orient,"right"),o=kCe({legend:e,channel:r,timeUnit:n,scaleType:i,alwaysReturn:!0});return ct(e.direction,t[o?"gradientDirection":"symbolDirection"],CIt(s,o))}function CIt(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function kIt({legend:e,legendConfig:t,model:n,channel:r,scaleType:i}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=t;if(_Ce({legend:e,legendConfig:t,channel:r,scaleType:i})==="horizontal"){const c=ct(e.orient,t.orient);return c==="top"||c==="bottom"?vte(n,"width",o,s):o}else return vte(n,"height",u,a)}function vte(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function $It(e){if(et(["quantile","threshold","log"],e))return"greedy"}function ECe(e,t,n){const r=t.getScaleComponent(n).get("type");return ct(e.get("type"),$Ce({channel:n,scaleType:r,alwaysReturn:!0}))}function _It(e,t,n,r,i){if(ECe(i,n,r)!=="symbol")return;let s=Object.assign({},bAt({},n,jwe),yCe(n));switch(n.mark){case bb:case ok:case LO:s.shape={value:"square"};break;case ak:case uk:s.shape={value:n.mark};break}const{markDef:o,encoding:a}=n,u=o.filled,l=TCe(a.opacity)||o.opacity;if(s.fill){if(r==="fill"||u&&r===Nu)delete s.fill;else if(s.fill.field)i.get("symbolFillColor")?delete s.fill:(s.fill={value:"black"},s.fillOpacity={value:l||1});else if(be(s.fill)){const c=WM(a.fill||a.color)||o.fill||u&&o.color;c&&(s.fill={value:c})}}if(s.stroke){if(r==="stroke"||!u&&r===Nu)delete s.stroke;else if(s.stroke.field)delete s.stroke;else if(be(s.stroke)){const c=ct(WM(a.stroke||a.color),o.stroke,u?o.color:void 0);c&&(s.stroke={value:c})}}if(r!==so){const c=WM(a.shape)||o.shape;c&&(s.shape={value:c})}return r!==bh&&l&&(s.opacity={value:l}),s=Object.assign({},s,t),Se(s).length>0?s:void 0}function EIt(e,t,n,r,i){if(ECe(i,n,r)!=="gradient")return;let s={};const o=TCe(n.encoding.opacity)||n.markDef.opacity;return o&&(s.opacity={value:o}),s=Object.assign({},s,t),Se(s).length>0?s:void 0}function TIt(e,t,n,r,i){const s=n.legend(r),o=n.config;let a={};if(xb(e)){const u=n.getScaleComponent(r).get("type")===Ut.UTC,l=DG("datum.value",e.timeUnit,s.format,o.legend.shortTimeLabels,o.timeFormat,u);t=Object.assign({},l?{text:{signal:l}}:{},t)}return a=Object.assign({},a,t),Se(a).length>0?a:void 0}function TCe(e){return ACe(e,(t,n)=>Math.max(t,n.value))}function WM(e){return ACe(e,(t,n)=>ct(t,n.value))}function ACe(e,t){if(l2e(e))return(be(e.condition)?e.condition:[e.condition]).reduce(t,e.value);if(nf(e))return e.value}const xte=Object.freeze(Object.defineProperty({__proto__:null,gradient:EIt,labels:TIt,symbols:_It},Symbol.toStringTag,{value:"Module"}));function NCe(e){us(e)?e.component.legends=AIt(e):e.component.legends=FIt(e)}function AIt(e){const{encoding:t}=e;return[Nu,gh,yh,fg,ug,so,bh,lg,cg].reduce((n,r)=>{const i=t[r];return e.legend(r)&&e.getScaleComponent(r)&&!(ye(i)&&r===so&&i.type===pg)&&(n[r]=DIt(e,r)),n},{})}function NIt(e,t){switch(t){case Nu:const n=e.scaleName(Nu);return e.markDef.filled?{fill:n}:{stroke:n};case gh:case yh:case fg:case ug:case so:case bh:case lg:case cg:return{[t]:e.scaleName(t)}}}function IIt(e,t,n,r){switch(t){case"values":return!!n.values;case"title":if(t==="title"&&e===r.title)return!0}return e===n[t]}function DIt(e,t){const n=e.fieldDef(t),r=e.legend(t),i=new wIt({},NIt(e,t));for(const a of L2e){const u=OIt(a,r,t,e);if(u!==void 0){const l=IIt(u,a,r,n);(l||e.config.legend[a]===void 0)&&i.set(a,u,l)}}const s=r.encoding||{},o=["labels","legend","title","symbols","gradient"].reduce((a,u)=>{const l=wCe(s[u]||{},e),c=xte[u]?xte[u](n,l,e,t,i):l;return c!==void 0&&Se(c).length>0&&(a[u]={update:c}),a},{});return Se(o).length>0&&i.set("encode",o,!!r.encoding),i}function OIt(e,t,n,r){const{encoding:i}=r,s=vh(i[n]),o=r.config.legend,{timeUnit:a}=s,u=r.getScaleComponent(n).get("type");switch(e){case"format":return IG(s,t.format,r.config);case"title":return gd(s,r.config,{allowDisabling:!0})||void 0;case"type":return kCe({legend:t,channel:n,timeUnit:a,scaleType:u,alwaysReturn:!1});case"direction":return _Ce({legend:t,legendConfig:o,timeUnit:a,channel:n,scaleType:u});case"labelOverlap":return ct(t.labelOverlap,$It(u));case"gradientLength":return ct(t.gradientLength,o.gradientLength,kIt({model:r,legend:t,legendConfig:o,channel:n,scaleType:u}));case"values":return SIt(t,s)}return t[e]}function FIt(e){const{legends:t,resolve:n}=e.component;for(const r of e.children)NCe(r),Se(r.component.legends).forEach(i=>{n.legend[i]=UG(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=ICe(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))});return Se(t).forEach(r=>{for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r]}),t}function ICe(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const s of z2e){const o=yk(e.getWithExplicit(s),t.getWithExplicit(s),s,"legend",(a,u)=>{switch(s){case"title":return zSe(a,u);case"type":return i=!0,SCe("symbol")}return sF(a,u,s,"legend")});e.setWithExplicit(s,o)}return i&&(((e.implicit||{}).encode||{}).gradient&&OA(e.implicit,["encode","gradient"]),((e.explicit||{}).encode||{}).gradient&&OA(e.explicit,["encode","gradient"])),e}function DCe(e){const t=e.component.legends,n={};for(const r of Se(t)){const i=e.getScaleComponent(r),s=pn(i.domains);if(n[s])for(const o of n[s])ICe(o,t[r])||n[s].push(t[r]);else n[s]=[t[r].clone()]}return Pd(Mc(n)).map(r=>{const i=r.combine();if(i.encode&&i.encode.symbols){const s=i.encode.symbols.update;s.fill&&s.fill.value!=="transparent"&&!s.stroke&&!i.stroke&&(s.stroke={value:"transparent"})}return i})}function RIt(e){return T1(e)||jG(e)||VG(e)?MIt(e):OCe(e)}function MIt(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),OCe(e))}function OCe(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n,i=Mt(n,["name"]),s={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},o=t.data.reduce((a,u)=>{const l=fAt(u)?u.signal:`data('${e.lookupDataSource(u)}')`;return et(a,l)||a.push(l),a},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:s,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},i)]}const PIt=["type","clipAngle","clipExtent","center","rotate","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class FCe extends kf{constructor(t,n,r,i){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}}function RCe(e){us(e)?e.component.projection=LIt(e):e.component.projection=BIt(e)}function LIt(e){const{specifiedProjection:t,config:n,hasProjection:r}=e;if(r){const i=[];return[[gb,pb],[gm,mb]].forEach(s=>{(e.channelHasField(s[0])||e.channelHasField(s[1]))&&i.push({signal:e.getName(`geojson_${i.length}`)})}),e.channelHasField(so)&&e.fieldDef(so).type===pg&&i.push({signal:e.getName(`geojson_${i.length}`)}),i.length===0&&i.push(e.requestDataName(ts)),new FCe(e.projectionName(!0),Object.assign({},n.projection||{},t||{}),[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")],i)}}function zIt(e,t){const n=CH(PIt,i=>!!(!e.explicit.hasOwnProperty(i)&&!t.explicit.hasOwnProperty(i)||e.explicit.hasOwnProperty(i)&&t.explicit.hasOwnProperty(i)&&pn(e.get(i))===pn(t.get(i))));if(pn(e.size)===pn(t.size)){if(n)return e;if(pn(e.explicit)===pn({}))return t;if(pn(t.explicit)===pn({}))return e}return null}function BIt(e){if(e.children.length===0)return;let t;const n=CH(e.children,r=>{RCe(r);const i=r.component.projection;if(i)if(t){const s=zIt(t,i);return s&&(t=s),!!s}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new FCe(r,t.specifiedProjection,t.size,jt(t.data));return e.children.forEach(s=>{s.component.projection&&(i.data=i.data.concat(s.component.projection.data),s.renameProjection(s.component.projection.get("name"),r),s.component.projection.merged=!0)}),i}}class zo{constructor(t,n){this.expr=t,this.signalNames=n}static fromName(t){return new zo(t,[t])}map(t){return new zo(t(this.expr),this.signalNames)}}const UIt=NNt({globalvar:"global"});function a6(e,t){const n=Se(t),r=[];for(const i of n){const s=t[i];if(s instanceof zo){for(const o of s.signalNames)r.push(o);e=e.replace(DA(i),s.expr)}else e=e.replace(DA(i),Fe(s))}if(r.length>0)return new zo(e,r);try{const i=GSe(e),{code:s}=UIt(i);return new Function("global",`return ${s};`)(t)}catch(i){if(i.message.indexOf("Unrecognized function")===0)return new zo(e,[]);throw i}}function u6(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",parent,n),!1;if(!u6(t.children))return!1}return!0}class E1 extends Br{constructor(t){super(null),t=t||{name:"source"};const n=t.format?Object.assign({},SH(t.format,["parse"])):{};if(d2(t))this._data={values:t.values};else if(C1(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];et(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else wG(t)&&(this._data={});t.name&&(this._name=t.name),n&&Se(n).length>0&&(this._data.format=n)}get data(){return this._data}hasName(){return!!this._name}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign({name:this._name},this._data,{transform:[]})}}class MCe{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Cb extends MCe{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}optimizeNextFromLeaves(t){if(t instanceof E1)return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class PCe extends MCe{}function WIt(e,t,n){return Wl(n)&&dn(n.bin)?(e.add(Pe(n,{})),e.add(Pe(n,{binSuffix:"end"})),wb(n,t)&&e.add(Pe(n,{binSuffix:"range"}))):e.add(Pe(n)),e}function VIt(e,t){for(const n of Se(t)){const r=t[n];for(const i of Se(r))n in e?e[n][i]=new Set([...e[n][i]||[],...r[i]]):e[n]={[i]:r[i]}}}class El extends Br{constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}clone(){return new El(null,new Set(this.dimensions),jt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const i={},s=new Set;return!r||(n.forEachFieldDef((o,a)=>{const{aggregate:u,field:l}=o;u?u==="count"?(i["*"]=i["*"]||{},i["*"].count=new Set([Pe(o,{forAs:!0})])):(i[l]=i[l]||{},i[l][u]=new Set([Pe(o,{forAs:!0})]),dg(a)&&n.scaleDomain(a)==="unaggregated"&&(i[l].min=new Set([Pe({field:l,aggregate:"min"},{forAs:!0})]),i[l].max=new Set([Pe({field:l,aggregate:"max"},{forAs:!0})]))):WIt(s,a,o)}),s.size+Se(i).length===0)?null:new El(t,s,i)}static makeFromTransform(t,n){const r=new Set,i={};for(const s of n.aggregate){const{op:o,field:a,as:u}=s;o&&(o==="count"?(i["*"]=i["*"]||{},i["*"].count=new Set([u||Pe(s,{forAs:!0})])):(i[a]=i[a]||{},i[a][o]=new Set([u||Pe(s,{forAs:!0})])))}for(const s of n.groupby||[])r.add(s);return r.size+Se(i).length===0?null:new El(t,r,i)}merge(t){return mwe(this.dimensions,t.dimensions)?(VIt(this.measures,t.measures),!0):(TEt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Se(this.measures)])}producedFields(){const t=new Set;for(const n of Se(this.measures))for(const r of Se(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${mr({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const s of Se(this.measures))for(const o of Se(this.measures[s]))for(const a of this.measures[s][o])r.push(a),t.push(o),n.push(RO(s));return{type:"aggregate",groupby:[...this.dimensions],ops:t,fields:n,as:r}}}class kb extends Br{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const s of[zd,Ld]){const o=n.facet[s];if(o){const{bin:a,sort:u}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[Pe(o),...dn(a)?[Pe(o,{binSuffix:"end"})]:[]]},Aa(u)?{sortField:u}:be(u)?{sortIndexField:k1(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";return this.column&&(t+=` c:${mr(this.column)}`),this.row&&(t+=` r:${mr(this.row)}`),t}get fields(){return[...this.column&&this.column.fields||[],...this.row&&this.row.fields||[]]}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of["x","y"]){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),s=r.get("range");if(ki(i)&&Cf(s)){const o=oF(this.childModel,n),a=WG(o);a?t[n]=a:_e("Unknown field for ${channel}.  Cannot calculate view size.")}}}return t}assembleRowColumnData(t,n,r){const i=t==="row"?"y":"x",s=[],o=[],a=[];r[i]&&(n?(s.push(`distinct_${r[i]}`),o.push("max")):(s.push(r[i]),o.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c,field:f}=u;s.push(f),o.push(c),a.push(Pe(u,{forAs:!0}))}else l&&(s.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:n||this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assemble(){const t=[];let n=null;const r=this.getChildIndependentFieldsWithStep();if(this.column&&this.row&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;const i=[].concat(r.x?[r.x]:[],r.y?[r.y]:[]),s=i.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:[...this.column.fields,...this.row.fields],fields:i,ops:s}]})}for(const i of[zd,Ld])this[i]&&t.push(this.assembleRowColumnData(i,n,r));return t}}function jIt(e,t){const n=Ta(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=t.slice(5,t.length);return`timeParse(${n},${r})`}else if(t.indexOf("utc:")===0){const r=t.slice(4,t.length);return`utcParse(${n},${r})`}else return _e(we.unrecognizedParse(t)),null}class Pa extends Br{clone(){return new Pa(null,jt(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${mr(this._parse)}`}static makeExplicit(t,n,r){let i={};const s=n.data;return s&&s.format&&s.format.parse&&(i=s.format.parse),this.makeWithAncestors(t,i,{},r)}static makeImplicitFromFilterTransform(t,n,r){const i={};return eE(n.filter,s=>{if(mSe(s)){let o=null;EG(s)?o=s.equal:TG(s)?o=s.range[0]:AG(s)&&(o=(s.oneOf||s.in)[0]),o&&(KH(o)?i[s.field]="date":Rr(o)?i[s.field]="number":ft(o)&&(i[s.field]="string")),s.timeUnit&&(i[s.field]="date")}}),Se(i).length===0?null:this.makeWithAncestors(t,{},i,r)}static makeImplicitFromEncoding(t,n,r){const i={};function s(o){xb(o)?i[o.field]="date":S2e(o)&&kwe(o.aggregate)?i[o.field]="number":lx(o.field)>1?o.field in i||(i[o.field]="flatten"):UO(o)&&Aa(o.sort)&&lx(o.sort.field)>1&&(o.sort.field in i||(i[o.sort.field]="flatten"))}return(us(n)||Tl(n))&&n.forEachFieldDef((o,a)=>{if(Wl(o))s(o);else{const u=MO(a);if(u!==a){const l=n.fieldDef(u);s(Object.assign({},o,{type:l.type}))}else throw new Error(`Non-secondary channel ${a} must have type in its field definition ${JSON.stringify(o)}`)}}),this.makeWithAncestors(t,{},i,r)}static makeWithAncestors(t,n,r,i){for(const a of Se(r)){const u=i.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===r[a]||u.value==="derived"||r[a]==="flatten"?delete r[a]:_e(we.differentParse(a,r[a],u.value)))}for(const a of Se(n)){const u=i.get(a);u!==void 0&&(u===n[a]?delete n[a]:_e(we.differentParse(a,n[a],u)))}const s=new kf(n,r);i.copyAll(s);const o={};for(const a of Se(s.combine())){const u=s.get(a);u!==null&&(o[a]=u)}return Se(o).length===0||i.parseNothing?null:new Pa(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign({},this._parse,t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Se(this._parse)){const r=this._parse[n];lx(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Se(this._parse))}dependentFields(){return new Set(Se(this._parse))}assembleTransforms(t=!1){return Se(this._parse).filter(n=>t?lx(n)>1:!0).map(n=>{const r=jIt(n,this._parse[n]);return r?{type:"formula",expr:r,as:bwe(n)}:null}).filter(n=>n!==null)}}function HIt(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Pe(r);return i&&t.push(i),t},[])}function GIt(e){return be(e)&&e.every(t=>ft(t))&&e.length>1}class Lc extends Br{clone(){return new Lc(null,jt(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:r,groupby:i,as:s,offset:o="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(ct(f.order,"ascending"));const l={field:a,order:u};let c;return GIt(s)?c=s:ft(s)?c=[s,s+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new Lc(t,{stackField:r,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;let s;if(r.groupbyChannel){const l=i[r.groupbyChannel];s=vh(l)}const o=HIt(n),a=n.encoding.order;let u;return be(a)||ye(a)?u=MSe(a):u=o.reduce((l,c)=>(l.field.push(c),l.order.push("descending"),l),{field:[],order:[]}),new Lc(t,{dimensionFieldDef:s,stackField:n.vgField(r.fieldChannel),facetby:[],stackby:o,sort:u,offset:r.offset,impute:r.impute,as:[n.vgField(r.fieldChannel,{suffix:"start",forAs:!0}),n.vgField(r.fieldChannel,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby=this._stack.facetby.concat(t)}dependentFields(){const t=new Set;t.add(this._stack.stackField),this.getGroupbyFields().forEach(r=>t.add(r)),this._stack.facetby.forEach(r=>t.add(r));const n=this._stack.sort.field;return be(n)?n.forEach(r=>t.add(r)):t.add(n),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${mr(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Pe(t,{binSuffix:"mid"})]:[Pe(t,{}),Pe(t,{binSuffix:"end"})]:[Pe(t)]:r||[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:s,sort:o,offset:a,impute:u,as:l}=this._stack;return u&&r&&(r.bin&&t.push({type:"formula",expr:"("+Pe(r,{expr:"datum"})+"+"+Pe(r,{expr:"datum",binSuffix:"end"})+")/2",as:Pe(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...s,...n],key:Pe(r,{binSuffix:"mid"}),method:"value",value:0})),t.push({type:"stack",groupby:this.getGroupbyFields().concat(n),field:i,sort:o,as:l,offset:a}),t}}class gg extends Br{constructor(t,n){super(t),this.transform=n}clone(){return new gg(null,jt(this.transform))}addDimensions(t){this.transform.groupby=o0(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby.forEach(n=>t.add(n)),this.transform.sort.forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(n=>t.add(n)),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as||Pe(t)}hash(){return`WindowTransform ${mr(this.transform)}`}assemble(){const t=[],n=[],r=[],i=[];for(const d of this.transform.window)n.push(d.op),r.push(this.getDefaultName(d)),i.push(d.param===void 0?null:d.param),t.push(d.field===void 0?null:d.field);const s=this.transform.frame,o=this.transform.groupby,a=[],u=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)a.push(d.field),u.push(d.order||"ascending");const l={field:a,order:u},c=this.transform.ignorePeers,f={type:"window",params:i,as:r,ops:n,fields:t,sort:l};return c!==void 0&&(f.ignorePeers=c),o!==void 0&&(f.groupby=o),s!==void 0&&(f.frame=s),f}}class qIt extends Cb{run(t){const n=t.parent;if(t instanceof Pa){if(n instanceof E1)return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof Pa)this.setMutated(),n.merge(t);else{if(gwe(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class XIt extends PCe{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Se(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class KIt extends Cb{run(t){return t instanceof xu||t.numChildren()>0||t instanceof kb?this.flags:(this.setMutated(),t.remove(),this.flags)}}class YIt extends Cb{constructor(){super(...arguments),this.fields=new Set}run(t){if(this.setContinue(),t instanceof Pc){const n=t.producedFields();kH(n,this.fields)?(this.setMutated(),t.remove()):this.fields=new Set([...this.fields,...n])}return this.flags}}function ZIt(e){function t(n){if(!(n instanceof kb)){const r=n.clone();if(r instanceof xu){const i=c6+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof El||r instanceof Lc||r instanceof gg)&&r.addDimensions(e.fields);return Pd(n.children.map(t)).forEach(i=>i.parent=r),[r]}return Pd(n.children.map(t))}return t}function l6(e){if(e instanceof kb)if(e.numChildren()===1&&!(e.children[0]instanceof xu)){const t=e.children[0];(t instanceof El||t instanceof Lc||t instanceof gg)&&t.addDimensions(e.fields),t.swapWithParent(),l6(e)}else{const t=e.model.component.data.main;LCe(t);const n=ZIt(e),r=Pd(e.children.map(n));for(const i of r)i.parent=t}else e.children.map(l6)}function LCe(e){if(e instanceof xu&&e.type===ts&&e.numChildren()===1){const t=e.children[0];t instanceof kb||(t.swapWithParent(),LCe(e))}}class QIt extends PCe{run(t){t instanceof xu&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class JIt extends Cb{run(t){const n=t.parent,r=n.children.filter(i=>i instanceof Pa);if(r.length>1){const i={};for(const s of r){const o=s.parse;for(const a of Se(o))i[a]===void 0?i[a]=o[a]:i[a]!==o[a]&&delete i[a]}if(Se(i).length!==0){this.setMutated();const s=new Pa(n,i);for(const o of r){for(const a of Se(i))delete o.parse[a];n.removeChild(o),o.parent=s,Se(o.parse).length===0&&o.remove()}}}return this.setContinue(),this.flags}}class e3t extends Cb{run(t){const n=t.parent,r=n.children.filter(s=>s instanceof El),i={};for(const s of r){const o=mr(Se(s.groupBy).sort());o in i||(i[o]=[]),i[o].push(s)}for(const s of Se(i)){const o=i[s];if(o.length>1){const a=o.pop();for(const u of o)a.merge(u)&&(n.removeChild(u),u.parent=a,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}const c6="scale_",q$=5;function wv(e){const t=[];function n(r){r.numChildren()===0?t.push(r):r.children.forEach(n)}return e.forEach(n),t}function t3t(e){return e}function Nh(e,t,n){return t.map(i=>{const s=new e;return s instanceof Cb?s.optimizeNextFromLeaves(i):s.run(i)}).some(t3t)||n}function wte(e){let t=e.sources,n=!1;return n=Nh(QIt,t,n),t=t.filter(r=>r.numChildren()>0),n=Nh(KIt,wv(t),n),t=t.filter(r=>r.numChildren()>0),n=Nh(qIt,wv(t),n),n=Nh(YIt,wv(t),n),n=Nh(JIt,wv(t),n),n=Nh(e3t,wv(t),n),n=Nh(XIt,t,n),e.sources=t,n}function n3t(e){u6(e.sources);let t=0,n=0;for(let r=0;r<q$&&wte(e);r++)t++;e.sources.map(l6);for(let r=0;r<q$&&wte(e);r++)n++;u6(e.sources),Math.max(t,n)===q$&&_e(`Maximum optimization runs(${q$}) reached.`)}function zCe(e){us(e)?r3t(e):i3t(e)}function r3t(e){const t=e.specifiedScales,n=e.component.scales;Se(n).forEach(r=>{const i=t[r],s=i?i.domain:void 0,o=o3t(e,r),a=n[r];if(a.domains=o,GO(s)&&a.set("domainRaw",{signal:PG+mr(s)},!0),e.component.data.isFaceted){let u=e;for(;!Tl(u)&&u.parent;)u=u.parent;if(u.component.resolve.scale[r]==="shared")for(const c of o)Qf(c)&&(c.data=c6+c.data.replace(c6,""))}})}function i3t(e){for(const n of e.children)zCe(n);const t=e.component.scales;Se(t).forEach(n=>{let r,i=null;for(const s of e.children){const o=s.component.scales[n];if(o){r===void 0?r=o.domains:r=r.concat(o.domains);const a=o.get("domainRaw");i&&a&&i.signal!==a.signal&&_e("The same selection must be used to override scale domains in a layered view."),i=a}}t[n].domains=r,i&&t[n].set("domainRaw",i,!0)})}function s3t(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:s}=Ste(t,n);if(!i){_e(s);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=Ste(t,n);if(i)return"unaggregated"}return e}function o3t(e,t){const n=e.getScaleComponent(t).get("type"),r=s3t(e.scaleDomain(t),e.fieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign({},e.specifiedScales[t],{domain:r})),t==="x"&&e.channelHasField("x2")?e.channelHasField("x")?Ih(n,r,e,"x").concat(Ih(n,r,e,"x2")):Ih(n,r,e,"x2"):t==="y"&&e.channelHasField("y2")?e.channelHasField("y")?Ih(n,r,e,"y").concat(Ih(n,r,e,"y2")):Ih(n,r,e,"y2"):Ih(n,r,e,t)}function a3t(e,t,n){return e.map(r=>({signal:`{data: ${lk(r,{timeUnit:n,type:t})}}`}))}function Ih(e,t,n,r){const i=n.fieldDef(r);if(t&&t!=="unaggregated"&&!GO(t)){const{type:a,timeUnit:u}=i;return a==="temporal"||u?a3t(t,a,u):[t]}const s=n.stack;if(s&&r===s.fieldChannel){if(s.offset==="normalize")return[[0,1]];const a=n.requestDataName(ts);return[{data:a,field:n.vgField(r,{suffix:"start"})},{data:a,field:n.vgField(r,{suffix:"end"})}]}const o=dg(r)?u3t(n,r,e):void 0;if(t==="unaggregated"){const a=n.requestDataName(ts),{field:u}=i;return[{data:a,field:Pe({field:u,aggregate:"min"})},{data:a,field:Pe({field:u,aggregate:"max"})}]}else if(dn(i.bin)){if(fk(e)){const a=n.getName(`${PO(i.bin)}_${i.field}_bins`);return[{signal:`sequence(${a}.start, ${a}.stop + ${a}.step, ${a}.step)`}]}if(ki(e))return[{data:u2(o)?n.requestDataName(ts):n.requestDataName(h2),field:n.vgField(r,wb(i,r)?{binSuffix:"range"}:{}),sort:o===!0||!Aa(o)?{field:n.vgField(r,{}),op:"min"}:o}];if(r==="x"||r==="y"){if(HH(i.bin)&&i.bin.extent)return[i.bin.extent];const a=n.requestDataName(ts);return[{data:a,field:n.vgField(r,{})},{data:a,field:n.vgField(r,{binSuffix:"end"})}]}else return[{data:n.requestDataName(ts),field:n.vgField(r,{})}]}else return o?[{data:u2(o)?n.requestDataName(ts):n.requestDataName(h2),field:n.vgField(r),sort:o}]:[{data:n.requestDataName(ts),field:n.vgField(r)}]}function u3t(e,t,n){if(!ki(n))return;const r=e.fieldDef(t),i=r.sort;if(kG(i))return{op:"min",field:k1(r,t),order:"ascending"};if(Aa(i))return Object.assign({},i,i.field?{field:RO(i.field)}:{});if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(et(["ascending",void 0],i))return!0}function Ste(e,t){return e.aggregate?Ewe[e.aggregate]?e.type==="quantitative"&&t==="log"?{valid:!1,reason:we.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:we.unaggregateDomainWithNonSharedDomainOp(e.aggregate)}:{valid:!1,reason:we.unaggregateDomainHasNoEffectForRawField(e)}}function l3t(e){const t=o0(e.map(o=>Qf(o)?Mt(o,["sort"]):o),mr),n=o0(e.map(o=>{if(Qf(o)){const a=o.sort;return a!==void 0&&!u2(a)&&(a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),mr);if(t.length===1){const o=e[0];if(Qf(o)&&n.length>0){let a=n[0];return n.length>1&&(_e(we.MORE_THAN_ONE_SORT),a=!0),Object.assign({},o,{sort:a})}return o}const r=o0(n.map(o=>u2(o)||o.op==="count"?o:(_e(we.domainSortDropped(o)),!0)),mr);let i;r.length===1?i=r[0]:r.length>1&&(_e(we.MORE_THAN_ONE_SORT),i=!0);const s=o0(e.map(o=>Qf(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:t.map(a=>a.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function WG(e){if(Qf(e)&&ft(e.field))return e.field;if(dAt(e)){let t;for(const n of e.fields)if(Qf(n)&&ft(n.field)){if(!t)t=n.field;else if(t!==n.field)return _e("Detected faceted independent scales that union domain of multiple fields from different data sources.  We will use the first field.  The result view size may be incorrect."),t}return _e("Detected faceted independent scales that union domain of identical fields from different source detected.  We will assume that this is the same field from a different fork of the same data source.  However, if this is not case, the result view size maybe incorrect."),t}else if(hAt(e)){_e("Detected faceted independent scales that union domain of multiple fields from the same data source.  We will use the first field.  The result view size may be incorrect.");const t=e.fields[0];return ft(t)?t:void 0}}function oF(e,t){const r=e.component.scales[t].domains.map(i=>(Qf(i)&&(i.data=e.lookupDataSource(i.data)),i));return l3t(r)}function BCe(e){return T1(e)||jG(e)||VG(e)?e.children.reduce((t,n)=>t.concat(BCe(n)),Cte(e)):Cte(e)}function Cte(e){return Se(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine();let{domainRaw:s}=i;const{name:o,type:a,domainRaw:u,range:l}=i,c=Mt(i,["name","type","domainRaw","range"]),f=c3t(i.range,o,e,n);return s&&cIt(s)&&(s=fIt(e,s)),t.push(Object.assign({name:o,type:a,domain:oF(e,n)},s?{domainRaw:s}:{},{range:f},c)),t},[])}function kte(e,t){let n=e.expr;for(const r of e.signalNames){const i=t.getSignalName(r);if(i!==r){const s=DA(r);n=n.replace(s,i)}}return{signal:n}}function c3t(e,t,n,r){return e instanceof zo?kte(e,n):be(e)?e.map(i=>i instanceof zo?kte(i,n):i):(r==="x"||r==="y")&&Cf(e)?{step:{signal:t+"_step"}}:e}class UCe extends kf{constructor(t,n){super({},{name:t}),this.merged=!1,this.domains=[],this.setWithExplicit("type",n)}}const f3t=["range","rangeStep","scheme"];function WCe(e){return e==="x"?"width":e==="y"?"height":void 0}function d3t(e){const t=e.component.scales;nk.forEach(n=>{const r=t[n];if(!r)return;const i=e.getScaleComponent(n),s=e.specifiedScales[n],o=e.fieldDef(n),a=WCe(n);let u=a?!!e.component.layoutSize.get(a):void 0;const l=i.get("type"),c=et(["point","band"],l)||!!s.rangeStep;a&&e.fit&&!u&&c&&(_e(we.CANNOT_FIX_RANGE_STEP_WITH_FIT),u=!0);const f=p3t(e),d=m3t(n,l,o.type,s,e.config,r.get("zero"),e.mark,u,e.getName(a),f);r.setWithExplicit("range",d)})}function h3t(e,t){const n=e.getScaleComponent(t);if(!n)return;const r=n.get("type"),i=e.fieldDef(t);if(ki(r)){const s=n&&n.get("range");if(s&&Cf(s)&&Rr(s.step))return s.step}else if(i&&i.bin&&dn(i.bin)){const s=e.getName(Pe(i,{suffix:"bins"})),o=`(${s}.stop - ${s}.start) / ${s}.step`,a=WCe(t),u=e.getName(a);return new zo(`${u} / (${o})`,[u,s])}}function p3t(e){const t=[];for(const n of yb){const r=h3t(e,n);r!==void 0&&t.push(r)}return t}function m3t(e,t,n,r,i,s,o,a,u,l){const c=a||r.rangeStep===null;for(const f of f3t)if(r[f]!==void 0){const d=yG(t,f),h=bG(e,f);if(!d)_e(we.scalePropertyNotWorkWithScaleType(t,f,e));else if(h)_e(h);else switch(f){case"range":return UM(r[f]);case"scheme":return UM(g3t(r[f]));case"rangeStep":const p=r[f];if(p!==null)if(a)_e(we.rangeStepDropped(e));else return UM({step:p})}}return SCe(y3t(e,t,n,i,s,o,u,l,c,r.domain))}function g3t(e){if(H2e(e)){const t={scheme:e.name};return e.count&&(t.count=e.count),e.extent&&(t.extent=e.extent),t}return{scheme:e}}function y3t(e,t,n,r,i,s,o,a,u,l){switch(e){case Dt:case fn:if(et(["point","band"],t)&&!u){if(e===Dt&&s==="text"){if(r.scale.textXRangeStep)return{step:r.scale.textXRangeStep}}else if(r.scale.rangeStep)return{step:r.scale.rangeStep}}return e===fn&&wf(t)?[zo.fromName(o),0]:[0,zo.fromName(o)];case ug:const c=v3t(s,i,r),f=w3t(s,a,r);return c2(t)?b3t(c,f,$te(t,r,l,e)):[c,f];case fg:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case so:return"symbol";case Nu:case gh:case yh:if(t==="ordinal")return n==="nominal"?"category":"ordinal";if(c2(t)){const d=$te(t,r,l,e);return r.range&&Q2e(r.range.ordinal)?Object.assign({},r.range.ordinal,{count:d}):{scheme:"blues",count:d}}else return fu(t)?["#f7fbff","#0e427f"]:s==="rect"||s==="geoshape"?"heatmap":"ramp";case bh:case lg:case cg:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function $te(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&be(n)?n.length+1:(_e(we.domainRequiredForThresholdScale(r)),3)}}function b3t(e,t,n){const r="(rangeMax - rangeMin) / (cardinality - 1)";return a6(`sequence(rangeMin, rangeMax + ${r}, ${r})`,{rangeMin:e,rangeMax:t,cardinality:n})}function v3t(e,t,n){if(t)return 0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(we.incompatibleChannel("size",e))}const x3t=.95;function w3t(e,t,n){const r=n.scale;switch(e){case"bar":case"tick":if(n.scale.maxBandSize!==void 0)return n.scale.maxBandSize;const i=_te(t,n.scale);return a6("min - 1",{min:i});case"line":case"trail":case"rule":return n.scale.maxStrokeWidth;case"text":return n.scale.maxFontSize;case"point":case"square":case"circle":if(n.scale.maxSize)return n.scale.maxSize;const s=_te(t,r);return a6(`pow(${x3t} * pointStep, 2)`,{pointStep:s})}throw new Error(we.incompatibleChannel("size",e))}function _te(e,t){if(e.length>0){const n=[],r=[];let i=1/0;for(const s of e)if(s instanceof zo){n.push(s.expr);for(const o of s.signalNames)r.push(o);i=void 0}else n.push(s),i!==void 0&&s<i&&(i=s);return i!==void 0?i:new zo(`min(${n.join(", ")})`,r)}return t.rangeStep?t.rangeStep:21}function VCe(e,t){us(e)?S3t(e,t):HCe(e,t)}function S3t(e,t){const n=e.component.scales;Se(n).forEach(r=>{const i=e.specifiedScales[r],s=n[r],o=e.getScaleComponent(r),a=e.fieldDef(r),u=e.config,l=i[t],c=o.get("type"),f=yG(c,t),d=bG(r,t);if(l!==void 0&&(f?d&&_e(d):_e(we.scalePropertyNotWorkWithScaleType(c,t,r))),f&&d===void 0)if(l!==void 0)s.copyKeyFromObject(t,i);else{const h=C3t(t,r,a,o.get("type"),o.get("padding"),o.get("paddingInner"),i.domain,e.markDef,u);h!==void 0&&s.set(t,h,!1)}})}function C3t(e,t,n,r,i,s,o,a,u){const l=u.scale;switch(e){case"interpolate":return k3t(t,r);case"nice":return $3t(r,t,n);case"padding":return _3t(t,r,l,n,a,u.bar);case"paddingInner":return E3t(i,t,a.type,l);case"paddingOuter":return T3t(i,t,r,a.type,s,l);case"reverse":return A3t(r,n.sort);case"zero":return N3t(t,n,o,a,r)}return l[e]}function jCe(e){us(e)?d3t(e):HCe(e,"range")}function HCe(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?jCe(r):VCe(r,t);Se(n).forEach(r=>{let i;for(const s of e.children){const o=s.component.scales[r];if(o){const a=o.getWithExplicit(t);i=yk(i,a,t,"scale",CCe((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)})}function k3t(e,t){if(et([Nu,gh,yh],e)&&fu(t))return"hcl"}function $3t(e,t,n){if(!(n.bin||et([Ut.TIME,Ut.UTC],e)))return et([Dt,fn],t)?!0:void 0}function _3t(e,t,n,r,i,s){if(et([Dt,fn],e)){if(fu(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=i;if(o==="bar"&&!r.bin&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===Ut.POINT)return n.pointPadding}}function E3t(e,t,n,r){if(e===void 0&&et([Dt,fn],t)){const{bandPaddingInner:i,barBandPaddingInner:s,rectBandPaddingInner:o}=r;return ct(i,n==="bar"?s:o)}}function T3t(e,t,n,r,i,s){if(e===void 0&&et([Dt,fn],t)&&n===Ut.BAND){const{bandPaddingOuter:o,barBandPaddingOuter:a,rectBandPaddingOuter:u}=s;return ct(o,r==="bar"?a:u,i/2)}}function A3t(e,t){if(wf(e)&&t==="descending")return!0}function N3t(e,t,n,r,i){if(!!n&&n!=="unaggregated")return!1;if(e==="size"&&t.type==="quantitative"&&!c2(i))return!0;if(!t.bin&&et([Dt,fn],e)){const{orient:o,type:a}=r;return!(et(["bar","area","line","trail"],a)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function I3t(e,t,n,r,i){const s=D3t(t,n,r,e),{type:o}=e;return dg(t)?o!==void 0?xG(t,o)?vG(o,n.type,n.bin)?o:(_e(we.scaleTypeNotWorkWithFieldDef(o,s)),s):(_e(we.scaleTypeNotWorkWithChannel(t,o,s)),s):s:null}function D3t(e,t,n,r,i){switch(t.type){case"nominal":case"ordinal":return T0(e)||Vx(e)==="discrete"?(e==="shape"&&t.type==="ordinal"&&_e(we.discreteChannelCannotEncode(e,"ordinal")),"ordinal"):et(["x","y"],e)&&(et(["rect","bar","rule"],n)||n==="bar")?"band":"point";case"temporal":return T0(e)?"time":Vx(e)==="discrete"?(_e(we.discreteChannelCannotEncode(e,"temporal")),"ordinal"):"time";case"quantitative":if(T0(e)){if(dn(t.bin))return"bin-ordinal";const{domain:s=void 0,range:o=void 0}=r||{};return s&&be(s)&&s.length>2&&o&&be(o)&&o.length>2?"linear":"sequential"}else if(Vx(e)==="discrete")return _e(we.discreteChannelCannotEncode(e,"quantitative")),"ordinal";return dn(t.bin)&&e!=="x"&&e!=="y"?"bin-linear":"linear";case"geojson":return}throw new Error(we.invalidFieldType(t.type))}function O3t(e){GCe(e),zCe(e);for(const t of q2e)VCe(e,t);jCe(e)}function GCe(e){us(e)?e.component.scales=F3t(e):e.component.scales=M3t(e)}function F3t(e){const{encoding:t,config:n,mark:r}=e;return nk.reduce((i,s)=>{let o,a;const u=t[s];if(ye(u)&&r===GH&&s===so&&u.type===pg)return i;if(ye(u)?(o=u,a=u.scale):Iu(u)&&(o=u.condition,a=u.condition.scale),o&&a!==null&&a!==!1){a=a||{};const l=I3t(a,s,o,r,n.scale);i[s]=new UCe(e.scaleName(s+"",!0),{value:l,explicit:a.type===l})}return i},{})}const R3t=CCe((e,t)=>QL(e)-QL(t));function M3t(e){const t=e.component.scales={},n={},r=e.component.resolve;for(const i of e.children)GCe(i),Se(i.component.scales).forEach(s=>{if(r.scale[s]=r.scale[s]||xIt(s,e),r.scale[s]==="shared"){const o=n[s],a=i.component.scales[s].getWithExplicit("type");o?U2e(o.value,a.value)?n[s]=yk(o,a,"type","scale",R3t):(r.scale[s]="independent",delete n[s]):n[s]=a}});return Se(n).forEach(i=>{const s=e.scaleName(i,!0),o=n[i];t[i]=new UCe(s,o);for(const a of e.children){const u=a.component.scales[i];u&&(a.renameScale(u.get("name"),s),u.merged=!0)}}),t}class VM{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function us(e){return e&&e.type==="unit"}function Tl(e){return e&&e.type==="facet"}function VG(e){return e&&e.type==="repeat"}function jG(e){return e&&e.type==="concat"}function T1(e){return e&&e.type==="layer"}class HG{constructor(t,n,r,i,s,o){this.children=[],this.correctDataNames=a=>(a.from&&a.from.data&&(a.from.data=this.lookupDataSource(a.from.data)),a.from&&a.from.facet&&a.from.facet.data&&(a.from.facet.data=this.lookupDataSource(a.from.facet.data)),a),this.parent=n,this.config=i,this.repeater=s,this.name=t.name||r,this.title=ft(t.title)?{text:t.title}:t.title,this.scaleNameMap=n?n.scaleNameMap:new VM,this.projectionNameMap=n?n.projectionNameMap:new VM,this.signalNameMap=n?n.signalNameMap:new VM,this.data=t.data,this.description=t.description,this.transforms=ASe(t.transform||[]),this.layout=Sf(t)||Ql(t)?void 0:uAt(t),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:hg(t)||n&&n.component.data.isFaceted&&!t.data},layoutSize:new kf,layoutHeaders:{row:{},column:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?jt(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}initSize(t){const{width:n,height:r}=t;n&&this.component.layoutSize.set("width",n,!0),r&&this.component.layoutSize.set("height",r,!0)}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelection(),this.parseProjection(),this.parseData(),this.parseAxisAndHeader(),this.parseLegend(),this.parseMarkGroup()}parseScale(){O3t(this)}parseProjection(){RCe(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegend(){NCe(this)}assembleGroupStyle(){if(this.type==="unit"||this.type==="layer")return"cell"}assembleLayoutSize(){if(this.type==="unit"||this.type==="layer")return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}}assembleLayout(){if(!this.layout)return;const{align:t,bounds:n,center:r,spacing:i={}}=this.layout;return Object.assign({padding:Rr(i)?i:{row:i.row||10,column:i.column||10}},this.assembleDefaultLayout(),t?{align:t}:{},n?{bounds:n}:{},r?{center:r}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of ute)t[r].title&&n.push(ONt(this,r));for(const r of ute)n=n.concat(FNt(this,r));return n}assembleAxes(){return yAt(this.component.axes,this.config)}assembleLegends(){return DCe(this)}assembleProjections(){return RIt(this)}assembleTitle(){const t=this.title||{},{encoding:n}=t,r=Mt(t,["encoding"]),i=Object.assign({},Y2e(this.config.title).nonMark,r,n?{encode:{update:n}}:{});if(i.text)return et(["unit","layer"],this.type)||(i.anchor&&i.anchor!=="start"&&_e(we.cannotSetTitleAnchor(this.type)),i.anchor="start"),et(["middle",void 0],i.anchor)&&i.frame===void 0&&(i.frame="group"),Se(i).length>0?i:void 0}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSelectionSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Tl(this.parent)?BCe(this):[];i.length>0&&(n.scales=i);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}hasDescendantWithFieldOnChannel(t){for(const n of this.children)if(us(n)){if(n.channelHasField(t))return!0}else if(n.hasDescendantWithFieldOnChannel(t))return!0;return!1}getName(t){return Ul((this.name?this.name+"_":"")+t)}requestDataName(t){const n=this.getName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(Tl(this.parent)){const n=t==="width"?"x":"y",r=this.component.scales[n];if(r&&!r.merged){const i=r.get("type"),s=r.get("range");if(ki(i)&&Cf(s)){const o=r.get("name"),a=oF(this,n),u=WG(a);if(u){const l=Pe({aggregate:"distinct",field:u},{expr:"datum"});return{signal:YSe(o,r,l)}}else return _e("Unknown field for ${channel}.  Cannot calculate view size."),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(WH(t)&&dg(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale().  Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(we.selectionNotFound(n));return r}}class qCe extends HG{vgField(t,n={}){const r=this.fieldDef(t);if(r)return Pe(r,n)}reduceFieldDef(t,n,r){return jO(this.getMapping(),(i,s,o)=>{const a=PA(s);return a?t(i,a,o):i},n,r)}forEachFieldDef(t,n){ck(this.getMapping(),(r,i)=>{const s=PA(r);s&&t(s,i)},n)}}function P3t(e,t,n,r){if(wb(t,n)){const i=us(e)?e.axis(n)||e.legend(n)||{}:{},s=Pe(t,{expr:"datum"}),o=Pe(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Pe(t,{binSuffix:"range",forAs:!0}),formula:RSe(s,o,i.format,r)}}return{}}function L3t(e,t){return`${PO(e)}_${t}`}function z3t(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function B3t(e){return"as"in e}function Ete(e,t,n){let r;B3t(e)?r=ft(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Pe(e,{forAs:!0}),Pe(e,{binSuffix:"end",forAs:!0})];const i=fG(t,void 0)||{},s=L3t(i,e.field),{signal:o,extentSignal:a}=z3t(n,s),u=Object.assign({bin:i,field:e.field,as:r},o?{signal:o}:{},a?{extentSignal:a}:{});return{key:s,binComponent:u}}class yd extends Br{constructor(t,n){super(t),this.bins=n}clone(){return new yd(null,jt(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,o)=>{if(Wl(s)&&dn(s.bin)){const{key:a,binComponent:u}=Ete(s,s.bin,n);i[a]=Object.assign({},u,i[a],P3t(n,s,o,n.config))}return i},{});return Se(r).length===0?null:new yd(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:s}=Ete(n,n.bin,r);return new yd(t,{[i]:s})}merge(t){this.bins=Object.assign({},this.bins,t.bins),t.remove()}producedFields(){return new Set(Pd(Mc(this.bins).map(t=>t.as)))}dependentFields(){return new Set(Mc(this.bins).map(t=>t.field))}hash(){return`Bin ${mr(this.bins)}`}assemble(){return Pd(Mc(this.bins).map(t=>{const n=[],r=Object.assign({type:"bin",field:t.field,as:t.as,signal:t.signal},t.bin);return!t.bin.extent&&t.extentSignal&&(n.push({type:"extent",field:t.field,signal:t.extentSignal}),r.extent={signal:t.extentSignal}),n.push(r),t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n}))}}class aF extends Br{constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=hCe(this.model,this.filter,this),this._dependentFields=XSe(this.expr)}clone(){return new aF(null,this.model,jt(this.filter))}dependentFields(){return this._dependentFields}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}class uF extends Br{constructor(t,n){super(t),this.transform=n,this.transform=jt(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((s,o)=>i[o]||s)}clone(){return new uF(this.parent,jt(this.transform))}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${mr(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class lF extends Br{constructor(t,n){super(t),this.transform=n,this.transform=jt(n);const r=this.transform.as||[void 0,void 0];this.transform.as=[r[0]||"key",r[1]||"value"]}clone(){return new lF(null,jt(this.transform))}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${mr(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class A0 extends Br{constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}clone(){return new A0(null,jt(this.fields),this.geojson,this.signal)}static parseAll(t,n){let r=0;if([[gb,pb],[gm,mb]].forEach(i=>{const s=i.map(o=>n.channelHasField(o)?n.fieldDef(o).field:void 0);(s[0]||s[1])&&(t=new A0(t,s,null,n.getName(`geojson_${r++}`)))}),n.channelHasField(so)){const i=n.fieldDef(so);i.type===pg&&(t=new A0(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}assemble(){return Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{},this.geojson?{geojson:this.geojson}:{},{signal:this.signal})}}class y2 extends Br{constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}clone(){return new y2(null,this.projection,jt(this.fields),jt(this.as))}static parseAll(t,n){return n.projectionName()&&[[gb,pb],[gm,mb]].forEach(r=>{const i=r.map(o=>n.channelHasField(o)?n.fieldDef(o).field:void 0),s=r[0]===gm?"2":"";(i[0]||i[1])&&(t=new y2(t,n.projectionName(),i,[n.getName("x"+s),n.getName("y"+s)]))}),t}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class A1 extends Br{clone(){return new A1(null)}constructor(t){super(t)}producedFields(){return new Set([f2])}assemble(){return{type:"identifier",as:f2}}}const U3t={vgMark:"area",encodeEntry:e=>Object.assign({},ec(e,{size:"ignore",orient:"include"}),Mr("x",e,"zeroOrMin"),Mr("y",e,"zeroOrMin"),Sm(e,"zeroOrMin",e.markDef.orient==="horizontal"?"x2":"y2"),BG(e))},W3t={vgMark:"rect",encodeEntry:e=>Object.assign({},ec(e,{size:"ignore",orient:"ignore"}),V3t(e),j3t(e))};function V3t(e){const{config:t,encoding:n,markDef:r,width:i}=e,s=r.orient,o=n.size,a=n.x,u=n.x2,l=e.scaleName(Dt),c=e.getScaleComponent(Dt);if(ye(a)&&Do(a.bin))return _1(a,u,Dt,l,ct(r.binSpacing,t.bar.binSpacing),c.get("reverse"));if(s==="horizontal"||u)return Object.assign({},Mr("x",e,"zeroOrMin"),Sm(e,"zeroOrMin","x2"));if(ye(a)){const f=c.get("type");if(dn(a.bin)&&!o&&!ki(f))return _1(a,void 0,Dt,e.scaleName("x"),ct(r.binSpacing,t.bar.binSpacing),c.get("reverse"));if(f===Ut.BAND)return iF(a,"x",e)}return xCe("x",e,Object.assign({},oo(i)),XCe(r,l,c,t))}function j3t(e){const{config:t,encoding:n,height:r,markDef:i}=e,s=i.orient,o=n.size,a=n.y,u=n.y2,l=e.scaleName(fn),c=e.getScaleComponent(fn);if(ye(a)&&Do(a.bin))return _1(a,u,fn,l,ct(i.binSpacing,t.bar.binSpacing),c.get("reverse"));if(s==="vertical"||u)return Object.assign({},Mr("y",e,"zeroOrMin"),Sm(e,"zeroOrMin","y2"));if(ye(a)){const f=c.get("type");if(dn(a.bin)&&!o&&!ki(f))return _1(a,void 0,fn,e.scaleName("y"),ct(i.binSpacing,t.bar.binSpacing),c.get("reverse"));if(f===Ut.BAND)return iF(a,"y",e)}return xCe("y",e,oo(r),XCe(i,l,c,t))}function XCe(e,t,n,r){if(e.size!==void 0)return{value:e.size};const i=Js("size",e,r,{skipGeneralMarkConfig:!0});if(i!==void 0)return{value:i};if(n){const o=n.get("type");if(o==="point"||o==="band"){if(r.bar.discreteBandSize!==void 0)return{value:r.bar.discreteBandSize};if(o===Ut.POINT){const a=n.get("range");if(Cf(a)&&Rr(a.step))return{value:a.step-1};_e(we.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL)}else return mCe(t)}else return{value:r.bar.continuousBandSize}}return{value:ct(r.bar.discreteBandSize,r.scale.rangeStep?r.scale.rangeStep-1:void 0,20)}}const H3t={vgMark:"shape",encodeEntry:e=>Object.assign({},ec(e,{size:"ignore",orient:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&ye(n)&&n.type===pg?{field:Pe(n,{expr:"datum"})}:{})]}},G3t={vgMark:"line",encodeEntry:e=>{const{width:t,height:n}=e;return Object.assign({},ec(e,{size:"ignore",orient:"ignore"}),Mr("x",e,oo(t)),Mr("y",e,oo(n)),yi("size",e,{vgChannel:"strokeWidth"}),BG(e))}},q3t={vgMark:"trail",encodeEntry:e=>{const{width:t,height:n}=e;return Object.assign({},ec(e,{size:"include",orient:"ignore"}),Mr("x",e,oo(t)),Mr("y",e,oo(n)),yi("size",e),BG(e))}};function GG(e,t){const{config:n,markDef:r,width:i,height:s}=e;return Object.assign({},ec(e,{size:"include",orient:"ignore"}),Mr("x",e,oo(i)),Mr("y",e,oo(s)),yi("size",e,{defaultValue:Js("size",r,n)}),X3t(e,n,t))}function X3t(e,t,n){return n?{shape:{value:n}}:yi("shape",e,{defaultValue:Js("shape",e.markDef,t)})}const K3t={vgMark:"symbol",encodeEntry:e=>GG(e)},Y3t={vgMark:"symbol",encodeEntry:e=>GG(e,"circle")},Z3t={vgMark:"symbol",encodeEntry:e=>GG(e,"square")},Q3t={vgMark:"rect",encodeEntry:e=>Object.assign({},ec(e,{size:"ignore",orient:"ignore"}),J3t(e),eDt(e))};function J3t(e){const t=e.encoding.x,n=e.encoding.x2,r=e.getScaleComponent(Dt),i=r?r.get("type"):void 0,s=e.scaleName(Dt);if(ye(t)&&(dn(t.bin)||Do(t.bin)))return _1(t,n,Dt,s,0,r.get("reverse"));if(ye(t)&&r&&ki(i)){if(i===Ut.BAND)return iF(t,"x",e);throw new Error(we.scaleTypeNotWorkWithMark(zO,i))}else return Object.assign({},Mr("x",e,"zeroOrMax"),Sm(e,"zeroOrMin","x2"))}function eDt(e){const t=e.encoding.y,n=e.encoding.y2,r=e.getScaleComponent(fn),i=r?r.get("type"):void 0,s=e.scaleName(fn);if(ye(t)&&(dn(t.bin)||Do(t.bin)))return _1(t,n,fn,s,0,r.get("reverse"));if(ye(t)&&r&&ki(i)){if(i===Ut.BAND)return iF(t,"y",e);throw new Error(we.scaleTypeNotWorkWithMark(zO,i))}else return Object.assign({},Mr("y",e,"zeroOrMax"),Sm(e,"zeroOrMin","y2"))}const tDt={vgMark:"rule",encodeEntry:e=>{const{markDef:t,width:n,height:r}=e,i=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign({},ec(e,{size:"ignore",orient:"ignore"}),Mr("x",e,i==="horizontal"?"zeroOrMin":oo(n)),Mr("y",e,i==="vertical"?"zeroOrMin":oo(r)),i!=="vertical"?Sm(e,"zeroOrMax","x2"):{},i!=="horizontal"?Sm(e,"zeroOrMax","y2"):{},yi("size",e,{vgChannel:"strokeWidth",defaultValue:t.size}))}},nDt={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n,width:r,height:i,markDef:s}=e,o=ct(s.fontSize,s.size,JL("fontSize",s,t.style),JL("size",s,t.style),t[s.type].fontSize,t[s.type].size);return Object.assign({},ec(e,{size:"ignore",orient:"ignore"}),Mr("x",e,oo(r)),Mr("y",e,oo(i)),vCe(e),yi("size",e,{defaultValue:o,vgChannel:"fontSize"}),bIt("align",rDt(e.markDef,n,t)))}};function rDt(e,t,n){if((e.align||Js("align",e,n))===void 0)return"center"}const iDt={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n,width:r,height:i}=e,s=n.orient,o=s==="horizontal"?"width":"height",a=s==="horizontal"?"height":"width";return Object.assign({},ec(e,{size:"ignore",orient:"ignore"}),Mr("x",e,oo(r),"xc"),Mr("y",e,oo(i),"yc"),yi("size",e,{defaultValue:sDt(e),vgChannel:o}),{[a]:{value:ct(n.thickness,t.tick.thickness)}})}};function sDt(e){const{config:t,markDef:n}=e,r=n.orient,i=e.getScaleComponent(r==="horizontal"?"x":"y");if(n.size!==void 0)return n.size;if(t.tick.bandSize!==void 0)return t.tick.bandSize;{const s=i?i.get("range"):void 0,o=s&&Cf(s)?s.step:t.scale.rangeStep;if(typeof o!="number")throw new Error("Function does not handle non-numeric rangeStep");return o*3/4}}const X$={area:U3t,bar:W3t,circle:Y3t,geoshape:H3t,line:G3t,point:K3t,rect:Q3t,rule:tDt,square:Z3t,text:nDt,tick:iDt,trail:q3t};function oDt(e){return et([ik,rk,Bwe],e.mark)?aDt(e):KCe(e)}const Tte="faceted_path_";function aDt(e){const t=YCe(e.mark,e.encoding),n=KCe(e,{fromPrefix:t.length>0?Tte:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Tte+e.requestDataName(ts),data:e.requestDataName(ts),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}function uDt(e){const{encoding:t,stack:n,mark:r,markDef:i}=e,s=t.order;if(!(!be(s)&&nf(s))){if((be(s)||ye(s))&&!n)return MSe(s,{expr:"datum"});if(vb(r)){const o=t[i.orient==="horizontal"?"y":"x"];if(ye(o)){const a=o.sort;return{field:Aa(a)?Pe({aggregate:hG(e.encoding)?a.op:void 0,field:a.field},{expr:"datum"}):Pe(o,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"}),order:"descending"}}return}}}function KCe(e,t={fromPrefix:""}){const n=e.mark,r=ct(e.markDef.clip,lDt(e)),i=DSe(e.markDef),s=e.encoding.key,o=uDt(e),a=X$[n].postEncodingTransform?X$[n].postEncodingTransform(e):null;return[Object.assign({name:e.getName("marks"),type:X$[n].vgMark},r?{clip:!0}:{},i?{style:i}:{},s?{key:{field:s.field}}:{},o?{sort:o}:{},{from:{data:t.fromPrefix+e.requestDataName(ts)},encode:{update:X$[n].encodeEntry(e)}},a?{transform:a}:{})]}function YCe(e,t){return Se(t).reduce((n,r)=>{switch(r){case"x":case"y":case"order":case"href":case"x2":case"y2":case"xError":case"yError":case"xError2":case"yError2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":case"tooltip":return n;case"detail":case"key":const i=t[r];return(be(i)||ye(i))&&(be(i)?i:[i]).forEach(o=>{o.aggregate||n.push(Pe(o,{}))}),n;case"size":if(e==="trail")return n;case"color":case"fill":case"stroke":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":const s=vh(t[r]);return s&&!s.aggregate&&n.push(Pe(s,{})),n;default:throw new Error(`Bug: Channel ${r} unimplemented for line mark`)}},[])}function lDt(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("domainRaw")||n&&n.get("domainRaw"))}class Ip extends Br{constructor(t,n){super(t),this.transform=n}clone(){return new Ip(null,jt(this.transform))}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Ip(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,s=r.y;if(ye(i)&&ye(s)){const o=i.impute?i:s.impute?s:void 0;if(o===void 0)return;const a=i.impute?s:s.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=YCe(n.mark,r);return new Ip(t,Object.assign({impute:o.field,key:a.field},u?{method:u}:{},l!==void 0?{value:l}:{},c?{frame:c}:{},f!==void 0?{keyvals:f}:{},d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${mr(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:s,value:o,frame:a=[null,null]}=this.transform,u=Object.assign({type:"impute",field:t,key:n},r?{keyvals:ySe(r)?this.processSequence(r):r}:{},{method:"value"},s?{groupby:s}:{},{value:null});let l;if(i&&i!=="value"){const c=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),f={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};l=[c,f]}else l=[{type:"formula",expr:`datum.${t} === null ? ${o} : datum.${t}`,as:t}];return[u,...l]}}class cDt extends kf{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}class b2 extends Br{constructor(t,n,r){super(t),this.transform=n,this.secondary=r}clone(){return new b2(null,jt(this.transform),this.secondary)}static make(t,n,r,i){const s=n.component.data.sources;let o=eke(r.from.data,s);o||(o=new E1(r.from.data),s.push(o));const a=n.getName(`lookup_${i}`),u=new xu(o,a,"lookup",n.component.data.outputNodeRefCounts);return n.component.data.outputNodes[a]=u,new b2(t,r,u.getSource())}producedFields(){return new Set(this.transform.from.fields||(this.transform.as instanceof Array?this.transform.as:[this.transform.as]))}hash(){return`Lookup ${mr({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:this.transform.as instanceof Array?this.transform.as:[this.transform.as]}:{});else{let n=this.transform.as;ft(n)||(_e(we.NO_FIELDS_NEEDS_AS),n="_lookup"),t={as:[n]}}return Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t,this.transform.default?{default:this.transform.default}:{})}}class cF extends Br{constructor(t,n){super(t),this.transform=n}clone(){return new cF(null,jt(this.transform))}hash(){return`SampleTransform ${mr(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function ZCe(e){let t=0;function n(r,i){if(r instanceof E1&&(C1(r.data)||(e.push(i),i={name:null,source:i.name,transform:[]})),r instanceof Pa&&(r.parent instanceof E1&&!i.source?(i.format=Object.assign({},i.format||{},{parse:r.assembleFormatParse()}),i.transform=i.transform.concat(r.assembleTransforms(!0))):i.transform=i.transform.concat(r.assembleTransforms())),r instanceof kb){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,r.assemble().forEach(s=>e.push(s));return}switch((r instanceof aF||r instanceof wm||r instanceof y2||r instanceof A0||r instanceof El||r instanceof b2||r instanceof gg||r instanceof lF||r instanceof uF||r instanceof A1||r instanceof cF)&&i.transform.push(r.assemble()),(r instanceof yd||r instanceof Pc||r instanceof Ip||r instanceof Lc)&&(i.transform=i.transform.concat(r.assemble())),r instanceof xu&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof xu?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof xu&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:i.name||(i.name=`data_${t++}`);let s=i.name;!i.source||i.transform.length>0?e.push(i):s=i.source,r.children.forEach(o=>{n(o,{name:null,source:s,transform:[]})});break}}return n}function fDt(e){const t=[],n=ZCe(t);return e.children.forEach(r=>n(r,{source:e.name,name:null,transform:[]})),t}function dDt(e,t){const n=[],r=ZCe(n);let i=0;e.sources.forEach(o=>{o.hasName()||(o.dataName=`source_${i++}`);const a=o.assemble();r(o,a)}),n.forEach(o=>{o.transform.length===0&&delete o.transform});let s=0;for(let o=0;o<n.length;o++){const a=n[o];(a.transform||[]).length===0&&!a.source&&n.splice(s++,0,n.splice(o,1)[0])}for(const o of n)for(const a of o.transform||[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const o of n)o.name in t&&(o.values=t[o.name]);return n}function QCe(e){qG(e);const t=e.component.layoutSize;t.setWithExplicit("width",f6(e,"width")),t.setWithExplicit("height",f6(e,"height"))}const hDt=QCe;function pDt(e){qG(e);const t=e.component.layoutSize,n=e.isVConcat?"width":"height";t.setWithExplicit(n,f6(e,n))}function qG(e){for(const t of e.children)t.parseLayoutSize()}function f6(e,t){const n=t==="width"?"x":"y",r=e.component.resolve;let i;for(const s of e.children){const o=s.component.layoutSize.getWithExplicit(t),a=r.scale[n];if(a==="independent"&&o.value==="range-step"){i=void 0;break}if(i){if(a==="independent"&&i.value!==o.value){i=void 0;break}i=yk(i,o,t,"")}else i=o}if(i){for(const s of e.children)e.renameSignal(s.getName(t),e.getName(t)),s.component.layoutSize.set(t,"merged",!1);return i}else return{explicit:!1,value:void 0}}function mDt(e){const t=e.component.layoutSize;if(!t.explicit.width){const n=Ate(e,"width");t.set("width",n,!1)}if(!t.explicit.height){const n=Ate(e,"height");t.set("height",n,!1)}}function Ate(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const s=i.get("type"),o=i.get("range");return ki(s)&&Cf(o)?"range-step":r.view[t]}else return e.hasProjection?r.view[t]:t==="width"&&e.mark==="text"?r.scale.textXRangeStep:r.scale.rangeStep||gG.rangeStep}function gDt(e,t){return JCe(e,t)}function yDt(e,t){return JCe(e,t)}function Nte(e,t){if(a2e(e.field)){if(e.field.repeat in t)return Object.assign({},e,{field:t[e.field.repeat]});_e(we.noSuchRepeatedValue(e.field.repeat));return}return e}function Ite(e,t){if(e=Nte(e,t),e!==void 0){if(e===null)return null;if(u2e(e)&&Aa(e.sort)){const n=Nte(e.sort,t);e=Object.assign({},e,n?{sort:n}:{})}return e}}function Dte(e,t){if(ye(e)){const n=Ite(e,t);if(n)return n;if(aG(e))return{condition:e.condition}}else{if(Iu(e)){const n=Ite(e.condition,t);return n?Object.assign({},e,{condition:n}):Mt(e,["condition"])}return e}}function JCe(e,t){const n={};for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];if(be(i))n[r]=i.map(s=>Dte(s,t)).filter(s=>s);else{const s=Dte(i,t);s!==void 0&&(n[r]=s)}}return n}function d6(e,t,n){return Pe(t,Object.assign({suffix:`by_${Pe(e)}`},n||{}))}class Xx extends qCe{constructor(t,n,r,i,s){super(t,n,r,s,i,t.resolve),this.type="facet",this.child=dF(t.spec,this,this.getName("child"),void 0,i,s,!1),this.children=[this.child];const o=gDt(t.facet,i);this.facet=this.initFacet(o)}initFacet(t){return jO(t,(n,r,i)=>et([Ld,zd],i)?r.field===void 0?(_e(we.emptyFieldDef(r,i)),n):(n[i]=cG(r,i),n):(_e(we.incompatibleChannel(i,"facet")),n),{})}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=fF(this),this.child.parseData()}parseLayoutSize(){qG(this)}parseSelection(){this.child.parseSelection(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxisAndHeader(){this.child.parseAxisAndHeader(),this.parseHeader("column"),this.parseHeader("row"),this.mergeChildAxis("x"),this.mergeChildAxis("y")}parseHeader(t){if(this.channelHasField(t)){const n=this.facet[t];let r=gd(n,this.config,{allowDisabling:!0});this.child.component.layoutHeaders[t].title&&(r+=" / "+this.child.component.layoutHeaders[t].title,this.child.component.layoutHeaders[t].title=null),this.component.layoutHeaders[t]={title:r,facetFieldDef:n,header:[this.makeHeaderComponent(t,!0)]}}}makeHeaderComponent(t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:this.child.component.layoutSize.get(r)?this.child.getSizeSignalRef(r):void 0,axes:[]}}mergeChildAxis(t){const{child:n}=this;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=this.component;if(i.axis[t]=UG(i,t),i.axis[t]==="shared"){const s=t==="x"?"column":"row",o=r[s];for(const a of n.component.axes[t]){const u=DNt(a.get("orient"));o[u]=o[u]||[this.makeHeaderComponent(s,!1)];const l=fx(a,"main",this.config,{header:!0});o[u][0].axes.push(l),a.mainExtracted=!0}}}}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSelectionSignals(){return this.child.assembleSelectionSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};return["row","column"].forEach(n=>{["header","footer"].forEach(r=>{const i=this.component.layoutHeaders[n],s=i[r];if(s&&s[0]){const o=n==="row"?"height":"width",a=r==="header"?"headerBand":"footerBand";this.child.component.layoutSize.get(o)||(t[a]=t[a]||{},t[a][n]=.5),i.title&&(t.offset=t.offset||{},t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}})}),t}assembleDefaultLayout(){const t=this.channelHasField("column")?this.columnDistinctSignal():1;return Object.assign({},this.getHeaderLayoutMixins(),{columns:t,bounds:"full",align:"all"})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Xx))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof Xx?Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Pe(this.facet.column,{prefix:"distinct"})}}}}:{},super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof Xx){if(this.child.channelHasField("column")){const i=Pe(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of["x","y"]){const s=this.child.component.scales[i];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(ki(o)&&Cf(a)){const u=oF(this.child,i),l=WG(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):_e("Unknown field for ${channel}.  Cannot calculate view size.")}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),u=[];["row","column"].forEach(c=>{const f=this.facet[c];if(f){u.push(Pe(f));const{sort:d}=f;if(Aa(d)){const{field:h,op:p}=d,m=d6(f,d);r&&i?(s.push(m),o.push("max"),a.push(m)):(s.push(h),o.push(p),a.push(m))}else if(be(d)){const h=k1(f,c);s.push(h),o.push("max"),a.push(h)}}});const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||s.length?{aggregate:Object.assign({},l?{cross:l}:{},s.length?{fields:s,ops:o,as:a}:{})}:{})}headerSortFields(t){const{facet:n}=this,r=n[t];return r?Aa(r.sort)?[d6(r,r.sort,{expr:"datum"})]:be(r.sort)?[k1(r,t,{expr:"datum"})]:[Pe(r,{expr:"datum"})]:[]}headerSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Aa(i)?i.order:!be(i)&&i)||"ascending"]}return[]}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=fDt(n),i=t.assembleLayoutSize(),s=t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{},o?{style:o}:{},{from:{facet:this.assembleFacet()},sort:{field:[...this.headerSortFields("row"),...this.headerSortFields("column")],order:[...this.headerSortOrder("row"),...this.headerSortOrder("column")]}},r.length>0?{data:r}:{},i?{encode:{update:i}}:{},t.assembleGroup(oIt(this,[])))]}getMapping(){return this.facet}}function bDt(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const s of[n,r])if(Aa(s.sort)){const{field:o,op:a}=s.sort;e=i=new gg(e,{window:[{op:a,field:o,as:d6(s,s.sort,{forAs:!0})}],groupby:[Pe(s)],frame:[null,null]})}return i}return null}function eke(e,t){for(const n of t){const r=n.data;if(d2(e)&&d2(r)){const i=e.values,s=r.values;if(hwe(i,s))return n}else if(C1(e)&&C1(r)){if(e.url===r.url)return n}else if(wG(e)&&e.name===n.dataName)return n}return null}function vDt(e,t){if(e.data||!e.parent){const n=eke(e.data,t);if(n)return n.data.format=S1({},e.data.format,n.data.format),n;{const r=new E1(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function xDt(e,t,n){let r=0;for(const i of t.transforms){let s,o;if(SSe(i))o=e=new wm(e,i),s="derived";else if(NG(i))o=e=Pa.makeImplicitFromFilterTransform(e,i,n)||e,e=new aF(e,t,i.filter);else if(CSe(i))o=e=yd.makeFromTransform(e,i,t),s="number";else if($Se(i))o=e=Pc.makeFromTransform(e,i),s="date",n.getWithExplicit(i.field).value===void 0&&(e=new Pa(e,{[i.field]:s}),n.set(i.field,s,!1));else if(_Se(i))o=e=El.makeFromTransform(e,i),s="number",o6(t)&&(e=new A1(e));else if(bSe(i))o=e=b2.make(e,t,i,r++),s="derived";else if(xSe(i))o=e=new gg(e,i),s="number";else if(ESe(i))o=e=Lc.makeFromTransform(e,i),s="derived";else if(TSe(i))o=e=new lF(e,i),s="derived";else if(wSe(i))o=e=new uF(e,i),s="derived";else if(vSe(i))e=new cF(e,i);else if(kSe(i))o=e=Ip.makeFromTransform(e,i),s="derived";else{_e(we.invalidTransformIgnored(i));continue}if(o&&s!==void 0)for(const a of o.producedFields())n.set(a,s,!1)}return e}function fF(e){let t=vDt(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.parent?e.parent.component.data.ancestorParse.clone():new cDt;e.data&&e.data.format&&e.data.format.parse===null&&(i.parseNothing=!0),t=Pa.makeExplicit(t,e,i)||t,o6(e)&&(us(e)||T1(e))&&(t=new A1(t));const s=e.parent&&T1(e.parent);(us(e)||Tl(e))&&s&&(t=yd.makeFromEncoding(t,e)||t),e.transforms.length>0&&(t=xDt(t,e,i)),t=Pa.makeImplicitFromEncoding(t,e,i)||t,us(e)&&(t=A0.parseAll(t,e),t=y2.parseAll(t,e)),(us(e)||Tl(e))&&(s||(t=yd.makeFromEncoding(t,e)||t),t=Pc.makeFromEncoding(t,e)||t,t=wm.parseAllForSortIndex(t,e));const o=e.getName(h2),a=new xu(t,o,h2,r);if(n[o]=a,t=a,us(e)){const f=El.makeFromEncoding(t,e);f&&(t=f,o6(e)&&(t=new A1(t))),t=Ip.makeFromEncoding(t,e)||t,t=Lc.makeFromEncoding(t,e)||t}const u=e.getName(ts),l=new xu(t,u,ts,r);n[u]=l,t=l;let c=null;if(Tl(e)){const f=e.getName("facet");t=wm.parseAllForSortIndex(t,e),t=bDt(t,e.facet)||t,c=new kb(t,e,f,l.getSource()),n[f]=c,t=c}return Object.assign({},e.component.data,{outputNodes:n,outputNodeRefCounts:r,raw:a,main:l,facetRoot:c,ancestorParse:i})}class tke extends HG{constructor(t,n,r,i,s,o){super(t,n,r,i,s,o)}parseData(){this.component.data=fF(this),this.children.forEach(t=>{t.parseData()})}parseSelection(){this.component.selection={};for(const t of this.children)t.parseSelection(),Se(t.component.selection).forEach(n=>{this.component.selection[n]=t.component.selection[n]})}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxisAndHeader(){for(const t of this.children)t.parseAxisAndHeader()}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSelectionSignals(){return this.children.forEach(t=>t.assembleSelectionSignals()),[]}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),MG(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleLayoutSize();return Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{},r?{style:r}:{},i?{encode:{update:i}}:{},t.assembleGroup())})}}class wDt extends tke{constructor(t,n,r,i,s){super(t,n,r,s,i,t.resolve),this.type="concat",t.resolve&&t.resolve.axis&&(t.resolve.axis.x==="shared"||t.resolve.axis.y==="shared")&&_e(we.CONCAT_CANNOT_SHARE_AXIS),this.isVConcat=bm(t),this.children=(bm(t)?t.vconcat:t.hconcat).map((o,a)=>dF(o,this,this.getName("concat_"+a),void 0,i,s,!1))}parseLayoutSize(){pDt(this)}parseAxisGroup(){return null}assembleDefaultLayout(){return Object.assign({},this.isVConcat?{columns:1}:{},{bounds:"full",align:"each"})}}function SDt(e){return e===!1||e===null}class XG extends kf{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new XG(jt(this.explicit),jt(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!SDt(this.get(t))}}function nke(e,t,n,r="",i){const s=(i==="band"?["axisBand"]:[]).concat([n==="x"?"axisX":"axisY","axis"+r.substr(0,1).toUpperCase()+r.substr(1),"axis"]);for(const o of s)if(t[o]&&t[o][e]!==void 0)return t[o][e]}function CDt(e,t,n,r){const i=e.fieldDef(t)||(t==="x"?e.fieldDef("x2"):t==="y"?e.fieldDef("y2"):void 0),s=e.axis(t),o=e.config;let a={};if(xb(i)){const u=e.getScaleComponent(t).get("type")===Ut.UTC,l=DG("datum.value",i.timeUnit,s.format,o.axis.shortTimeLabels,null,u);l&&(a.text={signal:l})}return a=Object.assign({},a,n),Se(a).length===0?void 0:a}function kDt(e,t){return!ki(e)&&!dn(t.bin)}function $Dt(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function _Dt(e,t,n,r){if(t.labelAngle!==void 0)return(t.labelAngle%360+360)%360;{const i=nke("labelAngle",e.config,n,iE(n),e.getScaleComponent(n).get("type"));return i!==void 0?(i%360+360)%360:n===Dt&&et([oG,sG],r.type)?270:void 0}}function EDt(e,t){if(e!==void 0)return t==="top"||t==="bottom"?e<=45||315<=e?t==="top"?"bottom":"top":135<=e&&e<=225?t==="top"?"top":"bottom":"middle":e<=45||315<=e||135<=e&&e<=225?"middle":45<=e&&e<=135?t==="left"?"top":"bottom":t==="left"?"bottom":"top"}function TDt(e,t){if(e!==void 0)return e=(e%360+360)%360,t==="top"||t==="bottom"?e%180===0?"center":0<e&&e<180?t==="top"?"right":"left":t==="top"?"left":"right":(e+90)%180===0?"center":90<=e&&e<270?t==="left"?"left":"right":t==="left"?"right":"left"}function ADt(e,t){if(t==="x"&&et(["quantitative","temporal"],e.type))return!0}function NDt(e,t){if(e.type!=="nominal")return t==="log"?"greedy":!0}function iE(e){switch(e){case Dt:return"bottom";case fn:return"left"}throw new Error(we.INVALID_CHANNEL_FOR_AXIS)}function IDt({fieldDef:e,scaleType:t,size:n,scaleName:r,specifiedAxis:i={}}){if(!ki(t)&&t!=="log"&&!et(["month","hours","day","quarter"],e.timeUnit))return i.tickStep?{signal:`(domain('${r}')[1] - domain('${r}')[0]) / ${i.tickStep} + 1`}:dn(e.bin)?{signal:`ceil(${n.signal}/10)`}:{signal:`ceil(${n.signal}/40)`}}function DDt(e,t,n,r){const i=e.values;if(i)return dG(n,i);if(n.type===Ud){if(dn(n.bin)){const s=t.scaleDomain(r);if(s&&s!=="unaggregated"&&!GO(s))return i;const o=t.getName(Pe(n,{suffix:"bins"}));return{signal:`sequence(${o}.start, ${o}.stop + ${o}.step, ${o}.step)`}}else if(e.tickStep){const s=t.scaleName(r),o=e.tickStep;return{signal:`sequence(domain('${s}')[0], domain('${s}')[1] + ${o}, ${o})`}}}}function ODt(e){return yb.reduce((t,n)=>(e.component.scales[n]&&e.axis(n)&&(t[n]=[zDt(n,e)]),t),{})}const FDt={bottom:"top",top:"bottom",left:"right",right:"left"};function RDt(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxisAndHeader();for(const s of Se(i.component.axes))n.axis[s]=UG(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=MDt(t[s],i.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const i of[Dt,fn])for(const s of e.children)if(s.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]||[]).concat(s.component.axes[i]);for(const o of s.component.axes[i]){const{value:a,explicit:u}=o.getWithExplicit("orient");if(r[a]>0&&!u){const l=FDt[a];r[a]>r[l]&&o.set("orient",l,!1)}r[a]++}}delete s.component.axes[i]}}function MDt(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=t[r];if(!!i!=!!s)return;if(i&&s){const o=i.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[r]=PDt(i,s)}}}else return t.map(n=>n.clone());return e}function PDt(e,t){for(const n of EH){const r=yk(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,s)=>{switch(n){case"title":return zSe(i,s);case"gridScale":return{explicit:i.explicit,value:ct(i.value,s.value)}}return sF(i,s,n,"axis")});e.setWithExplicit(n,r)}return e}function rke(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),s=r?r.title:void 0,o=i?i.title:void 0;if(s&&o)return LSe(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function LDt(e,t,n,r,i){switch(t){case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===rke(r,i))return!0}return e===n[t]}function zDt(e,t){const n=t.axis(e),r=new XG;EH.forEach(o=>{const a=BDt(o,n,e,t);if(a!==void 0){const u=LDt(a,o,n,t,e),l=nke(o,t.config,e,r.get("orient"),t.getScaleComponent(e).get("type"));u||l===void 0?r.set(o,a,u):o==="grid"&&l&&r.set(o,l,!1)}});const i=n.encoding||{},s=_H.reduce((o,a)=>{if(!r.hasAxisPart(a))return o;const u=wCe(i[a]||{},t),l=a==="labels"?CDt(t,e,u,r.get("orient")):u;return l!==void 0&&Se(l).length>0&&(o[a]={update:l}),o},{});return Se(s).length>0&&r.set("encode",s,!!n.encoding||n.labelAngle!==void 0),r}function BDt(e,t,n,r){const i=r.fieldDef(n),s=_Dt(r,t,n,i);switch(e){case"scale":return r.scaleName(n);case"gridScale":return $Dt(r,n);case"format":return IG(i,t.format,r.config);case"grid":{if(Do(r.fieldDef(n).bin))return!1;{const u=r.getScaleComponent(n).get("type");return ct(t.grid,kDt(u,i))}}case"labelAlign":return ct(t.labelAlign,TDt(s,iE(n)));case"labelAngle":return s;case"labelBaseline":return ct(t.labelBaseline,EDt(s,iE(n)));case"labelFlush":return ct(t.labelFlush,ADt(i,n));case"labelOverlap":{const u=r.getScaleComponent(n).get("type");return ct(t.labelOverlap,NDt(i,u))}case"orient":return ct(t.orient,iE(n));case"tickCount":{const u=r.getScaleComponent(n).get("type"),l=r.scaleName(n),c=n==="x"?"width":n==="y"?"height":void 0,f=c?r.getSizeSignalRef(c):void 0;return ct(t.tickCount,IDt({fieldDef:i,scaleType:u,size:f,scaleName:l,specifiedAxis:t}))}case"title":const o=n==="x"?"x2":"y2",a=r.fieldDef(o);return ct(t.title,rke(r,n),PSe([YL(i)],a?[YL(a)]:[]));case"values":return DDt(t,r,i,n)}return Iwe(e)?t[e]:void 0}function UDt(e,t,n){const r=Ko(e)?Object.assign({},e):{type:e},i=r.orient||Js("orient",r,n);return r.orient=HDt(r.type,t,i),i!==void 0&&i!==r.orient&&_e(we.orientOverridden(r.orient,i)),ct(r.opacity,Js("opacity",r,n))===void 0&&(r.opacity=VDt(r.type,t)),r.filled===void 0&&(r.filled=jDt(r,n)),(r.cursor||Js("cursor",r,n))===void 0&&(r.cursor=WDt(r,t,n)),r}function WDt(e,t,n){return t.href||e.href||Js("href",e,n)?"pointer":e.cursor}function VDt(e,t){if(et([sk,ok,ak,uk],e)&&!hG(t))return .7}function jDt(e,t){const n=Js("filled",e,t),r=e.type;return ct(n,r!==sk&&r!==ik&&r!==l2)}function HDt(e,t,n){switch(e){case sk:case ak:case uk:case LO:case zO:return}const{x:r,y:i,x2:s,y2:o}=t;switch(e){case bb:if(ye(r)&&Do(r.bin))return"vertical";if(ye(i)&&Do(i.bin))return"horizontal";if(o||s){if(n)return n;if(!s&&ye(r)&&r.type===Ud&&!dn(r.bin))return"horizontal";if(!o&&ye(i)&&i.type===Ud&&!dn(i.bin))return"vertical"}case l2:if(s&&o)return;case rk:if(o)return ye(i)&&Do(i.bin)?"horizontal":"vertical";if(s)return ye(r)&&Do(r.bin)?"vertical":"horizontal";if(e===l2){if(t.x&&!t.y)return"vertical";if(t.y&&!t.x)return"horizontal"}case ik:case ok:const a=ye(t.x)&&cu(t.x),u=ye(t.y)&&cu(t.y);if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u){const l=t.x,c=t.y,f=l.type===RA,d=c.type===RA;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}return"vertical"}class ike extends qCe{constructor(t,n,r,i={},s,o,a){super(t,n,r,o,s,void 0),this.fit=a,this.type="unit",this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[],this.initSize(Object.assign({},i,t.width?{width:t.width}:{},t.height?{height:t.height}:{}));const u=Ko(t.mark)?t.mark.type:t.mark,l=this.encoding=k2e(yDt(t.encoding||{},s),u);this.markDef=UDt(t.mark,l,o),this.stack=qO(u,l,this.config.stack),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===GH,r=t&&Dwe.some(i=>ye(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return nk.reduce((r,i)=>{let s,o;const a=n[i];return ye(a)?(s=a,o=a.scale):Iu(a)&&(s=a.condition,o=a.condition.scale),s&&(r[i]=o||{}),r},{})}initAxes(t){return[Dt,fn].reduce((n,r)=>{const i=t[r];if(ye(i)||r===Dt&&ye(t.x2)||r===fn&&ye(t.y2)){const s=ye(i)?i.axis:null;s!==null&&(n[r]=Object.assign({},s))}return n},{})}initLegend(t){return Mwe.reduce((n,r)=>{const i=t[r];if(i){const s=ye(i)?i.legend:Iu(i)?i.condition.legend:null;s!==null&&s!==!1&&(n[r]=Object.assign({},s))}return n},{})}parseData(){this.component.data=fF(this)}parseLayoutSize(){mDt(this)}parseSelection(){this.component.selection=iIt(this,this.selection)}parseMarkGroup(){this.component.mark=oDt(this)}parseAxisAndHeader(){this.component.axes=ODt(this)}assembleSelectionTopLevelSignals(t){return aIt(this,t)}assembleSelectionSignals(){return sIt(this,[])}assembleSelectionData(t){return uIt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return MG(this)}assembleMarks(){let t=this.component.mark||[];return(!this.parent||!T1(this.parent))&&(t=fCe(this,t)),t.map(this.correctDataNames)}assembleLayoutSize(){return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}}getMapping(){return this.encoding}toSpec(t,n){const r=jt(this.encoding);let i;return i={mark:this.markDef,encoding:r},t||(i.config=jt(this.config)),n||(i.data=jt(this.data)),i}get mark(){return this.markDef.type}channelHasField(t){return Wd(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return vh(n)}}class KG extends HG{constructor(t,n,r,i,s,o,a){super(t,n,r,o,s,t.resolve),this.type="layer";const u=Object.assign({},i,t.width?{width:t.width}:{},t.height?{height:t.height}:{});this.initSize(u),this.children=t.layer.map((l,c)=>{if(Ql(l))return new KG(l,this,this.getName("layer_"+c),u,s,o,a);if(Sf(l))return new ike(l,this,this.getName("layer_"+c),u,s,o,a);throw new Error(we.INVALID_SPEC)})}parseData(){this.component.data=fF(this);for(const t of this.children)t.parseData()}parseLayoutSize(){QCe(this)}parseSelection(){this.component.selection={};for(const t of this.children)t.parseSelection(),Se(t.component.selection).forEach(n=>{this.component.selection[n]=t.component.selection[n]})}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxisAndHeader(){RDt(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSelectionSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSelectionSignals()),[])}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),MG(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return lIt(this,Pd(this.children.map(t=>t.assembleMarks())))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),DCe(this))}}class GDt extends tke{constructor(t,n,r,i,s){super(t,n,r,s,i,t.resolve),this.type="repeat",t.resolve&&t.resolve.axis&&(t.resolve.axis.x==="shared"||t.resolve.axis.y==="shared")&&_e(we.REPEAT_CANNOT_SHARE_AXIS),this.repeat=t.repeat,this.children=this._initChildren(t,this.repeat,i,s)}_initChildren(t,n,r,i){const s=[],o=n.row||[r?r.row:null],a=n.column||[r?r.column:null];for(const u of o)for(const l of a){const c=(u?"_"+u:"")+(l?"_"+l:""),f={row:u,column:l};s.push(dF(t.spec,this,this.getName("child"+c),void 0,f,i,!1))}return s}parseLayoutSize(){hDt(this)}assembleDefaultLayout(){return{columns:this.repeat&&this.repeat.column?this.repeat.column.length:1,bounds:"full",align:"all"}}}function dF(e,t,n,r,i,s,o){if(hg(e))return new Xx(e,t,n,i,s);if(Ql(e))return new KG(e,t,n,r,i,s,o);if(Sf(e))return new ike(e,t,n,r,i,s,o);if(Sb(e))return new GDt(e,t,n,i,s);if($G(e))return new wDt(e,t,n,i,s);throw new Error(we.INVALID_SPEC)}function qDt(e,t={}){t.logger&&_Et(t.logger),t.fieldTitle&&lG(t.fieldTitle);try{const n=eSe(S1({},t.config,e.config)),r=aSe(e,n),i=lAt(e.autosize,n.autosize,Ql(r)||Sf(r)),s=dF(r,null,"",void 0,void 0,n,i.type==="fit");return s.parse(),n3t(s.component.data),KDt(s,XDt(e,n,i),e.datasets,e.usermeta)}finally{t.logger&&EEt(),t.fieldTitle&&b2e()}}function XDt(e,t,n){return Object.assign({autosize:Se(n).length===1&&n.type?n.type:n},Jee(t),Jee(e))}function KDt(e,t,n={},r){const i=e.config?tSe(e.config):void 0,s=[].concat(e.assembleSelectionData([]),dDt(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle();let l=e.assembleLayoutSignals();return l=l.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),{spec:Object.assign({$schema:"https://vega.github.io/schema/vega/v4.json"},e.description?{description:e.description}:{},t,a?{title:a}:{},u?{style:u}:{},{data:s},o.length>0?{projections:o}:{},e.assembleGroup([...l,...e.assembleSelectionTopLevelSignals([])]),i?{config:i}:{},r?{usermeta:r}:{})}}function bk(e,t){if(hg(e)||Sb(e))return ZDt(e,t);if(Ql(e))return QDt(e,t);if(Sf(e))return YDt(e,t);if(bm(e))return JDt(e,t);if(XO(e))return eOt(e,t);throw new Error(we.INVALID_SPEC)}function YDt(e,t){if(e.encoding){const{encoding:n,transform:r}=e,i=Mt(e,["encoding","transform"]),{bins:s,timeUnits:o,aggregate:a,groupby:u,encoding:l}=VO(n,t);return Object.assign({transform:[...r||[],...s,...o,...a.length?[{aggregate:a,groupby:u}]:[]]},i,{encoding:l})}else return e}function ZDt(e,t){const{spec:n}=e,r=Mt(e,["spec"]);return Object.assign({},r,{spec:bk(n,t)})}function QDt(e,t){const{layer:n}=e,r=Mt(e,["layer"]);return Object.assign({},r,{layer:n.map(i=>bk(i,t))})}function JDt(e,t){const{vconcat:n}=e,r=Mt(e,["vconcat"]);return Object.assign({},r,{vconcat:n.map(i=>bk(i,t))})}function eOt(e,t){const{hconcat:n}=e,r=Mt(e,["hconcat"]);return Object.assign({},r,{hconcat:n.map(i=>bk(i,t))})}const tOt=K_t.version,nOt=Object.freeze(Object.defineProperty({__proto__:null,aggregate:dEt,axis:mEt,bin:SEt,channel:wEt,compile:qDt,compositeMark:hTt,config:OTt,data:FTt,datetime:OEt,encoding:qEt,extractTransforms:bk,fieldDef:HEt,header:RTt,legend:gTt,mark:$Et,scale:TTt,sort:MTt,spec:eAt,stack:zTt,timeUnit:UEt,transform:sAt,type:VEt,util:cEt,validate:aAt,version:tOt},Symbol.toStringTag,{value:"Module"}));var ske={};Object.defineProperty(ske,"__esModule",{value:!0});function rOt(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g,n=t.exec(e).slice(1,3),r=n[0],i=n[1];return{library:r,version:i}}var oke=ske.default=rOt,iOt="vega-themes",sOt="2.15.0",oOt="Themes for stylized Vega and Vega-Lite visualizations.",aOt=["vega","vega-lite","themes","style"],uOt="BSD-3-Clause",lOt={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},cOt=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],fOt="build/vega-themes.js",YG="build/vega-themes.module.js",dOt="build/vega-themes.min.js",hOt="build/vega-themes.min.js",pOt="build/vega-themes.module.d.ts",mOt={type:"git",url:"https://github.com/vega/vega-themes.git"},gOt=["src","build"],yOt={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},bOt={"@babel/core":"^7.24.6","@babel/plugin-transform-runtime":"^7.24.6","@babel/preset-env":"^7.24.6","@babel/preset-typescript":"^7.24.6","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","browser-sync":"^3.0.2",concurrently:"^8.2.2",eslint:"^8.45.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.1.3","gh-pages":"^6.1.1",prettier:"^3.2.5","release-it":"^17.3.0",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.4.5",typescript:"^5.4.5",vega:"^5.25.0","vega-lite":"^5.9.3"},vOt={vega:"*","vega-lite":"*"},xOt={},wOt={name:iOt,version:sOt,description:oOt,keywords:aOt,license:uOt,author:lOt,contributors:cOt,main:fOt,module:YG,unpkg:dOt,jsdelivr:hOt,types:pOt,repository:mOt,files:gOt,scripts:yOt,devDependencies:bOt,peerDependencies:vOt,dependencies:xOt};const Og="#fff",Ote="#888",SOt={background:"#333",view:{stroke:Ote},title:{color:Og,subtitleColor:Og},style:{"guide-label":{fill:Og},"guide-title":{fill:Og}},axis:{domainColor:Og,gridColor:Ote,tickColor:Og}},Dh="#4572a7",COt={background:"#fff",arc:{fill:Dh},area:{fill:Dh},line:{stroke:Dh,strokeWidth:2},path:{stroke:Dh},rect:{fill:Dh},shape:{stroke:Dh},symbol:{fill:Dh,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Oh="#30a2da",jM="#cbcbcb",kOt="#999",$Ot="#333",Fte="#f0f0f0",Rte="#333",_Ot={arc:{fill:Oh},area:{fill:Oh},axis:{domainColor:jM,grid:!0,gridColor:jM,gridWidth:1,labelColor:kOt,labelFontSize:10,titleColor:$Ot,tickColor:jM,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Fte,group:{fill:Fte},legend:{labelColor:Rte,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Rte,titleFontSize:14,titlePadding:10},line:{stroke:Oh,strokeWidth:2},path:{stroke:Oh,strokeWidth:.5},rect:{fill:Oh},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Oh},bar:{binSpacing:2,fill:Oh,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Fh="#000",EOt={group:{fill:"#e5e5e5"},arc:{fill:Fh},area:{fill:Fh},line:{stroke:Fh},path:{stroke:Fh},rect:{fill:Fh},shape:{stroke:Fh},symbol:{fill:Fh,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},TOt=22,AOt="normal",Mte="Benton Gothic, sans-serif",Pte=11.5,NOt="normal",Rh="#82c6df",HM="Benton Gothic Bold, sans-serif",Lte="normal",zte=13,Sv={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},IOt={background:"#ffffff",title:{anchor:"start",color:"#000000",font:HM,fontSize:TOt,fontWeight:AOt},arc:{fill:Rh},area:{fill:Rh},line:{stroke:Rh,strokeWidth:2},path:{stroke:Rh},rect:{fill:Rh},shape:{stroke:Rh},symbol:{fill:Rh,size:30},axis:{labelFont:Mte,labelFontSize:Pte,labelFontWeight:NOt,titleFont:HM,titleFontSize:zte,titleFontWeight:Lte},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Mte,labelFontSize:Pte,symbolType:"square",titleFont:HM,titleFontSize:zte,titleFontWeight:Lte},range:{category:Sv["category-6"],diverging:Sv["fireandice-6"],heatmap:Sv["fire-7"],ordinal:Sv["fire-7"],ramp:Sv["fire-7"]}},Mh="#ab5787",K$="#979797",DOt={background:"#f9f9f9",arc:{fill:Mh},area:{fill:Mh},line:{stroke:Mh},path:{stroke:Mh},rect:{fill:Mh},shape:{stroke:Mh},symbol:{fill:Mh,size:30},axis:{domainColor:K$,domainWidth:.5,gridWidth:.2,labelColor:K$,tickColor:K$,tickWidth:.2,titleColor:K$},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Ph="#3e5c69",OOt={background:"#fff",arc:{fill:Ph},area:{fill:Ph},line:{stroke:Ph},path:{stroke:Ph},rect:{fill:Ph},shape:{stroke:Ph},symbol:{fill:Ph},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ta="#1696d2",Bte="#000000",FOt="#FFFFFF",Y$="Lato",GM="Lato",ROt="Lato",MOt="#DEDDDD",POt=18,Cv={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},LOt={background:FOt,title:{anchor:"start",fontSize:POt,font:Y$},axisX:{domain:!0,domainColor:Bte,domainWidth:1,grid:!1,labelFontSize:12,labelFont:GM,labelAngle:0,tickColor:Bte,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Y$},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:MOt,gridWidth:1,labelFontSize:12,labelFont:GM,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Y$,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:GM,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Y$,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Cv["six-groups-cat-1"],diverging:Cv["diverging-colors"],heatmap:Cv["diverging-colors"],ordinal:Cv["six-groups-seq"],ramp:Cv["shades-blue"]},area:{fill:ta},rect:{fill:ta},line:{color:ta,stroke:ta,strokeWidth:5},trail:{color:ta,stroke:ta,strokeWidth:0,size:1},path:{stroke:ta,strokeWidth:.5},point:{filled:!0},text:{font:ROt,color:ta,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ta,stroke:null}},arc:{fill:ta},shape:{stroke:ta},symbol:{fill:ta,size:30}},Lh="#3366CC",Ute="#ccc",Z$="Arial, sans-serif",zOt={arc:{fill:Lh},area:{fill:Lh},path:{stroke:Lh},rect:{fill:Lh},shape:{stroke:Lh},symbol:{stroke:Lh},circle:{fill:Lh},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Z$,fontSize:12},"guide-title":{font:Z$,fontSize:12},"group-title":{font:Z$,fontSize:12}},title:{font:Z$,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Ute,tickColor:Ute,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},ZG=e=>e*(1/3+1),Wte=ZG(9),Vte=ZG(10),jte=ZG(12),kv="Segoe UI",Hte="wf_standard-font, helvetica, arial, sans-serif",Gte="#252423",$v="#605E5C",qte="transparent",BOt="#C8C6C4",Ya="#118DFF",UOt="#12239E",WOt="#E66C37",VOt="#6B007B",jOt="#E044A7",HOt="#744EC2",GOt="#D9B300",qOt="#D64550",ake=Ya,uke="#DEEFFF",Xte=[uke,ake],XOt=[uke,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",ake],KOt={view:{stroke:qte},background:qte,font:kv,header:{titleFont:Hte,titleFontSize:jte,titleColor:Gte,labelFont:kv,labelFontSize:Vte,labelColor:$v},axis:{ticks:!1,grid:!1,domain:!1,labelColor:$v,labelFontSize:Wte,titleFont:Hte,titleColor:Gte,titleFontSize:jte,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:BOt,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:Ya},line:{stroke:Ya,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:kv,fontSize:Wte,fill:$v},arc:{fill:Ya},area:{fill:Ya,line:!0,opacity:.6},path:{stroke:Ya},rect:{fill:Ya},point:{fill:Ya,filled:!0,size:75},shape:{stroke:Ya},symbol:{fill:Ya,strokeWidth:1.5,size:50},legend:{titleFont:kv,titleFontWeight:"bold",titleColor:$v,labelFont:kv,labelFontSize:Vte,labelColor:$v,symbolType:"circle",symbolSize:75},range:{category:[Ya,UOt,WOt,VOt,jOt,HOt,GOt,qOt],diverging:Xte,heatmap:Xte,ordinal:XOt}},qM='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',YOt='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',XM=400,Q$={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},ZOt=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],QOt=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function hF({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",r=Q$.gridBg[e],i=Q$.textPrimary[e],s=Q$.textSecondary[e],o=n==="dark"?ZOt:QOt,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:qM,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:YOt,labelFontWeight:XM,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:Q$.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:qM,fill:s,fontWeight:XM},"guide-title":{font:qM,fill:s,fontWeight:XM}},range:{category:o,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const JOt=hF({theme:"white",background:"#ffffff"}),eFt=hF({theme:"g10",background:"#f4f4f4"}),tFt=hF({theme:"g90",background:"#262626"}),nFt=hF({theme:"g100",background:"#161616"}),rFt=wOt.version,iFt=Object.freeze(Object.defineProperty({__proto__:null,carbong10:eFt,carbong100:nFt,carbong90:tFt,carbonwhite:JOt,dark:SOt,excel:COt,fivethirtyeight:_Ot,ggplot2:EOt,googlecharts:zOt,latimes:IOt,powerbi:KOt,quartz:DOt,urbaninstitute:LOt,version:rFt,vox:OOt},Symbol.toStringTag,{value:"Module"})),sFt=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`,lke="vg-tooltip-element",oFt={offsetX:10,offsetY:10,id:lke,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:aFt,maxDepth:2};function aFt(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function uFt(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return sFt.toString().replace(lke,e)}function lFt(e,t,n){if(be(e))return`[${e.map(r=>t(ft(r)?r:Kte(r,n))).join(", ")}]`;if(yt(e)){let r="";const i=e,{title:s}=i,o=Mt(i,["title"]);s&&(r+=`<h2>${t(s)}</h2>`);const a=Object.keys(o);if(a.length>0){r+="<table>";for(const u of a){let l=o[u];yt(l)&&(l=Kte(l,n)),r+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(l)}</td></tr>`}r+="</table>"}return r||"{}"}return t(e)}function cFt(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function Kte(e,t){return JSON.stringify(e,cFt(t))}function fFt(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let s=e.clientY+r;return s+t.height>window.innerHeight&&(s=+e.clientY-r-t.height),{x:i,y:s}}class dFt{constructor(t){this.options=Object.assign({},oFt,t);const n=this.options.id;if(this.call=this.tooltip_handler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=uFt(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}this.el=document.getElementById(n),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",n),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltip_handler(t,n,r,i){if(i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=lFt(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:o}=fFt(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${s}px`)}}function hFt(e,t,n){const r=e.open(t),i=1e4,s=250;let o=~~(i/s);function a(l){l.source===r&&(o=0,e.removeEventListener("message",a,!1))}e.addEventListener("message",a,!1);function u(){o<=0||(r.postMessage(n,"*"),setTimeout(u,s),o-=1)}setTimeout(u,s)}const pFt=`.vega-embed {
  position: relative;
  display: inline-block;
  padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    display: flex;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5); }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: scroll;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;function a0(e,...t){for(const n of t)e=mFt(e,n);return e}function mFt(e,t){if(typeof t!="object"||t===null)return e;for(const n in t)t.hasOwnProperty(n)&&t[n]!==void 0&&(typeof t[n]!="object"||be(t[n])||t[n]===null?e[n]=t[n]:typeof e[n]!="object"||e[n]===null?e[n]=a0(be(t[n].constructor)?[]:{},t[n]):a0(e[n],t[n]));return e}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});const lc=T_t,VA=nOt,sE={vega:"Vega","vega-lite":"Vega-Lite"},jA={vega:lc.version,"vega-lite":VA?VA.version:"not available"},gFt={vega:(e,t)=>e,"vega-lite":(e,t)=>VA.compile(e,{config:t}).spec},yFt=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" width="14" height="14">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,bFt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Vega Source",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"};function vFt(e){return typeof e=="function"}function Yte(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+e+s),o.document.title=`${sE[r]} JSON Source`}function cke(e,t){if(e.$schema){const n=oke(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${sE[n.library]}, but mode argument sets ${sE[t]||t}.`);const r=n.library;return cpe.satisfies(jA[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${r} ${n.version}, but the current version of ${sE[r]} is ${jA[r]}.`),r}else{if("mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e)return"vega-lite";if("marks"in e||"signals"in e||"scales"in e||"axes"in e)return"vega"}return t||"vega"}function xFt(e){return!!(e&&"load"in e)}function h6(e,t,n={}){return Vnt(this,void 0,void 0,function*(){n=n||{};const r=n.patch||n.onBeforeParse,i=n.actions===!0||n.actions===!1?n.actions:a0({},{export:{svg:!0,png:!0},source:!0,compiled:!1,editor:!0},n.actions||{}),s=Object.assign({},bFt,n.i18n),o=xFt(n.loader)?n.loader:lc.loader(n.loader),a=n.renderer||"canvas",u=n.logLevel||lc.Warn;if(lc.isString(t)){const g=yield o.load(t);return h6(e,JSON.parse(g),n)}let l=n.config||{};if(lc.isString(l)){const g=yield o.load(l);return h6(e,t,Object.assign({},n,{config:JSON.parse(g)}))}if(n.defaultStyle!==!1){const g="vega-embed-style";if(!document.getElementById(g)){const y=document.createElement("style");y.id=g,y.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?pFt.toString():n.defaultStyle,document.head.appendChild(y)}}n.theme&&(l=a0({},iFt[n.theme],l));const c=cke(t,n.mode);let f=gFt[c](t,l);if(c==="vega-lite"&&f.$schema){const g=oke(f.$schema);cpe.satisfies(jA.vega,`^${g.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${g.version}, but current version is ${jA.vega}.`)}const d=bU(e).classed("vega-embed",!0).html("");if(r)if(r instanceof Function)f=r(f);else if(lc.isString(r)){const g=yield o.load(r);f=a0(f,JSON.parse(g))}else f=a0(f,r);const h=lc.parse(f,c==="vega-lite"?{}:l),p=new lc.View(h,{loader:o,logLevel:u,renderer:a}).initialize(e);if(n.tooltip!==!1){let g;vFt(n.tooltip)?g=n.tooltip:g=new dFt(n.tooltip===!0?{}:n.tooltip).call,p.tooltip(g)}let m=n.hover;if(m===void 0&&(m=c!=="vega-lite"),m){const{hoverSet:g,updateSet:y}=typeof m=="boolean"?{}:m;p.hover(g,y)}if(n&&(n.width&&p.width(n.width),n.height&&p.height(n.height),n.padding&&p.padding(n.padding)),n.runAsync?yield p.runAsync():p.run(),i!==!1){let g=d;if(n.defaultStyle!==!1){const b=g=d.append("details").attr("title",s.CLICK_TO_VIEW_ACTIONS);b.insert("summary").html(yFt);const x=b.node();document.addEventListener("click",w=>{x.contains(w.target)||x.removeAttribute("open")})}const y=g.insert("div").attr("class","vega-actions");if(i===!0||i.export!==!1){for(const b of["svg","png"])if(i===!0||i.export===!0||i.export[b]){const v=s[`${b.toUpperCase()}_ACTION`];y.append("a").text(v).attr("href","#").attr("target","_blank").attr("download",`visualization.${b}`).on("mousedown",function(){p.toImageURL(b,n.scaleFactor).then(x=>{this.href=x}).catch(x=>{throw x}),No.preventDefault()})}}if((i===!0||i.source!==!1)&&y.append("a").text(s.SOURCE_ACTION).attr("href","#").on("mousedown",()=>{Yte(_R(t),n.sourceHeader||"",n.sourceFooter||"",c),No.preventDefault()}),c==="vega-lite"&&(i===!0||i.compiled!==!1)&&y.append("a").text(s.COMPILED_ACTION).attr("href","#").on("mousedown",()=>{Yte(_R(f),n.sourceHeader||"",n.sourceFooter||"","vega"),No.preventDefault()}),i===!0||i.editor!==!1){const b=n.editorUrl||"https://vega.github.io/editor/";y.append("a").text(s.EDITOR_ACTION).attr("href","#").on("mousedown",()=>{hFt(window,b,{config:l,mode:c,renderer:a,spec:_R(t)}),No.preventDefault()})}}return{view:p,spec:t,vgSpec:f}})}const wFt=Object.freeze(Object.defineProperty({__proto__:null,default:h6,guessMode:cke,vega:lc,vl:VA},Symbol.toStringTag,{value:"Module"})),$b=Em(wFt);var As={},vk={};Object.defineProperty(vk,"__esModule",{value:!0});function SFt(e){return e.name!=null}vk.isSurfaceInfo=SFt;function CFt(e){return e.drawArea instanceof HTMLElement}vk.isSurface=CFt;var xk={},QG={};function kFt(){}var ao={},Fg=[],Zte=[];function v2(e,t){var n=Zte,r,i,s,o;for(o=arguments.length;o-- >2;)Fg.push(arguments[o]);for(t&&t.children!=null&&(Fg.length||Fg.push(t.children),delete t.children);Fg.length;)if((i=Fg.pop())&&i.pop!==void 0)for(o=i.length;o--;)Fg.push(i[o]);else typeof i=="boolean"&&(i=null),(s=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(s=!1)),s&&r?n[n.length-1]+=i:n===Zte?n=[i]:n.push(i),r=s;var a=new kFt;return a.nodeName=e,a.children=n,a.attributes=t??void 0,a.key=t==null?void 0:t.key,ao.vnode!==void 0&&ao.vnode(a),a}function bd(e,t){for(var n in t)e[n]=t[n];return e}var $Ft=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function fke(e,t){return v2(e.nodeName,bd(bd({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var _Ft=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,p6=[];function dke(e){!e._dirty&&(e._dirty=!0)&&p6.push(e)==1&&(ao.debounceRendering||$Ft)(JG)}function JG(){var e,t=p6;for(p6=[];e=t.pop();)e._dirty&&pF(e)}function EFt(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&hke(e,t.nodeName):n||e._componentConstructor===t.nodeName}function hke(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function pke(e){var t=bd({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function TFt(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function eq(e){var t=e.parentNode;t&&t.removeChild(e)}function Qte(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var s in n)s in r||(e.style[s]="");for(var s in r)e.style[s]=typeof r[s]=="number"&&_Ft.test(s)===!1?r[s]+"px":r[s]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,Jte,o):e.removeEventListener(t,Jte,o),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)AFt(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var a=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?a?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(a?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function AFt(e,t,n){try{e[t]=n}catch{}}function Jte(e){return this._listeners[e.type](ao.event&&ao.event(e)||e)}var mke=[],m6=0,Uf=!1,HA=!1;function gke(){for(var e;e=mke.pop();)ao.afterMount&&ao.afterMount(e),e.componentDidMount&&e.componentDidMount()}function yke(e,t,n,r,i,s){m6++||(Uf=i!=null&&i.ownerSVGElement!==void 0,HA=e!=null&&!("__preactattr_"in e));var o=bke(e,t,n,r,s);return i&&o.parentNode!==i&&i.appendChild(o),--m6||(HA=!1,s||gke()),o}function bke(e,t,n,r,i){var s=e,o=Uf;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(s=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(s,e),Cm(e,!0))),s.__preactattr_=!0,s;var a=t.nodeName;if(typeof a=="function")return FFt(e,t,n,r);if(Uf=a==="svg"?!0:a==="foreignObject"?!1:Uf,a=String(a),(!e||!hke(e,a))&&(s=TFt(a,Uf),e)){for(;e.firstChild;)s.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(s,e),Cm(e,!0)}var u=s.firstChild,l=s.__preactattr_,c=t.children;if(l==null){l=s.__preactattr_={};for(var f=s.attributes,d=f.length;d--;)l[f[d].name]=f[d].value}return!HA&&c&&c.length===1&&typeof c[0]=="string"&&u!=null&&u.splitText!==void 0&&u.nextSibling==null?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u!=null)&&NFt(s,c,n,r,HA||l.dangerouslySetInnerHTML!=null),IFt(s,t.attributes,l),Uf=o,s}function NFt(e,t,n,r,i){var s=e.childNodes,o=[],a={},u=0,l=0,c=s.length,f=0,d=t?t.length:0,h,p,m,g,y;if(c!==0)for(var b=0;b<c;b++){var v=s[b],x=v.__preactattr_,w=d&&x?v._component?v._component.__key:x.key:null;w!=null?(u++,a[w]=v):(x||(v.splitText!==void 0?!i||v.nodeValue.trim():i))&&(o[f++]=v)}if(d!==0)for(var b=0;b<d;b++){g=t[b],y=null;var w=g.key;if(w!=null)u&&a[w]!==void 0&&(y=a[w],a[w]=void 0,u--);else if(!y&&l<f){for(h=l;h<f;h++)if(o[h]!==void 0&&EFt(p=o[h],g,i)){y=p,o[h]=void 0,h===f-1&&f--,h===l&&l++;break}}y=bke(y,g,n,r),m=s[b],y&&y!==e&&y!==m&&(m==null?e.appendChild(y):y===m.nextSibling?eq(m):e.insertBefore(y,m))}if(u)for(var b in a)a[b]!==void 0&&Cm(a[b],!1);for(;l<=f;)(y=o[f--])!==void 0&&Cm(y,!1)}function Cm(e,t){var n=e._component;n?mF(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&eq(e),vke(e))}function vke(e){for(e=e.lastChild;e;){var t=e.previousSibling;Cm(e,!0),e=t}}function IFt(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&Qte(e,r,n[r],n[r]=void 0,Uf);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&Qte(e,r,n[r],n[r]=t[r],Uf)}var g6={};function DFt(e){var t=e.constructor.name;(g6[t]||(g6[t]=[])).push(e)}function xke(e,t,n){var r=g6[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),x2.call(i,t,n)):(i=new x2(t,n),i.constructor=e,i.render=OFt),r){for(var s=r.length;s--;)if(r[s].constructor===e){i.nextBase=r[s].nextBase,r.splice(s,1);break}}return i}function OFt(e,t,n){return this.constructor(e,n)}function GA(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||ao.syncComponentUpdates!==!1||!e.base?pF(e,1,i):dke(e)),e.__ref&&e.__ref(e))}function pF(e,t,n,r){if(!e._disable){var i=e.props,s=e.state,o=e.context,a=e.prevProps||i,u=e.prevState||s,l=e.prevContext||o,c=e.base,f=e.nextBase,d=c||f,h=e._component,p=!1,m,g,y;if(c&&(e.props=a,e.state=u,e.context=l,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,s,o)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,s,o),e.props=i,e.state=s,e.context=o),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){m=e.render(i,s,o),e.getChildContext&&(o=bd(bd({},o),e.getChildContext()));var b=m&&m.nodeName,v,x;if(typeof b=="function"){var w=pke(m);g=h,g&&g.constructor===b&&w.key==g.__key?GA(g,w,1,o,!1):(v=g,e._component=g=xke(b,w,o),g.nextBase=g.nextBase||f,g._parentComponent=e,GA(g,w,0,o,!1),pF(g,1,n,!0)),x=g.base}else y=d,v=h,v&&(y=e._component=null),(d||t===1)&&(y&&(y._component=null),x=yke(y,m,o,n||!c,d&&d.parentNode,!0));if(d&&x!==d&&g!==h){var S=d.parentNode;S&&x!==S&&(S.replaceChild(x,d),v||(d._component=null,Cm(d,!1)))}if(v&&mF(v),e.base=x,x&&!r){for(var C=e,k=e;k=k._parentComponent;)(C=k).base=x;x._component=C,x._componentConstructor=C.constructor}}if(!c||n?mke.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(a,u,l),ao.afterUpdate&&ao.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!m6&&!r&&gke()}}function FFt(e,t,n,r){for(var i=e&&e._component,s=i,o=e,a=i&&e._componentConstructor===t.nodeName,u=a,l=pke(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(GA(i,l,3,n,r),e=i.base):(s&&!a&&(mF(s),e=o=null),i=xke(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,o=null),GA(i,l,1,n,r),e=i.base,o&&e!==o&&(o._component=null,Cm(o,!1))),e}function mF(e){ao.beforeUnmount&&ao.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?mF(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,eq(t),DFt(e),vke(t)),e.__ref&&e.__ref(null)}function x2(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}bd(x2.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=bd({},r)),bd(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),dke(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),pF(this,2)},render:function(){}});function wke(e,t,n){return yke(n,e,{},!1,t,!1)}var RFt={h:v2,createElement:v2,cloneElement:fke,Component:x2,render:wke,rerender:JG,options:ao};const MFt=Object.freeze(Object.defineProperty({__proto__:null,Component:x2,cloneElement:fke,createElement:v2,default:RFt,h:v2,options:ao,render:wke,rerender:JG},Symbol.toStringTag,{value:"Module"})),tq=Em(MFt);var xe={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var ene=Object.getOwnPropertySymbols,PFt=Object.prototype.hasOwnProperty,LFt=Object.prototype.propertyIsEnumerable;function zFt(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function BFt(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(s){return t[s]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(s){i[s]=s}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var nq=BFt()?Object.assign:function(e,t){for(var n,r=zFt(e),i,s=1;s<arguments.length;s++){n=Object(arguments[s]);for(var o in n)PFt.call(n,o)&&(r[o]=n[o]);if(ene){i=ene(n);for(var a=0;a<i.length;a++)LFt.call(n,i[a])&&(r[i[a]]=n[i[a]])}}return r},rq={};Object.defineProperty(rq,"__esModule",{value:!0});rq.StyleSheet=Ske;var UFt=nq,WFt=VFt(UFt);function VFt(e){return e&&e.__esModule?e:{default:e}}function jFt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function KM(e){return e[e.length-1]}function tne(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var op=typeof window<"u",HFt=!1,GFt=function(){if(op){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function nne(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function Ske(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!HFt:t,r=e.maxLength,i=r===void 0?op&&GFt?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,WFt.default)(Ske.prototype,{getSheet:function(){return tne(KM(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");op?this.tags[0]=nne():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch{}},insert:function(t){if(op)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=KM(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else KM(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,op&&this.ctr%this.maxLength===0&&this.tags.push(nne()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){op?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!op)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(jFt(Array.from(tne(n).cssRules))))}),t}});var _b={},qFt=/-(.)/g;function XFt(e){return e.replace(qFt,function(t,n){return n.toUpperCase()})}var KFt=XFt,YFt=KFt,ZFt=/^-ms-/;function QFt(e){return YFt(e.replace(ZFt,"ms-"))}var JFt=QFt,iq={},sq={};Object.defineProperty(sq,"__esModule",{value:!0});var oE={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function eRt(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var tRt=["Webkit","ms","Moz","O"];Object.keys(oE).forEach(function(e){tRt.forEach(function(t){oE[eRt(t,e)]=oE[e]})});var nRt={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},rRt={isUnitlessNumber:oE,shorthandPropertyExpansions:nRt};sq.default=rRt;function gF(e){return function(){return e}}var yg=function(){};yg.thatReturns=gF;yg.thatReturnsFalse=gF(!1);yg.thatReturnsTrue=gF(!0);yg.thatReturnsNull=gF(null);yg.thatReturnsThis=function(){return this};yg.thatReturnsArgument=function(e){return e};var iRt=yg,sRt=iRt,oRt=sRt,Cke=oRt;Object.defineProperty(iq,"__esModule",{value:!0});var aRt=sq,uRt=kke(aRt),lRt=Cke;kke(lRt);function kke(e){return e&&e.__esModule?e:{default:e}}var rne=uRt.default.isUnitlessNumber;function cRt(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||rne.hasOwnProperty(e)&&rne[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}iq.default=cRt;var fRt=/([A-Z])/g;function dRt(e){return e.replace(fRt,"-$1").toLowerCase()}var hRt=dRt,pRt=hRt,mRt=/^ms-/;function gRt(e){return pRt(e).replace(mRt,"-ms-")}var yRt=gRt;function bRt(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var vRt=bRt;Object.defineProperty(_b,"__esModule",{value:!0});_b.processStyleName=void 0;_b.createMarkupForStyles=ARt;var xRt=JFt;wk(xRt);var wRt=iq,SRt=wk(wRt),CRt=yRt,kRt=wk(CRt),$Rt=vRt,_Rt=wk($Rt),ERt=Cke;wk(ERt);function wk(e){return e&&e.__esModule?e:{default:e}}var TRt=_b.processStyleName=(0,_Rt.default)(kRt.default);function ARt(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(e.hasOwnProperty(r)&&r!=="label"){var s=e[r];s!=null&&(i?n+=r+":"+s+";":(n+=TRt(r)+":",n+=(0,SRt.default)(r,s,t)+";"))}}return n||null}var oq={};Object.defineProperty(oq,"__esModule",{value:!0});var $ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};oq.default=aq;function NRt(e){return e==null||e===!1||(typeof e>"u"?"undefined":$ke(e))==="object"&&Object.keys(e).length===0}function IRt(e){if(NRt(e))return null;if((typeof e>"u"?"undefined":$ke(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var s=e[n[i]],o=aq(s);(o===null||o!==s)&&(r=!0),o!==null&&(t[n[i]]=o)}return Object.keys(t).length===0?null:r?t:e}function DRt(e){var t=!1,n=[];return e.forEach(function(r){var i=aq(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function aq(e){return Array.isArray(e)?DRt(e):IRt(e)}var Eb={},uq={},y6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],s=["Webkit","Moz"],o=["Webkit","ms"],a=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:s,userSelect:a,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:a,breakBefore:a,breakInside:a,columnCount:s,columnFill:s,columnGap:s,columnRule:s,columnRuleColor:s,columnRuleStyle:s,columnRuleWidth:s,columns:s,columnSpan:s,columnWidth:s,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:a,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(y6,y6.exports);var ORt=y6.exports,b6={exports:{}},v6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(v6,v6.exports);var _ke=v6.exports;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=_ke,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function s(o,a,u){if(o.hasOwnProperty(a))for(var l=o[a],c=0,f=l.length;c<f;++c)u[l[c]+(0,r.default)(a)]=u[a]}e.exports=t.default})(b6,b6.exports);var FRt=b6.exports,x6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,s,o,a){for(var u=0,l=r.length;u<l;++u){var c=r[u](i,s,o,a);if(c)return c}}e.exports=t.default})(x6,x6.exports);var RRt=x6.exports,w6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(s,o){if(s==="cursor"&&r.hasOwnProperty(o))return n.map(function(a){return a+o})}e.exports=t.default})(w6,w6.exports);var MRt=w6.exports,S6={exports:{}},C6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(C6,C6.exports);var Sk=C6.exports;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Sk,r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}var s=["-webkit-",""];function o(a,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("cross-fade(")>-1)return s.map(function(l){return u.replace(/cross-fade\(/g,l+"cross-fade(")})}e.exports=t.default})(S6,S6.exports);var PRt=S6.exports,k6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Sk,r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}var s=["-webkit-",""];function o(a,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("filter(")>-1)return s.map(function(l){return u.replace(/filter\(/g,l+"filter(")})}e.exports=t.default})(k6,k6.exports);var LRt=k6.exports,$6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,s){if(i==="display"&&n.hasOwnProperty(s))return n[s]}e.exports=t.default})($6,$6.exports);var zRt=$6.exports,_6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(s,o,a){s==="flexDirection"&&typeof o=="string"&&(o.indexOf("column")>-1?a.WebkitBoxOrient="vertical":a.WebkitBoxOrient="horizontal",o.indexOf("reverse")>-1?a.WebkitBoxDirection="reverse":a.WebkitBoxDirection="normal"),r.hasOwnProperty(s)&&(a[r[s]]=n[o]||o)}e.exports=t.default})(_6,_6.exports);var BRt=_6.exports,E6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Sk,r=i(n);function i(u){return u&&u.__esModule?u:{default:u}}var s=["-webkit-","-moz-",""],o=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function a(u,l){if(typeof l=="string"&&!(0,r.default)(l)&&o.test(l))return s.map(function(c){return c+l})}e.exports=t.default})(E6,E6.exports);var URt=E6.exports,T6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Sk,r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}var s=["-webkit-",""];function o(a,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("image-set(")>-1)return s.map(function(l){return u.replace(/image-set\(/g,l+"image-set(")})}e.exports=t.default})(T6,T6.exports);var WRt=T6.exports,A6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(A6,A6.exports);var VRt=A6.exports,N6={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function s(o,a){if(r.hasOwnProperty(o)&&i.hasOwnProperty(a))return n.map(function(u){return u+a})}e.exports=t.default})(N6,N6.exports);var jRt=N6.exports,I6={exports:{}},D6={exports:{}},HRt=/[A-Z]/g,GRt=/^ms-/,YM={};function qRt(e){return"-"+e.toLowerCase()}function XRt(e){if(YM.hasOwnProperty(e))return YM[e];var t=e.replace(HRt,qRt);return YM[e]=GRt.test(t)?"-"+t:t}const KRt=Object.freeze(Object.defineProperty({__proto__:null,default:XRt},Symbol.toStringTag,{value:"Module"})),YRt=Em(KRt);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=YRt,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function s(o){return(0,r.default)(o)}e.exports=t.default})(D6,D6.exports);var ZRt=D6.exports;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=ZRt,r=u(n),i=Sk,s=u(i),o=_ke,a=u(o);function u(h){return h&&h.__esModule?h:{default:h}}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(h,p){if((0,s.default)(h))return h;for(var m=h.split(/,(?![^()]*(?:\([^()]*\))?\))/g),g=0,y=m.length;g<y;++g){var b=m[g],v=[b];for(var x in p){var w=(0,r.default)(x);if(b.indexOf(w)>-1&&w!=="order")for(var S=p[x],C=0,k=S.length;C<k;++C)v.unshift(b.replace(w,c[S[C]]+w))}m[g]=v.join(",")}return m.join(",")}function d(h,p,m,g){if(typeof p=="string"&&l.hasOwnProperty(h)){var y=f(p,g),b=y.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(h.indexOf("Webkit")>-1)return b;var v=y.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return h.indexOf("Moz")>-1?v:(m["Webkit"+(0,a.default)(h)]=b,m["Moz"+(0,a.default)(h)]=v,y)}}e.exports=t.default})(I6,I6.exports);var QRt=I6.exports;Object.defineProperty(uq,"__esModule",{value:!0});uq.default=_Mt;var JRt=ORt,eMt=Yo(JRt),tMt=FRt,nMt=Yo(tMt),rMt=RRt,iMt=Yo(rMt),sMt=MRt,oMt=Yo(sMt),aMt=PRt,uMt=Yo(aMt),lMt=LRt,cMt=Yo(lMt),fMt=zRt,dMt=Yo(fMt),hMt=BRt,pMt=Yo(hMt),mMt=URt,gMt=Yo(mMt),yMt=WRt,bMt=Yo(yMt),vMt=VRt,xMt=Yo(vMt),wMt=jRt,SMt=Yo(wMt),CMt=QRt,kMt=Yo(CMt);function Yo(e){return e&&e.__esModule?e:{default:e}}var $Mt=[uMt.default,oMt.default,cMt.default,pMt.default,gMt.default,bMt.default,xMt.default,SMt.default,kMt.default,dMt.default],ine=eMt.default.prefixMap;function _Mt(e){for(var t in e){var n=e[t],r=(0,iMt.default)($Mt,t,n,e,ine);r&&(e[t]=r),(0,nMt.default)(ine,t,e)}return e}Object.defineProperty(Eb,"__esModule",{value:!0});var O6=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};Eb.PluginSet=Tke;Eb.fallbacks=IMt;Eb.contentWrap=OMt;Eb.prefixes=FMt;var EMt=nq,lq=Eke(EMt),TMt=_b,AMt=uq,NMt=Eke(AMt);function Eke(e){return e&&e.__esModule?e:{default:e}}function Tke(e){this.fns=e||[]}(0,lq.default)(Tke.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(s){t.fns.indexOf(s)>=0||(t.fns=[s].concat(t.fns))})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function IMt(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,s){return i[s]=Array.isArray(n[s])?n[s].join("; "+(0,TMt.processStyleName)(s)+": "):n[s],i},{});return(0,lq.default)({},e,{style:r})}return e}var DMt=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function OMt(e){if(e.style.content){var t=e.style.content;return DMt.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:O6({},e,{style:O6({},e.style,{content:'"'+t+'"'})})}return e}function FMt(e){return(0,lq.default)({},e,{style:(0,NMt.default)(O6({},e.style))})}var cq={};Object.defineProperty(cq,"__esModule",{value:!0});cq.default=RMt;function RMt(e,t){for(var n=1540483477,r=24,i=t^e.length,s=e.length,o=0;s>=4;){var a=MMt(e,o);a=zh(a,n),a^=a>>>r,a=zh(a,n),i=zh(i,n),i^=a,o+=4,s-=4}switch(s){case 3:i^=sne(e,o),i^=e.charCodeAt(o+2)<<16,i=zh(i,n);break;case 2:i^=sne(e,o),i=zh(i,n);break;case 1:i^=e.charCodeAt(o),i=zh(i,n);break}return i^=i>>>13,i=zh(i,n),i^=i>>>15,i>>>0}function MMt(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function sne(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function zh(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(xe,"__esModule",{value:!0});xe.compose=xe.merge=xe.$=xe.style=xe.presets=xe.keyframes=xe.fontFace=xe.insertGlobal=xe.insertRule=xe.plugins=xe.styleSheet=void 0;xe.speedy=VMt;xe.simulations=jMt;xe.simulate=HMt;xe.cssLabels=GMt;xe.isLikeRule=mq;xe.idFor=gq;xe.css=ti;xe.rehydrate=o4t;xe.flush=a4t;xe.select=yq;xe.parent=l4t;xe.media=c4t;xe.pseudo=st;xe.active=f4t;xe.any=d4t;xe.checked=h4t;xe.disabled=p4t;xe.empty=m4t;xe.enabled=g4t;xe._default=y4t;xe.first=b4t;xe.firstChild=v4t;xe.firstOfType=x4t;xe.fullscreen=w4t;xe.focus=S4t;xe.hover=C4t;xe.indeterminate=k4t;xe.inRange=$4t;xe.invalid=_4t;xe.lastChild=E4t;xe.lastOfType=T4t;xe.left=A4t;xe.link=N4t;xe.onlyChild=I4t;xe.onlyOfType=D4t;xe.optional=O4t;xe.outOfRange=F4t;xe.readOnly=R4t;xe.readWrite=M4t;xe.required=P4t;xe.right=L4t;xe.root=z4t;xe.scope=B4t;xe.target=U4t;xe.valid=W4t;xe.visited=V4t;xe.dir=j4t;xe.lang=H4t;xe.not=G4t;xe.nthChild=q4t;xe.nthLastChild=X4t;xe.nthLastOfType=K4t;xe.nthOfType=Y4t;xe.after=Z4t;xe.before=Q4t;xe.firstLetter=J4t;xe.firstLine=e5t;xe.selection=t5t;xe.backdrop=n5t;xe.placeholder=r5t;xe.cssFor=i5t;xe.attribsFor=s5t;var PMt=nq,LMt=dq(PMt),zMt=rq,fq=_b,BMt=oq,wh=dq(BMt),Ac=Eb,UMt=cq,WMt=dq(UMt);function dq(e){return e&&e.__esModule?e:{default:e}}function Ck(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Oo=xe.styleSheet=new zMt.StyleSheet;Oo.inject();function VMt(e){return Oo.speedy(e)}var kk=xe.plugins=Oo.plugins=new Ac.PluginSet([Ac.prefixes,Ac.contentWrap,Ac.fallbacks]);kk.media=new Ac.PluginSet;kk.fontFace=new Ac.PluginSet;kk.keyframes=new Ac.PluginSet([Ac.prefixes,Ac.fallbacks]);var hq=!1,yF=typeof window<"u",pq=hq,one=!1,ane=!1;function jMt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;pq=!!e}function HMt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,wh.default)(t),t?pq?t.reduce(function(r,i){return r["data-simulate-"+qA(i)]="",r},{}):(one||(console.warn("can't simulate without once calling simulations(true)"),one=!0),ane||(console.warn("don't use simulation outside dev"),ane=!0),{}):{}}var $k=hq;function GMt(e){$k=!!e}function qA(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function _k(e){var t=JSON.stringify(e),n=(0,WMt.default)(t).toString(36);return e.label&&e.label.length>0&&hq?qA(e.label.join("."),"-")+"-"+n:n}function mq(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function gq(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var qMt=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function F6(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=qMt.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function une(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=F6(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return pq&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+qA(t)+"],[data-css-"+e+"][data-simulate-"+qA(t)+"]"),n}function R6(e){var t=e.selector,n=e.style,r=kk.transform({selector:t,style:n});return r.selector+"{"+(0,fq.createMarkupForStyles)(r.style)+"}"}function XA(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(s){s.indexOf("&")>=0?(n=n||{},n[s]=e[s]):s.indexOf("@media")===0?(r=r||{},r[s]=XA(e[s])):s.indexOf("@supports")===0?(i=i||{},i[s]=XA(e[s])):s==="label"?e.label.length>0&&(t=t||{},t.label=$k?e.label.join("."):""):(t=t||{},t[s]=e[s])}),{plain:t,selects:n,medias:r,supports:i}}function KA(e,t){var n=[],r=t.plain,i=t.selects,s=t.medias,o=t.supports;return r&&n.push(R6({style:r,selector:une(e)})),i&&Object.keys(i).forEach(function(a){return n.push(R6({style:i[a],selector:une(e,a)}))}),s&&Object.keys(s).forEach(function(a){return n.push(a+"{"+KA(e,s[a]).join("")+"}")}),o&&Object.keys(o).forEach(function(a){return n.push(a+"{"+KA(e,o[a]).join("")+"}")}),n}var Su=Oo.inserted={};function XMt(e){if(!Su[e.id]){Su[e.id]=!0;var t=XA(e.style),n=KA(e.id,t);Su[e.id]=yF?!0:n,n.forEach(function(r){return Oo.insert(r)})}}var w2=Oo.registered={};function bF(e){w2[e.id]||(w2[e.id]=e)}function KMt(e){if(mq(e)){var t=w2[gq(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var aE={};function YMt(e){if(bF(e),XMt(e),aE[e.id])return aE[e.id];var t=Ck({},"data-css-"+e.id,$k&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),aE[e.id]=t,t}function ZMt(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function lne(e,t){var n=F6(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=F6(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,s){return i.concat(n.map(function(o){return s.replace(/\&/g,o)}))},[]).join(",")}function QMt(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function JMt(e){return e.indexOf("@media")===0}function e4t(e){return e.indexOf("@supports")===0}function t4t(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function Ake(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(Ake(e[n])):t=t.concat(e[n]);return t}var cne={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function ap(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,s=i===void 0?"":i,o=t.supp,a=o===void 0?"":o,u=t.src,l=u===void 0?{}:u;Array.isArray(l)||(l=[l]),l=Ake(l),l.forEach(function(c){if(mq(c)){var f=KMt(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,wh.default)(c),c&&c.composes&&ap(e,{selector:r,mq:s,supp:a,src:c.composes}),Object.keys(c||{}).forEach(function(d){if(ZMt(d))cne[d]&&cne[d].forEach(function(p){return ap(e,{selector:lne(r,p),mq:s,supp:a,src:c[d]})}),ap(e,{selector:lne(r,d),mq:s,supp:a,src:c[d]});else if(JMt(d))ap(e,{selector:r,mq:QMt(s,d),supp:a,src:c[d]});else if(e4t(d))ap(e,{selector:r,mq:s,supp:t4t(a,d),src:c[d]});else if(d!=="composes"){var h=e;a&&(h[a]=h[a]||{},h=h[a]),s&&(h[s]=h[s]||{},h=h[s]),r&&(h[r]=h[r]||{},h=h[r]),d==="label"?$k&&(e.label=e.label.concat(c.label)):h[d]=c[d]}})})}function fne(e){var t={label:[]};ap(t,{src:e});var n={id:_k(t),style:t,label:$k?t.label.join("."):"",type:"css"};return YMt(n)}var YA={};Object.defineProperty(YA,"toString",{enumerable:!1,value:function(){return"css-nil"}});var J$=typeof WeakMap<"u"?[YA,new WeakMap,new WeakMap,new WeakMap]:[YA];function n4t(e){return function(t){if(J$[t.length]){for(var n=J$[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(w2[i.toString().substring(4)])return i}}var s=e(t);if(J$[t.length]){for(var o=0,a=J$[t.length];o<t.length-1;)a=a.get(t[o]),o++;try{a.set(t[o],s)}catch{}}return s}}var r4t=typeof WeakMap<"u"?n4t(fne):fne;function ti(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,wh.default)(t),t?r4t(t):YA}ti.insert=function(e){var t={id:_k(e),css:e,type:"raw"};bF(t),Su[t.id]||(Oo.insert(t.css),Su[t.id]=yF?!0:[t.css])};xe.insertRule=ti.insert;ti.global=function(e,t){if(t=(0,wh.default)(t),t)return ti.insert(R6({selector:e,style:t}))};xe.insertGlobal=ti.global;function i4t(e){if(!Su[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=kk.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,fq.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Oo.insert(r)}),Su[e.id]=yF?!0:n}}ti.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,wh.default)(t)||{};var n={id:_k({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return bF(n),i4t(n),e+"_"+n.id};ti.fontFace=function(e){e=(0,wh.default)(e);var t={id:_k(e),type:"font-face",font:e};return bF(t),s4t(t),e.fontFamily};xe.fontFace=ti.fontFace;xe.keyframes=ti.keyframes;function s4t(e){if(!Su[e.id]){var t="@font-face{"+(0,fq.createMarkupForStyles)(e.font)+"}";Oo.insert(t),Su[e.id]=yF?!0:[t]}}function o4t(e){(0,LMt.default)(Su,e.reduce(function(t,n){return t[n]=!0,t},{}))}function a4t(){Su=Oo.inserted={},w2=Oo.registered={},aE={},Oo.flush(),Oo.inject()}xe.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var u4t=xe.style=ti;function yq(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?ti(Ck({},e,n)):u4t(n)}xe.$=yq;function l4t(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ti(Ck({},e+" &",n))}xe.merge=ti;xe.compose=ti;function c4t(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ti(Ck({},"@media "+e,n))}function st(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ti(Ck({},e,n))}function f4t(e){return st(":active",e)}function d4t(e){return st(":any",e)}function h4t(e){return st(":checked",e)}function p4t(e){return st(":disabled",e)}function m4t(e){return st(":empty",e)}function g4t(e){return st(":enabled",e)}function y4t(e){return st(":default",e)}function b4t(e){return st(":first",e)}function v4t(e){return st(":first-child",e)}function x4t(e){return st(":first-of-type",e)}function w4t(e){return st(":fullscreen",e)}function S4t(e){return st(":focus",e)}function C4t(e){return st(":hover",e)}function k4t(e){return st(":indeterminate",e)}function $4t(e){return st(":in-range",e)}function _4t(e){return st(":invalid",e)}function E4t(e){return st(":last-child",e)}function T4t(e){return st(":last-of-type",e)}function A4t(e){return st(":left",e)}function N4t(e){return st(":link",e)}function I4t(e){return st(":only-child",e)}function D4t(e){return st(":only-of-type",e)}function O4t(e){return st(":optional",e)}function F4t(e){return st(":out-of-range",e)}function R4t(e){return st(":read-only",e)}function M4t(e){return st(":read-write",e)}function P4t(e){return st(":required",e)}function L4t(e){return st(":right",e)}function z4t(e){return st(":root",e)}function B4t(e){return st(":scope",e)}function U4t(e){return st(":target",e)}function W4t(e){return st(":valid",e)}function V4t(e){return st(":visited",e)}function j4t(e,t){return st(":dir("+e+")",t)}function H4t(e,t){return st(":lang("+e+")",t)}function G4t(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?st(":not("+e+")",t):yq(n.join(""),t)}function q4t(e,t){return st(":nth-child("+e+")",t)}function X4t(e,t){return st(":nth-last-child("+e+")",t)}function K4t(e,t){return st(":nth-last-of-type("+e+")",t)}function Y4t(e,t){return st(":nth-of-type("+e+")",t)}function Z4t(e){return st("::after",e)}function Q4t(e){return st("::before",e)}function J4t(e){return st("::first-letter",e)}function e5t(e){return st("::first-line",e)}function t5t(e){return st("::selection",e)}function n5t(e){return st("::backdrop",e)}function r5t(e){return ti({"::placeholder":e})}function i5t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,wh.default)(t),t?t.map(function(r){var i={label:[]};return ap(i,{src:r}),KA(_k(i),XA(i)).join("")}).join(""):""}function s5t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,wh.default)(t);var r=t?t.map(function(i){gq(i);var s=Object.keys(i)[0],o=i[s];return s+'="'+(o||"")+'"'}).join(" "):"";return r}var $f={},bg={};bg.hasClass=function(e){return/^\.\S+/.test(e)};bg.isClassSelector=function(e){return/^\.[^.# ]+$/.test(e)};var Nke=/^\.?(.*)-([nsml]{1,2})$/;bg.getAtRuleSize=function(e){return e.replace(Nke,"$2")};bg.stripAtRuleSize=function(e){return e.replace(Nke,"$1")};bg.getPseudos=function(e){return e.replace(/^[^:]*(.*)$/,"$1")};function o5t(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var Ike=o5t;function a5t(){this.__data__=[],this.size=0}var u5t=a5t;function l5t(e,t){return e===t||e!==e&&t!==t}var Ek=l5t,c5t=Ek;function f5t(e,t){for(var n=e.length;n--;)if(c5t(e[n][0],t))return n;return-1}var vF=f5t,d5t=vF,h5t=Array.prototype,p5t=h5t.splice;function m5t(e){var t=this.__data__,n=d5t(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():p5t.call(t,n,1),--this.size,!0}var g5t=m5t,y5t=vF;function b5t(e){var t=this.__data__,n=y5t(t,e);return n<0?void 0:t[n][1]}var v5t=b5t,x5t=vF;function w5t(e){return x5t(this.__data__,e)>-1}var S5t=w5t,C5t=vF;function k5t(e,t){var n=this.__data__,r=C5t(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var $5t=k5t,_5t=u5t,E5t=g5t,T5t=v5t,A5t=S5t,N5t=$5t;function Tb(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Tb.prototype.clear=_5t;Tb.prototype.delete=E5t;Tb.prototype.get=T5t;Tb.prototype.has=A5t;Tb.prototype.set=N5t;var xF=Tb,I5t=xF;function D5t(){this.__data__=new I5t,this.size=0}var O5t=D5t;function F5t(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var R5t=F5t;function M5t(e){return this.__data__.get(e)}var P5t=M5t;function L5t(e){return this.__data__.has(e)}var z5t=L5t,B5t=typeof rt=="object"&&rt&&rt.Object===Object&&rt,Dke=B5t,U5t=Dke,W5t=typeof self=="object"&&self&&self.Object===Object&&self,V5t=U5t||W5t||Function("return this")(),tc=V5t,j5t=tc,H5t=j5t.Symbol,Tk=H5t,dne=Tk,Oke=Object.prototype,G5t=Oke.hasOwnProperty,q5t=Oke.toString,_v=dne?dne.toStringTag:void 0;function X5t(e){var t=G5t.call(e,_v),n=e[_v];try{e[_v]=void 0;var r=!0}catch{}var i=q5t.call(e);return r&&(t?e[_v]=n:delete e[_v]),i}var K5t=X5t,Y5t=Object.prototype,Z5t=Y5t.toString;function Q5t(e){return Z5t.call(e)}var J5t=Q5t,hne=Tk,ePt=K5t,tPt=J5t,nPt="[object Null]",rPt="[object Undefined]",pne=hne?hne.toStringTag:void 0;function iPt(e){return e==null?e===void 0?rPt:nPt:pne&&pne in Object(e)?ePt(e):tPt(e)}var Ab=iPt;function sPt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var _f=sPt,oPt=Ab,aPt=_f,uPt="[object AsyncFunction]",lPt="[object Function]",cPt="[object GeneratorFunction]",fPt="[object Proxy]";function dPt(e){if(!aPt(e))return!1;var t=oPt(e);return t==lPt||t==cPt||t==uPt||t==fPt}var wF=dPt,hPt=tc,pPt=hPt["__core-js_shared__"],mPt=pPt,ZM=mPt,mne=function(){var e=/[^.]+$/.exec(ZM&&ZM.keys&&ZM.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function gPt(e){return!!mne&&mne in e}var yPt=gPt,bPt=Function.prototype,vPt=bPt.toString;function xPt(e){if(e!=null){try{return vPt.call(e)}catch{}try{return e+""}catch{}}return""}var Fke=xPt,wPt=wF,SPt=yPt,CPt=_f,kPt=Fke,$Pt=/[\\^$.*+?()[\]{}|]/g,_Pt=/^\[object .+?Constructor\]$/,EPt=Function.prototype,TPt=Object.prototype,APt=EPt.toString,NPt=TPt.hasOwnProperty,IPt=RegExp("^"+APt.call(NPt).replace($Pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function DPt(e){if(!CPt(e)||SPt(e))return!1;var t=wPt(e)?IPt:_Pt;return t.test(kPt(e))}var OPt=DPt;function FPt(e,t){return e==null?void 0:e[t]}var RPt=FPt,MPt=OPt,PPt=RPt;function LPt(e,t){var n=PPt(e,t);return MPt(n)?n:void 0}var vg=LPt,zPt=vg,BPt=tc,UPt=zPt(BPt,"Map"),bq=UPt,WPt=vg,VPt=WPt(Object,"create"),SF=VPt,gne=SF;function jPt(){this.__data__=gne?gne(null):{},this.size=0}var HPt=jPt;function GPt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var qPt=GPt,XPt=SF,KPt="__lodash_hash_undefined__",YPt=Object.prototype,ZPt=YPt.hasOwnProperty;function QPt(e){var t=this.__data__;if(XPt){var n=t[e];return n===KPt?void 0:n}return ZPt.call(t,e)?t[e]:void 0}var JPt=QPt,eLt=SF,tLt=Object.prototype,nLt=tLt.hasOwnProperty;function rLt(e){var t=this.__data__;return eLt?t[e]!==void 0:nLt.call(t,e)}var iLt=rLt,sLt=SF,oLt="__lodash_hash_undefined__";function aLt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=sLt&&t===void 0?oLt:t,this}var uLt=aLt,lLt=HPt,cLt=qPt,fLt=JPt,dLt=iLt,hLt=uLt;function Nb(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Nb.prototype.clear=lLt;Nb.prototype.delete=cLt;Nb.prototype.get=fLt;Nb.prototype.has=dLt;Nb.prototype.set=hLt;var pLt=Nb,yne=pLt,mLt=xF,gLt=bq;function yLt(){this.size=0,this.__data__={hash:new yne,map:new(gLt||mLt),string:new yne}}var bLt=yLt;function vLt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var xLt=vLt,wLt=xLt;function SLt(e,t){var n=e.__data__;return wLt(t)?n[typeof t=="string"?"string":"hash"]:n.map}var CF=SLt,CLt=CF;function kLt(e){var t=CLt(this,e).delete(e);return this.size-=t?1:0,t}var $Lt=kLt,_Lt=CF;function ELt(e){return _Lt(this,e).get(e)}var TLt=ELt,ALt=CF;function NLt(e){return ALt(this,e).has(e)}var ILt=NLt,DLt=CF;function OLt(e,t){var n=DLt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var FLt=OLt,RLt=bLt,MLt=$Lt,PLt=TLt,LLt=ILt,zLt=FLt;function Ib(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ib.prototype.clear=RLt;Ib.prototype.delete=MLt;Ib.prototype.get=PLt;Ib.prototype.has=LLt;Ib.prototype.set=zLt;var vq=Ib,BLt=xF,ULt=bq,WLt=vq,VLt=200;function jLt(e,t){var n=this.__data__;if(n instanceof BLt){var r=n.__data__;if(!ULt||r.length<VLt-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new WLt(r)}return n.set(e,t),this.size=n.size,this}var HLt=jLt,GLt=xF,qLt=O5t,XLt=R5t,KLt=P5t,YLt=z5t,ZLt=HLt;function Db(e){var t=this.__data__=new GLt(e);this.size=t.size}Db.prototype.clear=qLt;Db.prototype.delete=XLt;Db.prototype.get=KLt;Db.prototype.has=YLt;Db.prototype.set=ZLt;var xq=Db,QLt="__lodash_hash_undefined__";function JLt(e){return this.__data__.set(e,QLt),this}var e6t=JLt;function t6t(e){return this.__data__.has(e)}var n6t=t6t,r6t=vq,i6t=e6t,s6t=n6t;function ZA(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new r6t;++t<n;)this.add(e[t])}ZA.prototype.add=ZA.prototype.push=i6t;ZA.prototype.has=s6t;var o6t=ZA;function a6t(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var u6t=a6t;function l6t(e,t){return e.has(t)}var c6t=l6t,f6t=o6t,d6t=u6t,h6t=c6t,p6t=1,m6t=2;function g6t(e,t,n,r,i,s){var o=n&p6t,a=e.length,u=t.length;if(a!=u&&!(o&&u>a))return!1;var l=s.get(e),c=s.get(t);if(l&&c)return l==t&&c==e;var f=-1,d=!0,h=n&m6t?new f6t:void 0;for(s.set(e,t),s.set(t,e);++f<a;){var p=e[f],m=t[f];if(r)var g=o?r(m,p,f,t,e,s):r(p,m,f,e,t,s);if(g!==void 0){if(g)continue;d=!1;break}if(h){if(!d6t(t,function(y,b){if(!h6t(h,b)&&(p===y||i(p,y,n,r,s)))return h.push(b)})){d=!1;break}}else if(!(p===m||i(p,m,n,r,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var Rke=g6t,y6t=tc,b6t=y6t.Uint8Array,Mke=b6t;function v6t(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n}var x6t=v6t;function w6t(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var S6t=w6t,bne=Tk,vne=Mke,C6t=Ek,k6t=Rke,$6t=x6t,_6t=S6t,E6t=1,T6t=2,A6t="[object Boolean]",N6t="[object Date]",I6t="[object Error]",D6t="[object Map]",O6t="[object Number]",F6t="[object RegExp]",R6t="[object Set]",M6t="[object String]",P6t="[object Symbol]",L6t="[object ArrayBuffer]",z6t="[object DataView]",xne=bne?bne.prototype:void 0,QM=xne?xne.valueOf:void 0;function B6t(e,t,n,r,i,s,o){switch(n){case z6t:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case L6t:return!(e.byteLength!=t.byteLength||!s(new vne(e),new vne(t)));case A6t:case N6t:case O6t:return C6t(+e,+t);case I6t:return e.name==t.name&&e.message==t.message;case F6t:case M6t:return e==t+"";case D6t:var a=$6t;case R6t:var u=r&E6t;if(a||(a=_6t),e.size!=t.size&&!u)return!1;var l=o.get(e);if(l)return l==t;r|=T6t,o.set(e,t);var c=k6t(a(e),a(t),r,i,s,o);return o.delete(e),c;case P6t:if(QM)return QM.call(e)==QM.call(t)}return!1}var U6t=B6t;function W6t(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Pke=W6t,V6t=Array.isArray,Va=V6t,j6t=Pke,H6t=Va;function G6t(e,t,n){var r=t(e);return H6t(e)?r:j6t(r,n(e))}var q6t=G6t;function X6t(e,t){for(var n=-1,r=e==null?0:e.length,i=0,s=[];++n<r;){var o=e[n];t(o,n,e)&&(s[i++]=o)}return s}var K6t=X6t;function Y6t(){return[]}var Z6t=Y6t,Q6t=K6t,J6t=Z6t,ezt=Object.prototype,tzt=ezt.propertyIsEnumerable,wne=Object.getOwnPropertySymbols,nzt=wne?function(e){return e==null?[]:(e=Object(e),Q6t(wne(e),function(t){return tzt.call(e,t)}))}:J6t,rzt=nzt;function izt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var szt=izt;function ozt(e){return e!=null&&typeof e=="object"}var xg=ozt,azt=Ab,uzt=xg,lzt="[object Arguments]";function czt(e){return uzt(e)&&azt(e)==lzt}var fzt=czt,Sne=fzt,dzt=xg,Lke=Object.prototype,hzt=Lke.hasOwnProperty,pzt=Lke.propertyIsEnumerable,mzt=Sne(function(){return arguments}())?Sne:function(e){return dzt(e)&&hzt.call(e,"callee")&&!pzt.call(e,"callee")},kF=mzt,QA={exports:{}};function gzt(){return!1}var yzt=gzt;QA.exports;(function(e,t){var n=tc,r=yzt,i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===i,a=o?n.Buffer:void 0,u=a?a.isBuffer:void 0,l=u||r;e.exports=l})(QA,QA.exports);var wq=QA.exports,bzt=9007199254740991,vzt=/^(?:0|[1-9]\d*)$/;function xzt(e,t){var n=typeof e;return t=t??bzt,!!t&&(n=="number"||n!="symbol"&&vzt.test(e))&&e>-1&&e%1==0&&e<t}var Sq=xzt,wzt=9007199254740991;function Szt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=wzt}var Cq=Szt,Czt=Ab,kzt=Cq,$zt=xg,_zt="[object Arguments]",Ezt="[object Array]",Tzt="[object Boolean]",Azt="[object Date]",Nzt="[object Error]",Izt="[object Function]",Dzt="[object Map]",Ozt="[object Number]",Fzt="[object Object]",Rzt="[object RegExp]",Mzt="[object Set]",Pzt="[object String]",Lzt="[object WeakMap]",zzt="[object ArrayBuffer]",Bzt="[object DataView]",Uzt="[object Float32Array]",Wzt="[object Float64Array]",Vzt="[object Int8Array]",jzt="[object Int16Array]",Hzt="[object Int32Array]",Gzt="[object Uint8Array]",qzt="[object Uint8ClampedArray]",Xzt="[object Uint16Array]",Kzt="[object Uint32Array]",_n={};_n[Uzt]=_n[Wzt]=_n[Vzt]=_n[jzt]=_n[Hzt]=_n[Gzt]=_n[qzt]=_n[Xzt]=_n[Kzt]=!0;_n[_zt]=_n[Ezt]=_n[zzt]=_n[Tzt]=_n[Bzt]=_n[Azt]=_n[Nzt]=_n[Izt]=_n[Dzt]=_n[Ozt]=_n[Fzt]=_n[Rzt]=_n[Mzt]=_n[Pzt]=_n[Lzt]=!1;function Yzt(e){return $zt(e)&&kzt(e.length)&&!!_n[Czt(e)]}var Zzt=Yzt;function Qzt(e){return function(t){return e(t)}}var Jzt=Qzt,JA={exports:{}};JA.exports;(function(e,t){var n=Dke,r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,o=s&&n.process,a=function(){try{var u=i&&i.require&&i.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}}();e.exports=a})(JA,JA.exports);var eBt=JA.exports,tBt=Zzt,nBt=Jzt,Cne=eBt,kne=Cne&&Cne.isTypedArray,rBt=kne?nBt(kne):tBt,kq=rBt,iBt=szt,sBt=kF,oBt=Va,aBt=wq,uBt=Sq,lBt=kq,cBt=Object.prototype,fBt=cBt.hasOwnProperty;function dBt(e,t){var n=oBt(e),r=!n&&sBt(e),i=!n&&!r&&aBt(e),s=!n&&!r&&!i&&lBt(e),o=n||r||i||s,a=o?iBt(e.length,String):[],u=a.length;for(var l in e)(t||fBt.call(e,l))&&!(o&&(l=="length"||i&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||uBt(l,u)))&&a.push(l);return a}var zke=dBt,hBt=Object.prototype;function pBt(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||hBt;return e===n}var $q=pBt;function mBt(e,t){return function(n){return e(t(n))}}var Bke=mBt,gBt=Bke,yBt=gBt(Object.keys,Object),bBt=yBt,vBt=$q,xBt=bBt,wBt=Object.prototype,SBt=wBt.hasOwnProperty;function CBt(e){if(!vBt(e))return xBt(e);var t=[];for(var n in Object(e))SBt.call(e,n)&&n!="constructor"&&t.push(n);return t}var kBt=CBt,$Bt=wF,_Bt=Cq;function EBt(e){return e!=null&&_Bt(e.length)&&!$Bt(e)}var Ob=EBt,TBt=zke,ABt=kBt,NBt=Ob;function IBt(e){return NBt(e)?TBt(e):ABt(e)}var _q=IBt,DBt=q6t,OBt=rzt,FBt=_q;function RBt(e){return DBt(e,FBt,OBt)}var MBt=RBt,$ne=MBt,PBt=1,LBt=Object.prototype,zBt=LBt.hasOwnProperty;function BBt(e,t,n,r,i,s){var o=n&PBt,a=$ne(e),u=a.length,l=$ne(t),c=l.length;if(u!=c&&!o)return!1;for(var f=u;f--;){var d=a[f];if(!(o?d in t:zBt.call(t,d)))return!1}var h=s.get(e),p=s.get(t);if(h&&p)return h==t&&p==e;var m=!0;s.set(e,t),s.set(t,e);for(var g=o;++f<u;){d=a[f];var y=e[d],b=t[d];if(r)var v=o?r(b,y,d,t,e,s):r(y,b,d,e,t,s);if(!(v===void 0?y===b||i(y,b,n,r,s):v)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var x=e.constructor,w=t.constructor;x!=w&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof w=="function"&&w instanceof w)&&(m=!1)}return s.delete(e),s.delete(t),m}var UBt=BBt,WBt=vg,VBt=tc,jBt=WBt(VBt,"DataView"),HBt=jBt,GBt=vg,qBt=tc,XBt=GBt(qBt,"Promise"),KBt=XBt,YBt=vg,ZBt=tc,QBt=YBt(ZBt,"Set"),JBt=QBt,e8t=vg,t8t=tc,n8t=e8t(t8t,"WeakMap"),r8t=n8t,M6=HBt,P6=bq,L6=KBt,z6=JBt,B6=r8t,Uke=Ab,Fb=Fke,_ne="[object Map]",i8t="[object Object]",Ene="[object Promise]",Tne="[object Set]",Ane="[object WeakMap]",Nne="[object DataView]",s8t=Fb(M6),o8t=Fb(P6),a8t=Fb(L6),u8t=Fb(z6),l8t=Fb(B6),Yh=Uke;(M6&&Yh(new M6(new ArrayBuffer(1)))!=Nne||P6&&Yh(new P6)!=_ne||L6&&Yh(L6.resolve())!=Ene||z6&&Yh(new z6)!=Tne||B6&&Yh(new B6)!=Ane)&&(Yh=function(e){var t=Uke(e),n=t==i8t?e.constructor:void 0,r=n?Fb(n):"";if(r)switch(r){case s8t:return Nne;case o8t:return _ne;case a8t:return Ene;case u8t:return Tne;case l8t:return Ane}return t});var c8t=Yh,JM=xq,f8t=Rke,d8t=U6t,h8t=UBt,Ine=c8t,Dne=Va,One=wq,p8t=kq,m8t=1,Fne="[object Arguments]",Rne="[object Array]",e_="[object Object]",g8t=Object.prototype,Mne=g8t.hasOwnProperty;function y8t(e,t,n,r,i,s){var o=Dne(e),a=Dne(t),u=o?Rne:Ine(e),l=a?Rne:Ine(t);u=u==Fne?e_:u,l=l==Fne?e_:l;var c=u==e_,f=l==e_,d=u==l;if(d&&One(e)){if(!One(t))return!1;o=!0,c=!1}if(d&&!c)return s||(s=new JM),o||p8t(e)?f8t(e,t,n,r,i,s):d8t(e,t,u,n,r,i,s);if(!(n&m8t)){var h=c&&Mne.call(e,"__wrapped__"),p=f&&Mne.call(t,"__wrapped__");if(h||p){var m=h?e.value():e,g=p?t.value():t;return s||(s=new JM),i(m,g,n,r,s)}}return d?(s||(s=new JM),h8t(e,t,n,r,i,s)):!1}var b8t=y8t,v8t=b8t,Pne=xg;function Wke(e,t,n,r,i){return e===t?!0:e==null||t==null||!Pne(e)&&!Pne(t)?e!==e&&t!==t:v8t(e,t,n,r,Wke,i)}var Vke=Wke,x8t=xq,w8t=Vke,S8t=1,C8t=2;function k8t(e,t,n,r){var i=n.length,s=i,o=!r;if(e==null)return!s;for(e=Object(e);i--;){var a=n[i];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<s;){a=n[i];var u=a[0],l=e[u],c=a[1];if(o&&a[2]){if(l===void 0&&!(u in e))return!1}else{var f=new x8t;if(r)var d=r(l,c,u,e,t,f);if(!(d===void 0?w8t(c,l,S8t|C8t,r,f):d))return!1}}return!0}var $8t=k8t,_8t=_f;function E8t(e){return e===e&&!_8t(e)}var jke=E8t,T8t=jke,A8t=_q;function N8t(e){for(var t=A8t(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,T8t(i)]}return t}var I8t=N8t;function D8t(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var Hke=D8t,O8t=$8t,F8t=I8t,R8t=Hke;function M8t(e){var t=F8t(e);return t.length==1&&t[0][2]?R8t(t[0][0],t[0][1]):function(n){return n===e||O8t(n,e,t)}}var P8t=M8t,L8t=Ab,z8t=xg,B8t="[object Symbol]";function U8t(e){return typeof e=="symbol"||z8t(e)&&L8t(e)==B8t}var Eq=U8t,W8t=Va,V8t=Eq,j8t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,H8t=/^\w*$/;function G8t(e,t){if(W8t(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||V8t(e)?!0:H8t.test(e)||!j8t.test(e)||t!=null&&e in Object(t)}var Tq=G8t,Gke=vq,q8t="Expected a function";function Aq(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(q8t);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(Aq.Cache||Gke),n}Aq.Cache=Gke;var X8t=Aq,K8t=X8t,Y8t=500;function Z8t(e){var t=K8t(e,function(r){return n.size===Y8t&&n.clear(),r}),n=t.cache;return t}var Q8t=Z8t,J8t=Q8t,e7t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t7t=/\\(\\)?/g,n7t=J8t(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(e7t,function(n,r,i,s){t.push(i?s.replace(t7t,"$1"):r||n)}),t}),r7t=n7t,Lne=Tk,i7t=Ike,s7t=Va,o7t=Eq,a7t=1/0,zne=Lne?Lne.prototype:void 0,Bne=zne?zne.toString:void 0;function qke(e){if(typeof e=="string")return e;if(s7t(e))return i7t(e,qke)+"";if(o7t(e))return Bne?Bne.call(e):"";var t=e+"";return t=="0"&&1/e==-a7t?"-0":t}var u7t=qke,l7t=u7t;function c7t(e){return e==null?"":l7t(e)}var Nq=c7t,f7t=Va,d7t=Tq,h7t=r7t,p7t=Nq;function m7t(e,t){return f7t(e)?e:d7t(e,t)?[e]:h7t(p7t(e))}var Xke=m7t,g7t=Eq,y7t=1/0;function b7t(e){if(typeof e=="string"||g7t(e))return e;var t=e+"";return t=="0"&&1/e==-y7t?"-0":t}var $F=b7t,v7t=Xke,x7t=$F;function w7t(e,t){t=v7t(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[x7t(t[n++])];return n&&n==r?e:void 0}var Kke=w7t,S7t=Kke;function C7t(e,t,n){var r=e==null?void 0:S7t(e,t);return r===void 0?n:r}var k7t=C7t;function $7t(e,t){return e!=null&&t in Object(e)}var _7t=$7t,E7t=Xke,T7t=kF,A7t=Va,N7t=Sq,I7t=Cq,D7t=$F;function O7t(e,t,n){t=E7t(t,e);for(var r=-1,i=t.length,s=!1;++r<i;){var o=D7t(t[r]);if(!(s=e!=null&&n(e,o)))break;e=e[o]}return s||++r!=i?s:(i=e==null?0:e.length,!!i&&I7t(i)&&N7t(o,i)&&(A7t(e)||T7t(e)))}var F7t=O7t,R7t=_7t,M7t=F7t;function P7t(e,t){return e!=null&&M7t(e,t,R7t)}var L7t=P7t,z7t=Vke,B7t=k7t,U7t=L7t,W7t=Tq,V7t=jke,j7t=Hke,H7t=$F,G7t=1,q7t=2;function X7t(e,t){return W7t(e)&&V7t(t)?j7t(H7t(e),t):function(n){var r=B7t(n,e);return r===void 0&&r===t?U7t(n,e):z7t(t,r,G7t|q7t)}}var K7t=X7t;function Y7t(e){return e}var Iq=Y7t;function Z7t(e){return function(t){return t==null?void 0:t[e]}}var Q7t=Z7t,J7t=Kke;function e9t(e){return function(t){return J7t(t,e)}}var t9t=e9t,n9t=Q7t,r9t=t9t,i9t=Tq,s9t=$F;function o9t(e){return i9t(e)?n9t(s9t(e)):r9t(e)}var a9t=o9t,u9t=P8t,l9t=K7t,c9t=Iq,f9t=Va,d9t=a9t;function h9t(e){return typeof e=="function"?e:e==null?c9t:typeof e=="object"?f9t(e)?l9t(e[0],e[1]):u9t(e):d9t(e)}var Yke=h9t;function p9t(e){return function(t,n,r){for(var i=-1,s=Object(t),o=r(t),a=o.length;a--;){var u=o[e?a:++i];if(n(s[u],u,s)===!1)break}return t}}var m9t=p9t,g9t=m9t,y9t=g9t(),Zke=y9t,b9t=Zke,v9t=_q;function x9t(e,t){return e&&b9t(e,t,v9t)}var w9t=x9t,S9t=Ob;function C9t(e,t){return function(n,r){if(n==null)return n;if(!S9t(n))return e(n,r);for(var i=n.length,s=t?i:-1,o=Object(n);(t?s--:++s<i)&&r(o[s],s,o)!==!1;);return n}}var k9t=C9t,$9t=w9t,_9t=k9t,E9t=_9t($9t),Qke=E9t,T9t=Qke,A9t=Ob;function N9t(e,t){var n=-1,r=A9t(e)?Array(e.length):[];return T9t(e,function(i,s,o){r[++n]=t(i,s,o)}),r}var I9t=N9t,D9t=Ike,O9t=Yke,F9t=I9t,R9t=Va;function M9t(e,t){var n=R9t(e)?D9t:F9t;return n(e,O9t(t))}var Jke=M9t,P9t=vg,L9t=function(){try{var e=P9t(Object,"defineProperty");return e({},"",{}),e}catch{}}(),e$e=L9t,Une=e$e;function z9t(e,t,n){t=="__proto__"&&Une?Une(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var Dq=z9t,B9t=Dq,U9t=Ek;function W9t(e,t,n){(n!==void 0&&!U9t(e[t],n)||n===void 0&&!(t in e))&&B9t(e,t,n)}var t$e=W9t,eN={exports:{}};eN.exports;(function(e,t){var n=tc,r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===r,o=s?n.Buffer:void 0,a=o?o.allocUnsafe:void 0;function u(l,c){if(c)return l.slice();var f=l.length,d=a?a(f):new l.constructor(f);return l.copy(d),d}e.exports=u})(eN,eN.exports);var V9t=eN.exports,Wne=Mke;function j9t(e){var t=new e.constructor(e.byteLength);return new Wne(t).set(new Wne(e)),t}var H9t=j9t,G9t=H9t;function q9t(e,t){var n=t?G9t(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var X9t=q9t;function K9t(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Y9t=K9t,Z9t=_f,Vne=Object.create,Q9t=function(){function e(){}return function(t){if(!Z9t(t))return{};if(Vne)return Vne(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),J9t=Q9t,eUt=Bke,tUt=eUt(Object.getPrototypeOf,Object),n$e=tUt,nUt=J9t,rUt=n$e,iUt=$q;function sUt(e){return typeof e.constructor=="function"&&!iUt(e)?nUt(rUt(e)):{}}var oUt=sUt,aUt=Ob,uUt=xg;function lUt(e){return uUt(e)&&aUt(e)}var cUt=lUt,fUt=Ab,dUt=n$e,hUt=xg,pUt="[object Object]",mUt=Function.prototype,gUt=Object.prototype,r$e=mUt.toString,yUt=gUt.hasOwnProperty,bUt=r$e.call(Object);function vUt(e){if(!hUt(e)||fUt(e)!=pUt)return!1;var t=dUt(e);if(t===null)return!0;var n=yUt.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&r$e.call(n)==bUt}var xUt=vUt;function wUt(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var i$e=wUt,SUt=Dq,CUt=Ek,kUt=Object.prototype,$Ut=kUt.hasOwnProperty;function _Ut(e,t,n){var r=e[t];(!($Ut.call(e,t)&&CUt(r,n))||n===void 0&&!(t in e))&&SUt(e,t,n)}var EUt=_Ut,TUt=EUt,AUt=Dq;function NUt(e,t,n,r){var i=!n;n||(n={});for(var s=-1,o=t.length;++s<o;){var a=t[s],u=r?r(n[a],e[a],a,n,e):void 0;u===void 0&&(u=e[a]),i?AUt(n,a,u):TUt(n,a,u)}return n}var IUt=NUt;function DUt(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var OUt=DUt,FUt=_f,RUt=$q,MUt=OUt,PUt=Object.prototype,LUt=PUt.hasOwnProperty;function zUt(e){if(!FUt(e))return MUt(e);var t=RUt(e),n=[];for(var r in e)r=="constructor"&&(t||!LUt.call(e,r))||n.push(r);return n}var BUt=zUt,UUt=zke,WUt=BUt,VUt=Ob;function jUt(e){return VUt(e)?UUt(e,!0):WUt(e)}var s$e=jUt,HUt=IUt,GUt=s$e;function qUt(e){return HUt(e,GUt(e))}var XUt=qUt,jne=t$e,KUt=V9t,YUt=X9t,ZUt=Y9t,QUt=oUt,Hne=kF,Gne=Va,JUt=cUt,eWt=wq,tWt=wF,nWt=_f,rWt=xUt,iWt=kq,qne=i$e,sWt=XUt;function oWt(e,t,n,r,i,s,o){var a=qne(e,n),u=qne(t,n),l=o.get(u);if(l){jne(e,n,l);return}var c=s?s(a,u,n+"",e,t,o):void 0,f=c===void 0;if(f){var d=Gne(u),h=!d&&eWt(u),p=!d&&!h&&iWt(u);c=u,d||h||p?Gne(a)?c=a:JUt(a)?c=ZUt(a):h?(f=!1,c=KUt(u,!0)):p?(f=!1,c=YUt(u,!0)):c=[]:rWt(u)||Hne(u)?(c=a,Hne(a)?c=sWt(a):(!nWt(a)||tWt(a))&&(c=QUt(u))):f=!1}f&&(o.set(u,c),i(c,u,r,s,o),o.delete(u)),jne(e,n,c)}var aWt=oWt,uWt=xq,lWt=t$e,cWt=Zke,fWt=aWt,dWt=_f,hWt=s$e,pWt=i$e;function o$e(e,t,n,r,i){e!==t&&cWt(t,function(s,o){if(i||(i=new uWt),dWt(s))fWt(e,t,o,n,o$e,r,i);else{var a=r?r(pWt(e,o),s,o+"",e,t,i):void 0;a===void 0&&(a=s),lWt(e,o,a)}},hWt)}var mWt=o$e;function gWt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var yWt=gWt,bWt=yWt,Xne=Math.max;function vWt(e,t,n){return t=Xne(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,s=Xne(r.length-t,0),o=Array(s);++i<s;)o[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(o),bWt(e,this,a)}}var xWt=vWt;function wWt(e){return function(){return e}}var SWt=wWt,CWt=SWt,Kne=e$e,kWt=Iq,$Wt=Kne?function(e,t){return Kne(e,"toString",{configurable:!0,enumerable:!1,value:CWt(t),writable:!0})}:kWt,_Wt=$Wt,EWt=800,TWt=16,AWt=Date.now;function NWt(e){var t=0,n=0;return function(){var r=AWt(),i=TWt-(r-n);if(n=r,i>0){if(++t>=EWt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var IWt=NWt,DWt=_Wt,OWt=IWt,FWt=OWt(DWt),RWt=FWt,MWt=Iq,PWt=xWt,LWt=RWt;function zWt(e,t){return LWt(PWt(e,t,MWt),e+"")}var BWt=zWt,UWt=Ek,WWt=Ob,VWt=Sq,jWt=_f;function HWt(e,t,n){if(!jWt(n))return!1;var r=typeof t;return(r=="number"?WWt(n)&&VWt(t,n.length):r=="string"&&t in n)?UWt(n[t],e):!1}var GWt=HWt,qWt=BWt,XWt=GWt;function KWt(e){return qWt(function(t,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(s=e.length>3&&typeof s=="function"?(i--,s):void 0,o&&XWt(n[0],n[1],o)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,s)}return t})}var YWt=KWt,ZWt=mWt,QWt=YWt,JWt=QWt(function(e,t,n){ZWt(e,t,n)}),eVt=JWt,a$e={"border-box":{boxSizing:"border-box"},"aspect-ratio":{height:"0",position:"relative"},"aspect-ratio--16x9":{paddingBottom:"56.25%"},"aspect-ratio--9x16":{paddingBottom:"177.77%"},"aspect-ratio--4x3":{paddingBottom:"75%"},"aspect-ratio--3x4":{paddingBottom:"133.33%"},"aspect-ratio--6x4":{paddingBottom:"66.6%"},"aspect-ratio--4x6":{paddingBottom:"150%"},"aspect-ratio--8x5":{paddingBottom:"62.5%"},"aspect-ratio--5x8":{paddingBottom:"160%"},"aspect-ratio--7x5":{paddingBottom:"71.42%"},"aspect-ratio--5x7":{paddingBottom:"140%"},"aspect-ratio--1x1":{paddingBottom:"100%"},"aspect-ratio--object":{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",width:"100%",height:"100%",zIndex:"100"},cover:{backgroundSize:"cover"},contain:{backgroundSize:"contain"},"bg-center":{backgroundRepeat:"no-repeat",backgroundPosition:"center center"},"bg-top":{backgroundRepeat:"no-repeat",backgroundPosition:"top center"},"bg-right":{backgroundRepeat:"no-repeat",backgroundPosition:"center right"},"bg-bottom":{backgroundRepeat:"no-repeat",backgroundPosition:"bottom center"},"bg-left":{backgroundRepeat:"no-repeat",backgroundPosition:"center left"},outline:{outline:"1px solid"},"outline-transparent":{outline:"1px solid transparent"},"outline-0":{outline:"0"},ba:{borderStyle:"solid",borderWidth:"1px"},bt:{borderTopStyle:"solid",borderTopWidth:"1px"},br:{borderRightStyle:"solid",borderRightWidth:"1px"},bb:{borderBottomStyle:"solid",borderBottomWidth:"1px"},bl:{borderLeftStyle:"solid",borderLeftWidth:"1px"},bn:{borderStyle:"none",borderWidth:"0"},"b--black":{borderColor:"#000"},"b--near-black":{borderColor:"#111"},"b--dark-gray":{borderColor:"#333"},"b--mid-gray":{borderColor:"#555"},"b--gray":{borderColor:"#777"},"b--silver":{borderColor:"#999"},"b--light-silver":{borderColor:"#aaa"},"b--moon-gray":{borderColor:"#ccc"},"b--light-gray":{borderColor:"#eee"},"b--near-white":{borderColor:"#f4f4f4"},"b--white":{borderColor:"#fff"},"b--white-90":{borderColor:"rgba( 255, 255, 255, .9 )"},"b--white-80":{borderColor:"rgba( 255, 255, 255, .8 )"},"b--white-70":{borderColor:"rgba( 255, 255, 255, .7 )"},"b--white-60":{borderColor:"rgba( 255, 255, 255, .6 )"},"b--white-50":{borderColor:"rgba( 255, 255, 255, .5 )"},"b--white-40":{borderColor:"rgba( 255, 255, 255, .4 )"},"b--white-30":{borderColor:"rgba( 255, 255, 255, .3 )"},"b--white-20":{borderColor:"rgba( 255, 255, 255, .2 )"},"b--white-10":{borderColor:"rgba( 255, 255, 255, .1 )"},"b--white-05":{borderColor:"rgba( 255, 255, 255, .05 )"},"b--white-025":{borderColor:"rgba( 255, 255, 255, .025 )"},"b--white-0125":{borderColor:"rgba( 255, 255, 255, .0125 )"},"b--black-90":{borderColor:"rgba( 0, 0, 0, .9 )"},"b--black-80":{borderColor:"rgba( 0, 0, 0, .8 )"},"b--black-70":{borderColor:"rgba( 0, 0, 0, .7 )"},"b--black-60":{borderColor:"rgba( 0, 0, 0, .6 )"},"b--black-50":{borderColor:"rgba( 0, 0, 0, .5 )"},"b--black-40":{borderColor:"rgba( 0, 0, 0, .4 )"},"b--black-30":{borderColor:"rgba( 0, 0, 0, .3 )"},"b--black-20":{borderColor:"rgba( 0, 0, 0, .2 )"},"b--black-10":{borderColor:"rgba( 0, 0, 0, .1 )"},"b--black-05":{borderColor:"rgba( 0, 0, 0, .05 )"},"b--black-025":{borderColor:"rgba( 0, 0, 0, .025 )"},"b--black-0125":{borderColor:"rgba( 0, 0, 0, .0125 )"},"b--dark-red":{borderColor:"#e7040f"},"b--red":{borderColor:"#ff4136"},"b--light-red":{borderColor:"#ff725c"},"b--orange":{borderColor:"#ff6300"},"b--gold":{borderColor:"#ffb700"},"b--yellow":{borderColor:"#ffd700"},"b--light-yellow":{borderColor:"#fbf1a9"},"b--purple":{borderColor:"#5e2ca5"},"b--light-purple":{borderColor:"#a463f2"},"b--dark-pink":{borderColor:"#d5008f"},"b--hot-pink":{borderColor:"#ff41b4"},"b--pink":{borderColor:"#ff80cc"},"b--light-pink":{borderColor:"#ffa3d7"},"b--dark-green":{borderColor:"#137752"},"b--green":{borderColor:"#19a974"},"b--light-green":{borderColor:"#9eebcf"},"b--navy":{borderColor:"#001b44"},"b--dark-blue":{borderColor:"#00449e"},"b--blue":{borderColor:"#357edd"},"b--light-blue":{borderColor:"#96ccff"},"b--lightest-blue":{borderColor:"#cdecff"},"b--washed-blue":{borderColor:"#f6fffe"},"b--washed-green":{borderColor:"#e8fdf5"},"b--washed-yellow":{borderColor:"#fffceb"},"b--washed-red":{borderColor:"#ffdfdf"},"b--transparent":{borderColor:"transparent"},"b--inherit":{borderColor:"inherit"},br0:{borderRadius:"0"},br1:{borderRadius:".125rem"},br2:{borderRadius:".25rem"},br3:{borderRadius:".5rem"},br4:{borderRadius:"1rem"},"br-100":{borderRadius:"100%"},"br-pill":{borderRadius:"9999px"},"br--bottom":{borderTopLeftRadius:"0",borderTopRightRadius:"0"},"br--top":{borderBottomLeftRadius:"0",borderBottomRightRadius:"0"},"br--right":{borderTopLeftRadius:"0",borderBottomLeftRadius:"0"},"br--left":{borderTopRightRadius:"0",borderBottomRightRadius:"0"},"b--dotted":{borderStyle:"dotted"},"b--dashed":{borderStyle:"dashed"},"b--solid":{borderStyle:"solid"},"b--none":{borderStyle:"none"},bw0:{borderWidth:"0"},bw1:{borderWidth:".125rem"},bw2:{borderWidth:".25rem"},bw3:{borderWidth:".5rem"},bw4:{borderWidth:"1rem"},bw5:{borderWidth:"2rem"},"bt-0":{borderTopWidth:"0"},"br-0":{borderRightWidth:"0"},"bb-0":{borderBottomWidth:"0"},"bl-0":{borderLeftWidth:"0"},"shadow-1":{boxShadow:"0 0 4px 2px rgba( 0, 0, 0, .2 )"},"shadow-2":{boxShadow:"0 0 8px 2px rgba( 0, 0, 0, .2 )"},"shadow-3":{boxShadow:"2px 2px 4px 2px rgba( 0, 0, 0, .2 )"},"shadow-4":{boxShadow:"2px 2px 8px 0 rgba( 0, 0, 0, .2 )"},"shadow-5":{boxShadow:"4px 4px 8px 0 rgba( 0, 0, 0, .2 )"},pre:{whiteSpace:"pre",overflowX:"auto",overflowY:"hidden",overflow:"scroll"},"top-0":{top:"0"},"right-0":{right:"0"},"bottom-0":{bottom:"0"},"left-0":{left:"0"},"top-1":{top:"1rem"},"right-1":{right:"1rem"},"bottom-1":{bottom:"1rem"},"left-1":{left:"1rem"},"top-2":{top:"2rem"},"right-2":{right:"2rem"},"bottom-2":{bottom:"2rem"},"left-2":{left:"2rem"},"top--1":{top:"-1rem"},"right--1":{right:"-1rem"},"bottom--1":{bottom:"-1rem"},"left--1":{left:"-1rem"},"top--2":{top:"-2rem"},"right--2":{right:"-2rem"},"bottom--2":{bottom:"-2rem"},"left--2":{left:"-2rem"},"absolute--fill":{top:"0",right:"0",bottom:"0",left:"0"},cf:{zoom:"1",":after":{content:'" "',display:"table"},":before":{content:'" "',display:"table"}},cl:{clear:"left"},cr:{clear:"right"},cb:{clear:"both"},cn:{clear:"none"},dn:{display:"none"},di:{display:"inline"},db:{display:"block"},dib:{display:"inline-block"},dit:{display:"inline-table"},dt:{display:"table"},dtc:{display:"table-cell"},"dt-row":{display:"table-row"},"dt-row-group":{display:"table-row-group"},"dt-column":{display:"table-column"},"dt-column-group":{display:"table-column-group"},"dt--fixed":{tableLayout:"fixed",width:"100%"},flex:{display:"flex"},"inline-flex":{display:"inline-flex"},"flex-auto":{webkitBoxFlex:"1",msFlex:"1 1 auto",flex:"1 1 auto",minWidth:"0",minHeight:"0"},"flex-none":{webkitBoxFlex:"0",msFlex:"none",flex:"none"},"flex-column":{webkitBoxOrient:"vertical",webkitBoxDirection:"normal",msFlexDirection:"column",flexDirection:"column"},"flex-row":{webkitBoxOrient:"horizontal",webkitBoxDirection:"normal",msFlexDirection:"row",flexDirection:"row"},"flex-wrap":{msFlexWrap:"wrap",flexWrap:"wrap"},"flex-nowrap":{msFlexWrap:"nowrap",flexWrap:"nowrap"},"flex-wrap-reverse":{msFlexWrap:"wrap-reverse",flexWrap:"wrap-reverse"},"flex-column-reverse":{webkitBoxOrient:"vertical",webkitBoxDirection:"reverse",msFlexDirection:"column-reverse",flexDirection:"column-reverse"},"flex-row-reverse":{webkitBoxOrient:"horizontal",webkitBoxDirection:"reverse",msFlexDirection:"row-reverse",flexDirection:"row-reverse"},"items-start":{webkitBoxAlign:"start",msFlexAlign:"start",alignItems:"flex-start"},"items-end":{webkitBoxAlign:"end",msFlexAlign:"end",alignItems:"flex-end"},"items-center":{webkitBoxAlign:"center",msFlexAlign:"center",alignItems:"center"},"items-baseline":{webkitBoxAlign:"baseline",msFlexAlign:"baseline",alignItems:"baseline"},"items-stretch":{webkitBoxAlign:"stretch",msFlexAlign:"stretch",alignItems:"stretch"},"self-start":{msFlexItemAlign:"start",alignSelf:"flex-start"},"self-end":{msFlexItemAlign:"end",alignSelf:"flex-end"},"self-center":{msFlexItemAlign:"center",msGridRowAlign:"center",alignSelf:"center"},"self-baseline":{msFlexItemAlign:"baseline",alignSelf:"baseline"},"self-stretch":{msFlexItemAlign:"stretch",msGridRowAlign:"stretch",alignSelf:"stretch"},"justify-start":{webkitBoxPack:"start",msFlexPack:"start",justifyContent:"flex-start"},"justify-end":{webkitBoxPack:"end",msFlexPack:"end",justifyContent:"flex-end"},"justify-center":{webkitBoxPack:"center",msFlexPack:"center",justifyContent:"center"},"justify-between":{webkitBoxPack:"justify",msFlexPack:"justify",justifyContent:"space-between"},"justify-around":{msFlexPack:"distribute",justifyContent:"space-around"},"content-start":{msFlexLinePack:"start",alignContent:"flex-start"},"content-end":{msFlexLinePack:"end",alignContent:"flex-end"},"content-center":{msFlexLinePack:"center",alignContent:"center"},"content-between":{msFlexLinePack:"justify",alignContent:"space-between"},"content-around":{msFlexLinePack:"distribute",alignContent:"space-around"},"content-stretch":{msFlexLinePack:"stretch",alignContent:"stretch"},"order-0":{webkitBoxOrdinalGroup:"1",msFlexOrder:"0",order:"0"},"order-1":{webkitBoxOrdinalGroup:"2",msFlexOrder:"1",order:"1"},"order-2":{webkitBoxOrdinalGroup:"3",msFlexOrder:"2",order:"2"},"order-3":{webkitBoxOrdinalGroup:"4",msFlexOrder:"3",order:"3"},"order-4":{webkitBoxOrdinalGroup:"5",msFlexOrder:"4",order:"4"},"order-5":{webkitBoxOrdinalGroup:"6",msFlexOrder:"5",order:"5"},"order-6":{webkitBoxOrdinalGroup:"7",msFlexOrder:"6",order:"6"},"order-7":{webkitBoxOrdinalGroup:"8",msFlexOrder:"7",order:"7"},"order-8":{webkitBoxOrdinalGroup:"9",msFlexOrder:"8",order:"8"},"order-last":{webkitBoxOrdinalGroup:"100000",msFlexOrder:"99999",order:"99999"},fl:{float:"left",display:"inline"},fr:{float:"right",display:"inline"},fn:{float:"none"},"sans-serif":{fontFamily:"-apple-system, BlinkMacSystemFont, 'avenir next', avenir, 'helvetica neue', helvetica, ubuntu, roboto, noto, 'segoe ui', arial, sans-serif"},serif:{fontFamily:"georgia, times, serif"},"system-sans-serif":{fontFamily:"sans-serif"},"system-serif":{fontFamily:"serif"},code:{fontFamily:"Consolas, monaco, monospace"},courier:{fontFamily:"'Courier Next', courier, monospace"},helvetica:{fontFamily:"'helvetica neue', helvetica, sans-serif"},avenir:{fontFamily:"'avenir next', avenir, sans-serif"},athelas:{fontFamily:"athelas, georgia, serif"},georgia:{fontFamily:"georgia, serif"},times:{fontFamily:"times, serif"},bodoni:{fontFamily:'"Bodoni MT", serif'},calisto:{fontFamily:'"Calisto MT", serif'},garamond:{fontFamily:"garamond, serif"},baskerville:{fontFamily:"baskerville, serif"},i:{fontStyle:"italic"},"fs-normal":{fontStyle:"normal"},normal:{fontWeight:"normal"},b:{fontWeight:"bold"},fw1:{fontWeight:"100"},fw2:{fontWeight:"200"},fw3:{fontWeight:"300"},fw4:{fontWeight:"400"},fw5:{fontWeight:"500"},fw6:{fontWeight:"600"},fw7:{fontWeight:"700"},fw8:{fontWeight:"800"},fw9:{fontWeight:"900"},"input-reset":{"::-moz-focus-inner":{border:"0",padding:"0"},webkitAppearance:"none",mozAppearance:"none"},"button-reset":{"::-moz-focus-inner":{border:"0",padding:"0"}},h1:{height:"1rem"},h2:{height:"2rem"},h3:{height:"4rem"},h4:{height:"8rem"},h5:{height:"16rem"},"h-25":{height:"25%"},"h-50":{height:"50%"},"h-75":{height:"75%"},"h-100":{height:"100%"},"min-h-100":{minHeight:"100%"},"vh-25":{height:"25vh"},"vh-50":{height:"50vh"},"vh-75":{height:"75vh"},"vh-100":{height:"100vh"},"min-vh-100":{minHeight:"100vh"},"h-auto":{height:"auto"},"h-inherit":{height:"inherit"},tracked:{letterSpacing:".1em"},"tracked-tight":{letterSpacing:"-.05em"},"tracked-mega":{letterSpacing:".25em"},"lh-solid":{lineHeight:"1"},"lh-title":{lineHeight:"1.25"},"lh-copy":{lineHeight:"1.5"},link:{":focus":{transition:"color .15s ease-in",outline:"1px dotted currentColor"},":active":{transition:"color .15s ease-in"},":hover":{transition:"color .15s ease-in"},":visited":{transition:"color .15s ease-in"},":link":{transition:"color .15s ease-in"},textDecoration:"none",transition:"color .15s ease-in"},list:{listStyleType:"none"},"mw-100":{maxWidth:"100%"},mw1:{maxWidth:"1rem"},mw2:{maxWidth:"2rem"},mw3:{maxWidth:"4rem"},mw4:{maxWidth:"8rem"},mw5:{maxWidth:"16rem"},mw6:{maxWidth:"32rem"},mw7:{maxWidth:"48rem"},mw8:{maxWidth:"64rem"},mw9:{maxWidth:"96rem"},"mw-none":{maxWidth:"none"},w1:{width:"1rem"},w2:{width:"2rem"},w3:{width:"4rem"},w4:{width:"8rem"},w5:{width:"16rem"},"w-10":{width:"10%"},"w-20":{width:"20%"},"w-25":{width:"25%"},"w-30":{width:"30%"},"w-33":{width:"33%"},"w-34":{width:"34%"},"w-40":{width:"40%"},"w-50":{width:"50%"},"w-60":{width:"60%"},"w-70":{width:"70%"},"w-75":{width:"75%"},"w-80":{width:"80%"},"w-90":{width:"90%"},"w-100":{width:"100%"},"w-third":{width:"calc( 100% / 3 )"},"w-two-thirds":{width:"calc( 100% / 1.5 )"},"w-auto":{width:"auto"},"overflow-visible":{overflow:"visible"},"overflow-hidden":{overflow:"hidden"},"overflow-scroll":{overflow:"scroll"},"overflow-auto":{overflow:"auto"},"overflow-x-visible":{overflowX:"visible"},"overflow-x-hidden":{overflowX:"hidden"},"overflow-x-scroll":{overflowX:"scroll"},"overflow-x-auto":{overflowX:"auto"},"overflow-y-visible":{overflowY:"visible"},"overflow-y-hidden":{overflowY:"hidden"},"overflow-y-scroll":{overflowY:"scroll"},"overflow-y-auto":{overflowY:"auto"},static:{position:"static"},relative:{position:"relative"},absolute:{position:"absolute"},fixed:{position:"fixed"},"o-100":{opacity:"1"},"o-90":{opacity:".9"},"o-80":{opacity:".8"},"o-70":{opacity:".7"},"o-60":{opacity:".6"},"o-50":{opacity:".5"},"o-40":{opacity:".4"},"o-30":{opacity:".3"},"o-20":{opacity:".2"},"o-10":{opacity:".1"},"o-05":{opacity:".05"},"o-025":{opacity:".025"},"o-0":{opacity:"0"},"rotate-45":{webkitTransform:"rotate( 45deg )",transform:"rotate( 45deg )"},"rotate-90":{webkitTransform:"rotate( 90deg )",transform:"rotate( 90deg )"},"rotate-135":{webkitTransform:"rotate( 135deg )",transform:"rotate( 135deg )"},"rotate-180":{webkitTransform:"rotate( 180deg )",transform:"rotate( 180deg )"},"rotate-225":{webkitTransform:"rotate( 225deg )",transform:"rotate( 225deg )"},"rotate-270":{webkitTransform:"rotate( 270deg )",transform:"rotate( 270deg )"},"rotate-315":{webkitTransform:"rotate( 315deg )",transform:"rotate( 315deg )"},"black-90":{color:"rgba( 0, 0, 0, .9 )"},"black-80":{color:"rgba( 0, 0, 0, .8 )"},"black-70":{color:"rgba( 0, 0, 0, .7 )"},"black-60":{color:"rgba( 0, 0, 0, .6 )"},"black-50":{color:"rgba( 0, 0, 0, .5 )"},"black-40":{color:"rgba( 0, 0, 0, .4 )"},"black-30":{color:"rgba( 0, 0, 0, .3 )"},"black-20":{color:"rgba( 0, 0, 0, .2 )"},"black-10":{color:"rgba( 0, 0, 0, .1 )"},"black-05":{color:"rgba( 0, 0, 0, .05 )"},"white-90":{color:"rgba( 255, 255, 255, .9 )"},"white-80":{color:"rgba( 255, 255, 255, .8 )"},"white-70":{color:"rgba( 255, 255, 255, .7 )"},"white-60":{color:"rgba( 255, 255, 255, .6 )"},"white-50":{color:"rgba( 255, 255, 255, .5 )"},"white-40":{color:"rgba( 255, 255, 255, .4 )"},"white-30":{color:"rgba( 255, 255, 255, .3 )"},"white-20":{color:"rgba( 255, 255, 255, .2 )"},"white-10":{color:"rgba( 255, 255, 255, .1 )"},black:{color:"#000"},"near-black":{color:"#111"},"dark-gray":{color:"#333"},"mid-gray":{color:"#555"},gray:{color:"#777"},silver:{color:"#999"},"light-silver":{color:"#aaa"},"moon-gray":{color:"#ccc"},"light-gray":{color:"#eee"},"near-white":{color:"#f4f4f4"},white:{color:"#fff"},"dark-red":{color:"#e7040f"},red:{color:"#ff4136"},"light-red":{color:"#ff725c"},orange:{color:"#ff6300"},gold:{color:"#ffb700"},yellow:{color:"#ffd700"},"light-yellow":{color:"#fbf1a9"},purple:{color:"#5e2ca5"},"light-purple":{color:"#a463f2"},"dark-pink":{color:"#d5008f"},"hot-pink":{color:"#ff41b4"},pink:{color:"#ff80cc"},"light-pink":{color:"#ffa3d7"},"dark-green":{color:"#137752"},green:{color:"#19a974"},"light-green":{color:"#9eebcf"},navy:{color:"#001b44"},"dark-blue":{color:"#00449e"},blue:{color:"#357edd"},"light-blue":{color:"#96ccff"},"lightest-blue":{color:"#cdecff"},"washed-blue":{color:"#f6fffe"},"washed-green":{color:"#e8fdf5"},"washed-yellow":{color:"#fffceb"},"washed-red":{color:"#ffdfdf"},"color-inherit":{color:"inherit"},"bg-black-90":{backgroundColor:"rgba( 0, 0, 0, .9 )"},"bg-black-80":{backgroundColor:"rgba( 0, 0, 0, .8 )"},"bg-black-70":{backgroundColor:"rgba( 0, 0, 0, .7 )"},"bg-black-60":{backgroundColor:"rgba( 0, 0, 0, .6 )"},"bg-black-50":{backgroundColor:"rgba( 0, 0, 0, .5 )"},"bg-black-40":{backgroundColor:"rgba( 0, 0, 0, .4 )"},"bg-black-30":{backgroundColor:"rgba( 0, 0, 0, .3 )"},"bg-black-20":{backgroundColor:"rgba( 0, 0, 0, .2 )"},"bg-black-10":{backgroundColor:"rgba( 0, 0, 0, .1 )"},"bg-black-05":{backgroundColor:"rgba( 0, 0, 0, .05 )"},"bg-white-90":{backgroundColor:"rgba( 255, 255, 255, .9 )"},"bg-white-80":{backgroundColor:"rgba( 255, 255, 255, .8 )"},"bg-white-70":{backgroundColor:"rgba( 255, 255, 255, .7 )"},"bg-white-60":{backgroundColor:"rgba( 255, 255, 255, .6 )"},"bg-white-50":{backgroundColor:"rgba( 255, 255, 255, .5 )"},"bg-white-40":{backgroundColor:"rgba( 255, 255, 255, .4 )"},"bg-white-30":{backgroundColor:"rgba( 255, 255, 255, .3 )"},"bg-white-20":{backgroundColor:"rgba( 255, 255, 255, .2 )"},"bg-white-10":{backgroundColor:"rgba( 255, 255, 255, .1 )"},"bg-black":{backgroundColor:"#000"},"bg-near-black":{backgroundColor:"#111"},"bg-dark-gray":{backgroundColor:"#333"},"bg-mid-gray":{backgroundColor:"#555"},"bg-gray":{backgroundColor:"#777"},"bg-silver":{backgroundColor:"#999"},"bg-light-silver":{backgroundColor:"#aaa"},"bg-moon-gray":{backgroundColor:"#ccc"},"bg-light-gray":{backgroundColor:"#eee"},"bg-near-white":{backgroundColor:"#f4f4f4"},"bg-white":{backgroundColor:"#fff"},"bg-transparent":{backgroundColor:"transparent"},"bg-dark-red":{backgroundColor:"#e7040f"},"bg-red":{backgroundColor:"#ff4136"},"bg-light-red":{backgroundColor:"#ff725c"},"bg-orange":{backgroundColor:"#ff6300"},"bg-gold":{backgroundColor:"#ffb700"},"bg-yellow":{backgroundColor:"#ffd700"},"bg-light-yellow":{backgroundColor:"#fbf1a9"},"bg-purple":{backgroundColor:"#5e2ca5"},"bg-light-purple":{backgroundColor:"#a463f2"},"bg-dark-pink":{backgroundColor:"#d5008f"},"bg-hot-pink":{backgroundColor:"#ff41b4"},"bg-pink":{backgroundColor:"#ff80cc"},"bg-light-pink":{backgroundColor:"#ffa3d7"},"bg-dark-green":{backgroundColor:"#137752"},"bg-green":{backgroundColor:"#19a974"},"bg-light-green":{backgroundColor:"#9eebcf"},"bg-navy":{backgroundColor:"#001b44"},"bg-dark-blue":{backgroundColor:"#00449e"},"bg-blue":{backgroundColor:"#357edd"},"bg-light-blue":{backgroundColor:"#96ccff"},"bg-lightest-blue":{backgroundColor:"#cdecff"},"bg-washed-blue":{backgroundColor:"#f6fffe"},"bg-washed-green":{backgroundColor:"#e8fdf5"},"bg-washed-yellow":{backgroundColor:"#fffceb"},"bg-washed-red":{backgroundColor:"#ffdfdf"},"bg-inherit":{backgroundColor:"inherit"},"hover-black":{":focus":{color:"#000"},":hover":{color:"#000"}},"hover-near-black":{":focus":{color:"#111"},":hover":{color:"#111"}},"hover-dark-gray":{":focus":{color:"#333"},":hover":{color:"#333"}},"hover-mid-gray":{":focus":{color:"#555"},":hover":{color:"#555"}},"hover-gray":{":focus":{color:"#777"},":hover":{color:"#777"}},"hover-silver":{":focus":{color:"#999"},":hover":{color:"#999"}},"hover-light-silver":{":focus":{color:"#aaa"},":hover":{color:"#aaa"}},"hover-moon-gray":{":focus":{color:"#ccc"},":hover":{color:"#ccc"}},"hover-light-gray":{":focus":{color:"#eee"},":hover":{color:"#eee"}},"hover-near-white":{":focus":{color:"#f4f4f4"},":hover":{color:"#f4f4f4"}},"hover-white":{":focus":{color:"#fff"},":hover":{color:"#fff"}},"hover-black-90":{":focus":{color:"rgba( 0, 0, 0, .9 )"},":hover":{color:"rgba( 0, 0, 0, .9 )"}},"hover-black-80":{":focus":{color:"rgba( 0, 0, 0, .8 )"},":hover":{color:"rgba( 0, 0, 0, .8 )"}},"hover-black-70":{":focus":{color:"rgba( 0, 0, 0, .7 )"},":hover":{color:"rgba( 0, 0, 0, .7 )"}},"hover-black-60":{":focus":{color:"rgba( 0, 0, 0, .6 )"},":hover":{color:"rgba( 0, 0, 0, .6 )"}},"hover-black-50":{":focus":{color:"rgba( 0, 0, 0, .5 )"},":hover":{color:"rgba( 0, 0, 0, .5 )"}},"hover-black-40":{":focus":{color:"rgba( 0, 0, 0, .4 )"},":hover":{color:"rgba( 0, 0, 0, .4 )"}},"hover-black-30":{":focus":{color:"rgba( 0, 0, 0, .3 )"},":hover":{color:"rgba( 0, 0, 0, .3 )"}},"hover-black-20":{":focus":{color:"rgba( 0, 0, 0, .2 )"},":hover":{color:"rgba( 0, 0, 0, .2 )"}},"hover-black-10":{":focus":{color:"rgba( 0, 0, 0, .1 )"},":hover":{color:"rgba( 0, 0, 0, .1 )"}},"hover-white-90":{":focus":{color:"rgba( 255, 255, 255, .9 )"},":hover":{color:"rgba( 255, 255, 255, .9 )"}},"hover-white-80":{":focus":{color:"rgba( 255, 255, 255, .8 )"},":hover":{color:"rgba( 255, 255, 255, .8 )"}},"hover-white-70":{":focus":{color:"rgba( 255, 255, 255, .7 )"},":hover":{color:"rgba( 255, 255, 255, .7 )"}},"hover-white-60":{":focus":{color:"rgba( 255, 255, 255, .6 )"},":hover":{color:"rgba( 255, 255, 255, .6 )"}},"hover-white-50":{":focus":{color:"rgba( 255, 255, 255, .5 )"},":hover":{color:"rgba( 255, 255, 255, .5 )"}},"hover-white-40":{":focus":{color:"rgba( 255, 255, 255, .4 )"},":hover":{color:"rgba( 255, 255, 255, .4 )"}},"hover-white-30":{":focus":{color:"rgba( 255, 255, 255, .3 )"},":hover":{color:"rgba( 255, 255, 255, .3 )"}},"hover-white-20":{":focus":{color:"rgba( 255, 255, 255, .2 )"},":hover":{color:"rgba( 255, 255, 255, .2 )"}},"hover-white-10":{":focus":{color:"rgba( 255, 255, 255, .1 )"},":hover":{color:"rgba( 255, 255, 255, .1 )"}},"hover-inherit":{":focus":{color:"inherit"},":hover":{color:"inherit"}},"hover-bg-black":{":focus":{backgroundColor:"#000"},":hover":{backgroundColor:"#000"}},"hover-bg-near-black":{":focus":{backgroundColor:"#111"},":hover":{backgroundColor:"#111"}},"hover-bg-dark-gray":{":focus":{backgroundColor:"#333"},":hover":{backgroundColor:"#333"}},"hover-bg-mid-gray":{":focus":{backgroundColor:"#555"},":hover":{backgroundColor:"#555"}},"hover-bg-gray":{":focus":{backgroundColor:"#777"},":hover":{backgroundColor:"#777"}},"hover-bg-silver":{":focus":{backgroundColor:"#999"},":hover":{backgroundColor:"#999"}},"hover-bg-light-silver":{":focus":{backgroundColor:"#aaa"},":hover":{backgroundColor:"#aaa"}},"hover-bg-moon-gray":{":focus":{backgroundColor:"#ccc"},":hover":{backgroundColor:"#ccc"}},"hover-bg-light-gray":{":focus":{backgroundColor:"#eee"},":hover":{backgroundColor:"#eee"}},"hover-bg-near-white":{":focus":{backgroundColor:"#f4f4f4"},":hover":{backgroundColor:"#f4f4f4"}},"hover-bg-white":{":focus":{backgroundColor:"#fff"},":hover":{backgroundColor:"#fff"}},"hover-bg-transparent":{":focus":{backgroundColor:"transparent"},":hover":{backgroundColor:"transparent"}},"hover-bg-black-90":{":focus":{backgroundColor:"rgba( 0, 0, 0, .9 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .9 )"}},"hover-bg-black-80":{":focus":{backgroundColor:"rgba( 0, 0, 0, .8 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .8 )"}},"hover-bg-black-70":{":focus":{backgroundColor:"rgba( 0, 0, 0, .7 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .7 )"}},"hover-bg-black-60":{":focus":{backgroundColor:"rgba( 0, 0, 0, .6 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .6 )"}},"hover-bg-black-50":{":focus":{backgroundColor:"rgba( 0, 0, 0, .5 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .5 )"}},"hover-bg-black-40":{":focus":{backgroundColor:"rgba( 0, 0, 0, .4 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .4 )"}},"hover-bg-black-30":{":focus":{backgroundColor:"rgba( 0, 0, 0, .3 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .3 )"}},"hover-bg-black-20":{":focus":{backgroundColor:"rgba( 0, 0, 0, .2 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .2 )"}},"hover-bg-black-10":{":focus":{backgroundColor:"rgba( 0, 0, 0, .1 )"},":hover":{backgroundColor:"rgba( 0, 0, 0, .1 )"}},"hover-bg-white-90":{":focus":{backgroundColor:"rgba( 255, 255, 255, .9 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .9 )"}},"hover-bg-white-80":{":focus":{backgroundColor:"rgba( 255, 255, 255, .8 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .8 )"}},"hover-bg-white-70":{":focus":{backgroundColor:"rgba( 255, 255, 255, .7 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .7 )"}},"hover-bg-white-60":{":focus":{backgroundColor:"rgba( 255, 255, 255, .6 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .6 )"}},"hover-bg-white-50":{":focus":{backgroundColor:"rgba( 255, 255, 255, .5 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .5 )"}},"hover-bg-white-40":{":focus":{backgroundColor:"rgba( 255, 255, 255, .4 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .4 )"}},"hover-bg-white-30":{":focus":{backgroundColor:"rgba( 255, 255, 255, .3 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .3 )"}},"hover-bg-white-20":{":focus":{backgroundColor:"rgba( 255, 255, 255, .2 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .2 )"}},"hover-bg-white-10":{":focus":{backgroundColor:"rgba( 255, 255, 255, .1 )"},":hover":{backgroundColor:"rgba( 255, 255, 255, .1 )"}},"hover-dark-red":{":focus":{color:"#e7040f"},":hover":{color:"#e7040f"}},"hover-red":{":focus":{color:"#ff4136"},":hover":{color:"#ff4136"}},"hover-light-red":{":focus":{color:"#ff725c"},":hover":{color:"#ff725c"}},"hover-orange":{":focus":{color:"#ff6300"},":hover":{color:"#ff6300"}},"hover-gold":{":focus":{color:"#ffb700"},":hover":{color:"#ffb700"}},"hover-yellow":{":focus":{color:"#ffd700"},":hover":{color:"#ffd700"}},"hover-light-yellow":{":focus":{color:"#fbf1a9"},":hover":{color:"#fbf1a9"}},"hover-purple":{":focus":{color:"#5e2ca5"},":hover":{color:"#5e2ca5"}},"hover-light-purple":{":focus":{color:"#a463f2"},":hover":{color:"#a463f2"}},"hover-dark-pink":{":focus":{color:"#d5008f"},":hover":{color:"#d5008f"}},"hover-hot-pink":{":focus":{color:"#ff41b4"},":hover":{color:"#ff41b4"}},"hover-pink":{":focus":{color:"#ff80cc"},":hover":{color:"#ff80cc"}},"hover-light-pink":{":focus":{color:"#ffa3d7"},":hover":{color:"#ffa3d7"}},"hover-dark-green":{":focus":{color:"#137752"},":hover":{color:"#137752"}},"hover-green":{":focus":{color:"#19a974"},":hover":{color:"#19a974"}},"hover-light-green":{":focus":{color:"#9eebcf"},":hover":{color:"#9eebcf"}},"hover-navy":{":focus":{color:"#001b44"},":hover":{color:"#001b44"}},"hover-dark-blue":{":focus":{color:"#00449e"},":hover":{color:"#00449e"}},"hover-blue":{":focus":{color:"#357edd"},":hover":{color:"#357edd"}},"hover-light-blue":{":focus":{color:"#96ccff"},":hover":{color:"#96ccff"}},"hover-lightest-blue":{":focus":{color:"#cdecff"},":hover":{color:"#cdecff"}},"hover-washed-blue":{":focus":{color:"#f6fffe"},":hover":{color:"#f6fffe"}},"hover-washed-green":{":focus":{color:"#e8fdf5"},":hover":{color:"#e8fdf5"}},"hover-washed-yellow":{":focus":{color:"#fffceb"},":hover":{color:"#fffceb"}},"hover-washed-red":{":focus":{color:"#ffdfdf"},":hover":{color:"#ffdfdf"}},"hover-bg-dark-red":{":focus":{backgroundColor:"#e7040f"},":hover":{backgroundColor:"#e7040f"}},"hover-bg-red":{":focus":{backgroundColor:"#ff4136"},":hover":{backgroundColor:"#ff4136"}},"hover-bg-light-red":{":focus":{backgroundColor:"#ff725c"},":hover":{backgroundColor:"#ff725c"}},"hover-bg-orange":{":focus":{backgroundColor:"#ff6300"},":hover":{backgroundColor:"#ff6300"}},"hover-bg-gold":{":focus":{backgroundColor:"#ffb700"},":hover":{backgroundColor:"#ffb700"}},"hover-bg-yellow":{":focus":{backgroundColor:"#ffd700"},":hover":{backgroundColor:"#ffd700"}},"hover-bg-light-yellow":{":focus":{backgroundColor:"#fbf1a9"},":hover":{backgroundColor:"#fbf1a9"}},"hover-bg-purple":{":focus":{backgroundColor:"#5e2ca5"},":hover":{backgroundColor:"#5e2ca5"}},"hover-bg-light-purple":{":focus":{backgroundColor:"#a463f2"},":hover":{backgroundColor:"#a463f2"}},"hover-bg-dark-pink":{":focus":{backgroundColor:"#d5008f"},":hover":{backgroundColor:"#d5008f"}},"hover-bg-hot-pink":{":focus":{backgroundColor:"#ff41b4"},":hover":{backgroundColor:"#ff41b4"}},"hover-bg-pink":{":focus":{backgroundColor:"#ff80cc"},":hover":{backgroundColor:"#ff80cc"}},"hover-bg-light-pink":{":focus":{backgroundColor:"#ffa3d7"},":hover":{backgroundColor:"#ffa3d7"}},"hover-bg-dark-green":{":focus":{backgroundColor:"#137752"},":hover":{backgroundColor:"#137752"}},"hover-bg-green":{":focus":{backgroundColor:"#19a974"},":hover":{backgroundColor:"#19a974"}},"hover-bg-light-green":{":focus":{backgroundColor:"#9eebcf"},":hover":{backgroundColor:"#9eebcf"}},"hover-bg-navy":{":focus":{backgroundColor:"#001b44"},":hover":{backgroundColor:"#001b44"}},"hover-bg-dark-blue":{":focus":{backgroundColor:"#00449e"},":hover":{backgroundColor:"#00449e"}},"hover-bg-blue":{":focus":{backgroundColor:"#357edd"},":hover":{backgroundColor:"#357edd"}},"hover-bg-light-blue":{":focus":{backgroundColor:"#96ccff"},":hover":{backgroundColor:"#96ccff"}},"hover-bg-lightest-blue":{":focus":{backgroundColor:"#cdecff"},":hover":{backgroundColor:"#cdecff"}},"hover-bg-washed-blue":{":focus":{backgroundColor:"#f6fffe"},":hover":{backgroundColor:"#f6fffe"}},"hover-bg-washed-green":{":focus":{backgroundColor:"#e8fdf5"},":hover":{backgroundColor:"#e8fdf5"}},"hover-bg-washed-yellow":{":focus":{backgroundColor:"#fffceb"},":hover":{backgroundColor:"#fffceb"}},"hover-bg-washed-red":{":focus":{backgroundColor:"#ffdfdf"},":hover":{backgroundColor:"#ffdfdf"}},"hover-bg-inherit":{":focus":{backgroundColor:"inherit"},":hover":{backgroundColor:"inherit"}},pa0:{padding:"0"},pa1:{padding:".25rem"},pa2:{padding:".5rem"},pa3:{padding:"1rem"},pa4:{padding:"2rem"},pa5:{padding:"4rem"},pa6:{padding:"8rem"},pa7:{padding:"16rem"},pl0:{paddingLeft:"0"},pl1:{paddingLeft:".25rem"},pl2:{paddingLeft:".5rem"},pl3:{paddingLeft:"1rem"},pl4:{paddingLeft:"2rem"},pl5:{paddingLeft:"4rem"},pl6:{paddingLeft:"8rem"},pl7:{paddingLeft:"16rem"},pr0:{paddingRight:"0"},pr1:{paddingRight:".25rem"},pr2:{paddingRight:".5rem"},pr3:{paddingRight:"1rem"},pr4:{paddingRight:"2rem"},pr5:{paddingRight:"4rem"},pr6:{paddingRight:"8rem"},pr7:{paddingRight:"16rem"},pb0:{paddingBottom:"0"},pb1:{paddingBottom:".25rem"},pb2:{paddingBottom:".5rem"},pb3:{paddingBottom:"1rem"},pb4:{paddingBottom:"2rem"},pb5:{paddingBottom:"4rem"},pb6:{paddingBottom:"8rem"},pb7:{paddingBottom:"16rem"},pt0:{paddingTop:"0"},pt1:{paddingTop:".25rem"},pt2:{paddingTop:".5rem"},pt3:{paddingTop:"1rem"},pt4:{paddingTop:"2rem"},pt5:{paddingTop:"4rem"},pt6:{paddingTop:"8rem"},pt7:{paddingTop:"16rem"},pv0:{paddingTop:"0",paddingBottom:"0"},pv1:{paddingTop:".25rem",paddingBottom:".25rem"},pv2:{paddingTop:".5rem",paddingBottom:".5rem"},pv3:{paddingTop:"1rem",paddingBottom:"1rem"},pv4:{paddingTop:"2rem",paddingBottom:"2rem"},pv5:{paddingTop:"4rem",paddingBottom:"4rem"},pv6:{paddingTop:"8rem",paddingBottom:"8rem"},pv7:{paddingTop:"16rem",paddingBottom:"16rem"},ph0:{paddingLeft:"0",paddingRight:"0"},ph1:{paddingLeft:".25rem",paddingRight:".25rem"},ph2:{paddingLeft:".5rem",paddingRight:".5rem"},ph3:{paddingLeft:"1rem",paddingRight:"1rem"},ph4:{paddingLeft:"2rem",paddingRight:"2rem"},ph5:{paddingLeft:"4rem",paddingRight:"4rem"},ph6:{paddingLeft:"8rem",paddingRight:"8rem"},ph7:{paddingLeft:"16rem",paddingRight:"16rem"},ma0:{margin:"0"},ma1:{margin:".25rem"},ma2:{margin:".5rem"},ma3:{margin:"1rem"},ma4:{margin:"2rem"},ma5:{margin:"4rem"},ma6:{margin:"8rem"},ma7:{margin:"16rem"},ml0:{marginLeft:"0"},ml1:{marginLeft:".25rem"},ml2:{marginLeft:".5rem"},ml3:{marginLeft:"1rem"},ml4:{marginLeft:"2rem"},ml5:{marginLeft:"4rem"},ml6:{marginLeft:"8rem"},ml7:{marginLeft:"16rem"},mr0:{marginRight:"0"},mr1:{marginRight:".25rem"},mr2:{marginRight:".5rem"},mr3:{marginRight:"1rem"},mr4:{marginRight:"2rem"},mr5:{marginRight:"4rem"},mr6:{marginRight:"8rem"},mr7:{marginRight:"16rem"},mb0:{marginBottom:"0"},mb1:{marginBottom:".25rem"},mb2:{marginBottom:".5rem"},mb3:{marginBottom:"1rem"},mb4:{marginBottom:"2rem"},mb5:{marginBottom:"4rem"},mb6:{marginBottom:"8rem"},mb7:{marginBottom:"16rem"},mt0:{marginTop:"0"},mt1:{marginTop:".25rem"},mt2:{marginTop:".5rem"},mt3:{marginTop:"1rem"},mt4:{marginTop:"2rem"},mt5:{marginTop:"4rem"},mt6:{marginTop:"8rem"},mt7:{marginTop:"16rem"},mv0:{marginTop:"0",marginBottom:"0"},mv1:{marginTop:".25rem",marginBottom:".25rem"},mv2:{marginTop:".5rem",marginBottom:".5rem"},mv3:{marginTop:"1rem",marginBottom:"1rem"},mv4:{marginTop:"2rem",marginBottom:"2rem"},mv5:{marginTop:"4rem",marginBottom:"4rem"},mv6:{marginTop:"8rem",marginBottom:"8rem"},mv7:{marginTop:"16rem",marginBottom:"16rem"},mh0:{marginLeft:"0",marginRight:"0"},mh1:{marginLeft:".25rem",marginRight:".25rem"},mh2:{marginLeft:".5rem",marginRight:".5rem"},mh3:{marginLeft:"1rem",marginRight:"1rem"},mh4:{marginLeft:"2rem",marginRight:"2rem"},mh5:{marginLeft:"4rem",marginRight:"4rem"},mh6:{marginLeft:"8rem",marginRight:"8rem"},mh7:{marginLeft:"16rem",marginRight:"16rem"},na1:{margin:"-.25rem"},na2:{margin:"-.5rem"},na3:{margin:"-1rem"},na4:{margin:"-2rem"},na5:{margin:"-4rem"},na6:{margin:"-8rem"},na7:{margin:"-16rem"},nl1:{marginLeft:"-.25rem"},nl2:{marginLeft:"-.5rem"},nl3:{marginLeft:"-1rem"},nl4:{marginLeft:"-2rem"},nl5:{marginLeft:"-4rem"},nl6:{marginLeft:"-8rem"},nl7:{marginLeft:"-16rem"},nr1:{marginRight:"-.25rem"},nr2:{marginRight:"-.5rem"},nr3:{marginRight:"-1rem"},nr4:{marginRight:"-2rem"},nr5:{marginRight:"-4rem"},nr6:{marginRight:"-8rem"},nr7:{marginRight:"-16rem"},nb1:{marginBottom:"-.25rem"},nb2:{marginBottom:"-.5rem"},nb3:{marginBottom:"-1rem"},nb4:{marginBottom:"-2rem"},nb5:{marginBottom:"-4rem"},nb6:{marginBottom:"-8rem"},nb7:{marginBottom:"-16rem"},nt1:{marginTop:"-.25rem"},nt2:{marginTop:"-.5rem"},nt3:{marginTop:"-1rem"},nt4:{marginTop:"-2rem"},nt5:{marginTop:"-4rem"},nt6:{marginTop:"-8rem"},nt7:{marginTop:"-16rem"},collapse:{borderCollapse:"collapse",borderSpacing:"0"},"striped--light-silver":{":nth-child(odd)":{backgroundColor:"#aaa"}},"striped--moon-gray":{":nth-child(odd)":{backgroundColor:"#ccc"}},"striped--light-gray":{":nth-child(odd)":{backgroundColor:"#eee"}},"striped--near-white":{":nth-child(odd)":{backgroundColor:"#f4f4f4"}},"stripe-light":{":nth-child(odd)":{backgroundColor:"rgba( 255, 255, 255, .1 )"}},"stripe-dark":{":nth-child(odd)":{backgroundColor:"rgba( 0, 0, 0, .1 )"}},strike:{textDecoration:"line-through"},underline:{textDecoration:"underline"},"no-underline":{textDecoration:"none"},tl:{textAlign:"left"},tr:{textAlign:"right"},tc:{textAlign:"center"},tj:{textAlign:"justify"},ttc:{textTransform:"capitalize"},ttl:{textTransform:"lowercase"},ttu:{textTransform:"uppercase"},ttn:{textTransform:"none"},"f-6":{fontSize:"6rem"},"f-headline":{fontSize:"6rem"},"f-5":{fontSize:"5rem"},"f-subheadline":{fontSize:"5rem"},f1:{fontSize:"3rem"},f2:{fontSize:"2.25rem"},f3:{fontSize:"1.5rem"},f4:{fontSize:"1.25rem"},f5:{fontSize:"1rem"},f6:{fontSize:".875rem"},f7:{fontSize:".75rem"},measure:{maxWidth:"30em"},"measure-wide":{maxWidth:"34em"},"measure-narrow":{maxWidth:"20em"},indent:{textIndent:"1em",marginTop:"0",marginBottom:"0"},"small-caps":{fontVariant:"small-caps"},truncate:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},"overflow-container":{overflowY:"scroll"},center:{marginRight:"auto",marginLeft:"auto"},"mr-auto":{marginRight:"auto"},"ml-auto":{marginLeft:"auto"},clip:{position:"absolute",clip:"rect( 1px, 1px, 1px, 1px )"},"ws-normal":{whiteSpace:"normal"},nowrap:{whiteSpace:"nowrap"},"v-base":{verticalAlign:"baseline"},"v-mid":{verticalAlign:"middle"},"v-top":{verticalAlign:"top"},"v-btm":{verticalAlign:"bottom"},dim:{":active":{opacity:".8",transition:"opacity .15s ease-out"},":focus":{opacity:".5",transition:"opacity .15s ease-in"},":hover":{opacity:".5",transition:"opacity .15s ease-in"},opacity:"1",transition:"opacity .15s ease-in"},glow:{":focus":{opacity:"1",transition:"opacity .15s ease-in"},":hover":{opacity:"1",transition:"opacity .15s ease-in"},transition:"opacity .15s ease-in"},"underline-hover":{":focus":{textDecoration:"underline"},":hover":{textDecoration:"underline"}},grow:{":active":{webkitTransform:"scale( .90 )",transform:"scale( .90 )"},":focus":{webkitTransform:"scale( 1.05 )",transform:"scale( 1.05 )"},":hover":{webkitTransform:"scale( 1.05 )",transform:"scale( 1.05 )"},mozOsxFontSmoothing:"grayscale",webkitBackfaceVisibility:"hidden",backfaceVisibility:"hidden",webkitTransform:"translateZ( 0 )",transform:"translateZ( 0 )",transition:"transform .25s ease-out, -webkit-transform .25s ease-out"},"grow-large":{":active":{webkitTransform:"scale( .95 )",transform:"scale( .95 )"},":focus":{webkitTransform:"scale( 1.2 )",transform:"scale( 1.2 )"},":hover":{webkitTransform:"scale( 1.2 )",transform:"scale( 1.2 )"},mozOsxFontSmoothing:"grayscale",webkitBackfaceVisibility:"hidden",backfaceVisibility:"hidden",webkitTransform:"translateZ( 0 )",transform:"translateZ( 0 )",transition:"transform .25s ease-in-out, -webkit-transform .25s ease-in-out"},pointer:{":hover":{cursor:"pointer"}},"shadow-hover":{":focus::after":{opacity:"1"},":hover::after":{opacity:"1"},"::after":{content:"''",boxShadow:"0 0 16px 2px rgba( 0, 0, 0, .2 )",borderRadius:"inherit",opacity:"0",position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"-1",transition:"opacity .5s cubic-bezier( .165, .84, .44, 1 )"},cursor:"pointer",position:"relative",transition:"all .5s cubic-bezier( .165, .84, .44, 1 )"},"bg-animate":{":focus":{transition:"background-color .15s ease-in-out"},":hover":{transition:"background-color .15s ease-in-out"},transition:"background-color .15s ease-in-out"},"z-0":{zIndex:"0"},"z-1":{zIndex:"1"},"z-2":{zIndex:"2"},"z-3":{zIndex:"3"},"z-4":{zIndex:"4"},"z-5":{zIndex:"5"},"z-999":{zIndex:"999"},"z-9999":{zIndex:"9999"},"z-max":{zIndex:"2147483647"},"z-inherit":{zIndex:"inherit"},"z-initial":{zIndex:"initial"},"z-unset":{zIndex:"unset"},"debug-grid":{background:"transparent url( data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAFElEQVR4AWPAC97/9x0eCsAEPgwAVLshdpENIxcAAAAASUVORK5CYII= ) repeat top left"},"debug-grid-16":{background:"transparent url( data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMklEQVR4AWOgCLz/b0epAa6UGuBOqQHOQHLUgFEDnAbcBZ4UGwDOkiCnkIhdgNgNxAYAiYlD+8sEuo8AAAAASUVORK5CYII= ) repeat top left"},"debug-grid-8-solid":{background:"white url( data:image/gif;base64,R0lGODdhCAAIAPEAAADw/wDx/////wAAACwAAAAACAAIAAACDZQvgaeb/lxbAIKA8y0AOw== ) repeat top left"},"debug-grid-16-solid":{background:"white url( data:image/gif;base64,R0lGODdhEAAQAPEAAADw/wDx/xXy/////ywAAAAAEAAQAAACIZyPKckYDQFsb6ZqD85jZ2+BkwiRFKehhqQCQgDHcgwEBQA7 ) repeat top left"},"aspect-ratio-ns":"aspect-ratio","aspect-ratio--16x9-ns":"aspect-ratio--16x9","aspect-ratio--9x16-ns":"aspect-ratio--9x16","aspect-ratio--4x3-ns":"aspect-ratio--4x3","aspect-ratio--3x4-ns":"aspect-ratio--3x4","aspect-ratio--6x4-ns":"aspect-ratio--6x4","aspect-ratio--4x6-ns":"aspect-ratio--4x6","aspect-ratio--8x5-ns":"aspect-ratio--8x5","aspect-ratio--5x8-ns":"aspect-ratio--5x8","aspect-ratio--7x5-ns":"aspect-ratio--7x5","aspect-ratio--5x7-ns":"aspect-ratio--5x7","aspect-ratio--1x1-ns":"aspect-ratio--1x1","aspect-ratio--object-ns":"aspect-ratio--object","cover-ns":"cover","contain-ns":"contain","bg-center-ns":"bg-center","bg-top-ns":"bg-top","bg-right-ns":"bg-right","bg-bottom-ns":"bg-bottom","bg-left-ns":"bg-left","outline-ns":"outline","outline-transparent-ns":"outline-transparent","outline-0-ns":"outline-0","ba-ns":"ba","bt-ns":"bt","br-ns":"br","bb-ns":"bb","bl-ns":"bl","bn-ns":"bn","br0-ns":"br0","br1-ns":"br1","br2-ns":"br2","br3-ns":"br3","br4-ns":"br4","br-100-ns":"br-100","br-pill-ns":"br-pill","br--bottom-ns":"br--bottom","br--top-ns":"br--top","br--right-ns":"br--right","br--left-ns":"br--left","b--dotted-ns":"b--dotted","b--dashed-ns":"b--dashed","b--solid-ns":"b--solid","b--none-ns":"b--none","bw0-ns":"bw0","bw1-ns":"bw1","bw2-ns":"bw2","bw3-ns":"bw3","bw4-ns":"bw4","bw5-ns":"bw5","bt-0-ns":"bt-0","br-0-ns":"br-0","bb-0-ns":"bb-0","bl-0-ns":"bl-0","shadow-1-ns":"shadow-1","shadow-2-ns":"shadow-2","shadow-3-ns":"shadow-3","shadow-4-ns":"shadow-4","shadow-5-ns":"shadow-5","top-0-ns":"top-0","left-0-ns":"left-0","right-0-ns":"right-0","bottom-0-ns":"bottom-0","top-1-ns":"top-1","left-1-ns":"left-1","right-1-ns":"right-1","bottom-1-ns":"bottom-1","top-2-ns":"top-2","left-2-ns":"left-2","right-2-ns":"right-2","bottom-2-ns":"bottom-2","top--1-ns":"top--1","right--1-ns":"right--1","bottom--1-ns":"bottom--1","left--1-ns":"left--1","top--2-ns":"top--2","right--2-ns":"right--2","bottom--2-ns":"bottom--2","left--2-ns":"left--2","absolute--fill-ns":"absolute--fill","cl-ns":"cl","cr-ns":"cr","cb-ns":"cb","cn-ns":"cn","dn-ns":"dn","di-ns":"di","db-ns":"db","dib-ns":"dib","dit-ns":"dit","dt-ns":"dt","dtc-ns":"dtc","dt-row-ns":"dt-row","dt-row-group-ns":"dt-row-group","dt-column-ns":"dt-column","dt-column-group-ns":"dt-column-group","dt--fixed-ns":"dt--fixed","flex-ns":"flex","inline-flex-ns":"inline-flex","flex-auto-ns":"flex-auto","flex-none-ns":"flex-none","flex-column-ns":"flex-column","flex-row-ns":"flex-row","flex-wrap-ns":"flex-wrap","flex-nowrap-ns":"flex-nowrap","flex-wrap-reverse-ns":"flex-wrap-reverse","flex-column-reverse-ns":"flex-column-reverse","flex-row-reverse-ns":"flex-row-reverse","items-start-ns":"items-start","items-end-ns":"items-end","items-center-ns":"items-center","items-baseline-ns":"items-baseline","items-stretch-ns":"items-stretch","self-start-ns":"self-start","self-end-ns":"self-end","self-center-ns":"self-center","self-baseline-ns":"self-baseline","self-stretch-ns":"self-stretch","justify-start-ns":"justify-start","justify-end-ns":"justify-end","justify-center-ns":"justify-center","justify-between-ns":"justify-between","justify-around-ns":"justify-around","content-start-ns":"content-start","content-end-ns":"content-end","content-center-ns":"content-center","content-between-ns":"content-between","content-around-ns":"content-around","content-stretch-ns":"content-stretch","order-0-ns":"order-0","order-1-ns":"order-1","order-2-ns":"order-2","order-3-ns":"order-3","order-4-ns":"order-4","order-5-ns":"order-5","order-6-ns":"order-6","order-7-ns":"order-7","order-8-ns":"order-8","order-last-ns":"order-last","fl-ns":"fl","fr-ns":"fr","fn-ns":"fn","i-ns":"i","fs-normal-ns":"fs-normal","normal-ns":"normal","b-ns":"b","fw1-ns":"fw1","fw2-ns":"fw2","fw3-ns":"fw3","fw4-ns":"fw4","fw5-ns":"fw5","fw6-ns":"fw6","fw7-ns":"fw7","fw8-ns":"fw8","fw9-ns":"fw9","h1-ns":"h1","h2-ns":"h2","h3-ns":"h3","h4-ns":"h4","h5-ns":"h5","h-25-ns":"h-25","h-50-ns":"h-50","h-75-ns":"h-75","h-100-ns":"h-100","min-h-100-ns":"min-h-100","vh-25-ns":"vh-25","vh-50-ns":"vh-50","vh-75-ns":"vh-75","vh-100-ns":"vh-100","min-vh-100-ns":"min-vh-100","h-auto-ns":"h-auto","h-inherit-ns":"h-inherit","tracked-ns":"tracked","tracked-tight-ns":"tracked-tight","tracked-mega-ns":"tracked-mega","lh-solid-ns":"lh-solid","lh-title-ns":"lh-title","lh-copy-ns":"lh-copy","mw-100-ns":"mw-100","mw1-ns":"mw1","mw2-ns":"mw2","mw3-ns":"mw3","mw4-ns":"mw4","mw5-ns":"mw5","mw6-ns":"mw6","mw7-ns":"mw7","mw8-ns":"mw8","mw9-ns":"mw9","mw-none-ns":"mw-none","w1-ns":"w1","w2-ns":"w2","w3-ns":"w3","w4-ns":"w4","w5-ns":"w5","w-10-ns":"w-10","w-20-ns":"w-20","w-25-ns":"w-25","w-30-ns":"w-30","w-33-ns":"w-33","w-34-ns":"w-34","w-40-ns":"w-40","w-50-ns":"w-50","w-60-ns":"w-60","w-70-ns":"w-70","w-75-ns":"w-75","w-80-ns":"w-80","w-90-ns":"w-90","w-100-ns":"w-100","w-third-ns":"w-third","w-two-thirds-ns":"w-two-thirds","w-auto-ns":"w-auto","overflow-visible-ns":"overflow-visible","overflow-hidden-ns":"overflow-hidden","overflow-scroll-ns":"overflow-scroll","overflow-auto-ns":"overflow-auto","overflow-x-visible-ns":"overflow-x-visible","overflow-x-hidden-ns":"overflow-x-hidden","overflow-x-scroll-ns":"overflow-x-scroll","overflow-x-auto-ns":"overflow-x-auto","overflow-y-visible-ns":"overflow-y-visible","overflow-y-hidden-ns":"overflow-y-hidden","overflow-y-scroll-ns":"overflow-y-scroll","overflow-y-auto-ns":"overflow-y-auto","static-ns":"static","relative-ns":"relative","absolute-ns":"absolute","fixed-ns":"fixed","rotate-45-ns":"rotate-45","rotate-90-ns":"rotate-90","rotate-135-ns":"rotate-135","rotate-180-ns":"rotate-180","rotate-225-ns":"rotate-225","rotate-270-ns":"rotate-270","rotate-315-ns":"rotate-315","pa0-ns":"pa0","pa1-ns":"pa1","pa2-ns":"pa2","pa3-ns":"pa3","pa4-ns":"pa4","pa5-ns":"pa5","pa6-ns":"pa6","pa7-ns":"pa7","pl0-ns":"pl0","pl1-ns":"pl1","pl2-ns":"pl2","pl3-ns":"pl3","pl4-ns":"pl4","pl5-ns":"pl5","pl6-ns":"pl6","pl7-ns":"pl7","pr0-ns":"pr0","pr1-ns":"pr1","pr2-ns":"pr2","pr3-ns":"pr3","pr4-ns":"pr4","pr5-ns":"pr5","pr6-ns":"pr6","pr7-ns":"pr7","pb0-ns":"pb0","pb1-ns":"pb1","pb2-ns":"pb2","pb3-ns":"pb3","pb4-ns":"pb4","pb5-ns":"pb5","pb6-ns":"pb6","pb7-ns":"pb7","pt0-ns":"pt0","pt1-ns":"pt1","pt2-ns":"pt2","pt3-ns":"pt3","pt4-ns":"pt4","pt5-ns":"pt5","pt6-ns":"pt6","pt7-ns":"pt7","pv0-ns":"pv0","pv1-ns":"pv1","pv2-ns":"pv2","pv3-ns":"pv3","pv4-ns":"pv4","pv5-ns":"pv5","pv6-ns":"pv6","pv7-ns":"pv7","ph0-ns":"ph0","ph1-ns":"ph1","ph2-ns":"ph2","ph3-ns":"ph3","ph4-ns":"ph4","ph5-ns":"ph5","ph6-ns":"ph6","ph7-ns":"ph7","ma0-ns":"ma0","ma1-ns":"ma1","ma2-ns":"ma2","ma3-ns":"ma3","ma4-ns":"ma4","ma5-ns":"ma5","ma6-ns":"ma6","ma7-ns":"ma7","ml0-ns":"ml0","ml1-ns":"ml1","ml2-ns":"ml2","ml3-ns":"ml3","ml4-ns":"ml4","ml5-ns":"ml5","ml6-ns":"ml6","ml7-ns":"ml7","mr0-ns":"mr0","mr1-ns":"mr1","mr2-ns":"mr2","mr3-ns":"mr3","mr4-ns":"mr4","mr5-ns":"mr5","mr6-ns":"mr6","mr7-ns":"mr7","mb0-ns":"mb0","mb1-ns":"mb1","mb2-ns":"mb2","mb3-ns":"mb3","mb4-ns":"mb4","mb5-ns":"mb5","mb6-ns":"mb6","mb7-ns":"mb7","mt0-ns":"mt0","mt1-ns":"mt1","mt2-ns":"mt2","mt3-ns":"mt3","mt4-ns":"mt4","mt5-ns":"mt5","mt6-ns":"mt6","mt7-ns":"mt7","mv0-ns":"mv0","mv1-ns":"mv1","mv2-ns":"mv2","mv3-ns":"mv3","mv4-ns":"mv4","mv5-ns":"mv5","mv6-ns":"mv6","mv7-ns":"mv7","mh0-ns":"mh0","mh1-ns":"mh1","mh2-ns":"mh2","mh3-ns":"mh3","mh4-ns":"mh4","mh5-ns":"mh5","mh6-ns":"mh6","mh7-ns":"mh7","na1-ns":"na1","na2-ns":"na2","na3-ns":"na3","na4-ns":"na4","na5-ns":"na5","na6-ns":"na6","na7-ns":"na7","nl1-ns":"nl1","nl2-ns":"nl2","nl3-ns":"nl3","nl4-ns":"nl4","nl5-ns":"nl5","nl6-ns":"nl6","nl7-ns":"nl7","nr1-ns":"nr1","nr2-ns":"nr2","nr3-ns":"nr3","nr4-ns":"nr4","nr5-ns":"nr5","nr6-ns":"nr6","nr7-ns":"nr7","nb1-ns":"nb1","nb2-ns":"nb2","nb3-ns":"nb3","nb4-ns":"nb4","nb5-ns":"nb5","nb6-ns":"nb6","nb7-ns":"nb7","nt1-ns":"nt1","nt2-ns":"nt2","nt3-ns":"nt3","nt4-ns":"nt4","nt5-ns":"nt5","nt6-ns":"nt6","nt7-ns":"nt7","strike-ns":"strike","underline-ns":"underline","no-underline-ns":"no-underline","tl-ns":"tl","tr-ns":"tr","tc-ns":"tc","tj-ns":"tj","ttc-ns":"ttc","ttl-ns":"ttl","ttu-ns":"ttu","ttn-ns":"ttn","f-6-ns":"f-6","f-headline-ns":"f-headline","f-5-ns":"f-5","f-subheadline-ns":"f-subheadline","f1-ns":"f1","f2-ns":"f2","f3-ns":"f3","f4-ns":"f4","f5-ns":"f5","f6-ns":"f6","f7-ns":"f7","measure-ns":"measure","measure-wide-ns":"measure-wide","measure-narrow-ns":"measure-narrow","indent-ns":"indent","small-caps-ns":"small-caps","truncate-ns":"truncate","center-ns":"center","mr-auto-ns":"mr-auto","ml-auto-ns":"ml-auto","clip-ns":"clip","ws-normal-ns":"ws-normal","nowrap-ns":"nowrap","pre-ns":{"@media screen and (min-width: 30em)":{whiteSpace:"pre"}},"v-base-ns":"v-base","v-mid-ns":"v-mid","v-top-ns":"v-top","v-btm-ns":"v-btm","aspect-ratio-m":"aspect-ratio","aspect-ratio--16x9-m":"aspect-ratio--16x9","aspect-ratio--9x16-m":"aspect-ratio--9x16","aspect-ratio--4x3-m":"aspect-ratio--4x3","aspect-ratio--3x4-m":"aspect-ratio--3x4","aspect-ratio--6x4-m":"aspect-ratio--6x4","aspect-ratio--4x6-m":"aspect-ratio--4x6","aspect-ratio--8x5-m":"aspect-ratio--8x5","aspect-ratio--5x8-m":"aspect-ratio--5x8","aspect-ratio--7x5-m":"aspect-ratio--7x5","aspect-ratio--5x7-m":"aspect-ratio--5x7","aspect-ratio--1x1-m":"aspect-ratio--1x1","aspect-ratio--object-m":"aspect-ratio--object","cover-m":"cover","contain-m":"contain","bg-center-m":"bg-center","bg-top-m":"bg-top","bg-right-m":"bg-right","bg-bottom-m":"bg-bottom","bg-left-m":"bg-left","outline-m":"outline","outline-transparent-m":"outline-transparent","outline-0-m":"outline-0","ba-m":"ba","bt-m":"bt","br-m":"br","bb-m":"bb","bl-m":"bl","bn-m":"bn","br0-m":"br0","br1-m":"br1","br2-m":"br2","br3-m":"br3","br4-m":"br4","br-100-m":"br-100","br-pill-m":"br-pill","br--bottom-m":"br--bottom","br--top-m":"br--top","br--right-m":"br--right","br--left-m":"br--left","b--dotted-m":"b--dotted","b--dashed-m":"b--dashed","b--solid-m":"b--solid","b--none-m":"b--none","bw0-m":"bw0","bw1-m":"bw1","bw2-m":"bw2","bw3-m":"bw3","bw4-m":"bw4","bw5-m":"bw5","bt-0-m":"bt-0","br-0-m":"br-0","bb-0-m":"bb-0","bl-0-m":"bl-0","shadow-1-m":"shadow-1","shadow-2-m":"shadow-2","shadow-3-m":"shadow-3","shadow-4-m":"shadow-4","shadow-5-m":"shadow-5","top-0-m":"top-0","left-0-m":"left-0","right-0-m":"right-0","bottom-0-m":"bottom-0","top-1-m":"top-1","left-1-m":"left-1","right-1-m":"right-1","bottom-1-m":"bottom-1","top-2-m":"top-2","left-2-m":"left-2","right-2-m":"right-2","bottom-2-m":"bottom-2","top--1-m":"top--1","right--1-m":"right--1","bottom--1-m":"bottom--1","left--1-m":"left--1","top--2-m":"top--2","right--2-m":"right--2","bottom--2-m":"bottom--2","left--2-m":"left--2","absolute--fill-m":"absolute--fill","cl-m":"cl","cr-m":"cr","cb-m":"cb","cn-m":"cn","dn-m":"dn","di-m":"di","db-m":"db","dib-m":"dib","dit-m":"dit","dt-m":"dt","dtc-m":"dtc","dt-row-m":"dt-row","dt-row-group-m":"dt-row-group","dt-column-m":"dt-column","dt-column-group-m":"dt-column-group","dt--fixed-m":"dt--fixed","flex-m":"flex","inline-flex-m":"inline-flex","flex-auto-m":"flex-auto","flex-none-m":"flex-none","flex-column-m":"flex-column","flex-row-m":"flex-row","flex-wrap-m":"flex-wrap","flex-nowrap-m":"flex-nowrap","flex-wrap-reverse-m":"flex-wrap-reverse","flex-column-reverse-m":"flex-column-reverse","flex-row-reverse-m":"flex-row-reverse","items-start-m":"items-start","items-end-m":"items-end","items-center-m":"items-center","items-baseline-m":"items-baseline","items-stretch-m":"items-stretch","self-start-m":"self-start","self-end-m":"self-end","self-center-m":"self-center","self-baseline-m":"self-baseline","self-stretch-m":"self-stretch","justify-start-m":"justify-start","justify-end-m":"justify-end","justify-center-m":"justify-center","justify-between-m":"justify-between","justify-around-m":"justify-around","content-start-m":"content-start","content-end-m":"content-end","content-center-m":"content-center","content-between-m":"content-between","content-around-m":"content-around","content-stretch-m":"content-stretch","order-0-m":"order-0","order-1-m":"order-1","order-2-m":"order-2","order-3-m":"order-3","order-4-m":"order-4","order-5-m":"order-5","order-6-m":"order-6","order-7-m":"order-7","order-8-m":"order-8","order-last-m":"order-last","fl-m":"fl","fr-m":"fr","fn-m":"fn","i-m":"i","fs-normal-m":"fs-normal","normal-m":"normal","b-m":"b","fw1-m":"fw1","fw2-m":"fw2","fw3-m":"fw3","fw4-m":"fw4","fw5-m":"fw5","fw6-m":"fw6","fw7-m":"fw7","fw8-m":"fw8","fw9-m":"fw9","h1-m":"h1","h2-m":"h2","h3-m":"h3","h4-m":"h4","h5-m":"h5","h-25-m":"h-25","h-50-m":"h-50","h-75-m":"h-75","h-100-m":"h-100","min-h-100-m":"min-h-100","vh-25-m":"vh-25","vh-50-m":"vh-50","vh-75-m":"vh-75","vh-100-m":"vh-100","min-vh-100-m":"min-vh-100","h-auto-m":"h-auto","h-inherit-m":"h-inherit","tracked-m":"tracked","tracked-tight-m":"tracked-tight","tracked-mega-m":"tracked-mega","lh-solid-m":"lh-solid","lh-title-m":"lh-title","lh-copy-m":"lh-copy","mw-100-m":"mw-100","mw1-m":"mw1","mw2-m":"mw2","mw3-m":"mw3","mw4-m":"mw4","mw5-m":"mw5","mw6-m":"mw6","mw7-m":"mw7","mw8-m":"mw8","mw9-m":"mw9","mw-none-m":"mw-none","w1-m":"w1","w2-m":"w2","w3-m":"w3","w4-m":"w4","w5-m":"w5","w-10-m":"w-10","w-20-m":"w-20","w-25-m":"w-25","w-30-m":"w-30","w-33-m":"w-33","w-34-m":"w-34","w-40-m":"w-40","w-50-m":"w-50","w-60-m":"w-60","w-70-m":"w-70","w-75-m":"w-75","w-80-m":"w-80","w-90-m":"w-90","w-100-m":"w-100","w-third-m":"w-third","w-two-thirds-m":"w-two-thirds","w-auto-m":"w-auto","overflow-visible-m":"overflow-visible","overflow-hidden-m":"overflow-hidden","overflow-scroll-m":"overflow-scroll","overflow-auto-m":"overflow-auto","overflow-x-visible-m":"overflow-x-visible","overflow-x-hidden-m":"overflow-x-hidden","overflow-x-scroll-m":"overflow-x-scroll","overflow-x-auto-m":"overflow-x-auto","overflow-y-visible-m":"overflow-y-visible","overflow-y-hidden-m":"overflow-y-hidden","overflow-y-scroll-m":"overflow-y-scroll","overflow-y-auto-m":"overflow-y-auto","static-m":"static","relative-m":"relative","absolute-m":"absolute","fixed-m":"fixed","rotate-45-m":"rotate-45","rotate-90-m":"rotate-90","rotate-135-m":"rotate-135","rotate-180-m":"rotate-180","rotate-225-m":"rotate-225","rotate-270-m":"rotate-270","rotate-315-m":"rotate-315","pa0-m":"pa0","pa1-m":"pa1","pa2-m":"pa2","pa3-m":"pa3","pa4-m":"pa4","pa5-m":"pa5","pa6-m":"pa6","pa7-m":"pa7","pl0-m":"pl0","pl1-m":"pl1","pl2-m":"pl2","pl3-m":"pl3","pl4-m":"pl4","pl5-m":"pl5","pl6-m":"pl6","pl7-m":"pl7","pr0-m":"pr0","pr1-m":"pr1","pr2-m":"pr2","pr3-m":"pr3","pr4-m":"pr4","pr5-m":"pr5","pr6-m":"pr6","pr7-m":"pr7","pb0-m":"pb0","pb1-m":"pb1","pb2-m":"pb2","pb3-m":"pb3","pb4-m":"pb4","pb5-m":"pb5","pb6-m":"pb6","pb7-m":"pb7","pt0-m":"pt0","pt1-m":"pt1","pt2-m":"pt2","pt3-m":"pt3","pt4-m":"pt4","pt5-m":"pt5","pt6-m":"pt6","pt7-m":"pt7","pv0-m":"pv0","pv1-m":"pv1","pv2-m":"pv2","pv3-m":"pv3","pv4-m":"pv4","pv5-m":"pv5","pv6-m":"pv6","pv7-m":"pv7","ph0-m":"ph0","ph1-m":"ph1","ph2-m":"ph2","ph3-m":"ph3","ph4-m":"ph4","ph5-m":"ph5","ph6-m":"ph6","ph7-m":"ph7","ma0-m":"ma0","ma1-m":"ma1","ma2-m":"ma2","ma3-m":"ma3","ma4-m":"ma4","ma5-m":"ma5","ma6-m":"ma6","ma7-m":"ma7","ml0-m":"ml0","ml1-m":"ml1","ml2-m":"ml2","ml3-m":"ml3","ml4-m":"ml4","ml5-m":"ml5","ml6-m":"ml6","ml7-m":"ml7","mr0-m":"mr0","mr1-m":"mr1","mr2-m":"mr2","mr3-m":"mr3","mr4-m":"mr4","mr5-m":"mr5","mr6-m":"mr6","mr7-m":"mr7","mb0-m":"mb0","mb1-m":"mb1","mb2-m":"mb2","mb3-m":"mb3","mb4-m":"mb4","mb5-m":"mb5","mb6-m":"mb6","mb7-m":"mb7","mt0-m":"mt0","mt1-m":"mt1","mt2-m":"mt2","mt3-m":"mt3","mt4-m":"mt4","mt5-m":"mt5","mt6-m":"mt6","mt7-m":"mt7","mv0-m":"mv0","mv1-m":"mv1","mv2-m":"mv2","mv3-m":"mv3","mv4-m":"mv4","mv5-m":"mv5","mv6-m":"mv6","mv7-m":"mv7","mh0-m":"mh0","mh1-m":"mh1","mh2-m":"mh2","mh3-m":"mh3","mh4-m":"mh4","mh5-m":"mh5","mh6-m":"mh6","mh7-m":"mh7","na1-m":"na1","na2-m":"na2","na3-m":"na3","na4-m":"na4","na5-m":"na5","na6-m":"na6","na7-m":"na7","nl1-m":"nl1","nl2-m":"nl2","nl3-m":"nl3","nl4-m":"nl4","nl5-m":"nl5","nl6-m":"nl6","nl7-m":"nl7","nr1-m":"nr1","nr2-m":"nr2","nr3-m":"nr3","nr4-m":"nr4","nr5-m":"nr5","nr6-m":"nr6","nr7-m":"nr7","nb1-m":"nb1","nb2-m":"nb2","nb3-m":"nb3","nb4-m":"nb4","nb5-m":"nb5","nb6-m":"nb6","nb7-m":"nb7","nt1-m":"nt1","nt2-m":"nt2","nt3-m":"nt3","nt4-m":"nt4","nt5-m":"nt5","nt6-m":"nt6","nt7-m":"nt7","strike-m":"strike","underline-m":"underline","no-underline-m":"no-underline","tl-m":"tl","tr-m":"tr","tc-m":"tc","tj-m":"tj","ttc-m":"ttc","ttl-m":"ttl","ttu-m":"ttu","ttn-m":"ttn","f-6-m":"f-6","f-headline-m":"f-headline","f-5-m":"f-5","f-subheadline-m":"f-subheadline","f1-m":"f1","f2-m":"f2","f3-m":"f3","f4-m":"f4","f5-m":"f5","f6-m":"f6","f7-m":"f7","measure-m":"measure","measure-wide-m":"measure-wide","measure-narrow-m":"measure-narrow","indent-m":"indent","small-caps-m":"small-caps","truncate-m":"truncate","center-m":"center","mr-auto-m":"mr-auto","ml-auto-m":"ml-auto","clip-m":"clip","ws-normal-m":"ws-normal","nowrap-m":"nowrap","pre-m":{"@media screen and (min-width: 30em) and (max-width: 60em)":{whiteSpace:"pre"}},"v-base-m":"v-base","v-mid-m":"v-mid","v-top-m":"v-top","v-btm-m":"v-btm","aspect-ratio-l":"aspect-ratio","aspect-ratio--16x9-l":"aspect-ratio--16x9","aspect-ratio--9x16-l":"aspect-ratio--9x16","aspect-ratio--4x3-l":"aspect-ratio--4x3","aspect-ratio--3x4-l":"aspect-ratio--3x4","aspect-ratio--6x4-l":"aspect-ratio--6x4","aspect-ratio--4x6-l":"aspect-ratio--4x6","aspect-ratio--8x5-l":"aspect-ratio--8x5","aspect-ratio--5x8-l":"aspect-ratio--5x8","aspect-ratio--7x5-l":"aspect-ratio--7x5","aspect-ratio--5x7-l":"aspect-ratio--5x7","aspect-ratio--1x1-l":"aspect-ratio--1x1","aspect-ratio--object-l":"aspect-ratio--object","cover-l":"cover","contain-l":"contain","bg-center-l":"bg-center","bg-top-l":"bg-top","bg-right-l":"bg-right","bg-bottom-l":"bg-bottom","bg-left-l":"bg-left","outline-l":"outline","outline-transparent-l":"outline-transparent","outline-0-l":"outline-0","ba-l":"ba","bt-l":"bt","br-l":"br","bb-l":"bb","bl-l":"bl","bn-l":"bn","br0-l":"br0","br1-l":"br1","br2-l":"br2","br3-l":"br3","br4-l":"br4","br-100-l":"br-100","br-pill-l":"br-pill","br--bottom-l":"br--bottom","br--top-l":"br--top","br--right-l":"br--right","br--left-l":"br--left","b--dotted-l":"b--dotted","b--dashed-l":"b--dashed","b--solid-l":"b--solid","b--none-l":"b--none","bw0-l":"bw0","bw1-l":"bw1","bw2-l":"bw2","bw3-l":"bw3","bw4-l":"bw4","bw5-l":"bw5","bt-0-l":"bt-0","br-0-l":"br-0","bb-0-l":"bb-0","bl-0-l":"bl-0","shadow-1-l":"shadow-1","shadow-2-l":"shadow-2","shadow-3-l":"shadow-3","shadow-4-l":"shadow-4","shadow-5-l":"shadow-5","top-0-l":"top-0","left-0-l":"left-0","right-0-l":"right-0","bottom-0-l":"bottom-0","top-1-l":"top-1","left-1-l":"left-1","right-1-l":"right-1","bottom-1-l":"bottom-1","top-2-l":"top-2","left-2-l":"left-2","right-2-l":"right-2","bottom-2-l":"bottom-2","top--1-l":"top--1","right--1-l":"right--1","bottom--1-l":"bottom--1","left--1-l":"left--1","top--2-l":"top--2","right--2-l":"right--2","bottom--2-l":"bottom--2","left--2-l":"left--2","absolute--fill-l":"absolute--fill","cl-l":"cl","cr-l":"cr","cb-l":"cb","cn-l":"cn","dn-l":"dn","di-l":"di","db-l":"db","dib-l":"dib","dit-l":"dit","dt-l":"dt","dtc-l":"dtc","dt-row-l":"dt-row","dt-row-group-l":"dt-row-group","dt-column-l":"dt-column","dt-column-group-l":"dt-column-group","dt--fixed-l":"dt--fixed","flex-l":"flex","inline-flex-l":"inline-flex","flex-auto-l":"flex-auto","flex-none-l":"flex-none","flex-column-l":"flex-column","flex-row-l":"flex-row","flex-wrap-l":"flex-wrap","flex-nowrap-l":"flex-nowrap","flex-wrap-reverse-l":"flex-wrap-reverse","flex-column-reverse-l":"flex-column-reverse","flex-row-reverse-l":"flex-row-reverse","items-start-l":"items-start","items-end-l":"items-end","items-center-l":"items-center","items-baseline-l":"items-baseline","items-stretch-l":"items-stretch","self-start-l":"self-start","self-end-l":"self-end","self-center-l":"self-center","self-baseline-l":"self-baseline","self-stretch-l":"self-stretch","justify-start-l":"justify-start","justify-end-l":"justify-end","justify-center-l":"justify-center","justify-between-l":"justify-between","justify-around-l":"justify-around","content-start-l":"content-start","content-end-l":"content-end","content-center-l":"content-center","content-between-l":"content-between","content-around-l":"content-around","content-stretch-l":"content-stretch","order-0-l":"order-0","order-1-l":"order-1","order-2-l":"order-2","order-3-l":"order-3","order-4-l":"order-4","order-5-l":"order-5","order-6-l":"order-6","order-7-l":"order-7","order-8-l":"order-8","order-last-l":"order-last","fl-l":"fl","fr-l":"fr","fn-l":"fn","i-l":"i","fs-normal-l":"fs-normal","normal-l":"normal","b-l":"b","fw1-l":"fw1","fw2-l":"fw2","fw3-l":"fw3","fw4-l":"fw4","fw5-l":"fw5","fw6-l":"fw6","fw7-l":"fw7","fw8-l":"fw8","fw9-l":"fw9","h1-l":"h1","h2-l":"h2","h3-l":"h3","h4-l":"h4","h5-l":"h5","h-25-l":"h-25","h-50-l":"h-50","h-75-l":"h-75","h-100-l":"h-100","min-h-100-l":"min-h-100","vh-25-l":"vh-25","vh-50-l":"vh-50","vh-75-l":"vh-75","vh-100-l":"vh-100","min-vh-100-l":"min-vh-100","h-auto-l":"h-auto","h-inherit-l":"h-inherit","tracked-l":"tracked","tracked-tight-l":"tracked-tight","tracked-mega-l":"tracked-mega","lh-solid-l":"lh-solid","lh-title-l":"lh-title","lh-copy-l":"lh-copy","mw-100-l":"mw-100","mw1-l":"mw1","mw2-l":"mw2","mw3-l":"mw3","mw4-l":"mw4","mw5-l":"mw5","mw6-l":"mw6","mw7-l":"mw7","mw8-l":"mw8","mw9-l":"mw9","mw-none-l":"mw-none","w1-l":"w1","w2-l":"w2","w3-l":"w3","w4-l":"w4","w5-l":"w5","w-10-l":"w-10","w-20-l":"w-20","w-25-l":"w-25","w-30-l":"w-30","w-33-l":"w-33","w-34-l":"w-34","w-40-l":"w-40","w-50-l":"w-50","w-60-l":"w-60","w-70-l":"w-70","w-75-l":"w-75","w-80-l":"w-80","w-90-l":"w-90","w-100-l":"w-100","w-third-l":"w-third","w-two-thirds-l":"w-two-thirds","w-auto-l":"w-auto","overflow-visible-l":"overflow-visible","overflow-hidden-l":"overflow-hidden","overflow-scroll-l":"overflow-scroll","overflow-auto-l":"overflow-auto","overflow-x-visible-l":"overflow-x-visible","overflow-x-hidden-l":"overflow-x-hidden","overflow-x-scroll-l":"overflow-x-scroll","overflow-x-auto-l":"overflow-x-auto","overflow-y-visible-l":"overflow-y-visible","overflow-y-hidden-l":"overflow-y-hidden","overflow-y-scroll-l":"overflow-y-scroll","overflow-y-auto-l":"overflow-y-auto","static-l":"static","relative-l":"relative","absolute-l":"absolute","fixed-l":"fixed","rotate-45-l":"rotate-45","rotate-90-l":"rotate-90","rotate-135-l":"rotate-135","rotate-180-l":"rotate-180","rotate-225-l":"rotate-225","rotate-270-l":"rotate-270","rotate-315-l":"rotate-315","pa0-l":"pa0","pa1-l":"pa1","pa2-l":"pa2","pa3-l":"pa3","pa4-l":"pa4","pa5-l":"pa5","pa6-l":"pa6","pa7-l":"pa7","pl0-l":"pl0","pl1-l":"pl1","pl2-l":"pl2","pl3-l":"pl3","pl4-l":"pl4","pl5-l":"pl5","pl6-l":"pl6","pl7-l":"pl7","pr0-l":"pr0","pr1-l":"pr1","pr2-l":"pr2","pr3-l":"pr3","pr4-l":"pr4","pr5-l":"pr5","pr6-l":"pr6","pr7-l":"pr7","pb0-l":"pb0","pb1-l":"pb1","pb2-l":"pb2","pb3-l":"pb3","pb4-l":"pb4","pb5-l":"pb5","pb6-l":"pb6","pb7-l":"pb7","pt0-l":"pt0","pt1-l":"pt1","pt2-l":"pt2","pt3-l":"pt3","pt4-l":"pt4","pt5-l":"pt5","pt6-l":"pt6","pt7-l":"pt7","pv0-l":"pv0","pv1-l":"pv1","pv2-l":"pv2","pv3-l":"pv3","pv4-l":"pv4","pv5-l":"pv5","pv6-l":"pv6","pv7-l":"pv7","ph0-l":"ph0","ph1-l":"ph1","ph2-l":"ph2","ph3-l":"ph3","ph4-l":"ph4","ph5-l":"ph5","ph6-l":"ph6","ph7-l":"ph7","ma0-l":"ma0","ma1-l":"ma1","ma2-l":"ma2","ma3-l":"ma3","ma4-l":"ma4","ma5-l":"ma5","ma6-l":"ma6","ma7-l":"ma7","ml0-l":"ml0","ml1-l":"ml1","ml2-l":"ml2","ml3-l":"ml3","ml4-l":"ml4","ml5-l":"ml5","ml6-l":"ml6","ml7-l":"ml7","mr0-l":"mr0","mr1-l":"mr1","mr2-l":"mr2","mr3-l":"mr3","mr4-l":"mr4","mr5-l":"mr5","mr6-l":"mr6","mr7-l":"mr7","mb0-l":"mb0","mb1-l":"mb1","mb2-l":"mb2","mb3-l":"mb3","mb4-l":"mb4","mb5-l":"mb5","mb6-l":"mb6","mb7-l":"mb7","mt0-l":"mt0","mt1-l":"mt1","mt2-l":"mt2","mt3-l":"mt3","mt4-l":"mt4","mt5-l":"mt5","mt6-l":"mt6","mt7-l":"mt7","mv0-l":"mv0","mv1-l":"mv1","mv2-l":"mv2","mv3-l":"mv3","mv4-l":"mv4","mv5-l":"mv5","mv6-l":"mv6","mv7-l":"mv7","mh0-l":"mh0","mh1-l":"mh1","mh2-l":"mh2","mh3-l":"mh3","mh4-l":"mh4","mh5-l":"mh5","mh6-l":"mh6","mh7-l":"mh7","na1-l":"na1","na2-l":"na2","na3-l":"na3","na4-l":"na4","na5-l":"na5","na6-l":"na6","na7-l":"na7","nl1-l":"nl1","nl2-l":"nl2","nl3-l":"nl3","nl4-l":"nl4","nl5-l":"nl5","nl6-l":"nl6","nl7-l":"nl7","nr1-l":"nr1","nr2-l":"nr2","nr3-l":"nr3","nr4-l":"nr4","nr5-l":"nr5","nr6-l":"nr6","nr7-l":"nr7","nb1-l":"nb1","nb2-l":"nb2","nb3-l":"nb3","nb4-l":"nb4","nb5-l":"nb5","nb6-l":"nb6","nb7-l":"nb7","nt1-l":"nt1","nt2-l":"nt2","nt3-l":"nt3","nt4-l":"nt4","nt5-l":"nt5","nt6-l":"nt6","nt7-l":"nt7","strike-l":"strike","underline-l":"underline","no-underline-l":"no-underline","tl-l":"tl","tr-l":"tr","tc-l":"tc","tj-l":"tj","ttc-l":"ttc","ttl-l":"ttl","ttu-l":"ttu","ttn-l":"ttn","f-6-l":"f-6","f-headline-l":"f-headline","f-5-l":"f-5","f-subheadline-l":"f-subheadline","f1-l":"f1","f2-l":"f2","f3-l":"f3","f4-l":"f4","f5-l":"f5","f6-l":"f6","f7-l":"f7","measure-l":"measure","measure-wide-l":"measure-wide","measure-narrow-l":"measure-narrow","indent-l":"indent","small-caps-l":"small-caps","truncate-l":"truncate","center-l":"center","mr-auto-l":"mr-auto","ml-auto-l":"ml-auto","clip-l":"clip","ws-normal-l":"ws-normal","nowrap-l":"nowrap","pre-l":{"@media screen and (min-width: 60em)":{whiteSpace:"pre"}},"v-base-l":"v-base","v-mid-l":"v-mid","v-top-l":"v-top","v-btm-l":"v-btm",ns:"@media screen and (min-width: 30em)",m:"@media screen and (min-width: 30em) and (max-width: 60em)",l:"@media screen and (min-width: 60em)"},tVt=bg,nVt=Jke,rVt=eVt,e4=a$e,u$e=function(e){var t;return typeof e=="string"?t=e.split(" "):t=e,nVt(t,function(n){var r=e4[n];if(typeof r=="string"){var i=e4[tVt.getAtRuleSize(n)],s=r;r={},r[i]=e4[s]}return r||(console.error(n+" is not in the list of available Tachyons classes"),null)}).reduce(function(n,r){return rVt(n,r)},{})},iVt=["html { line-height: 1.15;  -ms-text-size-adjust: 100%;  -webkit-text-size-adjust: 100%;  }","body { margin: 0; }","article, aside, footer, header, nav, section { display: block; }","h1 { font-size: 2em; margin: .67em 0; }","figcaption, figure, main { display: block; }","figure { margin: 1em 40px; }","hr { box-sizing: content-box;  height: 0;  overflow: visible;  }","pre { font-family: monospace, monospace;  font-size: 1em;  }","a { background-color: transparent;  -webkit-text-decoration-skip: objects;  }","abbr[title] { border-bottom: none;  text-decoration: underline;  text-decoration: underline dotted;  }","b, strong { font-weight: inherit; }","b, strong { font-weight: bolder; }","code, kbd, samp { font-family: monospace, monospace;  font-size: 1em;  }","dfn { font-style: italic; }","mark { background-color: #ff0; color: #000; }","small { font-size: 80%; }","sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }","sub { bottom: -0.25em; }","sup { top: -0.5em; }","audio, video { display: inline-block; }","audio:not([controls]) { display: none; height: 0; }","img { border-style: none; }","svg:not(:root) { overflow: hidden; }","button, input, optgroup, select, textarea { font-family: sans-serif;  font-size: 100%;  line-height: 1.15;  margin: 0;  }","button, input { overflow: visible; }","button, select { text-transform: none; }",'button, html [type="button"], [type="reset"], [type="submit"] { -webkit-appearance: button;  }','button::-moz-focus-inner, [type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner, [type="submit"]::-moz-focus-inner { border-style: none; padding: 0; }','button:-moz-focusring, [type="button"]:-moz-focusring,[type="reset"]:-moz-focusring, [type="submit"]:-moz-focusring { outline: 1px dotted ButtonText; }',"fieldset { padding: .35em .75em .625em; }","legend { box-sizing: border-box;  color: inherit;  display: table;  max-width: 100%;  padding: 0;  white-space: normal;  }","progress { display: inline-block;  vertical-align: baseline;  }","textarea { overflow: auto; }",'[type="checkbox"], [type="radio"] { box-sizing: border-box;  padding: 0;  }','[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button { height: auto; }','[type="search"] { -webkit-appearance: textfield;  outline-offset: -2px;  }','[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }',"::-webkit-file-upload-button { -webkit-appearance: button;  font: inherit;  }","details, menu { display: block; }","summary { display: list-item; }","canvas { display: inline-block; }","template { display: none; }","[hidden] { display: none; }",'html, body, div, article, section, main, footer, header, form, fieldset, legend,pre, code, a, h1, h2, h3, h4, h5, h6, p, ul, ol, li, dl, dt, dd, textarea, table,td, th, tr, input[type="email"], input[type="number"], input[type="password"],input[type="tel"], input[type="text"], input[type="url"], .border-box { box-sizing: border-box; }',"img { max-width: 100%; }","code, .code { font-family: Consolas, monaco, monospace; }"],sVt=iVt,oVt=function(e){sVt.forEach(function(t){e.insertRule(t)})};function aVt(e,t,n,r){var i=-1,s=e==null?0:e.length;for(r&&s&&(n=e[++i]);++i<s;)n=t(n,e[i],i,e);return n}var l$e=aVt;function uVt(e,t,n,r,i){return i(e,function(s,o,a){n=r?(r=!1,s):t(n,s,o,a)}),n}var lVt=uVt,cVt=l$e,fVt=Qke,dVt=Yke,hVt=lVt,pVt=Va;function mVt(e,t,n){var r=pVt(e)?cVt:hVt,i=arguments.length<3;return r(e,dVt(t),n,i,fVt)}var c$e=mVt,gVt=c$e,yVt=_f,bVt=wF,Yne=u$e,vVt=function e(t,n){return gVt(t,function(r,i,s){return yVt(i)===!0?r[s]=e(i,n):r[s]=bVt(n)?n(Yne(i)):Yne(i),r},{})};function xVt(e){return function(t){return e==null?void 0:e[t]}}var wVt=xVt,SVt=wVt,CVt={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},kVt=SVt(CVt),$Vt=kVt,_Vt=$Vt,EVt=Nq,TVt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,AVt="\\u0300-\\u036f",NVt="\\ufe20-\\ufe2f",IVt="\\u20d0-\\u20ff",DVt=AVt+NVt+IVt,OVt="["+DVt+"]",FVt=RegExp(OVt,"g");function RVt(e){return e=EVt(e),e&&e.replace(TVt,_Vt).replace(FVt,"")}var MVt=RVt,PVt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function LVt(e){return e.match(PVt)||[]}var zVt=LVt,BVt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function UVt(e){return BVt.test(e)}var WVt=UVt,f$e="\\ud800-\\udfff",VVt="\\u0300-\\u036f",jVt="\\ufe20-\\ufe2f",HVt="\\u20d0-\\u20ff",GVt=VVt+jVt+HVt,d$e="\\u2700-\\u27bf",h$e="a-z\\xdf-\\xf6\\xf8-\\xff",qVt="\\xac\\xb1\\xd7\\xf7",XVt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",KVt="\\u2000-\\u206f",YVt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",p$e="A-Z\\xc0-\\xd6\\xd8-\\xde",ZVt="\\ufe0e\\ufe0f",m$e=qVt+XVt+KVt+YVt,g$e="[']",Zne="["+m$e+"]",QVt="["+GVt+"]",y$e="\\d+",JVt="["+d$e+"]",b$e="["+h$e+"]",v$e="[^"+f$e+m$e+y$e+d$e+h$e+p$e+"]",ejt="\\ud83c[\\udffb-\\udfff]",tjt="(?:"+QVt+"|"+ejt+")",njt="[^"+f$e+"]",x$e="(?:\\ud83c[\\udde6-\\uddff]){2}",w$e="[\\ud800-\\udbff][\\udc00-\\udfff]",Ug="["+p$e+"]",rjt="\\u200d",Qne="(?:"+b$e+"|"+v$e+")",ijt="(?:"+Ug+"|"+v$e+")",Jne="(?:"+g$e+"(?:d|ll|m|re|s|t|ve))?",ere="(?:"+g$e+"(?:D|LL|M|RE|S|T|VE))?",S$e=tjt+"?",C$e="["+ZVt+"]?",sjt="(?:"+rjt+"(?:"+[njt,x$e,w$e].join("|")+")"+C$e+S$e+")*",ojt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ajt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ujt=C$e+S$e+sjt,ljt="(?:"+[JVt,x$e,w$e].join("|")+")"+ujt,cjt=RegExp([Ug+"?"+b$e+"+"+Jne+"(?="+[Zne,Ug,"$"].join("|")+")",ijt+"+"+ere+"(?="+[Zne,Ug+Qne,"$"].join("|")+")",Ug+"?"+Qne+"+"+Jne,Ug+"+"+ere,ajt,ojt,y$e,ljt].join("|"),"g");function fjt(e){return e.match(cjt)||[]}var djt=fjt,hjt=zVt,pjt=WVt,mjt=Nq,gjt=djt;function yjt(e,t,n){return e=mjt(e),t=n?void 0:t,t===void 0?pjt(e)?gjt(e):hjt(e):e.match(t)||[]}var bjt=yjt,vjt=l$e,xjt=MVt,wjt=bjt,Sjt="[']",Cjt=RegExp(Sjt,"g");function kjt(e){return function(t){return vjt(wjt(xjt(t).replace(Cjt,"")),e,"")}}var $jt=kjt,_jt=$jt,Ejt=_jt(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Tjt=Ejt,tre=Tk,Ajt=kF,Njt=Va,nre=tre?tre.isConcatSpreadable:void 0;function Ijt(e){return Njt(e)||Ajt(e)||!!(nre&&e&&e[nre])}var Djt=Ijt,Ojt=Pke,Fjt=Djt;function k$e(e,t,n,r,i){var s=-1,o=e.length;for(n||(n=Fjt),i||(i=[]);++s<o;){var a=e[s];t>0&&n(a)?t>1?k$e(a,t-1,n,r,i):Ojt(i,a):r||(i[i.length]=a)}return i}var Rjt=k$e,Mjt=Rjt;function Pjt(e){var t=e==null?0:e.length;return t?Mjt(e,1):[]}var Ljt=Pjt,zjt=bg,Bjt=Jke,Ujt=c$e,Wjt=Tjt,Vjt=Ljt,U6=a$e;function jjt(e,t){var n=U6[zjt.getAtRuleSize(e)];return Ujt(t,function(r,i,s){var o="."+e+"{"+Wjt(s)+":"+i+";}";return typeof n=="string"&&(o=n+"{"+o+"}"),r.push(o),r},[])}var Hjt=function(e){var t;typeof e=="string"?t=e.split(" "):t=e;var n=Bjt(t,function(r){var i=U6[r];if(typeof i=="string"){var s=i;i=U6[s]}return i?jjt(r,i):(console.error(r+" is not in the list of available Tachyons classes"),[])});return Vjt(n)};$f.tachyons=u$e;$f.reset=oVt;$f.wrap=vVt;$f.globals=Hjt;var Oq={};Object.defineProperty(Oq,"__esModule",{value:!0});const t_=tq,t4=xe,Gjt=$f;class N0 extends t_.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},N0.defaultStyles,r),{width:s,height:o}=i;let{maxHeight:a,maxWidth:u}=i;a=o===N0.defaultStyles.height?a:o,u=s===N0.defaultStyles.width?u:s;const l=t4.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:o,width:s,maxHeight:a,maxWidth:u,overflow:"auto"}),c=t4.css(Object.assign({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px"},Gjt.tachyons("fw6 tc"))),f=t4.css({boxSizing:"border-box"});return t_.h("div",{className:`${l} tf-surface`,ref:d=>this.container=d,"data-visible":n},t_.h("div",{className:`${c} tf-label`,ref:d=>this.label=d},t),t_.h("div",{className:`${f} tf-draw-area`,ref:d=>this.drawArea=d}))}}N0.defaultStyles={maxWidth:"580px",maxHeight:"580px",height:"auto",width:"auto"};Oq.SurfaceComponent=N0;var Fq={};Object.defineProperty(Fq,"__esModule",{value:!0});const Kx=tq,$$e=xe,_$e=$f;class qjt extends Kx.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(o=>Kx.h(Xjt,{key:o,id:o,handleClick:r,isActive:o===n},o)):null,s=$$e.css(Object.assign({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap"},_$e.tachyons("bb b--light-gray pb3 mt3")));return Kx.h("div",{className:`${s} visor-tabs`},i)}}Fq.Tabs=qjt;class Xjt extends Kx.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,s=$$e.css(Object.assign({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block"},_$e.tachyons("b f5 mr3 pa2")));return Kx.h("a",{className:`${s} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}Object.defineProperty(QG,"__esModule",{value:!0});const eu=tq,gp=xe,Kjt=$f,Yjt=Oq,Zjt=Fq;class Rq extends eu.Component{static render(t,n,r){return eu.render(eu.h(Rq,Object.assign({},r)),t,n)}constructor(t){super(t),this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(s=>s.tab),r=this.state.tabs;let i;for(const s of n)r.has(s)||(r.add(s),i=s);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){t.keyCode===192&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,s=Array.from(this.getTabs().values()),u=n?"90vw":"550px",l=gp.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=gp.css({right:"0"}),f=gp.css({right:`calc(-${u} - 10px)`}),d=t?c:f,h=gp.css({});return eu.h("div",{className:`${l} ${d} visor`,"data-isopen":t,"data-isfullscreen":n},eu.h(Qjt,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),eu.h(Zjt.Tabs,{tabNames:s,activeTab:r,handleClick:this.setActiveTab.bind(this)}),eu.h("div",{className:`${h} visor-surfaces`},i.map(p=>eu.h(Yjt.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}QG.VisorComponent=Rq;function Qjt(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=gp.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=gp.css(Object.assign({},Kjt.tachyons("f6 link br2 ph3 pv2 near-black"))),o=gp.css({marginLeft:"auto"});return eu.h("div",{className:`${i} visor-controls`},eu.h("button",{className:`${s}`,onClick:n},t?"Minimize":"Maximise"),eu.h("button",{className:`${s} ${o}`,onClick:r},"Hide"))}Object.defineProperty(xk,"__esModule",{value:!0});const Jjt=QG;let n_;const eHt="Visor",n4="tfjs-visor-container";function tHt(){if(typeof document>"u")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(n4)&&n_!=null)return n_;let e=document.getElementById(n4);e==null&&(e=document.createElement("div"),e.id=n4,document.body.appendChild(e));let t;function n(s,o){let a;return t=Jjt.VisorComponent.render(s,t,{ref:u=>a=u,surfaceList:Array.from(o.values())}),a}const r=new Map,i=n(e,r);return n_=new E$e(i,e,r,n),n_}xk.visor=tHt;class E$e{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?eHt:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),s=`${n}-${r}`;return this.surfaceList.has(s)||this.surfaceList.set(s,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}xk.Visor=E$e;var nHt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(As,"__esModule",{value:!0});const rre=vk,rHt=xk;function iHt(e){if(e instanceof HTMLElement)return e;if(rre.isSurface(e))return e.drawArea;if(rre.isSurfaceInfo(e))return rHt.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}As.getDrawArea=iHt;function sHt(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==t[s])return!1}return!0}As.shallowEquals=sHt;function oHt(){return nHt(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}As.nextFrame=oHt;var aHt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})},uHt=rt&&rt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dU,"__esModule",{value:!0});const lHt=uHt($b),r_=As;function cHt(e,t,n={}){return aHt(this,void 0,void 0,function*(){const r=r_.getDrawArea(e),i=t,s=Object.assign({},fHt,n);if(r4.has(r)){const m=r4.get(r);if(r_.shallowEquals(s,m.lastOptions)){yield r_.nextFrame();const g=m.view,y=g.changeset().remove(()=>!0).insert(i);yield g.change("values",y).runAsync();return}}const{xLabel:o,yLabel:a,xType:u,yType:l}=s;let c=null;o!=null&&(c={title:o});let f=null;a!=null&&(f={title:a});const d={actions:!1,mode:"vega-lite",defaultStyle:!1},h={width:s.width||r.clientWidth,height:s.height||r.clientHeight,padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:i,name:"values"},mark:"bar",encoding:{x:{field:"index",type:u,axis:c},y:{field:"value",type:l,axis:f}}};yield r_.nextFrame();const p=yield lHt.default(r,h,d);r4.set(r,{view:p.view,lastOptions:s})})}dU.barchart=cHt;const fHt={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},r4=new Map;var Mq={},dHt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})},hHt=rt&&rt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mq,"__esModule",{value:!0});const pHt=hHt($b),mHt=As;function gHt(e,t,n={}){return dHt(this,void 0,void 0,function*(){const r=Object.assign({},yHt,n),i=mHt.getDrawArea(e),s=[],o=t.values,a=t.tickLabels||[],u=a.length===0;let l=!0;for(let d=0;d<o.length;d++){const h=u?`Class ${d}`:a[d];u&&a.push(h);for(let p=0;p<o[d].length;p++){const m=u?`Class ${p}`:a[p],g=o[d][p];d===p&&!r.shadeDiagonal?s.push({label:h,prediction:m,diagCount:g,noFill:!0}):(s.push({label:h,prediction:m,count:g}),g!==0&&(l=!1))}}if(!r.shadeDiagonal&&l)for(const d of s)d.noFill===!0&&(d.noFill=!1,d.count=d.diagCount);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||i.clientWidth,height:r.height||i.clientHeight,padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:s},encoding:{x:{field:"prediction",type:"ordinal",scale:{domain:a}},y:{field:"label",type:"ordinal",scale:{domain:a}}},layer:[{mark:{type:"rect"},encoding:{fill:{condition:{test:'datum["noFill"] == true',value:"white"},field:"count",type:"quantitative",scale:{range:["#f7fbff","#4292c6"]}},tooltip:{condition:{test:'datum["noFill"] == true',field:"diagCount",type:"nominal"},field:"count",type:"nominal"}}}]};return r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{condition:{test:'datum["noFill"] == true',field:"diagCount",type:"nominal"},field:"count",type:"nominal"}}}),yield pHt.default(i,f,c),Promise.resolve()})}Mq.confusionMatrix=gHt;const yHt={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400};var Pq={};const T$e=Em(Pnt);var wg={};Object.defineProperty(wg,"__esModule",{value:!0});function A$e(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}wg.assert=A$e;function bHt(e,t,n=""){A$e(N$e(e,t),n+` Shapes ${e} and ${t} must match`)}wg.assertShapesMatch=bHt;function N$e(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}wg.arraysEqual=N$e;wg.DECIMAL_PLACES_TO_CHECK=4;var vHt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})},xHt=rt&&rt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},wHt=rt&&rt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pq,"__esModule",{value:!0});const i_=xHt(T$e),SHt=wHt($b),Bh=wg,CHt=As;function kHt(e,t,n={}){return vHt(this,void 0,void 0,function*(){const r=Object.assign({},$Ht,n),i=CHt.getDrawArea(e);let s=t.values;if(r.rowMajor){let d,h;s instanceof i_.Tensor?(d=s.shape,h=s.transpose()):(d=[s.length,s[0].length],h=i_.tidy(()=>i_.tensor2d(s).transpose())),Bh.assert(h.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d"),s=yield h.array(),h.dispose();const p=[s.length,s[0].length];Bh.assert(d[0]===p[1]&&d[1]===p[0],`Unexpected transposed shape. Original ${d} : Transposed ${p}`)}const o=[],{xTickLabels:a,yTickLabels:u}=t;if(s instanceof i_.Tensor){Bh.assert(s.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const d=s.shape;a&&Bh.assert(d[0]===a.length,`Length of xTickLabels (${a.length}) must match number of rows
          (${d[0]})`),u&&Bh.assert(d[1]===u.length,`Length of yTickLabels (${u.length}) must match number of columns
          (${d[1]})`);const h=yield s.data(),[p,m]=d;for(let g=0;g<p;g++){const y=a?a[g]:g;for(let b=0;b<m;b++){const v=u?u[b]:b,x=g*m+b,w=h[x];o.push({x:y,y:v,value:w})}}}else{a&&Bh.assert(s.length===a.length,`Number of rows (${s.length}) must match
          number of xTickLabels (${a.length})`);const d=s;for(let h=0;h<d.length;h++){const p=a?a[h]:h;u&&Bh.assert(s[h].length===u.length,`Number of columns in row ${h} (${s[h].length})
            must match length of yTickLabels (${u.length})`);for(let m=0;m<d[h].length;m++){const g=u?u[m]:m,y=d[h][m];o.push({x:p,y:g,value:y})}}}const l={actions:!1,mode:"vega-lite",defaultStyle:!1},c={width:r.width||i.clientWidth,height:r.height||i.clientHeight,padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:o},mark:"rect",encoding:{x:{field:"x",type:r.xType,scale:{domain:a},title:r.xLabel},y:{field:"y",type:r.yType,scale:{domain:u},title:r.yLabel},fill:{field:"value",type:"quantitative"}}};let f;switch(r.colorMap){case"blues":f=["#f7fbff","#4292c6"];break;case"greyscale":f=["#000000","#ffffff"];break;case"viridis":default:f="viridis";break}if(f!=="viridis"){const d=c.encoding.fill;d.scale={range:f}}if(r.domain){const d=c.encoding.fill;d.scale!=null?d.scale=Object.assign({},d.scale,{domain:r.domain}):d.scale={domain:r.domain}}yield SHt.default(i,c,l)})}Pq.heatmap=kHt;const $Ht={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var Ak={};const I$e=Em(cht);var Nk={};Object.defineProperty(Nk,"__esModule",{value:!0});const ire=xe,sre=$f,_Ht=As,EHt={prepend:!1};function THt(e,t,n={}){const r=_Ht.getDrawArea(e),i=ire.css(Object.assign({"& canvas":{display:"block"}},sre.tachyons("mv2"))),s=ire.css(Object.assign({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px"},sre.tachyons("fw6 tl"))),o=Object.assign({},EHt,n);let a=r.querySelector(`div[data-name=${t}]`);if(!a){if(a=document.createElement("div"),a.setAttribute("class",`${i}`),a.dataset.name=t,o.title){const u=document.createElement("div");u.setAttribute("class",`subsurface-title ${s}`),u.innerText=o.title,a.appendChild(u)}o.prepend?r.insertBefore(a,r.firstChild):r.appendChild(a)}return a}Nk.subSurface=THt;var nc={},_F=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(nc,"__esModule",{value:!0});const km=T$e,Jf=wg;function AHt(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,s=0,o=0;for(let u=0;u<t;u++){const l=e[u];l>n&&(n=l),l<r&&(r=l),l===0&&(i+=1),isNaN(l)?s+=1:isFinite(l)||(o+=1)}const a={numVals:t,numZeros:i,numNans:s,max:n,min:r,numInfs:o};return a.max===-1/0&&(a.max=NaN),a.min===1/0&&(a.min=NaN),a}nc.arrayStats=AHt;function NHt(e){return _F(this,void 0,void 0,function*(){const[t,n,r]=km.tidy(()=>{const i=km.scalar(0,e.dtype),s=e.min(),o=e.max(),a=e.equal(i).sum();return[s,o,a]});return yield Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,s,o,a])=>{const u=i.length;let l=0,c=0;for(let p=0;p<u;p++){const m=i[p];isNaN(m)?l+=1:isFinite(m)||(c+=1)}let f=s[0],d=o[0];return l===u&&(f=NaN,d=NaN),{numVals:u,numZeros:a[0],numNans:l,min:f,max:d,numInfs:c}})})}nc.tensorStats=NHt;function IHt(e,t,n,r){return _F(this,void 0,void 0,function*(){Jf.assert(e.rank===1,"labels must be a 1D tensor"),Jf.assert(t.rank===1,"predictions must be a 1D tensor"),Jf.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&Jf.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),s=t.cast("int32");n==null&&(n=km.tidy(()=>km.maximum(i.max(),s.max()).cast("int32").dataSync()[0]+1));let o=Promise.resolve(null);return r!=null&&(o=r.data()),Promise.all([i.data(),s.data(),o]).then(([a,u,l])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<a.length;f++){const d=a[f],h=u[f];l!=null?c[d][h]+=l[f]:c[d][h]+=1}return c})})}nc.confusionMatrix=IHt;function DHt(e,t){return _F(this,void 0,void 0,function*(){Jf.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return km.dispose([n,r]),i})}nc.accuracy=DHt;function OHt(e,t,n){return _F(this,void 0,void 0,function*(){return Jf.assert(e.rank===1,"labels must be a 1D tensor"),Jf.assert(t.rank===1,"predictions must be a 1D tensor"),Jf.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=km.tidy(()=>km.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const s=Array(n).fill(0),o=Array(n).fill(0);for(let u=0;u<r.length;u++){const l=r[u],c=i[u];s[l]+=1,l===c&&(o[l]+=1)}const a=[];for(let u=0;u<s.length;u++)a.push({count:s[u],accuracy:s[u]===0?0:o[u]/s[u]});return a})})}nc.perClassAccuracy=OHt;var Rb={};const FHt=Em(git);Object.defineProperty(Rb,"__esModule",{value:!0});const RHt=I$e,ore=FHt,i4=xe,s4=$f,MHt=As;function PHt(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=MHt.getDrawArea(e),i=Object.assign({},LHt,n);let s=ore.select(r).select("table.tf-table");const o=i4.css(Object.assign({},s4.tachyons("f6 w-100 mw8 center"),{fontSize:i.fontSize}));if(s.size()===0&&(s=ore.select(r).append("table"),s.attr("class",` ${o} tf-table`),s.append("thead").append("tr"),s.append("tbody")),s.size()!==1)throw new Error("Error inserting table");const a=i4.css(Object.assign({},s4.tachyons("fw6 bb b--black-20 tl pb3 pr3 bg-white"))),u=s.select("thead").select("tr").selectAll("th").data(t.headers),l=u.enter().append("th").attr("class",`${a}`);u.merge(l).html(g=>g),u.exit().remove();const c=RHt.format(",.4~f"),f=s.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),h=i4.css(Object.assign({},s4.tachyons("pa1 bb b--black-20"))),p=f.merge(d).selectAll("td").data(g=>g),m=p.enter().append("td").attr("class",`${h}`);p.merge(m).html(g=>typeof g=="number"?c(g):g),p.exit().remove(),f.exit().remove()}Rb.table=PHt;const LHt={fontSize:14};var zHt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})},BHt=rt&&rt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ak,"__esModule",{value:!0});const are=I$e,UHt=BHt($b),ure=Nk,WHt=nc,VHt=Rb,jHt={maxBins:12,fontSize:11};function HHt(e,t,n={}){return zHt(this,void 0,void 0,function*(){const r=qHt(t),i=Object.assign({},jHt,n),s={actions:!1,mode:"vega-lite",defaultStyle:!1},o=ure.subSurface(e,"histogram");if(n.stats!==!1){const l=ure.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=WHt.arrayStats(r.map(f=>f.value)),GHt(c,l,{fontSize:i.fontSize})}const a=[];for(let l=0;l<r.length;l++){const c=r[l].value;c!=null&&isFinite(c)&&a.push(r[l])}const u={width:i.width||o.clientWidth,height:i.height||o.clientHeight,padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:a},mark:"bar",config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:"#001B44"}}};return UHt.default(o,u,s)})}Ak.histogram=HHt;function GHt(e,t,n){const r=are.format(",.4~f"),i=are.format(".4~p"),s=[],o=[];if(e.numVals!=null&&(s.push("Num Vals"),o.push(r(e.numVals))),e.min!=null&&(s.push("Min"),o.push(r(e.min))),e.max!=null&&(s.push("Max"),o.push(r(e.max))),e.numZeros!=null){s.push("# Zeros");let a="";e.numVals&&(a=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),o.push(`${r(e.numZeros)} ${a}`)}if(e.numNans!=null){s.push("# NaNs");let a="";e.numVals&&(a=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),o.push(`${r(e.numNans)} ${a}`)}if(e.numInfs!=null){s.push("# Infinity");let a="";e.numVals&&(a=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),o.push(`${r(e.numInfs)} ${a}`)}VHt.table(t,{headers:s,values:[o]},n)}function qHt(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var EF={},XHt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})},KHt=rt&&rt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(EF,"__esModule",{value:!0});const YHt=KHt($b),ZHt=As;function QHt(e,t,n={}){return XHt(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const s=[],o=new Set;r.forEach((p,m)=>{const g=i[m]!=null?i[m]:`Series ${m+1}`;o.add(g);const y=p.map(b=>Object.assign({},b,{series:g}));s.push(...y)});const a=ZHt.getDrawArea(e),u=Object.assign({},JHt,n),l={actions:!1,mode:"vega-lite",defaultStyle:!1},c=()=>{if(u.zoomToFit)return{zero:!1};if(u.yAxisDomain!=null)return{domain:u.yAxisDomain}},f={x:{field:"x",type:u.xType,title:u.xLabel},y:{field:"y",type:u.yType,title:u.yLabel,scale:c()},color:{field:"series",type:"nominal",legend:{values:Array.from(o)}}};let d;u.yAxisDomain!=null&&(d={filter:{field:"y",range:u.yAxisDomain}});const h={width:u.width||a.clientWidth,height:u.height||a.clientHeight,padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:u.fontSize,titleFontSize:u.fontSize},text:{fontSize:u.fontSize},legend:{labelFontSize:u.fontSize,titleFontSize:u.fontSize}},data:{values:s},layer:[{mark:{type:"line",clip:!0},encoding:f},{mark:{type:"point"},transform:u.yAxisDomain?[d]:void 0,selection:{nearestPoint:{type:"single",on:"mouseover",nearest:!0,empty:"none",encodings:["x"]}},encoding:Object.assign({},f,{opacity:{value:0,condition:{selection:"nearestPoint",value:1}}})},{transform:[{filter:{selection:"nearestPoint"}},d].filter(Boolean),mark:{type:"text",align:"left",dx:5,dy:-5,color:"black"},encoding:Object.assign({},f,{text:{type:u.xType,field:"y",format:".6f"},color:void 0})},{transform:[{filter:{selection:"nearestPoint"}}],mark:{type:"rule",color:"gray"},encoding:{x:{type:u.xType,field:"x"}}}]};return yield YHt.default(a,h,l),Promise.resolve()})}EF.linechart=QHt;const JHt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var Lq={},eGt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})},tGt=rt&&rt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lq,"__esModule",{value:!0});const nGt=tGt($b),rGt=As;function iGt(e,t,n={}){return eGt(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const s=[];r.forEach((d,h)=>{const p=i[h]!=null?i[h]:`Series ${h+1}`,m=d.map(g=>Object.assign({},g,{series:p}));s.push(...m)});const o=rGt.getDrawArea(e),a=Object.assign({},sGt,n),u={actions:!1,mode:"vega-lite",defaultStyle:!1},l=()=>{if(a.zoomToFit)return{zero:!1};if(a.xAxisDomain!=null)return{domain:a.xAxisDomain}},c=()=>{if(a.zoomToFit)return{zero:!1};if(a.yAxisDomain!=null)return{domain:a.yAxisDomain}},f={width:a.width||o.clientWidth,height:a.height||o.clientHeight,padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:s},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:a.xType,title:a.xLabel,scale:l()},y:{field:"y",type:a.yType,title:a.yLabel,scale:c()},color:{field:"series",type:"nominal"},shape:{field:"series",type:"nominal"}}};return yield nGt.default(o,f,u),Promise.resolve()})}Lq.scatterplot=iGt;const sGt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var TF={},D$e=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(TF,"__esModule",{value:!0});const oGt=EF,W6=As,O$e=Nk;function F$e(e,t,n,r={}){return D$e(this,void 0,void 0,function*(){const i=W6.getDrawArea(e),s={};for(const l of n)if(/val_/.test(l)){const c=l.replace("val_","");lre(s,c);const f=cre(t,l,n.indexOf(l));s[c].series.push(l),s[c].values.push(f)}else{const c=cre(t,l,n.indexOf(l));lre(s,l),s[l].series.push(l),s[l].values.push(c)}const o=Object.keys(s),a=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),u=[];for(const l of o){const c=O$e.subSurface(i,l),f=s[l].series,d=s[l].values;f.every(p=>!!p.match("acc"))&&(a.zoomToFitAccuracy?a.zoomToFit=!0:(a.yAxisDomain=[0,1],delete a.zoomToFit));const h=oGt.linechart(c,{values:d,series:f},a);u.push(h)}yield Promise.all(u)})}TF.history=F$e;function lre(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function cre(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let s=0;s<r.length;s++){const o=r[s];i.push({x:s,y:o[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function aGt(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],s=W6.getDrawArea(e),o=Object.assign({},n);delete o.callbacks;function a(l){return(c,f)=>D$e(this,void 0,void 0,function*(){/batch/i.test(l)?o.xLabel="Batch":/epoch/i.test(l)&&(o.xLabel="Epoch");const d=[],h=[];for(const m of t)if(f[m]!=null){h.push(m);const g=uGt(r,l,m);g.push({[m]:f[m]}),d.push(g)}const p=O$e.subSurface(s,l,{title:l});F$e(p,d,h,o),yield W6.nextFrame()})}const u={};return i.forEach(l=>{u[l]=a(l)}),u}TF.fitCallbacks=aGt;function uGt(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var AF={},tN=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(AF,"__esModule",{value:!0});const lGt=Ak,R$e=As,M$e=Rb,o4=Nk,cGt=nc;function fGt(e,t){return tN(this,void 0,void 0,function*(){const n=R$e.getDrawArea(e),r=hGt(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],s=r.layers.map(o=>[o.name,o.outputShape,o.parameters,o.trainable]);M$e.table(n,{headers:i,values:s})})}AF.modelSummary=fGt;function dGt(e,t){return tN(this,void 0,void 0,function*(){const n=R$e.getDrawArea(e),r=yield mGt(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],s=o4.subSurface(n,"layer-weights-info"),o=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);M$e.table(s,{headers:i,values:o});const a=o4.subSurface(n,"select-layer"),u=o4.subSurface(n,"param-distribution"),l=c=>tN(this,void 0,void 0,function*(){const d=yield r.filter(h=>h.name===c)[0].weight.data();lGt.histogram(u,d,{height:150,width:460,stats:!1})});gGt(r.map(c=>c.name),a,l)})}AF.layer=dGt;function hGt(e){return{layers:e.layers.map(pGt)}}function pGt(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>V6(r)).join(", ")}]`:t=V6(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function mGt(e){return tN(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(cGt.tensorStats),i=yield Promise.all(r),s=t.map(o=>o.shape);return t.map((o,a)=>({name:n[a].name,stats:i[a],shape:V6(s[a]),weight:o}))})}function V6(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function gGt(e,t,n){const s=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(u=>`<option value=${u}>${u}</option>`)}
    </select>
  `}</div>`;t.innerHTML=s;const o=t.querySelector("button"),a=t.querySelector("select");o.addEventListener("click",()=>{n(a.selectedOptions[0].label)})}var zq={},yGt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(zq,"__esModule",{value:!0});const bGt=As,vGt=Rb;function xGt(e,t,n){return yGt(this,void 0,void 0,function*(){const r=bGt.getDrawArea(e),i=["Class","Accuracy","# Samples"],s=[];for(let o=0;o<t.length;o++){const a=n?n[o]:o.toString(),u=t[o];s.push([a,u.accuracy,u.count])}return vGt.table(r,{headers:i,values:s})})}zq.showPerClassAccuracy=xGt;var Bq={},wGt=rt&&rt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(l){try{u(r.next(l))}catch(c){s(c)}}function a(l){try{u(r.throw(l))}catch(c){s(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,a)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Bq,"__esModule",{value:!0});const SGt=Ak,CGt=As,kGt=nc;function $Gt(e,t){return wGt(this,void 0,void 0,function*(){const n=CGt.getDrawArea(e),r=yield kGt.tensorStats(t),i=yield t.data();SGt.histogram(n,i,{height:150,stats:r})})}Bq.valuesDistribution=$Gt;(function(e){function t(b){for(var v in b)e.hasOwnProperty(v)||(e[v]=b[v])}Object.defineProperty(e,"__esModule",{value:!0});const n=dU,r=Mq,i=Pq,s=Ak,o=EF,a=Lq,u=Rb,l=TF,c=AF,f=zq,d=Bq,h=nc,p={barchart:n.barchart,table:u.table,histogram:s.histogram,linechart:o.linechart,scatterplot:a.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=p;const m={accuracy:h.accuracy,perClassAccuracy:h.perClassAccuracy,confusionMatrix:h.confusionMatrix};e.metrics=m;const g={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.showPerClassAccuracy,valuesDistribution:d.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=g;var y=xk;e.visor=y.visor,t(vk)})(wl);/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function Ik(e){return e+.5|0}const ed=(e,t,n)=>Math.max(Math.min(e,n),t);function hx(e){return ed(Ik(e*2.55),0,255)}function vd(e){return ed(Ik(e*255),0,255)}function yc(e){return ed(Ik(e/2.55)/100,0,1)}function fre(e){return ed(Ik(e*100),0,100)}const na={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},j6=[..."0123456789ABCDEF"],_Gt=e=>j6[e&15],EGt=e=>j6[(e&240)>>4]+j6[e&15],s_=e=>(e&240)>>4===(e&15),TGt=e=>s_(e.r)&&s_(e.g)&&s_(e.b)&&s_(e.a);function AGt(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&na[e[1]]*17,g:255&na[e[2]]*17,b:255&na[e[3]]*17,a:t===5?na[e[4]]*17:255}:(t===7||t===9)&&(n={r:na[e[1]]<<4|na[e[2]],g:na[e[3]]<<4|na[e[4]],b:na[e[5]]<<4|na[e[6]],a:t===9?na[e[7]]<<4|na[e[8]]:255})),n}const NGt=(e,t)=>e<255?t(e):"";function IGt(e){var t=TGt(e)?_Gt:EGt;return e?"#"+t(e.r)+t(e.g)+t(e.b)+NGt(e.a,t):void 0}const DGt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function P$e(e,t,n){const r=t*Math.min(n,1-n),i=(s,o=(s+e/30)%12)=>n-r*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function OGt(e,t,n){const r=(i,s=(i+e/60)%6)=>n-n*t*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function FGt(e,t,n){const r=P$e(e,1,.5);let i;for(t+n>1&&(i=1/(t+n),t*=i,n*=i),i=0;i<3;i++)r[i]*=1-t-n,r[i]+=t;return r}function RGt(e,t,n,r,i){return e===i?(t-n)/r+(t<n?6:0):t===i?(n-e)/r+2:(e-t)/r+4}function Uq(e){const n=e.r/255,r=e.g/255,i=e.b/255,s=Math.max(n,r,i),o=Math.min(n,r,i),a=(s+o)/2;let u,l,c;return s!==o&&(c=s-o,l=a>.5?c/(2-s-o):c/(s+o),u=RGt(n,r,i,c,s),u=u*60+.5),[u|0,l||0,a]}function Wq(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(vd)}function Vq(e,t,n){return Wq(P$e,e,t,n)}function MGt(e,t,n){return Wq(FGt,e,t,n)}function PGt(e,t,n){return Wq(OGt,e,t,n)}function L$e(e){return(e%360+360)%360}function LGt(e){const t=DGt.exec(e);let n=255,r;if(!t)return;t[5]!==r&&(n=t[6]?hx(+t[5]):vd(+t[5]));const i=L$e(+t[2]),s=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?r=MGt(i,s,o):t[1]==="hsv"?r=PGt(i,s,o):r=Vq(i,s,o),{r:r[0],g:r[1],b:r[2],a:n}}function zGt(e,t){var n=Uq(e);n[0]=L$e(n[0]+t),n=Vq(n),e.r=n[0],e.g=n[1],e.b=n[2]}function BGt(e){if(!e)return;const t=Uq(e),n=t[0],r=fre(t[1]),i=fre(t[2]);return e.a<255?`hsla(${n}, ${r}%, ${i}%, ${yc(e.a)})`:`hsl(${n}, ${r}%, ${i}%)`}const dre={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},hre={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function UGt(){const e={},t=Object.keys(hre),n=Object.keys(dre);let r,i,s,o,a;for(r=0;r<t.length;r++){for(o=a=t[r],i=0;i<n.length;i++)s=n[i],a=a.replace(s,dre[s]);s=parseInt(hre[o],16),e[a]=[s>>16&255,s>>8&255,s&255]}return e}let o_;function WGt(e){o_||(o_=UGt(),o_.transparent=[0,0,0,0]);const t=o_[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const VGt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function jGt(e){const t=VGt.exec(e);let n=255,r,i,s;if(t){if(t[7]!==r){const o=+t[7];n=t[8]?hx(o):ed(o*255,0,255)}return r=+t[1],i=+t[3],s=+t[5],r=255&(t[2]?hx(r):ed(r,0,255)),i=255&(t[4]?hx(i):ed(i,0,255)),s=255&(t[6]?hx(s):ed(s,0,255)),{r,g:i,b:s,a:n}}}function HGt(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${yc(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const a4=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Rg=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function GGt(e,t,n){const r=Rg(yc(e.r)),i=Rg(yc(e.g)),s=Rg(yc(e.b));return{r:vd(a4(r+n*(Rg(yc(t.r))-r))),g:vd(a4(i+n*(Rg(yc(t.g))-i))),b:vd(a4(s+n*(Rg(yc(t.b))-s))),a:e.a+n*(t.a-e.a)}}function a_(e,t,n){if(e){let r=Uq(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,t===0?360:1)),r=Vq(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function z$e(e,t){return e&&Object.assign(t||{},e)}function pre(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=vd(e[3]))):(t=z$e(e,{r:0,g:0,b:0,a:1}),t.a=vd(t.a)),t}function qGt(e){return e.charAt(0)==="r"?jGt(e):LGt(e)}class S2{constructor(t){if(t instanceof S2)return t;const n=typeof t;let r;n==="object"?r=pre(t):n==="string"&&(r=AGt(t)||WGt(t)||qGt(t)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var t=z$e(this._rgb);return t&&(t.a=yc(t.a)),t}set rgb(t){this._rgb=pre(t)}rgbString(){return this._valid?HGt(this._rgb):void 0}hexString(){return this._valid?IGt(this._rgb):void 0}hslString(){return this._valid?BGt(this._rgb):void 0}mix(t,n){if(t){const r=this.rgb,i=t.rgb;let s;const o=n===s?.5:n,a=2*o-1,u=r.a-i.a,l=((a*u===-1?a:(a+u)/(1+a*u))+1)/2;s=1-l,r.r=255&l*r.r+s*i.r+.5,r.g=255&l*r.g+s*i.g+.5,r.b=255&l*r.b+s*i.b+.5,r.a=o*r.a+(1-o)*i.a,this.rgb=r}return this}interpolate(t,n){return t&&(this._rgb=GGt(this._rgb,t._rgb,n)),this}clone(){return new S2(this.rgb)}alpha(t){return this._rgb.a=vd(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=Ik(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return a_(this._rgb,2,t),this}darken(t){return a_(this._rgb,2,-t),this}saturate(t){return a_(this._rgb,1,t),this}desaturate(t){return a_(this._rgb,1,-t),this}rotate(t){return zGt(this._rgb,t),this}}/*!
 * Chart.js v4.4.3
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function ic(){}const XGt=(()=>{let e=0;return()=>e++})();function Nn(e){return e===null||typeof e>"u"}function cr(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Yt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Zr(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function go(e,t){return Zr(e)?e:t}function ln(e,t){return typeof e>"u"?t:e}const KGt=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Qn(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function en(e,t,n,r){let i,s,o;if(cr(e))for(s=e.length,i=0;i<s;i++)t.call(n,e[i],i);else if(Yt(e))for(o=Object.keys(e),s=o.length,i=0;i<s;i++)t.call(n,e[o[i]],o[i])}function nN(e,t){let n,r,i,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(i=e[n],s=t[n],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function rN(e){if(cr(e))return e.map(rN);if(Yt(e)){const t=Object.create(null),n=Object.keys(e),r=n.length;let i=0;for(;i<r;++i)t[n[i]]=rN(e[n[i]]);return t}return e}function B$e(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function YGt(e,t,n,r){if(!B$e(e))return;const i=t[e],s=n[e];Yt(i)&&Yt(s)?C2(i,s,r):t[e]=rN(s)}function C2(e,t,n){const r=cr(t)?t:[t],i=r.length;if(!Yt(e))return e;n=n||{};const s=n.merger||YGt;let o;for(let a=0;a<i;++a){if(o=r[a],!Yt(o))continue;const u=Object.keys(o);for(let l=0,c=u.length;l<c;++l)s(u[l],e,o,n)}return e}function Yx(e,t){return C2(e,t,{merger:ZGt})}function ZGt(e,t,n){if(!B$e(e))return;const r=t[e],i=n[e];Yt(r)&&Yt(i)?Yx(r,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=rN(i))}const mre={"":e=>e,x:e=>e.x,y:e=>e.y};function QGt(e){const t=e.split("."),n=[];let r="";for(const i of t)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function JGt(e){const t=QGt(e);return n=>{for(const r of t){if(r==="")break;n=n&&n[r]}return n}}function iN(e,t){return(mre[t]||(mre[t]=JGt(t)))(e)}function jq(e){return e.charAt(0).toUpperCase()+e.slice(1)}const sN=e=>typeof e<"u",jd=e=>typeof e=="function",gre=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function eqt(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Jr=Math.PI,Cu=2*Jr,tqt=Cu+Jr,oN=Number.POSITIVE_INFINITY,nqt=Jr/180,Fo=Jr/2,Uh=Jr/4,yre=Jr*2/3,td=Math.log10,N1=Math.sign;function Zx(e,t,n){return Math.abs(e-t)<n}function bre(e){const t=Math.round(e);e=Zx(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(td(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function rqt(e){const t=[],n=Math.sqrt(e);let r;for(r=1;r<n;r++)e%r===0&&(t.push(r),t.push(e/r));return n===(n|0)&&t.push(n),t.sort((i,s)=>i-s).pop(),t}function k2(e){return!isNaN(parseFloat(e))&&isFinite(e)}function iqt(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function U$e(e,t,n){let r,i,s;for(r=0,i=e.length;r<i;r++)s=e[r][n],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function nd(e){return e*(Jr/180)}function Hq(e){return e*(180/Jr)}function vre(e){if(!Zr(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function sqt(e,t){const n=t.x-e.x,r=t.y-e.y,i=Math.sqrt(n*n+r*r);let s=Math.atan2(r,n);return s<-.5*Jr&&(s+=Cu),{angle:s,distance:i}}function H6(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function oqt(e,t){return(e-t+tqt)%Cu-Jr}function nu(e){return(e%Cu+Cu)%Cu}function W$e(e,t,n,r){const i=nu(e),s=nu(t),o=nu(n),a=nu(s-i),u=nu(o-i),l=nu(i-s),c=nu(i-o);return i===s||i===o||r&&s===o||a>u&&l<c}function Sa(e,t,n){return Math.max(t,Math.min(n,e))}function aqt(e){return Sa(e,-32768,32767)}function uqt(e,t,n,r=1e-6){return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function Gq(e,t,n){n=n||(o=>e[o]<t);let r=e.length-1,i=0,s;for(;r-i>1;)s=i+r>>1,n(s)?i=s:r=s;return{lo:i,hi:r}}const yp=(e,t,n,r)=>Gq(e,n,r?i=>{const s=e[i][t];return s<n||s===n&&e[i+1][t]===n}:i=>e[i][t]<n),lqt=(e,t,n)=>Gq(e,n,r=>e[r][t]>=n);function cqt(e,t,n){let r=0,i=e.length;for(;r<i&&e[r]<t;)r++;for(;i>r&&e[i-1]>n;)i--;return r>0||i<e.length?e.slice(r,i):e}const V$e=["push","pop","shift","splice","unshift"];function fqt(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),V$e.forEach(n=>{const r="_onData"+jq(n),i=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return e._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...s)}),o}})})}function xre(e,t){const n=e._chartjs;if(!n)return;const r=n.listeners,i=r.indexOf(t);i!==-1&&r.splice(i,1),!(r.length>0)&&(V$e.forEach(s=>{delete e[s]}),delete e._chartjs)}function dqt(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const j$e=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function H$e(e,t){let n=[],r=!1;return function(...i){n=i,r||(r=!0,j$e.call(window,()=>{r=!1,e.apply(t,n)}))}}function hqt(e,t){let n;return function(...r){return t?(clearTimeout(n),n=setTimeout(e,t,r)):e.apply(this,r),t}}const pqt=e=>e==="start"?"left":e==="end"?"right":"center",wre=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2;function mqt(e,t,n){const r=t.length;let i=0,s=r;if(e._sorted){const{iScale:o,_parsed:a}=e,u=o.axis,{min:l,max:c,minDefined:f,maxDefined:d}=o.getUserBounds();f&&(i=Sa(Math.min(yp(a,u,l).lo,n?r:yp(t,u,o.getPixelForValue(l)).lo),0,r-1)),d?s=Sa(Math.max(yp(a,o.axis,c,!0).hi+1,n?0:yp(t,u,o.getPixelForValue(c),!0).hi+1),i,r)-i:s=r-i}return{start:i,count:s}}function gqt(e){const{xScale:t,yScale:n,_scaleRanges:r}=e,i={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=i,!0;const s=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,i),s}const u_=e=>e===0||e===1,Sre=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Cu/n)),Cre=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Cu/n)+1,Qx={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Fo)+1,easeOutSine:e=>Math.sin(e*Fo),easeInOutSine:e=>-.5*(Math.cos(Jr*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>u_(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>u_(e)?e:Sre(e,.075,.3),easeOutElastic:e=>u_(e)?e:Cre(e,.075,.3),easeInOutElastic(e){return u_(e)?e:e<.5?.5*Sre(e*2,.1125,.45):.5+.5*Cre(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Qx.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Qx.easeInBounce(e*2)*.5:Qx.easeOutBounce(e*2-1)*.5+.5};function qq(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function kre(e){return qq(e)?e:new S2(e)}function u4(e){return qq(e)?e:new S2(e).saturate(.5).darken(.1).hexString()}const yqt=["x","y","borderWidth","radius","tension"],bqt=["color","borderColor","backgroundColor"];function vqt(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:bqt},numbers:{type:"number",properties:yqt}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function xqt(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const $re=new Map;function wqt(e,t){t=t||{};const n=e+JSON.stringify(t);let r=$re.get(n);return r||(r=new Intl.NumberFormat(e,t),$re.set(n,r)),r}function Xq(e,t,n){return wqt(t,n).format(e)}const G$e={values(e){return cr(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const r=this.chart.options.locale;let i,s=e;if(n.length>1){const l=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(l<1e-4||l>1e15)&&(i="scientific"),s=Sqt(e,n)}const o=td(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),u={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(u,this.options.ticks.format),Xq(e,r,u)},logarithmic(e,t,n){if(e===0)return"0";const r=n[t].significand||e/Math.pow(10,Math.floor(td(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?G$e.numeric.call(this,e,t,n):""}};function Sqt(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var NF={formatters:G$e};function Cqt(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:NF.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const $m=Object.create(null),G6=Object.create(null);function Jx(e,t){if(!t)return e;const n=t.split(".");for(let r=0,i=n.length;r<i;++r){const s=n[r];e=e[s]||(e[s]=Object.create(null))}return e}function l4(e,t,n){return typeof t=="string"?C2(Jx(e,t),n):C2(Jx(e,""),t)}class kqt{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>u4(i.backgroundColor),this.hoverBorderColor=(r,i)=>u4(i.borderColor),this.hoverColor=(r,i)=>u4(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return l4(this,t,n)}get(t){return Jx(this,t)}describe(t,n){return l4(G6,t,n)}override(t,n){return l4($m,t,n)}route(t,n,r,i){const s=Jx(this,t),o=Jx(this,r),a="_"+n;Object.defineProperties(s,{[a]:{value:s[n],writable:!0},[n]:{enumerable:!0,get(){const u=this[a],l=o[i];return Yt(u)?Object.assign({},l,u):ln(u,l)},set(u){this[a]=u}}})}apply(t){t.forEach(n=>n(this))}}var dr=new kqt({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[vqt,xqt,Cqt]);function $qt(e){return!e||Nn(e.size)||Nn(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function aN(e,t,n,r,i){let s=t[i];return s||(s=t[i]=e.measureText(i).width,n.push(i)),s>r&&(r=s),r}function _qt(e,t,n,r){r=r||{};let i=r.data=r.data||{},s=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(i=r.data={},s=r.garbageCollect=[],r.font=t),e.save(),e.font=t;let o=0;const a=n.length;let u,l,c,f,d;for(u=0;u<a;u++)if(f=n[u],f!=null&&!cr(f))o=aN(e,i,s,o,f);else if(cr(f))for(l=0,c=f.length;l<c;l++)d=f[l],d!=null&&!cr(d)&&(o=aN(e,i,s,o,d));e.restore();const h=s.length/2;if(h>n.length){for(u=0;u<h;u++)delete i[s[u]];s.splice(0,h)}return o}function Wh(e,t,n){const r=e.currentDevicePixelRatio,i=n!==0?Math.max(n/2,.5):0;return Math.round((t-i)*r)/r+i}function _re(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function q6(e,t,n,r){Eqt(e,t,n,r)}function Eqt(e,t,n,r,i){let s,o,a,u,l,c,f,d;const h=t.pointStyle,p=t.rotation,m=t.radius;let g=(p||0)*nqt;if(h&&typeof h=="object"&&(s=h.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){e.save(),e.translate(n,r),e.rotate(g),e.drawImage(h,-h.width/2,-h.height/2,h.width,h.height),e.restore();return}if(!(isNaN(m)||m<=0)){switch(e.beginPath(),h){default:e.arc(n,r,m,0,Cu),e.closePath();break;case"triangle":c=m,e.moveTo(n+Math.sin(g)*c,r-Math.cos(g)*m),g+=yre,e.lineTo(n+Math.sin(g)*c,r-Math.cos(g)*m),g+=yre,e.lineTo(n+Math.sin(g)*c,r-Math.cos(g)*m),e.closePath();break;case"rectRounded":l=m*.516,u=m-l,o=Math.cos(g+Uh)*u,f=Math.cos(g+Uh)*u,a=Math.sin(g+Uh)*u,d=Math.sin(g+Uh)*u,e.arc(n-f,r-a,l,g-Jr,g-Fo),e.arc(n+d,r-o,l,g-Fo,g),e.arc(n+f,r+a,l,g,g+Fo),e.arc(n-d,r+o,l,g+Fo,g+Jr),e.closePath();break;case"rect":if(!p){u=Math.SQRT1_2*m,c=u,e.rect(n-c,r-u,2*c,2*u);break}g+=Uh;case"rectRot":f=Math.cos(g)*m,o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*m,e.moveTo(n-f,r-a),e.lineTo(n+d,r-o),e.lineTo(n+f,r+a),e.lineTo(n-d,r+o),e.closePath();break;case"crossRot":g+=Uh;case"cross":f=Math.cos(g)*m,o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*m,e.moveTo(n-f,r-a),e.lineTo(n+f,r+a),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o);break;case"star":f=Math.cos(g)*m,o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*m,e.moveTo(n-f,r-a),e.lineTo(n+f,r+a),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o),g+=Uh,f=Math.cos(g)*m,o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*m,e.moveTo(n-f,r-a),e.lineTo(n+f,r+a),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o);break;case"line":o=Math.cos(g)*m,a=Math.sin(g)*m,e.moveTo(n-o,r-a),e.lineTo(n+o,r+a);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(g)*m,r+Math.sin(g)*m);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Nc(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function q$e(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function X$e(e){e.restore()}function Tqt(e,t,n,r,i){if(!t)return e.lineTo(n.x,n.y);if(i==="middle"){const s=(t.x+n.x)/2;e.lineTo(s,t.y),e.lineTo(s,n.y)}else i==="after"!=!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Aqt(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function Nqt(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Nn(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function Iqt(e,t,n,r,i){if(i.strikethrough||i.underline){const s=e.measureText(r),o=t-s.actualBoundingBoxLeft,a=t+s.actualBoundingBoxRight,u=n-s.actualBoundingBoxAscent,l=n+s.actualBoundingBoxDescent,c=i.strikethrough?(u+l)/2:l;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(o,c),e.lineTo(a,c),e.stroke()}}function Dqt(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function uN(e,t,n,r,i,s={}){const o=cr(t)?t:[t],a=s.strokeWidth>0&&s.strokeColor!=="";let u,l;for(e.save(),e.font=i.string,Nqt(e,s),u=0;u<o.length;++u)l=o[u],s.backdrop&&Dqt(e,s.backdrop),a&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),Nn(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(l,n,r,s.maxWidth)),e.fillText(l,n,r,s.maxWidth),Iqt(e,n,r,l,s),r+=Number(i.lineHeight);e.restore()}function X6(e,t){const{x:n,y:r,w:i,h:s,radius:o}=t;e.arc(n+o.topLeft,r+o.topLeft,o.topLeft,1.5*Jr,Jr,!0),e.lineTo(n,r+s-o.bottomLeft),e.arc(n+o.bottomLeft,r+s-o.bottomLeft,o.bottomLeft,Jr,Fo,!0),e.lineTo(n+i-o.bottomRight,r+s),e.arc(n+i-o.bottomRight,r+s-o.bottomRight,o.bottomRight,Fo,0,!0),e.lineTo(n+i,r+o.topRight),e.arc(n+i-o.topRight,r+o.topRight,o.topRight,0,-Fo,!0),e.lineTo(n+o.topLeft,r)}const Oqt=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Fqt=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Rqt(e,t){const n=(""+e).match(Oqt);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const Mqt=e=>+e||0;function K$e(e,t){const n={},r=Yt(t),i=r?Object.keys(t):t,s=Yt(e)?r?o=>ln(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of i)n[o]=Mqt(s(o));return n}function Pqt(e){return K$e(e,{top:"y",right:"x",bottom:"y",left:"x"})}function ew(e){return K$e(e,["topLeft","topRight","bottomLeft","bottomRight"])}function La(e){const t=Pqt(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Ro(e,t){e=e||{},t=t||dr.font;let n=ln(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let r=ln(e.style,t.style);r&&!(""+r).match(Fqt)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:ln(e.family,t.family),lineHeight:Rqt(ln(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:ln(e.weight,t.weight),string:""};return i.string=$qt(i),i}function l_(e,t,n,r){let i,s,o;for(i=0,s=e.length;i<s;++i)if(o=e[i],o!==void 0&&o!==void 0)return o}function Lqt(e,t,n){const{min:r,max:i}=e,s=KGt(t,(i-r)/2),o=(a,u)=>n&&a===0?0:a+u;return{min:o(r,-Math.abs(s)),max:o(i,s)}}function Sh(e,t){return Object.assign(Object.create(e),t)}function Kq(e,t=[""],n,r,i=()=>e[0]){const s=n||e;typeof r>"u"&&(r=J$e("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:s,_fallback:r,_getTarget:i,override:a=>Kq([a,...e],t,s,r)};return new Proxy(o,{deleteProperty(a,u){return delete a[u],delete a._keys,delete e[0][u],!0},get(a,u){return Z$e(a,u,()=>Gqt(u,t,e,a))},getOwnPropertyDescriptor(a,u){return Reflect.getOwnPropertyDescriptor(a._scopes[0],u)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(a,u){return Tre(a).includes(u)},ownKeys(a){return Tre(a)},set(a,u,l){const c=a._storage||(a._storage=i());return a[u]=c[u]=l,delete a._keys,!0}})}function I1(e,t,n,r){const i={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:Y$e(e,r),setContext:s=>I1(e,s,n,r),override:s=>I1(e.override(s),t,n,r)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete e[o],!0},get(s,o,a){return Z$e(s,o,()=>Bqt(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(s,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(s,o,a){return e[o]=a,delete s[o],!0}})}function Y$e(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:r=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:n,indexable:r,isScriptable:jd(n)?n:()=>n,isIndexable:jd(r)?r:()=>r}}const zqt=(e,t)=>e?e+jq(t):t,Yq=(e,t)=>Yt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Z$e(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const r=n();return e[t]=r,r}function Bqt(e,t,n){const{_proxy:r,_context:i,_subProxy:s,_descriptors:o}=e;let a=r[t];return jd(a)&&o.isScriptable(t)&&(a=Uqt(t,a,e,n)),cr(a)&&a.length&&(a=Wqt(t,a,e,o.isIndexable)),Yq(t,a)&&(a=I1(a,i,s&&s[t],o)),a}function Uqt(e,t,n,r){const{_proxy:i,_context:s,_subProxy:o,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e);let u=t(s,o||r);return a.delete(e),Yq(e,u)&&(u=Zq(i._scopes,i,e,u)),u}function Wqt(e,t,n,r){const{_proxy:i,_context:s,_subProxy:o,_descriptors:a}=n;if(typeof s.index<"u"&&r(e))return t[s.index%t.length];if(Yt(t[0])){const u=t,l=i._scopes.filter(c=>c!==u);t=[];for(const c of u){const f=Zq(l,i,e,c);t.push(I1(f,s,o&&o[e],a))}}return t}function Q$e(e,t,n){return jd(e)?e(t,n):e}const Vqt=(e,t)=>e===!0?t:typeof e=="string"?iN(t,e):void 0;function jqt(e,t,n,r,i){for(const s of t){const o=Vqt(n,s);if(o){e.add(o);const a=Q$e(o._fallback,n,i);if(typeof a<"u"&&a!==n&&a!==r)return a}else if(o===!1&&typeof r<"u"&&n!==r)return null}return!1}function Zq(e,t,n,r){const i=t._rootScopes,s=Q$e(t._fallback,n,r),o=[...e,...i],a=new Set;a.add(r);let u=Ere(a,o,n,s||n,r);return u===null||typeof s<"u"&&s!==n&&(u=Ere(a,o,s,u,r),u===null)?!1:Kq(Array.from(a),[""],i,s,()=>Hqt(t,n,r))}function Ere(e,t,n,r,i){for(;n;)n=jqt(e,t,n,r,i);return n}function Hqt(e,t,n){const r=e._getTarget();t in r||(r[t]={});const i=r[t];return cr(i)&&Yt(n)?n:i||{}}function Gqt(e,t,n,r){let i;for(const s of t)if(i=J$e(zqt(s,e),n),typeof i<"u")return Yq(e,i)?Zq(n,r,e,i):i}function J$e(e,t){for(const n of t){if(!n)continue;const r=n[e];if(typeof r<"u")return r}}function Tre(e){let t=e._keys;return t||(t=e._keys=qqt(e._scopes)),t}function qqt(e){const t=new Set;for(const n of e)for(const r of Object.keys(n).filter(i=>!i.startsWith("_")))t.add(r);return Array.from(t)}const Xqt=Number.EPSILON||1e-14,D1=(e,t)=>t<e.length&&!e[t].skip&&e[t],e_e=e=>e==="x"?"y":"x";function Kqt(e,t,n,r){const i=e.skip?t:e,s=t,o=n.skip?t:n,a=H6(s,i),u=H6(o,s);let l=a/(a+u),c=u/(a+u);l=isNaN(l)?0:l,c=isNaN(c)?0:c;const f=r*l,d=r*c;return{previous:{x:s.x-f*(o.x-i.x),y:s.y-f*(o.y-i.y)},next:{x:s.x+d*(o.x-i.x),y:s.y+d*(o.y-i.y)}}}function Yqt(e,t,n){const r=e.length;let i,s,o,a,u,l=D1(e,0);for(let c=0;c<r-1;++c)if(u=l,l=D1(e,c+1),!(!u||!l)){if(Zx(t[c],0,Xqt)){n[c]=n[c+1]=0;continue}i=n[c]/t[c],s=n[c+1]/t[c],a=Math.pow(i,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),n[c]=i*o*t[c],n[c+1]=s*o*t[c])}}function Zqt(e,t,n="x"){const r=e_e(n),i=e.length;let s,o,a,u=D1(e,0);for(let l=0;l<i;++l){if(o=a,a=u,u=D1(e,l+1),!a)continue;const c=a[n],f=a[r];o&&(s=(c-o[n])/3,a[`cp1${n}`]=c-s,a[`cp1${r}`]=f-s*t[l]),u&&(s=(u[n]-c)/3,a[`cp2${n}`]=c+s,a[`cp2${r}`]=f+s*t[l])}}function Qqt(e,t="x"){const n=e_e(t),r=e.length,i=Array(r).fill(0),s=Array(r);let o,a,u,l=D1(e,0);for(o=0;o<r;++o)if(a=u,u=l,l=D1(e,o+1),!!u){if(l){const c=l[t]-u[t];i[o]=c!==0?(l[n]-u[n])/c:0}s[o]=a?l?N1(i[o-1])!==N1(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}Yqt(e,i,s),Zqt(e,s,t)}function c_(e,t,n){return Math.max(Math.min(e,n),t)}function Jqt(e,t){let n,r,i,s,o,a=Nc(e[0],t);for(n=0,r=e.length;n<r;++n)o=s,s=a,a=n<r-1&&Nc(e[n+1],t),s&&(i=e[n],o&&(i.cp1x=c_(i.cp1x,t.left,t.right),i.cp1y=c_(i.cp1y,t.top,t.bottom)),a&&(i.cp2x=c_(i.cp2x,t.left,t.right),i.cp2y=c_(i.cp2y,t.top,t.bottom)))}function eXt(e,t,n,r,i){let s,o,a,u;if(t.spanGaps&&(e=e.filter(l=>!l.skip)),t.cubicInterpolationMode==="monotone")Qqt(e,i);else{let l=r?e[e.length-1]:e[0];for(s=0,o=e.length;s<o;++s)a=e[s],u=Kqt(l,a,e[Math.min(s+1,o-(r?0:1))%o],t.tension),a.cp1x=u.previous.x,a.cp1y=u.previous.y,a.cp2x=u.next.x,a.cp2y=u.next.y,l=a}t.capBezierPoints&&Jqt(e,n)}function Qq(){return typeof window<"u"&&typeof document<"u"}function Jq(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function lN(e,t,n){let r;return typeof e=="string"?(r=parseInt(e,10),e.indexOf("%")!==-1&&(r=r/100*t.parentNode[n])):r=e,r}const IF=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function tXt(e,t){return IF(e).getPropertyValue(t)}const nXt=["top","right","bottom","left"];function Dp(e,t,n){const r={};n=n?"-"+n:"";for(let i=0;i<4;i++){const s=nXt[i];r[s]=parseFloat(e[t+"-"+s+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const rXt=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function iXt(e,t){const n=e.touches,r=n&&n.length?n[0]:e,{offsetX:i,offsetY:s}=r;let o=!1,a,u;if(rXt(i,s,e.target))a=i,u=s;else{const l=t.getBoundingClientRect();a=r.clientX-l.left,u=r.clientY-l.top,o=!0}return{x:a,y:u,box:o}}function Zh(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:r}=t,i=IF(n),s=i.boxSizing==="border-box",o=Dp(i,"padding"),a=Dp(i,"border","width"),{x:u,y:l,box:c}=iXt(e,n),f=o.left+(c&&a.left),d=o.top+(c&&a.top);let{width:h,height:p}=t;return s&&(h-=o.width+a.width,p-=o.height+a.height),{x:Math.round((u-f)/h*n.width/r),y:Math.round((l-d)/p*n.height/r)}}function sXt(e,t,n){let r,i;if(t===void 0||n===void 0){const s=e&&Jq(e);if(!s)t=e.clientWidth,n=e.clientHeight;else{const o=s.getBoundingClientRect(),a=IF(s),u=Dp(a,"border","width"),l=Dp(a,"padding");t=o.width-l.width-u.width,n=o.height-l.height-u.height,r=lN(a.maxWidth,s,"clientWidth"),i=lN(a.maxHeight,s,"clientHeight")}}return{width:t,height:n,maxWidth:r||oN,maxHeight:i||oN}}const f_=e=>Math.round(e*10)/10;function oXt(e,t,n,r){const i=IF(e),s=Dp(i,"margin"),o=lN(i.maxWidth,e,"clientWidth")||oN,a=lN(i.maxHeight,e,"clientHeight")||oN,u=sXt(e,t,n);let{width:l,height:c}=u;if(i.boxSizing==="content-box"){const d=Dp(i,"border","width"),h=Dp(i,"padding");l-=h.width+d.width,c-=h.height+d.height}return l=Math.max(0,l-s.width),c=Math.max(0,r?l/r:c-s.height),l=f_(Math.min(l,o,u.maxWidth)),c=f_(Math.min(c,a,u.maxHeight)),l&&!c&&(c=f_(l/2)),(t!==void 0||n!==void 0)&&r&&u.height&&c>u.height&&(c=u.height,l=f_(Math.floor(c*r))),{width:l,height:c}}function Are(e,t,n){const r=t||1,i=Math.floor(e.height*r),s=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==r||o.height!==i||o.width!==s?(e.currentDevicePixelRatio=r,o.height=i,o.width=s,e.ctx.setTransform(r,0,0,r,0,0),!0):!1}const aXt=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Qq()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function Nre(e,t){const n=tXt(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Qh(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function uXt(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:r==="middle"?n<.5?e.y:t.y:r==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function lXt(e,t,n,r){const i={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},o=Qh(e,i,n),a=Qh(i,s,n),u=Qh(s,t,n),l=Qh(o,a,n),c=Qh(a,u,n);return Qh(l,c,n)}const cXt=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},fXt=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function c4(e,t,n){return e?cXt(t,n):fXt()}function dXt(e,t){let n,r;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function hXt(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function t_e(e){return e==="angle"?{between:W$e,compare:oqt,normalize:nu}:{between:uqt,compare:(t,n)=>t-n,normalize:t=>t}}function Ire({start:e,end:t,count:n,loop:r,style:i}){return{start:e%n,end:t%n,loop:r&&(t-e+1)%n===0,style:i}}function pXt(e,t,n){const{property:r,start:i,end:s}=n,{between:o,normalize:a}=t_e(r),u=t.length;let{start:l,end:c,loop:f}=e,d,h;if(f){for(l+=u,c+=u,d=0,h=u;d<h&&o(a(t[l%u][r]),i,s);++d)l--,c--;l%=u,c%=u}return c<l&&(c+=u),{start:l,end:c,loop:f,style:e.style}}function mXt(e,t,n){if(!n)return[e];const{property:r,start:i,end:s}=n,o=t.length,{compare:a,between:u,normalize:l}=t_e(r),{start:c,end:f,loop:d,style:h}=pXt(e,t,n),p=[];let m=!1,g=null,y,b,v;const x=()=>u(i,v,y)&&a(i,v)!==0,w=()=>a(s,y)===0||u(s,v,y),S=()=>m||x(),C=()=>!m||w();for(let k=c,E=c;k<=f;++k)b=t[k%o],!b.skip&&(y=l(b[r]),y!==v&&(m=u(y,i,s),g===null&&S()&&(g=a(y,i)===0?k:E),g!==null&&C()&&(p.push(Ire({start:g,end:k,loop:d,count:o,style:h})),g=null),E=k,v=y));return g!==null&&p.push(Ire({start:g,end:f,loop:d,count:o,style:h})),p}function gXt(e,t){const n=[],r=e.segments;for(let i=0;i<r.length;i++){const s=mXt(r[i],e.points,t);s.length&&n.push(...s)}return n}function yXt(e,t,n,r){let i=0,s=t-1;if(n&&!r)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,n&&(s+=i);s>i&&e[s%t].skip;)s--;return s%=t,{start:i,end:s}}function bXt(e,t,n,r){const i=e.length,s=[];let o=t,a=e[t],u;for(u=t+1;u<=n;++u){const l=e[u%i];l.skip||l.stop?a.skip||(r=!1,s.push({start:t%i,end:(u-1)%i,loop:r}),t=o=l.stop?u:null):(o=u,a.skip&&(t=u)),a=l}return o!==null&&s.push({start:t%i,end:o%i,loop:r}),s}function vXt(e,t){const n=e.points,r=e.options.spanGaps,i=n.length;if(!i)return[];const s=!!e._loop,{start:o,end:a}=yXt(n,i,s,r);if(r===!0)return Dre(e,[{start:o,end:a,loop:s}],n,t);const u=a<o?a+i:a,l=!!e._fullLoop&&o===0&&a===i-1;return Dre(e,bXt(n,o,u,l),n,t)}function Dre(e,t,n,r){return!r||!r.setContext||!n?t:xXt(e,t,n,r)}function xXt(e,t,n,r){const i=e._chart.getContext(),s=Ore(e.options),{_datasetIndex:o,options:{spanGaps:a}}=e,u=n.length,l=[];let c=s,f=t[0].start,d=f;function h(p,m,g,y){const b=a?-1:1;if(p!==m){for(p+=u;n[p%u].skip;)p-=b;for(;n[m%u].skip;)m+=b;p%u!==m%u&&(l.push({start:p%u,end:m%u,loop:g,style:y}),c=y,f=m%u)}}for(const p of t){f=a?f:p.start;let m=n[f%u],g;for(d=f+1;d<=p.end;d++){const y=n[d%u];g=Ore(r.setContext(Sh(i,{type:"segment",p0:m,p1:y,p0DataIndex:(d-1)%u,p1DataIndex:d%u,datasetIndex:o}))),wXt(g,c)&&h(f,d-1,p.loop,c),m=y,c=g}f<d-1&&h(f,d-1,p.loop,c)}return l}function Ore(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function wXt(e,t){if(!t)return!1;const n=[],r=function(i,s){return qq(s)?(n.includes(s)||n.push(s),n.indexOf(s)):s};return JSON.stringify(e,r)!==JSON.stringify(t,r)}/*!
 * Chart.js v4.4.3
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class SXt{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,r,i){const s=n.listeners[i],o=n.duration;s.forEach(a=>a({chart:t,initial:n.initial,numSteps:o,currentStep:Math.min(r-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=j$e.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const s=r.items;let o=s.length-1,a=!1,u;for(;o>=0;--o)u=s[o],u._active?(u._total>r.duration&&(r.duration=u._total),u.tick(t),a=!0):(s[o]=s[s.length-1],s.pop());a&&(i.draw(),this._notify(i,r,t,"progress")),s.length||(r.running=!1,this._notify(i,r,t,"complete"),r.initial=!1),n+=s.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let r=n.get(t);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,r)),r}listen(t,n,r){this._getAnims(t).listeners[n].push(r)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const r=n.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var oc=new SXt;const Fre="transparent",CXt={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const r=kre(e||Fre),i=r.valid&&kre(t||Fre);return i&&i.valid?i.mix(r,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class kXt{constructor(t,n,r,i){const s=n[r];i=l_([t.to,i,s,t.from]);const o=l_([t.from,s,i]);this._active=!0,this._fn=t.fn||CXt[t.type||typeof o],this._easing=Qx[t.easing]||Qx.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=r,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,n,r){if(this._active){this._notify(!1);const i=this._target[this._prop],s=r-this._start,o=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=l_([t.to,n,i,t.from]),this._from=l_([t.from,i,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,r=this._duration,i=this._prop,s=this._from,o=this._loop,a=this._to;let u;if(this._active=s!==a&&(o||n<r),!this._active){this._target[i]=a,this._notify(!0);return}if(n<0){this._target[i]=s;return}u=n/r%2,u=o&&u>1?2-u:u,u=this._easing(Math.min(1,Math.max(0,u))),this._target[i]=this._fn(s,a,u)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,r)=>{t.push({res:n,rej:r})})}_notify(t){const n=t?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][n]()}}class n_e{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!Yt(t))return;const n=Object.keys(dr.animation),r=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const s=t[i];if(!Yt(s))return;const o={};for(const a of n)o[a]=s[a];(cr(s.properties)&&s.properties||[i]).forEach(a=>{(a===i||!r.has(a))&&r.set(a,o)})})}_animateOptions(t,n){const r=n.options,i=_Xt(t,r);if(!i)return[];const s=this._createAnimations(i,r);return r.$shared&&$Xt(t.options.$animations,r).then(()=>{t.options=r},()=>{}),s}_createAnimations(t,n){const r=this._properties,i=[],s=t.$animations||(t.$animations={}),o=Object.keys(n),a=Date.now();let u;for(u=o.length-1;u>=0;--u){const l=o[u];if(l.charAt(0)==="$")continue;if(l==="options"){i.push(...this._animateOptions(t,n));continue}const c=n[l];let f=s[l];const d=r.get(l);if(f)if(d&&f.active()){f.update(d,c,a);continue}else f.cancel();if(!d||!d.duration){t[l]=c;continue}s[l]=f=new kXt(d,t,l,c),i.push(f)}return i}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const r=this._createAnimations(t,n);if(r.length)return oc.add(this._chart,r),!0}}function $Xt(e,t){const n=[],r=Object.keys(t);for(let i=0;i<r.length;i++){const s=e[r[i]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}function _Xt(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Rre(e,t){const n=e&&e.options||{},r=n.reverse,i=n.min===void 0?t:0,s=n.max===void 0?t:0;return{start:r?s:i,end:r?i:s}}function EXt(e,t,n){if(n===!1)return!1;const r=Rre(e,n),i=Rre(t,n);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function TXt(e){let t,n,r,i;return Yt(e)?(t=e.top,n=e.right,r=e.bottom,i=e.left):t=n=r=i=e,{top:t,right:n,bottom:r,left:i,disabled:e===!1}}function r_e(e,t){const n=[],r=e._getSortedDatasetMetas(t);let i,s;for(i=0,s=r.length;i<s;++i)n.push(r[i].index);return n}function Mre(e,t,n,r={}){const i=e.keys,s=r.mode==="single";let o,a,u,l;if(t!==null){for(o=0,a=i.length;o<a;++o){if(u=+i[o],u===n){if(r.all)continue;break}l=e.values[u],Zr(l)&&(s||t===0||N1(t)===N1(l))&&(t+=l)}return t}}function AXt(e,t){const{iScale:n,vScale:r}=t,i=n.axis==="x"?"x":"y",s=r.axis==="x"?"x":"y",o=Object.keys(e),a=new Array(o.length);let u,l,c;for(u=0,l=o.length;u<l;++u)c=o[u],a[u]={[i]:c,[s]:e[c]};return a}function Pre(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function NXt(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function IXt(e){const{min:t,max:n,minDefined:r,maxDefined:i}=e.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}function DXt(e,t,n){const r=e[t]||(e[t]={});return r[n]||(r[n]={})}function Lre(e,t,n,r){for(const i of t.getMatchingVisibleMetas(r).reverse()){const s=e[i.index];if(n&&s>0||!n&&s<0)return i.index}return null}function zre(e,t){const{chart:n,_cachedMeta:r}=e,i=n._stacks||(n._stacks={}),{iScale:s,vScale:o,index:a}=r,u=s.axis,l=o.axis,c=NXt(s,o,r),f=t.length;let d;for(let h=0;h<f;++h){const p=t[h],{[u]:m,[l]:g}=p,y=p._stacks||(p._stacks={});d=y[l]=DXt(i,c,m),d[a]=g,d._top=Lre(d,o,!0,r.type),d._bottom=Lre(d,o,!1,r.type);const b=d._visualValues||(d._visualValues={});b[a]=g}}function f4(e,t){const n=e.scales;return Object.keys(n).filter(r=>n[r].axis===t).shift()}function OXt(e,t){return Sh(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function FXt(e,t,n){return Sh(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Ev(e,t){const n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;for(const i of t){const s=i._stacks;if(!s||s[r]===void 0||s[r][n]===void 0)return;delete s[r][n],s[r]._visualValues!==void 0&&s[r]._visualValues[n]!==void 0&&delete s[r]._visualValues[n]}}}const d4=e=>e==="reset"||e==="none",Bre=(e,t)=>t?e:Object.assign({},e),RXt=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:r_e(n,!0),values:null};class tw{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Pre(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Ev(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,r=this.getDataset(),i=(f,d,h,p)=>f==="x"?d:f==="r"?p:h,s=n.xAxisID=ln(r.xAxisID,f4(t,"x")),o=n.yAxisID=ln(r.yAxisID,f4(t,"y")),a=n.rAxisID=ln(r.rAxisID,f4(t,"r")),u=n.indexAxis,l=n.iAxisID=i(u,s,o,a),c=n.vAxisID=i(u,o,s,a);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(l),n.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&xre(this._data,this),t._stacked&&Ev(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),r=this._data;if(Yt(n)){const i=this._cachedMeta;this._data=AXt(n,i)}else if(r!==n){if(r){xre(r,this);const i=this._cachedMeta;Ev(i),i._parsed=[]}n&&Object.isExtensible(n)&&fqt(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const s=n._stacked;n._stacked=Pre(n.vScale,n),n.stack!==r.stack&&(i=!0,Ev(n),n.stack=r.stack),this._resyncElements(t),(i||s!==n._stacked)&&zre(this,n._parsed)}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),r=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:r,_data:i}=this,{iScale:s,_stacked:o}=r,a=s.axis;let u=t===0&&n===i.length?!0:r._sorted,l=t>0&&r._parsed[t-1],c,f,d;if(this._parsing===!1)r._parsed=i,r._sorted=!0,d=i;else{cr(i[t])?d=this.parseArrayData(r,i,t,n):Yt(i[t])?d=this.parseObjectData(r,i,t,n):d=this.parsePrimitiveData(r,i,t,n);const h=()=>f[a]===null||l&&f[a]<l[a];for(c=0;c<n;++c)r._parsed[c+t]=f=d[c],u&&(h()&&(u=!1),l=f);r._sorted=u}o&&zre(this,d)}parsePrimitiveData(t,n,r,i){const{iScale:s,vScale:o}=t,a=s.axis,u=o.axis,l=s.getLabels(),c=s===o,f=new Array(i);let d,h,p;for(d=0,h=i;d<h;++d)p=d+r,f[d]={[a]:c||s.parse(l[p],p),[u]:o.parse(n[p],p)};return f}parseArrayData(t,n,r,i){const{xScale:s,yScale:o}=t,a=new Array(i);let u,l,c,f;for(u=0,l=i;u<l;++u)c=u+r,f=n[c],a[u]={x:s.parse(f[0],c),y:o.parse(f[1],c)};return a}parseObjectData(t,n,r,i){const{xScale:s,yScale:o}=t,{xAxisKey:a="x",yAxisKey:u="y"}=this._parsing,l=new Array(i);let c,f,d,h;for(c=0,f=i;c<f;++c)d=c+r,h=n[d],l[c]={x:s.parse(iN(h,a),d),y:o.parse(iN(h,u),d)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,r){const i=this.chart,s=this._cachedMeta,o=n[t.axis],a={keys:r_e(i,!0),values:n._stacks[t.axis]._visualValues};return Mre(a,o,s.index,{mode:r})}updateRangeFromParsed(t,n,r,i){const s=r[n.axis];let o=s===null?NaN:s;const a=i&&r._stacks[n.axis];i&&a&&(i.values=a,o=Mre(i,s,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,n){const r=this._cachedMeta,i=r._parsed,s=r._sorted&&t===r.iScale,o=i.length,a=this._getOtherScale(t),u=RXt(n,r,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:f}=IXt(a);let d,h;function p(){h=i[d];const m=h[a.axis];return!Zr(h[t.axis])||c>m||f<m}for(d=0;d<o&&!(!p()&&(this.updateRangeFromParsed(l,t,h,u),s));++d);if(s){for(d=o-1;d>=0;--d)if(!p()){this.updateRangeFromParsed(l,t,h,u);break}}return l}getAllParsedValues(t){const n=this._cachedMeta._parsed,r=[];let i,s,o;for(i=0,s=n.length;i<s;++i)o=n[i][t.axis],Zr(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,r=n.iScale,i=n.vScale,s=this.getParsed(t);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=TXt(ln(this.options.clip,EXt(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,r=this._cachedMeta,i=r.data||[],s=n.chartArea,o=[],a=this._drawStart||0,u=this._drawCount||i.length-a,l=this.options.drawActiveElementsOnTop;let c;for(r.dataset&&r.dataset.draw(t,s,a,u),c=a;c<a+u;++c){const f=i[c];f.hidden||(f.active&&l?o.push(f):f.draw(t,s))}for(c=0;c<o.length;++c)o[c].draw(t,s)}getStyle(t,n){const r=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(t||0,r)}getContext(t,n,r){const i=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];s=o.$context||(o.$context=FXt(this.getContext(),t,o)),s.parsed=this.getParsed(t),s.raw=i.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=OXt(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=r,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",r){const i=n==="active",s=this._cachedDataOpts,o=t+"-"+n,a=s[o],u=this.enableOptionSharing&&sN(r);if(a)return Bre(a,u);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),f=i?[`${t}Hover`,"hover",t,""]:[t,""],d=l.getOptionScopes(this.getDataset(),c),h=Object.keys(dr.elements[t]),p=()=>this.getContext(r,i,n),m=l.resolveNamedOptions(d,h,p,f);return m.$shared&&(m.$shared=u,s[o]=Object.freeze(Bre(m,u))),m}_resolveAnimations(t,n,r){const i=this.chart,s=this._cachedDataOpts,o=`animation-${n}`,a=s[o];if(a)return a;let u;if(i.options.animation!==!1){const c=this.chart.config,f=c.datasetAnimationScopeKeys(this._type,n),d=c.getOptionScopes(this.getDataset(),f);u=c.createResolver(d,this.getContext(t,r,n))}const l=new n_e(i,u&&u.animations);return u&&u._cacheable&&(s[o]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||d4(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const r=this.resolveDataElementOptions(t,n),i=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(n,s)||s!==i;return this.updateSharedOptions(s,n,r),{sharedOptions:s,includeOptions:o}}updateElement(t,n,r,i){d4(i)?Object.assign(t,r):this._resolveAnimations(n,i).update(t,r)}updateSharedOptions(t,n,r){t&&!d4(n)&&this._resolveAnimations(void 0,n).update(t,r)}_setStyle(t,n,r,i){t.active=i;const s=this.getStyle(n,i);this._resolveAnimations(n,r,i).update(t,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(t,n,r){this._setStyle(t,r,"active",!1)}setHoverStyle(t,n,r){this._setStyle(t,r,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,r=this._cachedMeta.data;for(const[a,u,l]of this._syncList)this[a](u,l);this._syncList=[];const i=r.length,s=n.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,t):s<i&&this._removeElements(s,i-s)}_insertElements(t,n,r=!0){const i=this._cachedMeta,s=i.data,o=t+n;let a;const u=l=>{for(l.length+=n,a=l.length-1;a>=o;a--)l[a]=l[a-n]};for(u(s),a=t;a<o;++a)s[a]=new this.dataElementType;this._parsing&&u(i._parsed),this.parse(t,n),r&&this.updateElements(s,t,n,"reset")}updateElements(t,n,r,i){}_removeElements(t,n){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(t,n);r._stacked&&Ev(r,i)}r.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,r,i]=t;this[n](r,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",t,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ot(tw,"defaults",{}),ot(tw,"datasetElementType",null),ot(tw,"dataElementType",null);class uE extends tw{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:r,data:i=[],_dataset:s}=n,o=this.chart._animationsDisabled;let{start:a,count:u}=mqt(n,i,o);this._drawStart=a,this._drawCount=u,gqt(n)&&(a=0,u=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=i;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:l},t),this.updateElements(i,a,u,t)}updateElements(t,n,r,i){const s=i==="reset",{iScale:o,vScale:a,_stacked:u,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:f}=this._getSharedOptions(n,i),d=o.axis,h=a.axis,{spanGaps:p,segment:m}=this.options,g=k2(p)?p:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||s||i==="none",b=n+r,v=t.length;let x=n>0&&this.getParsed(n-1);for(let w=0;w<v;++w){const S=t[w],C=y?S:{};if(w<n||w>=b){C.skip=!0;continue}const k=this.getParsed(w),E=Nn(k[h]),_=C[d]=o.getPixelForValue(k[d],w),T=C[h]=s||E?a.getBasePixel():a.getPixelForValue(u?this.applyStack(a,k,u):k[h],w);C.skip=isNaN(_)||isNaN(T)||E,C.stop=w>0&&Math.abs(k[d]-x[d])>g,m&&(C.parsed=k,C.raw=l.data[w]),f&&(C.options=c||this.resolveDataElementOptions(w,S.active?"active":i)),y||this.updateElement(S,w,C,i),x=k}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,r=n.options&&n.options.borderWidth||0,i=t.data||[];if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}ot(uE,"id","line"),ot(uE,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),ot(uE,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function Vh(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class eX{constructor(t){ot(this,"options");this.options=t||{}}static override(t){Object.assign(eX.prototype,t)}init(){}formats(){return Vh()}parse(){return Vh()}format(){return Vh()}add(){return Vh()}diff(){return Vh()}startOf(){return Vh()}endOf(){return Vh()}}var MXt={_date:eX};function PXt(e,t,n,r){const{controller:i,data:s,_sorted:o}=e,a=i._cachedMeta.iScale;if(a&&t===a.axis&&t!=="r"&&o&&s.length){const u=a._reversePixels?lqt:yp;if(r){if(i._sharedOptions){const l=s[0],c=typeof l.getRange=="function"&&l.getRange(t);if(c){const f=u(s,t,n-c),d=u(s,t,n+c);return{lo:f.lo,hi:d.hi}}}}else return u(s,t,n)}return{lo:0,hi:s.length-1}}function Dk(e,t,n,r,i){const s=e.getSortedVisibleDatasetMetas(),o=n[t];for(let a=0,u=s.length;a<u;++a){const{index:l,data:c}=s[a],{lo:f,hi:d}=PXt(s[a],t,o,i);for(let h=f;h<=d;++h){const p=c[h];p.skip||r(p,l,h)}}}function LXt(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(r,i){const s=t?Math.abs(r.x-i.x):0,o=n?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function h4(e,t,n,r,i){const s=[];return!i&&!e.isPointInArea(t)||Dk(e,n,t,function(a,u,l){!i&&!Nc(a,e.chartArea,0)||a.inRange(t.x,t.y,r)&&s.push({element:a,datasetIndex:u,index:l})},!0),s}function zXt(e,t,n,r){let i=[];function s(o,a,u){const{startAngle:l,endAngle:c}=o.getProps(["startAngle","endAngle"],r),{angle:f}=sqt(o,{x:t.x,y:t.y});W$e(f,l,c)&&i.push({element:o,datasetIndex:a,index:u})}return Dk(e,n,t,s),i}function BXt(e,t,n,r,i,s){let o=[];const a=LXt(n);let u=Number.POSITIVE_INFINITY;function l(c,f,d){const h=c.inRange(t.x,t.y,i);if(r&&!h)return;const p=c.getCenterPoint(i);if(!(!!s||e.isPointInArea(p))&&!h)return;const g=a(t,p);g<u?(o=[{element:c,datasetIndex:f,index:d}],u=g):g===u&&o.push({element:c,datasetIndex:f,index:d})}return Dk(e,n,t,l),o}function p4(e,t,n,r,i,s){return!s&&!e.isPointInArea(t)?[]:n==="r"&&!r?zXt(e,t,n,i):BXt(e,t,n,r,i,s)}function Ure(e,t,n,r,i){const s=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return Dk(e,n,t,(u,l,c)=>{u[o](t[n],i)&&(s.push({element:u,datasetIndex:l,index:c}),a=a||u.inRange(t.x,t.y,i))}),r&&!a?[]:s}var UXt={evaluateInteractionItems:Dk,modes:{index(e,t,n,r){const i=Zh(t,e),s=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?h4(e,i,s,r,o):p4(e,i,s,!1,r,o),u=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(l=>{const c=a[0].index,f=l.data[c];f&&!f.skip&&u.push({element:f,datasetIndex:l.index,index:c})}),u):[]},dataset(e,t,n,r){const i=Zh(t,e),s=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?h4(e,i,s,r,o):p4(e,i,s,!1,r,o);if(a.length>0){const u=a[0].datasetIndex,l=e.getDatasetMeta(u).data;a=[];for(let c=0;c<l.length;++c)a.push({element:l[c],datasetIndex:u,index:c})}return a},point(e,t,n,r){const i=Zh(t,e),s=n.axis||"xy",o=n.includeInvisible||!1;return h4(e,i,s,r,o)},nearest(e,t,n,r){const i=Zh(t,e),s=n.axis||"xy",o=n.includeInvisible||!1;return p4(e,i,s,n.intersect,r,o)},x(e,t,n,r){const i=Zh(t,e);return Ure(e,i,"x",n.intersect,r)},y(e,t,n,r){const i=Zh(t,e);return Ure(e,i,"y",n.intersect,r)}}};const i_e=["left","top","right","bottom"];function Tv(e,t){return e.filter(n=>n.pos===t)}function Wre(e,t){return e.filter(n=>i_e.indexOf(n.pos)===-1&&n.box.axis===t)}function Av(e,t){return e.sort((n,r)=>{const i=t?r:n,s=t?n:r;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function WXt(e){const t=[];let n,r,i,s,o,a;for(n=0,r=(e||[]).length;n<r;++n)i=e[n],{position:s,options:{stack:o,stackWeight:a=1}}=i,t.push({index:n,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:a});return t}function VXt(e){const t={};for(const n of e){const{stack:r,pos:i,stackWeight:s}=n;if(!r||!i_e.includes(i))continue;const o=t[r]||(t[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return t}function jXt(e,t){const n=VXt(e),{vBoxMaxWidth:r,hBoxMaxHeight:i}=t;let s,o,a;for(s=0,o=e.length;s<o;++s){a=e[s];const{fullSize:u}=a.box,l=n[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*r:u&&t.availableWidth,a.height=i):(a.width=r,a.height=c?c*i:u&&t.availableHeight)}return n}function HXt(e){const t=WXt(e),n=Av(t.filter(l=>l.box.fullSize),!0),r=Av(Tv(t,"left"),!0),i=Av(Tv(t,"right")),s=Av(Tv(t,"top"),!0),o=Av(Tv(t,"bottom")),a=Wre(t,"x"),u=Wre(t,"y");return{fullSize:n,leftAndTop:r.concat(s),rightAndBottom:i.concat(u).concat(o).concat(a),chartArea:Tv(t,"chartArea"),vertical:r.concat(i).concat(u),horizontal:s.concat(o).concat(a)}}function Vre(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function s_e(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function GXt(e,t,n,r){const{pos:i,box:s}=n,o=e.maxPadding;if(!Yt(i)){n.size&&(e[i]-=n.size);const f=r[n.stack]||{size:0,count:1};f.size=Math.max(f.size,n.horizontal?s.height:s.width),n.size=f.size/f.count,e[i]+=n.size}s.getPadding&&s_e(o,s.getPadding());const a=Math.max(0,t.outerWidth-Vre(o,e,"left","right")),u=Math.max(0,t.outerHeight-Vre(o,e,"top","bottom")),l=a!==e.w,c=u!==e.h;return e.w=a,e.h=u,n.horizontal?{same:l,other:c}:{same:c,other:l}}function qXt(e){const t=e.maxPadding;function n(r){const i=Math.max(t[r]-e[r],0);return e[r]+=i,i}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function XXt(e,t){const n=t.maxPadding;function r(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(t[o],n[o])}),s}return r(e?["left","right"]:["top","bottom"])}function px(e,t,n,r){const i=[];let s,o,a,u,l,c;for(s=0,o=e.length,l=0;s<o;++s){a=e[s],u=a.box,u.update(a.width||t.w,a.height||t.h,XXt(a.horizontal,t));const{same:f,other:d}=GXt(t,n,a,r);l|=f&&i.length,c=c||d,u.fullSize||i.push(a)}return l&&px(i,t,n,r)||c}function d_(e,t,n,r,i){e.top=n,e.left=t,e.right=t+r,e.bottom=n+i,e.width=r,e.height=i}function jre(e,t,n,r){const i=n.padding;let{x:s,y:o}=t;for(const a of e){const u=a.box,l=r[a.stack]||{count:1,placed:0,weight:1},c=a.stackWeight/l.weight||1;if(a.horizontal){const f=t.w*c,d=l.size||u.height;sN(l.start)&&(o=l.start),u.fullSize?d_(u,i.left,o,n.outerWidth-i.right-i.left,d):d_(u,t.left+l.placed,o,f,d),l.start=o,l.placed+=f,o=u.bottom}else{const f=t.h*c,d=l.size||u.width;sN(l.start)&&(s=l.start),u.fullSize?d_(u,s,i.top,d,n.outerHeight-i.bottom-i.top):d_(u,s,t.top+l.placed,d,f),l.start=s,l.placed+=f,s=u.right}}t.x=s,t.y=o}var h_={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,r){if(!e)return;const i=La(e.options.layout.padding),s=Math.max(t-i.width,0),o=Math.max(n-i.height,0),a=HXt(e.boxes),u=a.vertical,l=a.horizontal;en(e.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const c=u.reduce((m,g)=>g.box.options&&g.box.options.display===!1?m:m+1,0)||1,f=Object.freeze({outerWidth:t,outerHeight:n,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/c,hBoxMaxHeight:o/2}),d=Object.assign({},i);s_e(d,La(r));const h=Object.assign({maxPadding:d,w:s,h:o,x:i.left,y:i.top},i),p=jXt(u.concat(l),f);px(a.fullSize,h,f,p),px(u,h,f,p),px(l,h,f,p)&&px(u,h,f,p),qXt(h),jre(a.leftAndTop,h,f,p),h.x+=h.w,h.y+=h.h,jre(a.rightAndBottom,h,f,p),e.chartArea={left:h.left,top:h.top,right:h.left+h.w,bottom:h.top+h.h,height:h.h,width:h.w},en(a.chartArea,m=>{const g=m.box;Object.assign(g,e.chartArea),g.update(h.w,h.h,{left:0,top:0,right:0,bottom:0})})}};class o_e{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,r){}removeEventListener(t,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,r,i){return n=Math.max(0,n||t.width),r=r||t.height,{width:n,height:Math.max(0,i?Math.floor(n/i):r)}}isAttached(t){return!0}updateConfig(t){}}class KXt extends o_e{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const lE="$chartjs",YXt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Hre=e=>e===null||e==="";function ZXt(e,t){const n=e.style,r=e.getAttribute("height"),i=e.getAttribute("width");if(e[lE]={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Hre(i)){const s=Nre(e,"width");s!==void 0&&(e.width=s)}if(Hre(r))if(e.style.height==="")e.height=e.width/(t||2);else{const s=Nre(e,"height");s!==void 0&&(e.height=s)}return e}const a_e=aXt?{passive:!0}:!1;function QXt(e,t,n){e&&e.addEventListener(t,n,a_e)}function JXt(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,a_e)}function eKt(e,t){const n=YXt[e.type]||e.type,{x:r,y:i}=Zh(e,t);return{type:n,chart:t,native:e,x:r!==void 0?r:null,y:i!==void 0?i:null}}function cN(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function tKt(e,t,n){const r=e.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||cN(a.addedNodes,r),o=o&&!cN(a.removedNodes,r);o&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}function nKt(e,t,n){const r=e.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||cN(a.removedNodes,r),o=o&&!cN(a.addedNodes,r);o&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}const $2=new Map;let Gre=0;function u_e(){const e=window.devicePixelRatio;e!==Gre&&(Gre=e,$2.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function rKt(e,t){$2.size||window.addEventListener("resize",u_e),$2.set(e,t)}function iKt(e){$2.delete(e),$2.size||window.removeEventListener("resize",u_e)}function sKt(e,t,n){const r=e.canvas,i=r&&Jq(r);if(!i)return;const s=H$e((a,u)=>{const l=i.clientWidth;n(a,u),l<i.clientWidth&&n()},window),o=new ResizeObserver(a=>{const u=a[0],l=u.contentRect.width,c=u.contentRect.height;l===0&&c===0||s(l,c)});return o.observe(i),rKt(e,s),o}function m4(e,t,n){n&&n.disconnect(),t==="resize"&&iKt(e)}function oKt(e,t,n){const r=e.canvas,i=H$e(s=>{e.ctx!==null&&n(eKt(s,e))},e);return QXt(r,t,i),i}class aKt extends o_e{acquireContext(t,n){const r=t&&t.getContext&&t.getContext("2d");return r&&r.canvas===t?(ZXt(t,n),r):null}releaseContext(t){const n=t.canvas;if(!n[lE])return!1;const r=n[lE].initial;["height","width"].forEach(s=>{const o=r[s];Nn(o)?n.removeAttribute(s):n.setAttribute(s,o)});const i=r.style||{};return Object.keys(i).forEach(s=>{n.style[s]=i[s]}),n.width=n.width,delete n[lE],!0}addEventListener(t,n,r){this.removeEventListener(t,n);const i=t.$proxies||(t.$proxies={}),o={attach:tKt,detach:nKt,resize:sKt}[n]||oKt;i[n]=o(t,n,r)}removeEventListener(t,n){const r=t.$proxies||(t.$proxies={}),i=r[n];if(!i)return;({attach:m4,detach:m4,resize:m4}[n]||JXt)(t,n,i),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,r,i){return oXt(t,n,r,i)}isAttached(t){const n=t&&Jq(t);return!!(n&&n.isConnected)}}function uKt(e){return!Qq()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?KXt:aKt}class _m{constructor(){ot(this,"x");ot(this,"y");ot(this,"active",!1);ot(this,"options");ot(this,"$animations")}tooltipPosition(t){const{x:n,y:r}=this.getProps(["x","y"],t);return{x:n,y:r}}hasValue(){return k2(this.x)&&k2(this.y)}getProps(t,n){const r=this.$animations;if(!n||!r)return this;const i={};return t.forEach(s=>{i[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),i}}ot(_m,"defaults",{}),ot(_m,"defaultRoutes");function lKt(e,t){const n=e.options.ticks,r=cKt(e),i=Math.min(n.maxTicksLimit||r,r),s=n.major.enabled?dKt(t):[],o=s.length,a=s[0],u=s[o-1],l=[];if(o>i)return hKt(t,l,s,o/i),l;const c=fKt(s,t,i);if(o>0){let f,d;const h=o>1?Math.round((u-a)/(o-1)):null;for(p_(t,l,c,Nn(h)?0:a-h,a),f=0,d=o-1;f<d;f++)p_(t,l,c,s[f],s[f+1]);return p_(t,l,c,u,Nn(h)?t.length:u+h),l}return p_(t,l,c),l}function cKt(e){const t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),i=e._maxLength/n;return Math.floor(Math.min(r,i))}function fKt(e,t,n){const r=pKt(e),i=t.length/n;if(!r)return Math.max(i,1);const s=rqt(r);for(let o=0,a=s.length-1;o<a;o++){const u=s[o];if(u>i)return u}return Math.max(i,1)}function dKt(e){const t=[];let n,r;for(n=0,r=e.length;n<r;n++)e[n].major&&t.push(n);return t}function hKt(e,t,n,r){let i=0,s=n[0],o;for(r=Math.ceil(r),o=0;o<e.length;o++)o===s&&(t.push(e[o]),i++,s=n[i*r])}function p_(e,t,n,r,i){const s=ln(r,0),o=Math.min(ln(i,e.length),e.length);let a=0,u,l,c;for(n=Math.ceil(n),i&&(u=i-r,n=u/Math.floor(u/n)),c=s;c<0;)a++,c=Math.round(s+a*n);for(l=Math.max(s,0);l<o;l++)l===c&&(t.push(e[l]),a++,c=Math.round(s+a*n))}function pKt(e){const t=e.length;let n,r;if(t<2)return!1;for(r=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==r)return!1;return r}const mKt=e=>e==="left"?"right":e==="right"?"left":e,qre=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,Xre=(e,t)=>Math.min(t||e,e);function Kre(e,t){const n=[],r=e.length/t,i=e.length;let s=0;for(;s<i;s+=r)n.push(e[Math.floor(s)]);return n}function gKt(e,t,n){const r=e.ticks.length,i=Math.min(t,r-1),s=e._startPixel,o=e._endPixel,a=1e-6;let u=e.getPixelForTick(i),l;if(!(n&&(r===1?l=Math.max(u-s,o-u):t===0?l=(e.getPixelForTick(1)-u)/2:l=(u-e.getPixelForTick(i-1))/2,u+=i<t?l:-l,u<s-a||u>o+a)))return u}function yKt(e,t){en(e,n=>{const r=n.gc,i=r.length/2;let s;if(i>t){for(s=0;s<i;++s)delete n.data[r[s]];r.splice(0,i)}})}function Nv(e){return e.drawTicks?e.tickLength:0}function Yre(e,t){if(!e.display)return 0;const n=Ro(e.font,t),r=La(e.padding);return(cr(e.text)?e.text.length:1)*n.lineHeight+r.height}function bKt(e,t){return Sh(e,{scale:t,type:"scale"})}function vKt(e,t,n){return Sh(e,{tick:n,index:t,type:"tick"})}function xKt(e,t,n){let r=pqt(e);return(n&&t!=="right"||!n&&t==="right")&&(r=mKt(r)),r}function wKt(e,t,n,r){const{top:i,left:s,bottom:o,right:a,chart:u}=e,{chartArea:l,scales:c}=u;let f=0,d,h,p;const m=o-i,g=a-s;if(e.isHorizontal()){if(h=wre(r,s,a),Yt(n)){const y=Object.keys(n)[0],b=n[y];p=c[y].getPixelForValue(b)+m-t}else n==="center"?p=(l.bottom+l.top)/2+m-t:p=qre(e,n,t);d=a-s}else{if(Yt(n)){const y=Object.keys(n)[0],b=n[y];h=c[y].getPixelForValue(b)-g+t}else n==="center"?h=(l.left+l.right)/2-g+t:h=qre(e,n,t);p=wre(r,o,i),f=n==="left"?-Fo:Fo}return{titleX:h,titleY:p,maxWidth:d,rotation:f}}class Sg extends _m{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:r,_suggestedMax:i}=this;return t=go(t,Number.POSITIVE_INFINITY),n=go(n,Number.NEGATIVE_INFINITY),r=go(r,Number.POSITIVE_INFINITY),i=go(i,Number.NEGATIVE_INFINITY),{min:go(t,r),max:go(n,i),minDefined:Zr(t),maxDefined:Zr(n)}}getMinMax(t){let{min:n,max:r,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:n,max:r};const a=this.getMatchingVisibleMetas();for(let u=0,l=a.length;u<l;++u)o=a[u].controller.getMinMax(this,t),i||(n=Math.min(n,o.min)),s||(r=Math.max(r,o.max));return n=s&&n>r?r:n,r=i&&n>r?n:r,{min:go(n,go(r,n)),max:go(r,go(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Qn(this.options.beforeUpdate,[this])}update(t,n,r){const{beginAtZero:i,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Lqt(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const u=a<this.ticks.length;this._convertTicksToLabels(u?Kre(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=lKt(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),u&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,t=!t),this._startPixel=n,this._endPixel=r,this._reversePixels=t,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Qn(this.options.afterUpdate,[this])}beforeSetDimensions(){Qn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Qn(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Qn(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Qn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let r,i,s;for(r=0,i=t.length;r<i;r++)s=t[r],s.label=Qn(n.callback,[s.value,r,t],this)}afterTickToLabelConversion(){Qn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Qn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,r=Xre(this.ticks.length,t.ticks.maxTicksLimit),i=n.minRotation||0,s=n.maxRotation;let o=i,a,u,l;if(!this._isVisible()||!n.display||i>=s||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const c=this._getLabelSizes(),f=c.widest.width,d=c.highest.height,h=Sa(this.chart.width-f,0,this.maxWidth);a=t.offset?this.maxWidth/r:h/(r-1),f+6>a&&(a=h/(r-(t.offset?.5:1)),u=this.maxHeight-Nv(t.grid)-n.padding-Yre(t.title,this.chart.options.font),l=Math.sqrt(f*f+d*d),o=Hq(Math.min(Math.asin(Sa((c.highest.height+6)/a,-1,1)),Math.asin(Sa(u/l,-1,1))-Math.asin(Sa(d/l,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Qn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Qn(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:r,title:i,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const u=Yre(i,n.options.font);if(a?(t.width=this.maxWidth,t.height=Nv(s)+u):(t.height=this.maxHeight,t.width=Nv(s)+u),r.display&&this.ticks.length){const{first:l,last:c,widest:f,highest:d}=this._getLabelSizes(),h=r.padding*2,p=nd(this.labelRotation),m=Math.cos(p),g=Math.sin(p);if(a){const y=r.mirror?0:g*f.width+m*d.height;t.height=Math.min(this.maxHeight,t.height+y+h)}else{const y=r.mirror?0:m*f.width+g*d.height;t.width=Math.min(this.maxWidth,t.width+y+h)}this._calculatePadding(l,c,g,m)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,r,i){const{ticks:{align:s,padding:o},position:a}=this.options,u=this.labelRotation!==0,l=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,h=0;u?l?(d=i*t.width,h=r*n.height):(d=r*t.height,h=i*n.width):s==="start"?h=n.width:s==="end"?d=t.width:s!=="inner"&&(d=t.width/2,h=n.width/2),this.paddingLeft=Math.max((d-c+o)*this.width/(this.width-c),0),this.paddingRight=Math.max((h-f+o)*this.width/(this.width-f),0)}else{let c=n.height/2,f=t.height/2;s==="start"?(c=0,f=t.height):s==="end"&&(c=n.height,f=0),this.paddingTop=c+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Qn(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,r;for(n=0,r=t.length;n<r;n++)Nn(t[n].label)&&(t.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=Kre(r,n)),this._labelSizes=t=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,r){const{ctx:i,_longestTextCache:s}=this,o=[],a=[],u=Math.floor(n/Xre(n,r));let l=0,c=0,f,d,h,p,m,g,y,b,v,x,w;for(f=0;f<n;f+=u){if(p=t[f].label,m=this._resolveTickFontOptions(f),i.font=g=m.string,y=s[g]=s[g]||{data:{},gc:[]},b=m.lineHeight,v=x=0,!Nn(p)&&!cr(p))v=aN(i,y.data,y.gc,v,p),x=b;else if(cr(p))for(d=0,h=p.length;d<h;++d)w=p[d],!Nn(w)&&!cr(w)&&(v=aN(i,y.data,y.gc,v,w),x+=b);o.push(v),a.push(x),l=Math.max(v,l),c=Math.max(x,c)}yKt(s,n);const S=o.indexOf(l),C=a.indexOf(c),k=E=>({width:o[E]||0,height:a[E]||0});return{first:k(0),last:k(n-1),widest:k(S),highest:k(C),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return aqt(this._alignToPixels?Wh(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const r=n[t];return r.$context||(r.$context=vKt(this.getContext(),t,r))}return this.$context||(this.$context=bKt(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=nd(this.labelRotation),r=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),s=this._getLabelSizes(),o=t.autoSkipPadding||0,a=s?s.widest.width+o:0,u=s?s.highest.height+o:0;return this.isHorizontal()?u*r>a*i?a/r:u/i:u*i<a*r?u/r:a/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,r=this.chart,i=this.options,{grid:s,position:o,border:a}=i,u=s.offset,l=this.isHorizontal(),f=this.ticks.length+(u?1:0),d=Nv(s),h=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,g=m/2,y=function(P){return Wh(r,P,m)};let b,v,x,w,S,C,k,E,_,T,D,O;if(o==="top")b=y(this.bottom),C=this.bottom-d,E=b-g,T=y(t.top)+g,O=t.bottom;else if(o==="bottom")b=y(this.top),T=t.top,O=y(t.bottom)-g,C=b+g,E=this.top+d;else if(o==="left")b=y(this.right),S=this.right-d,k=b-g,_=y(t.left)+g,D=t.right;else if(o==="right")b=y(this.left),_=t.left,D=y(t.right)-g,S=b+g,k=this.left+d;else if(n==="x"){if(o==="center")b=y((t.top+t.bottom)/2+.5);else if(Yt(o)){const P=Object.keys(o)[0],V=o[P];b=y(this.chart.scales[P].getPixelForValue(V))}T=t.top,O=t.bottom,C=b+g,E=C+d}else if(n==="y"){if(o==="center")b=y((t.left+t.right)/2);else if(Yt(o)){const P=Object.keys(o)[0],V=o[P];b=y(this.chart.scales[P].getPixelForValue(V))}S=b-g,k=S-d,_=t.left,D=t.right}const M=ln(i.ticks.maxTicksLimit,f),I=Math.max(1,Math.ceil(f/M));for(v=0;v<f;v+=I){const P=this.getContext(v),V=s.setContext(P),F=a.setContext(P),B=V.lineWidth,q=V.color,J=F.dash||[],ne=F.dashOffset,re=V.tickWidth,ae=V.tickColor,le=V.tickBorderDash||[],me=V.tickBorderDashOffset;x=gKt(this,v,u),x!==void 0&&(w=Wh(r,x,B),l?S=k=_=D=w:C=E=T=O=w,h.push({tx1:S,ty1:C,tx2:k,ty2:E,x1:_,y1:T,x2:D,y2:O,width:B,color:q,borderDash:J,borderDashOffset:ne,tickWidth:re,tickColor:ae,tickBorderDash:le,tickBorderDashOffset:me}))}return this._ticksLength=f,this._borderValue=b,h}_computeLabelItems(t){const n=this.axis,r=this.options,{position:i,ticks:s}=r,o=this.isHorizontal(),a=this.ticks,{align:u,crossAlign:l,padding:c,mirror:f}=s,d=Nv(r.grid),h=d+c,p=f?-c:h,m=-nd(this.labelRotation),g=[];let y,b,v,x,w,S,C,k,E,_,T,D,O="middle";if(i==="top")S=this.bottom-p,C=this._getXAxisLabelAlignment();else if(i==="bottom")S=this.top+p,C=this._getXAxisLabelAlignment();else if(i==="left"){const I=this._getYAxisLabelAlignment(d);C=I.textAlign,w=I.x}else if(i==="right"){const I=this._getYAxisLabelAlignment(d);C=I.textAlign,w=I.x}else if(n==="x"){if(i==="center")S=(t.top+t.bottom)/2+h;else if(Yt(i)){const I=Object.keys(i)[0],P=i[I];S=this.chart.scales[I].getPixelForValue(P)+h}C=this._getXAxisLabelAlignment()}else if(n==="y"){if(i==="center")w=(t.left+t.right)/2-h;else if(Yt(i)){const I=Object.keys(i)[0],P=i[I];w=this.chart.scales[I].getPixelForValue(P)}C=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(u==="start"?O="top":u==="end"&&(O="bottom"));const M=this._getLabelSizes();for(y=0,b=a.length;y<b;++y){v=a[y],x=v.label;const I=s.setContext(this.getContext(y));k=this.getPixelForTick(y)+s.labelOffset,E=this._resolveTickFontOptions(y),_=E.lineHeight,T=cr(x)?x.length:1;const P=T/2,V=I.color,F=I.textStrokeColor,B=I.textStrokeWidth;let q=C;o?(w=k,C==="inner"&&(y===b-1?q=this.options.reverse?"left":"right":y===0?q=this.options.reverse?"right":"left":q="center"),i==="top"?l==="near"||m!==0?D=-T*_+_/2:l==="center"?D=-M.highest.height/2-P*_+_:D=-M.highest.height+_/2:l==="near"||m!==0?D=_/2:l==="center"?D=M.highest.height/2-P*_:D=M.highest.height-T*_,f&&(D*=-1),m!==0&&!I.showLabelBackdrop&&(w+=_/2*Math.sin(m))):(S=k,D=(1-T)*_/2);let J;if(I.showLabelBackdrop){const ne=La(I.backdropPadding),re=M.heights[y],ae=M.widths[y];let le=D-ne.top,me=0-ne.left;switch(O){case"middle":le-=re/2;break;case"bottom":le-=re;break}switch(C){case"center":me-=ae/2;break;case"right":me-=ae;break;case"inner":y===b-1?me-=ae:y>0&&(me-=ae/2);break}J={left:me,top:le,width:ae+ne.width,height:re+ne.height,color:I.backdropColor}}g.push({label:x,font:E,textOffset:D,options:{rotation:m,color:V,strokeColor:F,strokeWidth:B,textAlign:q,textBaseline:O,translation:[w,S],backdrop:J}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-nd(this.labelRotation))return t==="top"?"left":"right";let i="center";return n.align==="start"?i="left":n.align==="end"?i="right":n.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),a=t+s,u=o.widest.width;let l,c;return n==="left"?i?(c=this.right+s,r==="near"?l="left":r==="center"?(l="center",c+=u/2):(l="right",c+=u)):(c=this.right-a,r==="near"?l="right":r==="center"?(l="center",c-=u/2):(l="left",c=this.left)):n==="right"?i?(c=this.left+s,r==="near"?l="right":r==="center"?(l="center",c-=u/2):(l="left",c-=u)):(c=this.left+a,r==="near"?l="left":r==="center"?(l="center",c+=u/2):(l="right",c=this.right)):l="right",{textAlign:l,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:r,top:i,width:s,height:o}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(r,i,s,o),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const i=this.ticks.findIndex(s=>s.value===t);return i>=0?n.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const n=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,o;const a=(u,l,c)=>{!c.width||!c.color||(r.save(),r.lineWidth=c.width,r.strokeStyle=c.color,r.setLineDash(c.borderDash||[]),r.lineDashOffset=c.borderDashOffset,r.beginPath(),r.moveTo(u.x,u.y),r.lineTo(l.x,l.y),r.stroke(),r.restore())};if(n.display)for(s=0,o=i.length;s<o;++s){const u=i[s];n.drawOnChartArea&&a({x:u.x1,y:u.y1},{x:u.x2,y:u.y2},u),n.drawTicks&&a({x:u.tx1,y:u.ty1},{x:u.tx2,y:u.ty2},{color:u.tickColor,width:u.tickWidth,borderDash:u.tickBorderDash,borderDashOffset:u.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:r,grid:i}}=this,s=r.setContext(this.getContext()),o=r.display?s.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,u=this._borderValue;let l,c,f,d;this.isHorizontal()?(l=Wh(t,this.left,o)-o/2,c=Wh(t,this.right,a)+a/2,f=d=u):(f=Wh(t,this.top,o)-o/2,d=Wh(t,this.bottom,a)+a/2,l=c=u),n.save(),n.lineWidth=s.width,n.strokeStyle=s.color,n.beginPath(),n.moveTo(l,f),n.lineTo(c,d),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&q$e(r,i);const s=this.getLabelItems(t);for(const o of s){const a=o.options,u=o.font,l=o.label,c=o.textOffset;uN(r,l,0,c,u,a)}i&&X$e(r)}drawTitle(){const{ctx:t,options:{position:n,title:r,reverse:i}}=this;if(!r.display)return;const s=Ro(r.font),o=La(r.padding),a=r.align;let u=s.lineHeight/2;n==="bottom"||n==="center"||Yt(n)?(u+=o.bottom,cr(r.text)&&(u+=s.lineHeight*(r.text.length-1))):u+=o.top;const{titleX:l,titleY:c,maxWidth:f,rotation:d}=wKt(this,u,n,a);uN(t,r.text,0,0,s,{color:r.color,maxWidth:f,rotation:d,textAlign:xKt(a,n,i),textBaseline:"middle",translation:[l,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,r=ln(t.grid&&t.grid.z,-1),i=ln(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Sg.prototype.draw?[{z:n,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:n,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let s,o;for(s=0,o=n.length;s<o;++s){const a=n[s];a[r]===this.id&&(!t||a.type===t)&&i.push(a)}return i}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return Ro(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class m_{constructor(t,n,r){this.type=t,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let r;kKt(n)&&(r=this.register(n));const i=this.items,s=t.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in i||(i[s]=t,SKt(t,o,r),this.override&&dr.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const n=this.items,r=t.id,i=this.scope;r in n&&delete n[r],i&&r in dr[i]&&(delete dr[i][r],this.override&&delete $m[r])}}function SKt(e,t,n){const r=C2(Object.create(null),[n?dr.get(n):{},dr.get(t),e.defaults]);dr.set(t,r),e.defaultRoutes&&CKt(t,e.defaultRoutes),e.descriptors&&dr.describe(t,e.descriptors)}function CKt(e,t){Object.keys(t).forEach(n=>{const r=n.split("."),i=r.pop(),s=[e].concat(r).join("."),o=t[n].split("."),a=o.pop(),u=o.join(".");dr.route(s,i,u,a)})}function kKt(e){return"id"in e&&"defaults"in e}class $Kt{constructor(){this.controllers=new m_(tw,"datasets",!0),this.elements=new m_(_m,"elements"),this.plugins=new m_(Object,"plugins"),this.scales=new m_(Sg,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,r){[...n].forEach(i=>{const s=r||this._getRegistryForType(i);r||s.isForType(i)||s===this.plugins&&i.id?this._exec(t,s,i):en(i,o=>{const a=r||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,n,r){const i=jq(t);Qn(r["before"+i],[],r),n[t](r),Qn(r["after"+i],[],r)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(t))return r}return this.plugins}_get(t,n,r){const i=n.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+r+".");return i}}var nl=new $Kt;class _Kt{constructor(){this._init=[]}notify(t,n,r,i){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const s=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(s,t,n,r);return n==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,n,r,i){i=i||{};for(const s of t){const o=s.plugin,a=o[r],u=[n,i,s.options];if(Qn(a,u,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Nn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const r=t&&t.config,i=ln(r.options&&r.options.plugins,{}),s=EKt(r);return i===!1&&!n?[]:AKt(t,s,i,n)}_notifyStateChanges(t){const n=this._oldCache||[],r=this._cache,i=(s,o)=>s.filter(a=>!o.some(u=>a.plugin.id===u.plugin.id));this._notify(i(n,r),t,"stop"),this._notify(i(r,n),t,"start")}}function EKt(e){const t={},n=[],r=Object.keys(nl.plugins.items);for(let s=0;s<r.length;s++)n.push(nl.getPlugin(r[s]));const i=e.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];n.indexOf(o)===-1&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}function TKt(e,t){return!t&&e===!1?null:e===!0?{}:e}function AKt(e,{plugins:t,localIds:n},r,i){const s=[],o=e.getContext();for(const a of t){const u=a.id,l=TKt(r[u],i);l!==null&&s.push({plugin:a,options:NKt(e.config,{plugin:a,local:n[u]},l,o)})}return s}function NKt(e,{plugin:t,local:n},r,i){const s=e.pluginScopeKeys(t),o=e.getOptionScopes(r,s);return n&&t.defaults&&o.push(t.defaults),e.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function K6(e,t){const n=dr.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function IKt(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function DKt(e,t){return e===t?"_index_":"_value_"}function Zre(e){if(e==="x"||e==="y"||e==="r")return e}function OKt(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Y6(e,...t){if(Zre(e))return e;for(const n of t){const r=n.axis||OKt(n.position)||e.length>1&&Zre(e[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function Qre(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function FKt(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(r=>r.xAxisID===e||r.yAxisID===e);if(n.length)return Qre(e,"x",n[0])||Qre(e,"y",n[0])}return{}}function RKt(e,t){const n=$m[e.type]||{scales:{}},r=t.scales||{},i=K6(e.type,t),s=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!Yt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const u=Y6(o,a,FKt(o,e),dr.scales[a.type]),l=DKt(u,i),c=n.scales||{};s[o]=Yx(Object.create(null),[{axis:u},a,c[u],c[l]])}),e.data.datasets.forEach(o=>{const a=o.type||e.type,u=o.indexAxis||K6(a,t),c=($m[a]||{}).scales||{};Object.keys(c).forEach(f=>{const d=IKt(f,u),h=o[d+"AxisID"]||d;s[h]=s[h]||Object.create(null),Yx(s[h],[{axis:d},r[h],c[f]])})}),Object.keys(s).forEach(o=>{const a=s[o];Yx(a,[dr.scales[a.type],dr.scale])}),s}function l_e(e){const t=e.options||(e.options={});t.plugins=ln(t.plugins,{}),t.scales=RKt(e,t)}function c_e(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function MKt(e){return e=e||{},e.data=c_e(e.data),l_e(e),e}const Jre=new Map,f_e=new Set;function g_(e,t){let n=Jre.get(e);return n||(n=t(),Jre.set(e,n),f_e.add(n)),n}const Iv=(e,t,n)=>{const r=iN(t,n);r!==void 0&&e.add(r)};class PKt{constructor(t){this._config=MKt(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=c_e(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),l_e(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return g_(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return g_(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return g_(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,r=this.type;return g_(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const r=this._scopeCache;let i=r.get(t);return(!i||n)&&(i=new Map,r.set(t,i)),i}getOptionScopes(t,n,r){const{options:i,type:s}=this,o=this._cachedScopes(t,r),a=o.get(n);if(a)return a;const u=new Set;n.forEach(c=>{t&&(u.add(t),c.forEach(f=>Iv(u,t,f))),c.forEach(f=>Iv(u,i,f)),c.forEach(f=>Iv(u,$m[s]||{},f)),c.forEach(f=>Iv(u,dr,f)),c.forEach(f=>Iv(u,G6,f))});const l=Array.from(u);return l.length===0&&l.push(Object.create(null)),f_e.has(n)&&o.set(n,l),l}chartOptionScopes(){const{options:t,type:n}=this;return[t,$m[n]||{},dr.datasets[n]||{},{type:n},dr,G6]}resolveNamedOptions(t,n,r,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=eie(this._resolverCache,t,i);let u=o;if(zKt(o,n)){s.$shared=!1,r=jd(r)?r():r;const l=this.createResolver(t,r,a);u=I1(o,r,l)}for(const l of n)s[l]=u[l];return s}createResolver(t,n,r=[""],i){const{resolver:s}=eie(this._resolverCache,t,r);return Yt(n)?I1(s,n,void 0,i):s}}function eie(e,t,n){let r=e.get(t);r||(r=new Map,e.set(t,r));const i=n.join();let s=r.get(i);return s||(s={resolver:Kq(t,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},r.set(i,s)),s}const LKt=e=>Yt(e)&&Object.getOwnPropertyNames(e).some(t=>jd(e[t]));function zKt(e,t){const{isScriptable:n,isIndexable:r}=Y$e(e);for(const i of t){const s=n(i),o=r(i),a=(o||s)&&e[i];if(s&&(jd(a)||LKt(a))||o&&cr(a))return!0}return!1}var BKt="4.4.3";const UKt=["top","bottom","left","right","chartArea"];function tie(e,t){return e==="top"||e==="bottom"||UKt.indexOf(e)===-1&&t==="x"}function nie(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function rie(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Qn(n&&n.onComplete,[e],t)}function WKt(e){const t=e.chart,n=t.options.animation;Qn(n&&n.onProgress,[e],t)}function d_e(e){return Qq()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const cE={},iie=e=>{const t=d_e(e);return Object.values(cE).filter(n=>n.canvas===t).pop()};function VKt(e,t,n){const r=Object.keys(e);for(const i of r){const s=+i;if(s>=t){const o=e[i];delete e[i],(n>0||s>t)&&(e[s+n]=o)}}}function jKt(e,t,n,r){return!n||e.type==="mouseout"?null:r?t:e}function y_(e,t,n){return e.options.clip?e[n]:t[n]}function HKt(e,t){const{xScale:n,yScale:r}=e;return n&&r?{left:y_(n,t,"left"),right:y_(n,t,"right"),top:y_(r,t,"top"),bottom:y_(r,t,"bottom")}:t}class ua{static register(...t){nl.add(...t),sie()}static unregister(...t){nl.remove(...t),sie()}constructor(t,n){const r=this.config=new PKt(n),i=d_e(t),s=iie(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||uKt(i)),this.platform.updateConfig(r);const a=this.platform.acquireContext(i,o.aspectRatio),u=a&&a.canvas,l=u&&u.height,c=u&&u.width;if(this.id=XGt(),this.ctx=a,this.canvas=u,this.width=c,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new _Kt,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=hqt(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],cE[this.id]=this,!a||!u){console.error("Failed to create chart: can't acquire context from the given item");return}oc.listen(this,"complete",rie),oc.listen(this,"progress",WKt),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:r,height:i,_aspectRatio:s}=this;return Nn(t)?n&&s?s:i?r/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return nl}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Are(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return _re(this.canvas,this.ctx),this}stop(){return oc.stop(this),this}resize(t,n){oc.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const r=this.options,i=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,n,s),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),u=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Are(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Qn(r.onResize,[this,o],this),this.attached&&this._doResize(u)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};en(n,(r,i)=>{r.id=i})}buildOrUpdateScales(){const t=this.options,n=t.scales,r=this.scales,i=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let s=[];n&&(s=s.concat(Object.keys(n).map(o=>{const a=n[o],u=Y6(o,a),l=u==="r",c=u==="x";return{options:a,dposition:l?"chartArea":c?"bottom":"left",dtype:l?"radialLinear":c?"category":"linear"}}))),en(s,o=>{const a=o.options,u=a.id,l=Y6(u,a),c=ln(a.type,o.dtype);(a.position===void 0||tie(a.position,l)!==tie(o.dposition))&&(a.position=o.dposition),i[u]=!0;let f=null;if(u in r&&r[u].type===c)f=r[u];else{const d=nl.getScale(c);f=new d({id:u,type:c,ctx:this.ctx,chart:this}),r[f.id]=f}f.init(a,t)}),en(i,(o,a)=>{o||delete r[a]}),en(r,o=>{h_.configure(this,o,o.options),h_.addBox(this,o)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,r=t.length;if(t.sort((i,s)=>i.index-s.index),r>n){for(let i=n;i<r;++i)this._destroyDatasetMeta(i);t.splice(n,r-n)}this._sortedMetasets=t.slice(0).sort(nie("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((r,i)=>{n.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=n.length;r<i;r++){const s=n[r];let o=this.getDatasetMeta(r);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=s.indexAxis||K6(a,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const u=nl.getController(a),{datasetElementType:l,dataElementType:c}=dr.datasets[a];Object.assign(u,{dataElementType:nl.getElement(c),datasetElementType:l&&nl.getElement(l)}),o.controller=new u(this,r),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){en(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:f}=this.getDatasetMeta(l),d=!i&&s.indexOf(f)===-1;f.buildOrUpdateElements(d),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),i||en(s,l=>{l.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(nie("z","_idx"));const{_active:a,_lastEvent:u}=this;u?this._eventHandler(u,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){en(this.scales,t=>{h_.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(t.events);(!gre(n,r)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:s}of n){const o=r==="_removeElements"?-s:s;VKt(t,i,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=s=>new Set(t.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),i=r(0);for(let s=1;s<n;s++)if(!gre(i,r(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;h_.update(this,this.width,this.height,t);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],en(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,jd(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const r=this.getDatasetMeta(t),i={meta:r,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(n),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(oc.has(this)?this.attached&&!oc.running(this)&&oc.start(this):(this.draw(),rie({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resize(r,i),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,r=[];let i,s;for(i=0,s=n.length;i<s;++i){const o=n[i];(!t||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,r=t._clip,i=!r.disabled,s=HKt(t,this.chartArea),o={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(i&&q$e(n,{left:r.left===!1?0:s.left-r.left,right:r.right===!1?this.width:s.right+r.right,top:r.top===!1?0:s.top-r.top,bottom:r.bottom===!1?this.height:s.bottom+r.bottom}),t.controller.draw(),i&&X$e(n),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(t){return Nc(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,r,i){const s=UXt.modes[n];return typeof s=="function"?s(this,t,r,i):[]}getDatasetMeta(t){const n=this.data.datasets[t],r=this._metasets;let i=r.filter(s=>s&&s._dataset===n).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=Sh(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const r=this.getDatasetMeta(t);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(t,n){const r=this.getDatasetMeta(t);r.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,r){const i=r?"show":"hide",s=this.getDatasetMeta(t),o=s.controller._resolveAnimations(void 0,i);sN(n)?(s.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),o.update(s,{visible:r}),this.update(a=>a.datasetIndex===t?i:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),oc.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),_re(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete cE[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,r=(s,o)=>{n.addEventListener(this,s,o),t[s]=o},i=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};en(this.options.events,s=>r(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,r=(u,l)=>{n.addEventListener(this,u,l),t[u]=l},i=(u,l)=>{t[u]&&(n.removeEventListener(this,u,l),delete t[u])},s=(u,l)=>{this.canvas&&this.resize(u,l)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),r("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){en(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},en(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,r){const i=r?"set":"remove";let s,o,a,u;for(n==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),a=0,u=t.length;a<u;++a){o=t[a];const l=o&&this.getDatasetMeta(o.datasetIndex).controller;l&&l[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],r=t.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!nN(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(t,n,r){return this._plugins.notify(this,t,n,r)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,r){const i=this.options.hover,s=(u,l)=>u.filter(c=>!l.some(f=>c.datasetIndex===f.datasetIndex&&c.index===f.index)),o=s(n,t),a=r?t:s(t,n);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(t,n){const r={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},i=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const s=this._handleEvent(t,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(s||r.changed)&&this.render(),this}_handleEvent(t,n,r){const{_active:i=[],options:s}=this,o=n,a=this._getActiveElements(t,i,r,o),u=eqt(t),l=jKt(t,this._lastEvent,r,u);r&&(this._lastEvent=null,Qn(s.onHover,[t,a,this],this),u&&Qn(s.onClick,[t,a,this],this));const c=!nN(a,i);return(c||n)&&(this._active=a,this._updateHoverStyles(a,i,n)),this._lastEvent=l,c}_getActiveElements(t,n,r,i){if(t.type==="mouseout")return[];if(!r)return n;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,i)}}ot(ua,"defaults",dr),ot(ua,"instances",cE),ot(ua,"overrides",$m),ot(ua,"registry",nl),ot(ua,"version",BKt),ot(ua,"getChart",iie);function sie(){return en(ua.instances,e=>e._plugins.invalidate())}function h_e(e,t,n=t){e.lineCap=ln(n.borderCapStyle,t.borderCapStyle),e.setLineDash(ln(n.borderDash,t.borderDash)),e.lineDashOffset=ln(n.borderDashOffset,t.borderDashOffset),e.lineJoin=ln(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=ln(n.borderWidth,t.borderWidth),e.strokeStyle=ln(n.borderColor,t.borderColor)}function GKt(e,t,n){e.lineTo(n.x,n.y)}function qKt(e){return e.stepped?Tqt:e.tension||e.cubicInterpolationMode==="monotone"?Aqt:GKt}function p_e(e,t,n={}){const r=e.length,{start:i=0,end:s=r-1}=n,{start:o,end:a}=t,u=Math.max(i,o),l=Math.min(s,a),c=i<o&&s<o||i>a&&s>a;return{count:r,start:u,loop:t.loop,ilen:l<u&&!c?r+l-u:l-u}}function XKt(e,t,n,r){const{points:i,options:s}=t,{count:o,start:a,loop:u,ilen:l}=p_e(i,n,r),c=qKt(s);let{move:f=!0,reverse:d}=r||{},h,p,m;for(h=0;h<=l;++h)p=i[(a+(d?l-h:h))%o],!p.skip&&(f?(e.moveTo(p.x,p.y),f=!1):c(e,m,p,d,s.stepped),m=p);return u&&(p=i[(a+(d?l:0))%o],c(e,m,p,d,s.stepped)),!!u}function KKt(e,t,n,r){const i=t.points,{count:s,start:o,ilen:a}=p_e(i,n,r),{move:u=!0,reverse:l}=r||{};let c=0,f=0,d,h,p,m,g,y;const b=x=>(o+(l?a-x:x))%s,v=()=>{m!==g&&(e.lineTo(c,g),e.lineTo(c,m),e.lineTo(c,y))};for(u&&(h=i[b(0)],e.moveTo(h.x,h.y)),d=0;d<=a;++d){if(h=i[b(d)],h.skip)continue;const x=h.x,w=h.y,S=x|0;S===p?(w<m?m=w:w>g&&(g=w),c=(f*c+x)/++f):(v(),e.lineTo(x,w),p=S,f=0,m=g=w),y=w}v()}function Z6(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?KKt:XKt}function YKt(e){return e.stepped?uXt:e.tension||e.cubicInterpolationMode==="monotone"?lXt:Qh}function ZKt(e,t,n,r){let i=t._path;i||(i=t._path=new Path2D,t.path(i,n,r)&&i.closePath()),h_e(e,t.options),e.stroke(i)}function QKt(e,t,n,r){const{segments:i,options:s}=t,o=Z6(t);for(const a of i)h_e(e,s,a.style),e.beginPath(),o(e,t,a,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}const JKt=typeof Path2D=="function";function eYt(e,t,n,r){JKt&&!t.options.segment?ZKt(e,t,n,r):QKt(e,t,n,r)}class mx extends _m{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;eXt(this._points,r,t,i,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=vXt(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,r=t.length;return r&&n[t[r-1].end]}interpolate(t,n){const r=this.options,i=t[n],s=this.points,o=gXt(this,{property:n,start:i,end:i});if(!o.length)return;const a=[],u=YKt(r);let l,c;for(l=0,c=o.length;l<c;++l){const{start:f,end:d}=o[l],h=s[f],p=s[d];if(h===p){a.push(h);continue}const m=Math.abs((i-h[n])/(p[n]-h[n])),g=u(h,p,m,r.stepped);g[n]=t[n],a.push(g)}return a.length===1?a[0]:a}pathSegment(t,n,r){return Z6(this)(t,this,n,r)}path(t,n,r){const i=this.segments,s=Z6(this);let o=this._loop;n=n||0,r=r||this.points.length-n;for(const a of i)o&=s(t,this,a,{start:n,end:n+r-1});return!!o}draw(t,n,r,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),eYt(t,this,r,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}ot(mx,"id","line"),ot(mx,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),ot(mx,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),ot(mx,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function oie(e,t,n,r){const i=e.options,{[n]:s}=e.getProps([n],r);return Math.abs(t-s)<i.radius+i.hitRadius}class fE extends _m{constructor(n){super();ot(this,"parsed");ot(this,"skip");ot(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,r,i){const s=this.options,{x:o,y:a}=this.getProps(["x","y"],i);return Math.pow(n-o,2)+Math.pow(r-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(n,r){return oie(this,n,"x",r)}inYRange(n,r){return oie(this,n,"y",r)}getCenterPoint(n){const{x:r,y:i}=this.getProps(["x","y"],n);return{x:r,y:i}}size(n){n=n||this.options||{};let r=n.radius||0;r=Math.max(r,r&&n.hoverRadius||0);const i=r&&n.borderWidth||0;return(r+i)*2}draw(n,r){const i=this.options;this.skip||i.radius<.1||!Nc(this,r,this.size(i)/2)||(n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.fillStyle=i.backgroundColor,q6(n,i,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}ot(fE,"id","point"),ot(fE,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),ot(fE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const gx={average(e){if(!e.length)return!1;let t,n,r=new Set,i=0,s=0;for(t=0,n=e.length;t<n;++t){const a=e[t].element;if(a&&a.hasValue()){const u=a.tooltipPosition();r.add(u.x),i+=u.y,++s}}return{x:[...r].reduce((a,u)=>a+u)/r.size,y:i/s}},nearest(e,t){if(!e.length)return!1;let n=t.x,r=t.y,i=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=e.length;s<o;++s){const u=e[s].element;if(u&&u.hasValue()){const l=u.getCenterPoint(),c=H6(t,l);c<i&&(i=c,a=u)}}if(a){const u=a.tooltipPosition();n=u.x,r=u.y}return{x:n,y:r}}};function el(e,t){return t&&(cr(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function ac(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function tYt(e,t){const{element:n,datasetIndex:r,index:i}=t,s=e.getDatasetMeta(r).controller,{label:o,value:a}=s.getLabelAndValue(i);return{chart:e,label:o,parsed:s.getParsed(i),raw:e.data.datasets[r].data[i],formattedValue:a,dataset:s.getDataset(),dataIndex:i,datasetIndex:r,element:n}}function aie(e,t){const n=e.chart.ctx,{body:r,footer:i,title:s}=e,{boxWidth:o,boxHeight:a}=t,u=Ro(t.bodyFont),l=Ro(t.titleFont),c=Ro(t.footerFont),f=s.length,d=i.length,h=r.length,p=La(t.padding);let m=p.height,g=0,y=r.reduce((x,w)=>x+w.before.length+w.lines.length+w.after.length,0);if(y+=e.beforeBody.length+e.afterBody.length,f&&(m+=f*l.lineHeight+(f-1)*t.titleSpacing+t.titleMarginBottom),y){const x=t.displayColors?Math.max(a,u.lineHeight):u.lineHeight;m+=h*x+(y-h)*u.lineHeight+(y-1)*t.bodySpacing}d&&(m+=t.footerMarginTop+d*c.lineHeight+(d-1)*t.footerSpacing);let b=0;const v=function(x){g=Math.max(g,n.measureText(x).width+b)};return n.save(),n.font=l.string,en(e.title,v),n.font=u.string,en(e.beforeBody.concat(e.afterBody),v),b=t.displayColors?o+2+t.boxPadding:0,en(r,x=>{en(x.before,v),en(x.lines,v),en(x.after,v)}),b=0,n.font=c.string,en(e.footer,v),n.restore(),g+=p.width,{width:g,height:m}}function nYt(e,t){const{y:n,height:r}=t;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}function rYt(e,t,n,r){const{x:i,width:s}=r,o=n.caretSize+n.caretPadding;if(e==="left"&&i+s+o>t.width||e==="right"&&i-s-o<0)return!0}function iYt(e,t,n,r){const{x:i,width:s}=n,{width:o,chartArea:{left:a,right:u}}=e;let l="center";return r==="center"?l=i<=(a+u)/2?"left":"right":i<=s/2?l="left":i>=o-s/2&&(l="right"),rYt(l,e,t,n)&&(l="center"),l}function uie(e,t,n){const r=n.yAlign||t.yAlign||nYt(e,n);return{xAlign:n.xAlign||t.xAlign||iYt(e,t,n,r),yAlign:r}}function sYt(e,t){let{x:n,width:r}=e;return t==="right"?n-=r:t==="center"&&(n-=r/2),n}function oYt(e,t,n){let{y:r,height:i}=e;return t==="top"?r+=n:t==="bottom"?r-=i+n:r-=i/2,r}function lie(e,t,n,r){const{caretSize:i,caretPadding:s,cornerRadius:o}=e,{xAlign:a,yAlign:u}=n,l=i+s,{topLeft:c,topRight:f,bottomLeft:d,bottomRight:h}=ew(o);let p=sYt(t,a);const m=oYt(t,u,l);return u==="center"?a==="left"?p+=l:a==="right"&&(p-=l):a==="left"?p-=Math.max(c,d)+i:a==="right"&&(p+=Math.max(f,h)+i),{x:Sa(p,0,r.width-t.width),y:Sa(m,0,r.height-t.height)}}function b_(e,t,n){const r=La(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-r.right:e.x+r.left}function cie(e){return el([],ac(e))}function aYt(e,t,n){return Sh(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function fie(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const m_e={beforeTitle:ic,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:ic,beforeBody:ic,beforeLabel:ic,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Nn(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:ic,afterBody:ic,beforeFooter:ic,footer:ic,afterFooter:ic};function Is(e,t,n,r){const i=e[t].call(n,r);return typeof i>"u"?m_e[t].call(n,r):i}class Q6 extends _m{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&n.options.animation&&r.animations,s=new n_e(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=aYt(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:r}=n,i=Is(r,"beforeTitle",this,t),s=Is(r,"title",this,t),o=Is(r,"afterTitle",this,t);let a=[];return a=el(a,ac(i)),a=el(a,ac(s)),a=el(a,ac(o)),a}getBeforeBody(t,n){return cie(Is(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:r}=n,i=[];return en(t,s=>{const o={before:[],lines:[],after:[]},a=fie(r,s);el(o.before,ac(Is(a,"beforeLabel",this,s))),el(o.lines,Is(a,"label",this,s)),el(o.after,ac(Is(a,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(t,n){return cie(Is(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:r}=n,i=Is(r,"beforeFooter",this,t),s=Is(r,"footer",this,t),o=Is(r,"afterFooter",this,t);let a=[];return a=el(a,ac(i)),a=el(a,ac(s)),a=el(a,ac(o)),a}_createItems(t){const n=this._active,r=this.chart.data,i=[],s=[],o=[];let a=[],u,l;for(u=0,l=n.length;u<l;++u)a.push(tYt(this.chart,n[u]));return t.filter&&(a=a.filter((c,f,d)=>t.filter(c,f,d,r))),t.itemSort&&(a=a.sort((c,f)=>t.itemSort(c,f,r))),en(a,c=>{const f=fie(t.callbacks,c);i.push(Is(f,"labelColor",this,c)),s.push(Is(f,"labelPointStyle",this,c)),o.push(Is(f,"labelTextColor",this,c))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(t,n){const r=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const a=gx[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const u=this._size=aie(this,r),l=Object.assign({},a,u),c=uie(this.chart,r,l),f=lie(r,l,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,s={opacity:1,x:f.x,y:f.y,width:u.width,height:u.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,r,i){const s=this.getCaretPosition(t,r,i);n.lineTo(s.x1,s.y1),n.lineTo(s.x2,s.y2),n.lineTo(s.x3,s.y3)}getCaretPosition(t,n,r){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:u,topRight:l,bottomLeft:c,bottomRight:f}=ew(a),{x:d,y:h}=t,{width:p,height:m}=n;let g,y,b,v,x,w;return s==="center"?(x=h+m/2,i==="left"?(g=d,y=g-o,v=x+o,w=x-o):(g=d+p,y=g+o,v=x-o,w=x+o),b=g):(i==="left"?y=d+Math.max(u,c)+o:i==="right"?y=d+p-Math.max(l,f)-o:y=this.caretX,s==="top"?(v=h,x=v-o,g=y-o,b=y+o):(v=h+m,x=v+o,g=y+o,b=y-o),w=v),{x1:g,x2:y,x3:b,y1:v,y2:x,y3:w}}drawTitle(t,n,r){const i=this.title,s=i.length;let o,a,u;if(s){const l=c4(r.rtl,this.x,this.width);for(t.x=b_(this,r.titleAlign,r),n.textAlign=l.textAlign(r.titleAlign),n.textBaseline="middle",o=Ro(r.titleFont),a=r.titleSpacing,n.fillStyle=r.titleColor,n.font=o.string,u=0;u<s;++u)n.fillText(i[u],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,u+1===s&&(t.y+=r.titleMarginBottom-a)}}_drawColorBox(t,n,r,i,s){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:u,boxWidth:l}=s,c=Ro(s.bodyFont),f=b_(this,"left",s),d=i.x(f),h=u<c.lineHeight?(c.lineHeight-u)/2:0,p=n.y+h;if(s.usePointStyle){const m={radius:Math.min(l,u)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},g=i.leftForLtr(d,l)+l/2,y=p+u/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,q6(t,m,g,y),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,q6(t,m,g,y)}else{t.lineWidth=Yt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const m=i.leftForLtr(d,l),g=i.leftForLtr(i.xPlus(d,1),l-2),y=ew(o.borderRadius);Object.values(y).some(b=>b!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,X6(t,{x:m,y:p,w:l,h:u,radius:y}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),X6(t,{x:g,y:p+1,w:l-2,h:u-2,radius:y}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(m,p,l,u),t.strokeRect(m,p,l,u),t.fillStyle=o.backgroundColor,t.fillRect(g,p+1,l-2,u-2))}t.fillStyle=this.labelTextColors[r]}drawBody(t,n,r){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:u,boxWidth:l,boxPadding:c}=r,f=Ro(r.bodyFont);let d=f.lineHeight,h=0;const p=c4(r.rtl,this.x,this.width),m=function(k){n.fillText(k,p.x(t.x+h),t.y+d/2),t.y+=d+s},g=p.textAlign(o);let y,b,v,x,w,S,C;for(n.textAlign=o,n.textBaseline="middle",n.font=f.string,t.x=b_(this,g,r),n.fillStyle=r.bodyColor,en(this.beforeBody,m),h=a&&g!=="right"?o==="center"?l/2+c:l+2+c:0,x=0,S=i.length;x<S;++x){for(y=i[x],b=this.labelTextColors[x],n.fillStyle=b,en(y.before,m),v=y.lines,a&&v.length&&(this._drawColorBox(n,t,x,p,r),d=Math.max(f.lineHeight,u)),w=0,C=v.length;w<C;++w)m(v[w]),d=f.lineHeight;en(y.after,m)}h=0,d=f.lineHeight,en(this.afterBody,m),t.y-=s}drawFooter(t,n,r){const i=this.footer,s=i.length;let o,a;if(s){const u=c4(r.rtl,this.x,this.width);for(t.x=b_(this,r.footerAlign,r),t.y+=r.footerMarginTop,n.textAlign=u.textAlign(r.footerAlign),n.textBaseline="middle",o=Ro(r.footerFont),n.fillStyle=r.footerColor,n.font=o.string,a=0;a<s;++a)n.fillText(i[a],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+r.footerSpacing}}drawBackground(t,n,r,i){const{xAlign:s,yAlign:o}=this,{x:a,y:u}=t,{width:l,height:c}=r,{topLeft:f,topRight:d,bottomLeft:h,bottomRight:p}=ew(i.cornerRadius);n.fillStyle=i.backgroundColor,n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.beginPath(),n.moveTo(a+f,u),o==="top"&&this.drawCaret(t,n,r,i),n.lineTo(a+l-d,u),n.quadraticCurveTo(a+l,u,a+l,u+d),o==="center"&&s==="right"&&this.drawCaret(t,n,r,i),n.lineTo(a+l,u+c-p),n.quadraticCurveTo(a+l,u+c,a+l-p,u+c),o==="bottom"&&this.drawCaret(t,n,r,i),n.lineTo(a+h,u+c),n.quadraticCurveTo(a,u+c,a,u+c-h),o==="center"&&s==="left"&&this.drawCaret(t,n,r,i),n.lineTo(a,u+f),n.quadraticCurveTo(a,u,a+f,u),n.closePath(),n.fill(),i.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,r=this.$animations,i=r&&r.x,s=r&&r.y;if(i||s){const o=gx[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=aie(this,t),u=Object.assign({},o,this._size),l=uie(n,t,u),c=lie(t,u,l,n);(i._to!==c.x||s._to!==c.y)&&(this.xAlign=l.xAlign,this.yAlign=l.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,c))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=La(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(t.save(),t.globalAlpha=r,this.drawBackground(s,t,i,n),dXt(t,n.textDirection),s.y+=o.top,this.drawTitle(s,t,n),this.drawBody(s,t,n),this.drawFooter(s,t,n),hXt(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const r=this._active,i=t.map(({datasetIndex:a,index:u})=>{const l=this.chart.getDatasetMeta(a);if(!l)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:l.data[u],index:u}}),s=!nN(r,i),o=this._positionChanged(i,n);(s||o)&&(this._active=i,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(t,s,n,r),a=this._positionChanged(o,t),u=n||!nN(o,s)||a;return u&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),u}_getActiveElements(t,n,r,i){const s=this.options;if(t.type==="mouseout")return[];if(!i)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(t,n){const{caretX:r,caretY:i,options:s}=this,o=gx[s.position].call(this,t,n);return o!==!1&&(r!==o.x||i!==o.y)}}ot(Q6,"positioners",gx);var uYt={id:"tooltip",_element:Q6,positioners:gx,afterInit(e,t,n){n&&(e.tooltip=new Q6({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:m_e},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const lYt=(e,t,n,r)=>(typeof t=="string"?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function cYt(e,t,n,r){const i=e.indexOf(t);if(i===-1)return lYt(e,t,n,r);const s=e.lastIndexOf(t);return i!==s?n:i}const fYt=(e,t)=>e===null?null:Sa(Math.round(e),0,t);function die(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class J6 extends Sg{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:i,label:s}of n)r[i]===s&&r.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(Nn(t))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===t?n:cYt(r,t,ln(n,t),this._addedLabels),fYt(n,r.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(r=0),n||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const t=this.min,n=this.max,r=this.options.offset,i=[];let s=this.getLabels();s=t===0&&n===s.length-1?s:s.slice(t,n+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=t;o<=n;o++)i.push({value:o});return i}getLabelForValue(t){return die.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}ot(J6,"id","category"),ot(J6,"defaults",{ticks:{callback:die}});function dYt(e,t){const n=[],{bounds:i,step:s,min:o,max:a,precision:u,count:l,maxTicks:c,maxDigits:f,includeBounds:d}=e,h=s||1,p=c-1,{min:m,max:g}=t,y=!Nn(o),b=!Nn(a),v=!Nn(l),x=(g-m)/(f+1);let w=bre((g-m)/p/h)*h,S,C,k,E;if(w<1e-14&&!y&&!b)return[{value:m},{value:g}];E=Math.ceil(g/w)-Math.floor(m/w),E>p&&(w=bre(E*w/p/h)*h),Nn(u)||(S=Math.pow(10,u),w=Math.ceil(w*S)/S),i==="ticks"?(C=Math.floor(m/w)*w,k=Math.ceil(g/w)*w):(C=m,k=g),y&&b&&s&&iqt((a-o)/s,w/1e3)?(E=Math.round(Math.min((a-o)/w,c)),w=(a-o)/E,C=o,k=a):v?(C=y?o:C,k=b?a:k,E=l-1,w=(k-C)/E):(E=(k-C)/w,Zx(E,Math.round(E),w/1e3)?E=Math.round(E):E=Math.ceil(E));const _=Math.max(vre(w),vre(C));S=Math.pow(10,Nn(u)?_:u),C=Math.round(C*S)/S,k=Math.round(k*S)/S;let T=0;for(y&&(d&&C!==o?(n.push({value:o}),C<o&&T++,Zx(Math.round((C+T*w)*S)/S,o,hie(o,x,e))&&T++):C<o&&T++);T<E;++T){const D=Math.round((C+T*w)*S)/S;if(b&&D>a)break;n.push({value:D})}return b&&d&&k!==a?n.length&&Zx(n[n.length-1].value,a,hie(a,x,e))?n[n.length-1].value=a:n.push({value:a}):(!b||k===a)&&n.push({value:k}),n}function hie(e,t,{horizontal:n,minRotation:r}){const i=nd(r),s=(n?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+e).length;return Math.min(t/s,o)}class fN extends Sg{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return Nn(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:i,max:s}=this;const o=u=>i=n?i:u,a=u=>s=r?s:u;if(t){const u=N1(i),l=N1(s);u<0&&l<0?a(0):u>0&&l>0&&o(0)}if(i===s){let u=s===0?1:Math.abs(s*.05);a(s+u),t||o(i-u)}this.min=i,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=t,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),n=n||11),n&&(i=Math.min(n,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},s=this._range||this,o=dYt(i,s);return t.bounds==="ticks"&&U$e(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&t.length){const i=(r-n)/Math.max(t.length-1,1)/2;n-=i,r+=i}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(t){return Xq(t,this.chart.options.locale,this.options.ticks.format)}}class ez extends fN{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Zr(t)?t:0,this.max=Zr(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,r=nd(this.options.ticks.minRotation),i=(t?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,s.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}ot(ez,"id","linear"),ot(ez,"defaults",{ticks:{callback:NF.formatters.numeric}});const _2=e=>Math.floor(td(e)),jh=(e,t)=>Math.pow(10,_2(e)+t);function pie(e){return e/Math.pow(10,_2(e))===1}function mie(e,t,n){const r=Math.pow(10,n),i=Math.floor(e/r);return Math.ceil(t/r)-i}function hYt(e,t){const n=t-e;let r=_2(n);for(;mie(e,t,r)>10;)r++;for(;mie(e,t,r)<10;)r--;return Math.min(r,_2(e))}function pYt(e,{min:t,max:n}){t=go(e.min,t);const r=[],i=_2(t);let s=hYt(t,n),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),u=i>s?Math.pow(10,i):0,l=Math.round((t-u)*o)/o,c=Math.floor((t-u)/a/10)*a*10;let f=Math.floor((l-c)/Math.pow(10,s)),d=go(e.min,Math.round((u+c+f*Math.pow(10,s))*o)/o);for(;d<n;)r.push({value:d,major:pie(d),significand:f}),f>=10?f=f<15?15:20:f++,f>=20&&(s++,f=2,o=s>=0?1:o),d=Math.round((u+c+f*Math.pow(10,s))*o)/o;const h=go(e.max,d);return r.push({value:h,major:pie(h),significand:f}),r}class gie extends Sg{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const r=fN.prototype.parse.apply(this,[t,n]);if(r===0){this._zero=!0;return}return Zr(r)&&r>0?r:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Zr(t)?Math.max(0,t):null,this.max=Zr(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Zr(this._userMin)&&(this.min=t===jh(this.min,0)?jh(this.min,-1):jh(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let r=this.min,i=this.max;const s=a=>r=t?r:a,o=a=>i=n?i:a;r===i&&(r<=0?(s(1),o(10)):(s(jh(r,-1)),o(jh(i,1)))),r<=0&&s(jh(i,-1)),i<=0&&o(jh(r,1)),this.min=r,this.max=i}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},r=pYt(n,this);return t.bounds==="ticks"&&U$e(r,this,"value"),t.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(t){return t===void 0?"0":Xq(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=td(t),this._valueRange=td(this.max)-td(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(td(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}ot(gie,"id","logarithmic"),ot(gie,"defaults",{ticks:{callback:NF.formatters.logarithmic,major:{enabled:!0}}});function tz(e){const t=e.ticks;if(t.display&&e.display){const n=La(t.backdropPadding);return ln(t.font&&t.font.size,dr.font.size)+n.height}return 0}function mYt(e,t,n){return n=cr(n)?n:[n],{w:_qt(e,t.string,n),h:n.length*t.lineHeight}}function yie(e,t,n,r,i){return e===r||e===i?{start:t-n/2,end:t+n/2}:e<r||e>i?{start:t-n,end:t}:{start:t,end:t+n}}function gYt(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),r=[],i=[],s=e._pointLabels.length,o=e.options.pointLabels,a=o.centerPointLabels?Jr/s:0;for(let u=0;u<s;u++){const l=o.setContext(e.getPointLabelContext(u));i[u]=l.padding;const c=e.getPointPosition(u,e.drawingArea+i[u],a),f=Ro(l.font),d=mYt(e.ctx,f,e._pointLabels[u]);r[u]=d;const h=nu(e.getIndexAngle(u)+a),p=Math.round(Hq(h)),m=yie(p,c.x,d.w,0,180),g=yie(p,c.y,d.h,90,270);yYt(n,t,h,m,g)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=xYt(e,r,i)}function yYt(e,t,n,r,i){const s=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,u=0;r.start<t.l?(a=(t.l-r.start)/s,e.l=Math.min(e.l,t.l-a)):r.end>t.r&&(a=(r.end-t.r)/s,e.r=Math.max(e.r,t.r+a)),i.start<t.t?(u=(t.t-i.start)/o,e.t=Math.min(e.t,t.t-u)):i.end>t.b&&(u=(i.end-t.b)/o,e.b=Math.max(e.b,t.b+u))}function bYt(e,t,n){const r=e.drawingArea,{extra:i,additionalAngle:s,padding:o,size:a}=n,u=e.getPointPosition(t,r+i+o,s),l=Math.round(Hq(nu(u.angle+Fo))),c=CYt(u.y,a.h,l),f=wYt(l),d=SYt(u.x,a.w,f);return{visible:!0,x:u.x,y:c,textAlign:f,left:d,top:c,right:d+a.w,bottom:c+a.h}}function vYt(e,t){if(!t)return!0;const{left:n,top:r,right:i,bottom:s}=e;return!(Nc({x:n,y:r},t)||Nc({x:n,y:s},t)||Nc({x:i,y:r},t)||Nc({x:i,y:s},t))}function xYt(e,t,n){const r=[],i=e._pointLabels.length,s=e.options,{centerPointLabels:o,display:a}=s.pointLabels,u={extra:tz(s)/2,additionalAngle:o?Jr/i:0};let l;for(let c=0;c<i;c++){u.padding=n[c],u.size=t[c];const f=bYt(e,c,u);r.push(f),a==="auto"&&(f.visible=vYt(f,l),f.visible&&(l=f))}return r}function wYt(e){return e===0||e===180?"center":e<180?"left":"right"}function SYt(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function CYt(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function kYt(e,t,n){const{left:r,top:i,right:s,bottom:o}=n,{backdropColor:a}=t;if(!Nn(a)){const u=ew(t.borderRadius),l=La(t.backdropPadding);e.fillStyle=a;const c=r-l.left,f=i-l.top,d=s-r+l.width,h=o-i+l.height;Object.values(u).some(p=>p!==0)?(e.beginPath(),X6(e,{x:c,y:f,w:d,h,radius:u}),e.fill()):e.fillRect(c,f,d,h)}}function $Yt(e,t){const{ctx:n,options:{pointLabels:r}}=e;for(let i=t-1;i>=0;i--){const s=e._pointLabelItems[i];if(!s.visible)continue;const o=r.setContext(e.getPointLabelContext(i));kYt(n,o,s);const a=Ro(o.font),{x:u,y:l,textAlign:c}=s;uN(n,e._pointLabels[i],u,l+a.lineHeight/2,a,{color:o.color,textAlign:c,textBaseline:"middle"})}}function g_e(e,t,n,r){const{ctx:i}=e;if(n)i.arc(e.xCenter,e.yCenter,t,0,Cu);else{let s=e.getPointPosition(0,t);i.moveTo(s.x,s.y);for(let o=1;o<r;o++)s=e.getPointPosition(o,t),i.lineTo(s.x,s.y)}}function _Yt(e,t,n,r,i){const s=e.ctx,o=t.circular,{color:a,lineWidth:u}=t;!o&&!r||!a||!u||n<0||(s.save(),s.strokeStyle=a,s.lineWidth=u,s.setLineDash(i.dash),s.lineDashOffset=i.dashOffset,s.beginPath(),g_e(e,n,o,r),s.closePath(),s.stroke(),s.restore())}function EYt(e,t,n){return Sh(e,{label:n,index:t,type:"pointLabel"})}class v_ extends fN{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=La(tz(this.options)/2),n=this.width=this.maxWidth-t.width,r=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+r/2+t.top),this.drawingArea=Math.floor(Math.min(n,r)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=Zr(t)&&!isNaN(t)?t:0,this.max=Zr(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/tz(this.options))}generateTickLabels(t){fN.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,r)=>{const i=Qn(this.options.pointLabels.callback,[n,r],this);return i||i===0?i:""}).filter((n,r)=>this.chart.getDataVisibility(r))}fit(){const t=this.options;t.display&&t.pointLabels.display?gYt(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,r,i){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((r-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,r,i))}getIndexAngle(t){const n=Cu/(this._pointLabels.length||1),r=this.options.startAngle||0;return nu(t*n+nd(r))}getDistanceFromCenterForValue(t){if(Nn(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(Nn(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const r=n[t];return EYt(this.getContext(),t,r)}}getPointPosition(t,n,r=0){const i=this.getIndexAngle(t)-Fo+r;return{x:Math.cos(i)*n+this.xCenter,y:Math.sin(i)*n+this.yCenter,angle:i}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:r,right:i,bottom:s}=this._pointLabelItems[t];return{left:n,top:r,right:i,bottom:s}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const r=this.ctx;r.save(),r.beginPath(),g_e(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),r.closePath(),r.fillStyle=t,r.fill(),r.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:r,grid:i,border:s}=n,o=this._pointLabels.length;let a,u,l;if(n.pointLabels.display&&$Yt(this,o),i.display&&this.ticks.forEach((c,f)=>{if(f!==0||f===0&&this.min<0){u=this.getDistanceFromCenterForValue(c.value);const d=this.getContext(f),h=i.setContext(d),p=s.setContext(d);_Yt(this,h,u,o,p)}}),r.display){for(t.save(),a=o-1;a>=0;a--){const c=r.setContext(this.getPointLabelContext(a)),{color:f,lineWidth:d}=c;!d||!f||(t.lineWidth=d,t.strokeStyle=f,t.setLineDash(c.borderDash),t.lineDashOffset=c.borderDashOffset,u=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),l=this.getPointPosition(a,u),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,r=n.ticks;if(!r.display)return;const i=this.getIndexAngle(0);let s,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,u)=>{if(u===0&&this.min>=0&&!n.reverse)return;const l=r.setContext(this.getContext(u)),c=Ro(l.font);if(s=this.getDistanceFromCenterForValue(this.ticks[u].value),l.showLabelBackdrop){t.font=c.string,o=t.measureText(a.label).width,t.fillStyle=l.backdropColor;const f=La(l.backdropPadding);t.fillRect(-o/2-f.left,-s-c.size/2-f.top,o+f.width,c.size+f.height)}uN(t,a.label,0,-s,c,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})}),t.restore()}drawTitle(){}}ot(v_,"id","radialLinear"),ot(v_,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:NF.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),ot(v_,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),ot(v_,"descriptors",{angleLines:{_fallback:"grid"}});const DF={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Vs=Object.keys(DF);function bie(e,t){return e-t}function vie(e,t){if(Nn(t))return null;const n=e._adapter,{parser:r,round:i,isoWeekday:s}=e._parseOpts;let o=t;return typeof r=="function"&&(o=r(o)),Zr(o)||(o=typeof r=="string"?n.parse(o,r):n.parse(o)),o===null?null:(i&&(o=i==="week"&&(k2(s)||s===!0)?n.startOf(o,"isoWeek",s):n.startOf(o,i)),+o)}function xie(e,t,n,r){const i=Vs.length;for(let s=Vs.indexOf(e);s<i-1;++s){const o=DF[Vs[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(a*o.size))<=r)return Vs[s]}return Vs[i-1]}function TYt(e,t,n,r,i){for(let s=Vs.length-1;s>=Vs.indexOf(n);s--){const o=Vs[s];if(DF[o].common&&e._adapter.diff(i,r,o)>=t-1)return o}return Vs[n?Vs.indexOf(n):0]}function AYt(e){for(let t=Vs.indexOf(e)+1,n=Vs.length;t<n;++t)if(DF[Vs[t]].common)return Vs[t]}function wie(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:r,hi:i}=Gq(n,t),s=n[r]>=t?n[r]:n[i];e[s]=!0}}function NYt(e,t,n,r){const i=e._adapter,s=+i.startOf(t[0].value,r),o=t[t.length-1].value;let a,u;for(a=s;a<=o;a=+i.add(a,1,r))u=n[a],u>=0&&(t[u].major=!0);return t}function Sie(e,t,n){const r=[],i={},s=t.length;let o,a;for(o=0;o<s;++o)a=t[o],i[a]=o,r.push({value:a,major:!1});return s===0||!n?r:NYt(e,r,i,n)}class dN extends Sg{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const r=t.time||(t.time={}),i=this._adapter=new MXt._date(t.adapters.date);i.init(n),Yx(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:vie(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,r=t.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function u(l){!o&&!isNaN(l.min)&&(i=Math.min(i,l.min)),!a&&!isNaN(l.max)&&(s=Math.max(s,l.max))}(!o||!a)&&(u(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&u(this.getMinMax(!1))),i=Zr(i)&&!isNaN(i)?i:+n.startOf(Date.now(),r),s=Zr(s)&&!isNaN(s)?s:+n.endOf(Date.now(),r)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],r=t[t.length-1]),{min:n,max:r}}buildTicks(){const t=this.options,n=t.time,r=t.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,a=cqt(i,s,o);return this._unit=n.unit||(r.autoSkip?xie(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):TYt(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:AYt(this._unit),this.initOffsets(i),t.reverse&&a.reverse(),Sie(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,r=0,i,s;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?n=1-i:n=(this.getDecimalForValue(t[1])-i)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?r=s:r=(s-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;n=Sa(n,0,o),r=Sa(r,0,o),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const t=this._adapter,n=this.min,r=this.max,i=this.options,s=i.time,o=s.unit||xie(s.minUnit,n,r,this._getLabelCapacity(n)),a=ln(i.ticks.stepSize,1),u=o==="week"?s.isoWeekday:!1,l=k2(u)||u===!0,c={};let f=n,d,h;if(l&&(f=+t.startOf(f,"isoWeek",u)),f=+t.startOf(f,l?"day":o),t.diff(r,n,o)>1e5*a)throw new Error(n+" and "+r+" are too far apart with stepSize of "+a+" "+o);const p=i.ticks.source==="data"&&this.getDataTimestamps();for(d=f,h=0;d<r;d=+t.add(d,a,o),h++)wie(c,d,p);return(d===r||i.bounds==="ticks"||h===1)&&wie(c,d,p),Object.keys(c).sort(bie).map(m=>+m)}getLabelForValue(t){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(t,r.tooltipFormat):n.format(t,r.displayFormats.datetime)}format(t,n){const i=this.options.time.displayFormats,s=this._unit,o=n||i[s];return this._adapter.format(t,o)}_tickFormatFunction(t,n,r,i){const s=this.options,o=s.ticks.callback;if(o)return Qn(o,[t,n,r],this);const a=s.time.displayFormats,u=this._unit,l=this._majorUnit,c=u&&a[u],f=l&&a[l],d=r[n],h=l&&f&&d&&d.major;return this._adapter.format(t,i||(h?f:c))}generateTickLabels(t){let n,r,i;for(n=0,r=t.length;n<r;++n)i=t[n],i.label=this._tickFormatFunction(i.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,r=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(t){const n=this._offsets,r=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,r=this.ctx.measureText(t).width,i=nd(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:r*s+a*o,h:r*o+a*s}}_getLabelCapacity(t){const n=this.options.time,r=n.displayFormats,i=r[n.unit]||r.millisecond,s=this._tickFormatFunction(t,0,Sie(this,[t],this._majorUnit),i),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],n,r;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(n=0,r=i.length;n<r;++n)t=t.concat(i[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,r;if(t.length)return t;const i=this.getLabels();for(n=0,r=i.length;n<r;++n)t.push(vie(this,i[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return dqt(t.sort(bie))}}ot(dN,"id","time"),ot(dN,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function x_(e,t,n){let r=0,i=e.length-1,s,o,a,u;n?(t>=e[r].pos&&t<=e[i].pos&&({lo:r,hi:i}=yp(e,"pos",t)),{pos:s,time:a}=e[r],{pos:o,time:u}=e[i]):(t>=e[r].time&&t<=e[i].time&&({lo:r,hi:i}=yp(e,"time",t)),{time:s,pos:a}=e[r],{time:o,pos:u}=e[i]);const l=o-s;return l?a+(u-a)*(t-s)/l:a}class Cie extends dN{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=x_(n,this.min),this._tableRange=x_(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:r}=this,i=[],s=[];let o,a,u,l,c;for(o=0,a=t.length;o<a;++o)l=t[o],l>=n&&l<=r&&i.push(l);if(i.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(o=0,a=i.length;o<a;++o)c=i[o+1],u=i[o-1],l=i[o],Math.round((c+u)/2)!==l&&s.push({time:l,pos:o/(a-1)});return s}_generate(){const t=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(t)||!r.length)&&r.splice(0,0,t),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((i,s)=>i-s)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?t=this.normalize(n.concat(r)):t=n.length?n:r,t=this._cache.all=t,t}getDecimalForValue(t){return(x_(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,r=this.getDecimalForPixel(t)/n.factor-n.end;return x_(this._table,r*this._tableRange+this._minPos,!0)}}ot(Cie,"id","timeseries"),ot(Cie,"defaults",dN.defaults);let kie,$ie,_ie,Eie,dE,hE,yx,bx;window.onload=function(){kie=document.getElementById("batchLossChart"),$ie=document.getElementById("batchAccChart"),_ie=document.getElementById("epochLossChart"),Eie=document.getElementById("epochAccChart"),dE=new ua(kie,{type:"line",data:{labels:[],datasets:[{label:"Batch Loss",data:[],borderColor:"rgba(75, 192, 192, 1)",fill:!1}]},options:{legend:!1,tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{x:{title:{display:!0,text:"Batch"}},y:{title:{display:!0,text:"Loss"}}}}}),hE=new ua($ie,{type:"line",data:{labels:[],datasets:[{label:"Batch Accuracy",data:[],borderColor:"rgba(255, 99, 132, 1)",fill:!1}]},options:{legend:!0,tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{x:{title:{display:!0,text:"Batch"}},y:{title:{display:!0,text:"Accuracy"}}}}}),yx=new ua(_ie,{type:"line",data:{labels:[],datasets:[{label:"Epoch Loss",data:[],borderColor:"rgba(75, 192, 192, 1)",fill:!1},{label:"Epoch Validation Loss",data:[],borderColor:"rgba(255, 99, 132, 1)",fill:!1}]},options:{legend:!0,tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{x:{title:{display:!0,text:"Epoch"}},y:{title:{display:!0,text:"Loss"}}}}}),bx=new ua(Eie,{type:"line",data:{labels:[],datasets:[{label:"Epoch Accuracy",data:[],borderColor:"rgba(75, 192, 192, 1)",fill:!1},{label:"Epoch Validation Accuracy",data:[],borderColor:"rgba(255, 99, 132, 1)",fill:!1}]},options:{legend:!0,tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{x:{title:{display:!0,text:"Epoch"}},y:{title:{display:!0,text:"Accuracy"}}}}})};ua.register(uE,mx,fE,ez,J6,uYt);const fs=ace();fs.add(N9({inputShape:[28,28,1],kernelSize:5,filters:8,strides:1,activation:"relu"}));fs.add(K3({poolSize:[2,2],strides:[2,2]}));fs.add(X3(.45));fs.add(N9({kernelSize:5,filters:16,strides:1,activation:"relu"}));fs.add(K3({poolSize:[2,2],strides:[2,2]}));fs.add(X3(.45));fs.add(zce());fs.add(I9({units:128,activation:"relu"}));fs.add(X3(.5));fs.add(I9({units:10,activation:"softmax"}));let w_=1,S_=1;async function IYt(e,t){const n=document.getElementById("learning-rate").value,r=Ff.adamax(n);e.compile({optimizer:r,loss:"categoricalCrossentropy",metrics:["accuracy"]});const i=parseInt(document.getElementById("batch-size").value,10),s=5200,o=1300,a=document.getElementById("epochs").value,u=t.nextTrainBatch(s),l=t.nextTestBatch(o);return e.fit(u.xs.reshape([s,28,28,1]),u.labels,{batchSize:i,validationData:[l.xs.reshape([o,28,28,1]),l.labels],epochs:a,shuffle:!0,callbacks:{onBatchEnd:(c,f)=>{dE.data.labels.push(w_),dE.data.datasets[0].data.push(f.loss),dE.update(),hE.data.labels.push(w_),hE.data.datasets[0].data.push(f.acc),hE.update(),document.getElementById("batch-info").textContent=`Batch: ${w_} | Loss: ${f.loss.toFixed(3)} | Accuracy: ${f.acc.toFixed(3)}`,w_++},onEpochEnd:(c,f)=>{yx.data.labels.push(S_),yx.data.datasets[0].data.push(f.loss),yx.data.datasets[1].data.push(f.val_loss),yx.update(),bx.data.labels.push(S_),bx.data.datasets[0].data.push(f.acc),bx.data.datasets[1].data.push(f.val_acc),bx.update(),document.getElementById("epoch-info").textContent=`Epoch: ${S_} | Train, Valid Loss: ${f.loss.toFixed(3)}, ${f.val_loss.toFixed(3)} | Train, Valid Acc: ${f.acc.toFixed(3)}, ${f.val_acc.toFixed(3)}`,S_++}}})}async function DYt(e){const t=wl.visor().surface({name:"Input Data Examples",tab:"Model & Data"}),n=e.nextTestBatch(20),r=n.xs.shape[0];for(let i=0;i<r;i++){const s=K(()=>n.xs.slice([i,0],[1,n.xs.shape[1]]).reshape([28,28,1])),o=document.createElement("canvas");o.width=28,o.height=28,o.style="margin: 4px;",await Hue(s,o),t.drawArea.appendChild(o),s.dispose()}}const y_e=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"];function b_e(e,t,n=500){const s=t.nextTestBatch(n),o=s.xs.reshape([n,28,28,1]),a=s.labels.argMax(-1),u=e.predict(o).argMax(-1);return o.dispose(),[u,a]}async function OYt(e,t){const[n,r]=b_e(e,t),i=await wl.metrics.perClassAccuracy(r,n),s={name:"Accuracy",tab:"Evaluation"};wl.show.perClassAccuracy(s,i,y_e),r.dispose()}async function FYt(e,t){const[n,r]=b_e(e,t),i=await wl.metrics.confusionMatrix(r,n),s={name:"Confusion Matrix",tab:"Evaluation"};wl.render.confusionMatrix(s,{values:i,tickLabels:y_e}),r.dispose()}async function RYt(){wl.show.modelSummary({name:"Model Architecture",tab:"Model & Data"},fs);const e=new Wnt;await e.load(),await DYt(e),await IYt(fs,e),await OYt(fs,e),await FYt(fs,e)}function MYt(e){const[t,n]=Ic.useState(!1),[r,i]=Ic.useState(!1);function s(){wl.visor().isOpen()?(wl.visor().close(),n(!1)):(wl.visor().open(),n(!0))}async function o(){i(!0),await RYt(),i(!1)}return tt.jsxs(tt.Fragment,{children:[tt.jsx("button",{className:"button",id:"train-btn",onClick:o,disabled:r,children:r?"Training model...":"Train model"}),tt.jsx("button",{className:"button",id:"togglePanel-btn",onClick:s,children:t?"Close visor":"Open visor"}),tt.jsx("button",{className:"button",id:"toggleBoard-btn",onClick:e.toggleDrawCanvas,children:e.isBoardOpen?"Close whiteboard":"Open whiteboard"})]})}function PYt(){return tt.jsx(tt.Fragment,{children:tt.jsxs("div",{id:"chart-container",children:[tt.jsxs("div",{children:[tt.jsx("p",{children:"Batch Loss"}),tt.jsx("canvas",{className:"canvas",id:"batchLossChart"})]}),tt.jsxs("div",{children:[tt.jsx("p",{children:"Batch Accuracy"}),tt.jsx("canvas",{className:"canvas",id:"batchAccChart"})]}),tt.jsxs("div",{children:[tt.jsx("p",{children:"Epoch Loss"}),tt.jsx("canvas",{className:"canvas",id:"epochLossChart"})]}),tt.jsxs("div",{children:[tt.jsx("p",{children:"Epoch Accuracy"}),tt.jsx("canvas",{className:"canvas",id:"epochAccChart"})]})]})})}function LYt(){return tt.jsx(tt.Fragment,{children:tt.jsxs("div",{id:"loss-info-container",children:[tt.jsx("p",{id:"batch-info",children:"Batch: 0 | Loss: 0.000 | Acc: 0.000"}),tt.jsx("p",{id:"epoch-info",children:"Epoch: 0 | Train, Valid Loss: 0.000, 0.000 | Train, Valid Acc: 0.000, 0.000"})]})})}function zYt(){return tt.jsxs("div",{id:"hyperparamSetting-container",children:[tt.jsxs("div",{children:[tt.jsx("label",{htmlFor:"batch-size",children:"Batch size: "}),tt.jsx("input",{type:"number",id:"batch-size",defaultValue:"512"})]}),tt.jsxs("div",{children:[tt.jsx("label",{htmlFor:"epochs",children:"Epochs: "}),tt.jsx("input",{type:"number",id:"epochs",defaultValue:"20"})]}),tt.jsxs("div",{children:[tt.jsx("label",{htmlFor:"learning-rate",children:"Learning rate: "}),tt.jsx("input",{type:"number",id:"learning-rate",defaultValue:"0.01"})]})]})}function BYt(){const e=Ic.useRef(null),t=Ic.useRef(fs),[n,r]=Ic.useState(null),i=a=>{const u=e.current,l=u.getContext("2d"),c=u.getBoundingClientRect(),f=a.clientX-c.left,d=a.clientY-c.top;a.buttons===1&&(l.fillStyle="black",l.beginPath(),l.arc(f,d,10,0,Math.PI*2,!0),l.fill())},s=()=>{const a=e.current;a.getContext("2d").clearRect(0,0,a.width,a.height)},o=async()=>{const a=e.current,l=a.getContext("2d").getImageData(0,0,a.width,a.height),c=new Uint8Array(l.data.length/4);for(let m=0;m<l.data.length;m+=4)c[m/4]=l.data[m+3];const f=hs(c,[a.height,a.width,1]),h=Eo.resizeBilinear(f,[28,28]).toFloat().expandDims(0),p=t.current.predict(h);r(p.argMax(1).dataSync()[0])};return tt.jsxs("div",{id:"drawCanvas-container",children:[tt.jsx("p",{style:{fontSize:"24px"},children:"Drawing board"}),tt.jsx("canvas",{id:"draw-canvas",ref:e,width:"280",height:"280",onMouseMove:i,onMouseUp:o}),tt.jsxs("p",{style:{color:"red",fontSize:"28px"},children:["Predict: ",n]}),tt.jsx("button",{className:"button",id:"cleanBoard-btn",onClick:s,children:"Clean whiteboard"})]})}function UYt(){const[e,t]=Ic.useState(!0),n=()=>{t(!e)};return tt.jsxs(tt.Fragment,{children:[tt.jsx("h1",{children:"Mnist dataset playground"}),tt.jsxs("div",{id:"canvas-container",children:[tt.jsx(PYt,{}),e&&tt.jsx(BYt,{})]}),tt.jsx(LYt,{}),tt.jsx(zYt,{}),tt.jsx(MYt,{toggleDrawCanvas:n,isBoardOpen:e}),tt.jsxs("p",{style:{fontSize:"15px"},children:["Reference from:",tt.jsx("a",{href:"https://www.tensorflow.org/js/tutorials/transfer/image_classification",target:"_blank",rel:"noopener noreferrer",children:"https://www.tensorflow.org/js/tutorials/transfer/image_classification"})]})]})}g4.createRoot(document.getElementById("root")).render(tt.jsx(sEe.StrictMode,{children:tt.jsx(UYt,{})}))});export default WYt();
